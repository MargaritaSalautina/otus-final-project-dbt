[0m14:57:09.379759 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:09.390288 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: COMMIT
[0m14:57:09.391836 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m14:57:09.392956 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: COMMIT
[0m14:57:09.396684 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:09.398119 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_country (execute): 2024-09-01 14:57:09.298809 => 2024-09-01 14:57:09.398046
[0m14:57:09.399158 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: Close
[0m14:57:09.400657 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7a108f40>]}
[0m14:57:09.401735 [info ] [Thread-1  ]: 35 of 45 OK created sql incremental model dbt.sat_country ...................... [[32mINSERT 0 0[0m in 0.15s]
[0m14:57:09.403132 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_country
[0m14:57:09.404503 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_currency
[0m14:57:09.405585 [info ] [Thread-1  ]: 36 of 45 START sql incremental model dbt.sat_currency .......................... [RUN]
[0m14:57:09.407248 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_currency'
[0m14:57:09.408580 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_currency
[0m14:57:09.446163 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.453742 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency (compile): 2024-09-01 14:57:09.409590 => 2024-09-01 14:57:09.453623
[0m14:57:09.454768 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_currency
[0m14:57:09.467438 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.468410 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */

    
  
    

  create temporary table "sat_currency__dbt_tmp145709461318"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CURRENCY_PK, a.CURRENCY_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency" AS a
    WHERE a.CURRENCY_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CURRENCY_PK, a.CURRENCY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CURRENCY_PK, current_records.CURRENCY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CURRENCY_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_currency" AS current_records
            JOIN (
                SELECT DISTINCT source_data.CURRENCY_PK
                FROM source_data
            ) AS source_records
                ON current_records.CURRENCY_PK = source_records.CURRENCY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CURRENCY_PK, stage.CURRENCY_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CURRENCY_PK = stage.CURRENCY_PK
        AND latest_records.CURRENCY_HASHDIFF = stage.CURRENCY_HASHDIFF
    WHERE latest_records.CURRENCY_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:09.469161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:09.479594 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0 seconds
[0m14:57:09.485349 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.486334 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: BEGIN
[0m14:57:09.487374 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:09.488708 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.489691 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_currency__dbt_tmp145709461318'
        
      order by ordinal_position

  
[0m14:57:09.496247 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:09.503326 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.504433 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:09.508099 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:09.514000 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.515085 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:09.518692 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:09.523913 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.530968 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.531844 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */

      insert into "postgres"."dbt"."sat_currency" ("currency_pk", "currency_hashdiff", "name", "effective_from", "load_date", "record_source")
    (
        select "currency_pk", "currency_hashdiff", "name", "effective_from", "load_date", "record_source"
        from "sat_currency__dbt_tmp145709461318"
    )


  
[0m14:57:09.533120 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:09.536080 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: COMMIT
[0m14:57:09.537320 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m14:57:09.538232 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: COMMIT
[0m14:57:09.541572 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:09.543066 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency (execute): 2024-09-01 14:57:09.455660 => 2024-09-01 14:57:09.542999
[0m14:57:09.543848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: Close
[0m14:57:09.545280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79ea4d30>]}
[0m14:57:09.546479 [info ] [Thread-1  ]: 36 of 45 OK created sql incremental model dbt.sat_currency ..................... [[32mINSERT 0 0[0m in 0.14s]
[0m14:57:09.547994 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_currency
[0m14:57:09.549606 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_currency_rate
[0m14:57:09.550891 [info ] [Thread-1  ]: 37 of 45 START sql incremental model dbt.sat_currency_rate ..................... [RUN]
[0m14:57:09.552891 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_currency_rate'
[0m14:57:09.554044 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_currency_rate
[0m14:57:09.592823 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.600165 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency_rate (compile): 2024-09-01 14:57:09.555010 => 2024-09-01 14:57:09.600040
[0m14:57:09.601009 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_currency_rate
[0m14:57:09.613609 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.614746 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */

    
  
    

  create temporary table "sat_currency_rate__dbt_tmp145709606905"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CURRENCY_RATE_PK, a.CURRENCY_RATE_HASHDIFF, a.relation_to_rur, a.date_start, a.date_end, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency_rate" AS a
    WHERE a.CURRENCY_RATE_PK IS NOT NULL
),

latest_records AS (
    SELECT a.CURRENCY_RATE_PK, a.CURRENCY_RATE_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.CURRENCY_RATE_PK, current_records.CURRENCY_RATE_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.CURRENCY_RATE_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_currency_rate" AS current_records
            JOIN (
                SELECT DISTINCT source_data.CURRENCY_RATE_PK
                FROM source_data
            ) AS source_records
                ON current_records.CURRENCY_RATE_PK = source_records.CURRENCY_RATE_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.CURRENCY_RATE_PK, stage.CURRENCY_RATE_HASHDIFF, stage.relation_to_rur, stage.date_start, stage.date_end, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.CURRENCY_RATE_PK = stage.CURRENCY_RATE_PK
        AND latest_records.CURRENCY_RATE_HASHDIFF = stage.CURRENCY_RATE_HASHDIFF
    WHERE latest_records.CURRENCY_RATE_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:09.615544 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:09.677616 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0 seconds
[0m14:57:09.682929 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.684041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: BEGIN
[0m14:57:09.685253 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:09.686535 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.687537 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_currency_rate__dbt_tmp145709606905'
        
      order by ordinal_position

  
[0m14:57:09.694271 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0 seconds
[0m14:57:09.701402 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.702467 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:09.705981 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0 seconds
[0m14:57:09.754664 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.755813 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:09.758998 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0 seconds
[0m14:57:09.762914 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.770846 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.771553 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */

      insert into "postgres"."dbt"."sat_currency_rate" ("currency_rate_pk", "currency_rate_hashdiff", "relation_to_rur", "date_start", "date_end", "effective_from", "load_date", "record_source")
    (
        select "currency_rate_pk", "currency_rate_hashdiff", "relation_to_rur", "date_start", "date_end", "effective_from", "load_date", "record_source"
        from "sat_currency_rate__dbt_tmp145709606905"
    )


  
[0m14:57:09.772558 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:09.775070 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: COMMIT
[0m14:57:09.776004 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m14:57:09.776906 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: COMMIT
[0m14:57:09.779505 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:09.780892 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency_rate (execute): 2024-09-01 14:57:09.601690 => 2024-09-01 14:57:09.780831
[0m14:57:09.781849 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: Close
[0m14:57:09.783174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79fa11c0>]}
[0m14:57:09.784426 [info ] [Thread-1  ]: 37 of 45 OK created sql incremental model dbt.sat_currency_rate ................ [[32mINSERT 0 0[0m in 0.23s]
[0m14:57:09.785827 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_currency_rate
[0m14:57:09.787108 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_good
[0m14:57:09.788438 [info ] [Thread-1  ]: 38 of 45 START sql incremental model dbt.sat_good .............................. [RUN]
[0m14:57:09.790395 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_good'
[0m14:57:09.791474 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_good
[0m14:57:09.830407 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_good"
[0m14:57:09.839886 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_good (compile): 2024-09-01 14:57:09.792368 => 2024-09-01 14:57:09.839769
[0m14:57:09.840948 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_good
[0m14:57:09.853594 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m14:57:09.854738 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */

    
  
    

  create temporary table "sat_good__dbt_tmp145709847040"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.GOOD_PK, a.GOOD_HASHDIFF, a.name, a.cost_per_unit, a.count, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_goods" AS a
    WHERE a.GOOD_PK IS NOT NULL
),

latest_records AS (
    SELECT a.GOOD_PK, a.GOOD_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.GOOD_PK, current_records.GOOD_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.GOOD_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_good" AS current_records
            JOIN (
                SELECT DISTINCT source_data.GOOD_PK
                FROM source_data
            ) AS source_records
                ON current_records.GOOD_PK = source_records.GOOD_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.GOOD_PK, stage.GOOD_HASHDIFF, stage.name, stage.cost_per_unit, stage.count, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.GOOD_PK = stage.GOOD_PK
        AND latest_records.GOOD_HASHDIFF = stage.GOOD_HASHDIFF
    WHERE latest_records.GOOD_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:09.856026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:11.307723 [debug] [Thread-1  ]: SQL status: SELECT 0 in 1 seconds
[0m14:57:11.316302 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m14:57:11.317385 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: BEGIN
[0m14:57:11.318528 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:11.319846 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m14:57:11.320712 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_good__dbt_tmp145709847040'
        
      order by ordinal_position

  
[0m14:57:11.328562 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0 seconds
[0m14:57:11.336747 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m14:57:11.337795 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_good'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:11.340719 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0 seconds
[0m14:57:11.346548 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m14:57:11.347401 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_good'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:11.350319 [debug] [Thread-1  ]: SQL status: SELECT 8 in 0 seconds
[0m14:57:11.353953 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_good"
[0m14:57:11.360636 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m14:57:11.361518 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */

      insert into "postgres"."dbt"."sat_good" ("good_pk", "good_hashdiff", "name", "cost_per_unit", "count", "effective_from", "load_date", "record_source")
    (
        select "good_pk", "good_hashdiff", "name", "cost_per_unit", "count", "effective_from", "load_date", "record_source"
        from "sat_good__dbt_tmp145709847040"
    )


  
[0m14:57:11.362649 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:11.365470 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: COMMIT
[0m14:57:11.366351 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m14:57:11.367033 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: COMMIT
[0m14:57:11.369305 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:11.370647 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_good (execute): 2024-09-01 14:57:09.841657 => 2024-09-01 14:57:11.370583
[0m14:57:11.371344 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: Close
[0m14:57:11.372577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7854b160>]}
[0m14:57:11.373641 [info ] [Thread-1  ]: 38 of 45 OK created sql incremental model dbt.sat_good ......................... [[32mINSERT 0 0[0m in 1.58s]
[0m14:57:11.375049 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_good
[0m14:57:11.376344 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order
[0m14:57:11.377377 [info ] [Thread-1  ]: 39 of 45 START sql incremental model dbt.sat_order ............................. [RUN]
[0m14:57:11.379063 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order'
[0m14:57:11.379983 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order
[0m14:57:11.421823 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order"
[0m14:57:11.429512 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order (compile): 2024-09-01 14:57:11.380705 => 2024-09-01 14:57:11.429379
[0m14:57:11.430353 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order
[0m14:57:11.443782 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m14:57:11.445177 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order"} */

    
  
    

  create temporary table "sat_order__dbt_tmp145711437257"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.order_date, a.length, a.height, a.width, a.weight, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_orders" AS a
    WHERE a.ORDER_PK IS NOT NULL
),

latest_records AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_PK, current_records.ORDER_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ORDER_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_order" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_PK = source_records.ORDER_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.order_date, stage.length, stage.height, stage.width, stage.weight, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ORDER_PK = stage.ORDER_PK
        AND latest_records.ORDER_HASHDIFF = stage.ORDER_HASHDIFF
    WHERE latest_records.ORDER_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:11.445968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:12.122705 [debug] [Thread-1  ]: SQL status: SELECT 0 in 1 seconds
[0m14:57:12.128399 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m14:57:12.129630 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: BEGIN
[0m14:57:12.130976 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:12.132129 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m14:57:12.133724 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_order__dbt_tmp145711437257'
        
      order by ordinal_position

  
[0m14:57:12.139826 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0 seconds
[0m14:57:12.146369 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m14:57:12.147478 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.150849 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0 seconds
[0m14:57:12.157862 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m14:57:12.159006 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.162430 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0 seconds
[0m14:57:12.166215 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order"
[0m14:57:12.174288 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m14:57:12.175045 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order"} */

      insert into "postgres"."dbt"."sat_order" ("order_pk", "order_hashdiff", "order_date", "length", "height", "width", "weight", "effective_from", "load_date", "record_source")
    (
        select "order_pk", "order_hashdiff", "order_date", "length", "height", "width", "weight", "effective_from", "load_date", "record_source"
        from "sat_order__dbt_tmp145711437257"
    )


  
[0m14:57:12.176050 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:12.178507 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: COMMIT
[0m14:57:12.179720 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m14:57:12.180721 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: COMMIT
[0m14:57:12.183545 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:12.185048 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order (execute): 2024-09-01 14:57:11.430959 => 2024-09-01 14:57:12.184989
[0m14:57:12.185748 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: Close
[0m14:57:12.187036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79df2cd0>]}
[0m14:57:12.188036 [info ] [Thread-1  ]: 39 of 45 OK created sql incremental model dbt.sat_order ........................ [[32mINSERT 0 0[0m in 0.81s]
[0m14:57:12.189313 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order
[0m14:57:12.190640 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_status
[0m14:57:12.191650 [info ] [Thread-1  ]: 40 of 45 START sql incremental model dbt.sat_order_status ...................... [RUN]
[0m14:57:12.193292 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_status'
[0m14:57:12.194418 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_status
[0m14:57:12.229432 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.238917 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status (compile): 2024-09-01 14:57:12.195476 => 2024-09-01 14:57:12.238804
[0m14:57:12.239811 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_status
[0m14:57:12.251376 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.252903 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */

    
  
    

  create temporary table "sat_order_status__dbt_tmp145712245557"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_STATUS_PK, a.ORDER_STATUS_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status" AS a
    WHERE a.ORDER_STATUS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.ORDER_STATUS_PK, a.ORDER_STATUS_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_STATUS_PK, current_records.ORDER_STATUS_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ORDER_STATUS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_order_status" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_STATUS_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_STATUS_PK = source_records.ORDER_STATUS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_STATUS_PK, stage.ORDER_STATUS_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ORDER_STATUS_PK = stage.ORDER_STATUS_PK
        AND latest_records.ORDER_STATUS_HASHDIFF = stage.ORDER_STATUS_HASHDIFF
    WHERE latest_records.ORDER_STATUS_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:12.254016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:12.264661 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0 seconds
[0m14:57:12.270282 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.271985 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: BEGIN
[0m14:57:12.273361 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:12.274581 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.275951 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_order_status__dbt_tmp145712245557'
        
      order by ordinal_position

  
[0m14:57:12.282953 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:12.288938 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.290263 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.293889 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:12.299894 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.301415 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.304518 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:12.308080 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.317324 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.318073 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */

      insert into "postgres"."dbt"."sat_order_status" ("order_status_pk", "order_status_hashdiff", "name", "effective_from", "load_date", "record_source")
    (
        select "order_status_pk", "order_status_hashdiff", "name", "effective_from", "load_date", "record_source"
        from "sat_order_status__dbt_tmp145712245557"
    )


  
[0m14:57:12.319085 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:12.321587 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: COMMIT
[0m14:57:12.322403 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m14:57:12.323187 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: COMMIT
[0m14:57:12.325632 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:12.326922 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status (execute): 2024-09-01 14:57:12.240412 => 2024-09-01 14:57:12.326862
[0m14:57:12.327680 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: Close
[0m14:57:12.329100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7a4479d0>]}
[0m14:57:12.330451 [info ] [Thread-1  ]: 40 of 45 OK created sql incremental model dbt.sat_order_status ................. [[32mINSERT 0 0[0m in 0.14s]
[0m14:57:12.331787 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order_status
[0m14:57:12.332818 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_status_history
[0m14:57:12.333965 [info ] [Thread-1  ]: 41 of 45 START sql incremental model dbt.sat_order_status_history .............. [RUN]
[0m14:57:12.335436 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_status_history'
[0m14:57:12.336466 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_status_history
[0m14:57:12.373509 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_status_history"
[0m14:57:12.381548 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status_history (compile): 2024-09-01 14:57:12.337256 => 2024-09-01 14:57:12.381441
[0m14:57:12.382543 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_status_history
[0m14:57:12.396575 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status_history"
[0m14:57:12.397825 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status_history"} */

    
  
    

  create temporary table "sat_order_status_history__dbt_tmp145712389085"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY_HASHDIFF, a.status_datetime, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status_history" AS a
    WHERE a.ORDER_STATUS_HISTORY_PK IS NOT NULL
),

latest_records AS (
    SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_STATUS_HISTORY_PK, current_records.ORDER_STATUS_HISTORY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ORDER_STATUS_HISTORY_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_order_status_history" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_STATUS_HISTORY_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_STATUS_HISTORY_PK = source_records.ORDER_STATUS_HISTORY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_STATUS_HISTORY_PK, stage.ORDER_STATUS_HISTORY_HASHDIFF, stage.status_datetime, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ORDER_STATUS_HISTORY_PK = stage.ORDER_STATUS_HISTORY_PK
        AND latest_records.ORDER_STATUS_HISTORY_HASHDIFF = stage.ORDER_STATUS_HISTORY_HASHDIFF
    WHERE latest_records.ORDER_STATUS_HISTORY_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:12.399050 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:12.408030 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column a.order_status_history_hashdiff does not exist
LINE 12:     SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY...
                                               ^

[0m14:57:12.411328 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status_history (execute): 2024-09-01 14:57:12.383361 => 2024-09-01 14:57:12.411193
[0m14:57:12.412777 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: Close
[0m14:57:12.416225 [debug] [Thread-1  ]: Database Error in model sat_order_status_history (models/raw_vault/sats/sat_order_status_history.sql)
  column a.order_status_history_hashdiff does not exist
  LINE 12:     SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY...
                                                 ^
[0m14:57:12.417880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79e018b0>]}
[0m14:57:12.419330 [error] [Thread-1  ]: 41 of 45 ERROR creating sql incremental model dbt.sat_order_status_history ..... [[31mERROR[0m in 0.08s]
[0m14:57:12.420842 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order_status_history
[0m14:57:12.422326 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_with_delay
[0m14:57:12.423788 [info ] [Thread-1  ]: 42 of 45 START sql incremental model dbt.sat_order_with_delay .................. [RUN]
[0m14:57:12.425721 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_with_delay'
[0m14:57:12.426880 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_with_delay
[0m14:57:12.465512 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.475073 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_with_delay (compile): 2024-09-01 14:57:12.427928 => 2024-09-01 14:57:12.474948
[0m14:57:12.475960 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_with_delay
[0m14:57:12.489405 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.490684 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_with_delay"} */

    
  
    

  create temporary table "sat_order_with_delay__dbt_tmp145712483003"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_WITH_DELAY_PK, a.ORDER_WITH_DELAY_HASHDIFF, a.reason_for_delay, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_with_delay" AS a
    WHERE a.ORDER_WITH_DELAY_PK IS NOT NULL
),

latest_records AS (
    SELECT a.ORDER_WITH_DELAY_PK, a.ORDER_WITH_DELAY_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.ORDER_WITH_DELAY_PK, current_records.ORDER_WITH_DELAY_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.ORDER_WITH_DELAY_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_order_with_delay" AS current_records
            JOIN (
                SELECT DISTINCT source_data.ORDER_WITH_DELAY_PK
                FROM source_data
            ) AS source_records
                ON current_records.ORDER_WITH_DELAY_PK = source_records.ORDER_WITH_DELAY_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_WITH_DELAY_PK, stage.ORDER_WITH_DELAY_HASHDIFF, stage.reason_for_delay, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.ORDER_WITH_DELAY_PK = stage.ORDER_WITH_DELAY_PK
        AND latest_records.ORDER_WITH_DELAY_HASHDIFF = stage.ORDER_WITH_DELAY_HASHDIFF
    WHERE latest_records.ORDER_WITH_DELAY_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:12.492001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:12.530286 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0 seconds
[0m14:57:12.536260 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.537522 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: BEGIN
[0m14:57:12.538905 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:12.539980 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.541348 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_order_with_delay__dbt_tmp145712483003'
        
      order by ordinal_position

  
[0m14:57:12.547836 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:12.554059 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.555091 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.558243 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:12.564675 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.565936 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.569440 [debug] [Thread-1  ]: SQL status: SELECT 6 in 0 seconds
[0m14:57:12.573338 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.582154 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.583155 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_with_delay"} */

      insert into "postgres"."dbt"."sat_order_with_delay" ("order_with_delay_pk", "order_with_delay_hashdiff", "reason_for_delay", "effective_from", "load_date", "record_source")
    (
        select "order_with_delay_pk", "order_with_delay_hashdiff", "reason_for_delay", "effective_from", "load_date", "record_source"
        from "sat_order_with_delay__dbt_tmp145712483003"
    )


  
[0m14:57:12.586024 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:12.594636 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: COMMIT
[0m14:57:12.597179 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m14:57:12.600789 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: COMMIT
[0m14:57:12.605719 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:12.607633 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_with_delay (execute): 2024-09-01 14:57:12.476596 => 2024-09-01 14:57:12.607559
[0m14:57:12.608882 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: Close
[0m14:57:12.610860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79f5eee0>]}
[0m14:57:12.612520 [info ] [Thread-1  ]: 42 of 45 OK created sql incremental model dbt.sat_order_with_delay ............. [[32mINSERT 0 0[0m in 0.19s]
[0m14:57:12.614226 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order_with_delay
[0m14:57:12.615883 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_warehouse
[0m14:57:12.617129 [info ] [Thread-1  ]: 43 of 45 START sql incremental model dbt.sat_warehouse ......................... [RUN]
[0m14:57:12.618646 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_warehouse'
[0m14:57:12.619675 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_warehouse
[0m14:57:12.656244 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.663421 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse (compile): 2024-09-01 14:57:12.620404 => 2024-09-01 14:57:12.663244
[0m14:57:12.664362 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_warehouse
[0m14:57:12.677522 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.678652 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse"} */

    
  
    

  create temporary table "sat_warehouse__dbt_tmp145712670801"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.WAREHOUSE_PK, a.WAREHOUSE_HASHDIFF, a.name, a.system_name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse" AS a
    WHERE a.WAREHOUSE_PK IS NOT NULL
),

latest_records AS (
    SELECT a.WAREHOUSE_PK, a.WAREHOUSE_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.WAREHOUSE_PK, current_records.WAREHOUSE_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.WAREHOUSE_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_warehouse" AS current_records
            JOIN (
                SELECT DISTINCT source_data.WAREHOUSE_PK
                FROM source_data
            ) AS source_records
                ON current_records.WAREHOUSE_PK = source_records.WAREHOUSE_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.WAREHOUSE_PK, stage.WAREHOUSE_HASHDIFF, stage.name, stage.system_name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.WAREHOUSE_PK = stage.WAREHOUSE_PK
        AND latest_records.WAREHOUSE_HASHDIFF = stage.WAREHOUSE_HASHDIFF
    WHERE latest_records.WAREHOUSE_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:12.679708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:12.743155 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0 seconds
[0m14:57:12.748624 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.749925 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: BEGIN
[0m14:57:12.751210 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:12.752418 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.753649 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse__dbt_tmp145712670801'
        
      order by ordinal_position

  
[0m14:57:12.760477 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:12.767348 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.768470 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.772149 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:12.778665 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.779702 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.783353 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:12.787855 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.796981 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.797833 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse"} */

      insert into "postgres"."dbt"."sat_warehouse" ("warehouse_pk", "warehouse_hashdiff", "name", "system_name", "effective_from", "load_date", "record_source")
    (
        select "warehouse_pk", "warehouse_hashdiff", "name", "system_name", "effective_from", "load_date", "record_source"
        from "sat_warehouse__dbt_tmp145712670801"
    )


  
[0m14:57:12.798953 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:12.801943 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: COMMIT
[0m14:57:12.802949 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m14:57:12.803743 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: COMMIT
[0m14:57:12.805928 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:12.807195 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse (execute): 2024-09-01 14:57:12.665261 => 2024-09-01 14:57:12.807132
[0m14:57:12.808065 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: Close
[0m14:57:12.809580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79e74df0>]}
[0m14:57:12.810724 [info ] [Thread-1  ]: 43 of 45 OK created sql incremental model dbt.sat_warehouse .................... [[32mINSERT 0 0[0m in 0.19s]
[0m14:57:12.812129 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_warehouse
[0m14:57:12.813348 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_warehouse_address
[0m14:57:12.814430 [info ] [Thread-1  ]: 44 of 45 START sql incremental model dbt.sat_warehouse_address ................. [RUN]
[0m14:57:12.815834 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_warehouse_address'
[0m14:57:12.816913 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_warehouse_address
[0m14:57:12.855647 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.865100 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_address (compile): 2024-09-01 14:57:12.817721 => 2024-09-01 14:57:12.864978
[0m14:57:12.865973 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_warehouse_address
[0m14:57:12.877327 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.878769 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_address"} */

    
  
    

  create temporary table "sat_warehouse_address__dbt_tmp145712871702"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.WAREHOUSE_ADDRESS_PK, a.WAREHOUSE_ADDRESS_HASHDIFF, a.street, a.house, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse_address" AS a
    WHERE a.WAREHOUSE_ADDRESS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.WAREHOUSE_ADDRESS_PK, a.WAREHOUSE_ADDRESS_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.WAREHOUSE_ADDRESS_PK, current_records.WAREHOUSE_ADDRESS_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.WAREHOUSE_ADDRESS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_warehouse_address" AS current_records
            JOIN (
                SELECT DISTINCT source_data.WAREHOUSE_ADDRESS_PK
                FROM source_data
            ) AS source_records
                ON current_records.WAREHOUSE_ADDRESS_PK = source_records.WAREHOUSE_ADDRESS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.WAREHOUSE_ADDRESS_PK, stage.WAREHOUSE_ADDRESS_HASHDIFF, stage.street, stage.house, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.WAREHOUSE_ADDRESS_PK = stage.WAREHOUSE_ADDRESS_PK
        AND latest_records.WAREHOUSE_ADDRESS_HASHDIFF = stage.WAREHOUSE_ADDRESS_HASHDIFF
    WHERE latest_records.WAREHOUSE_ADDRESS_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:12.879978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:12.940553 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0 seconds
[0m14:57:12.946267 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.947399 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: BEGIN
[0m14:57:12.948803 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:12.949991 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.951196 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse_address__dbt_tmp145712871702'
        
      order by ordinal_position

  
[0m14:57:12.957982 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:12.964831 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.966103 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.969693 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:12.977540 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.978833 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:12.983240 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:12.987382 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.996592 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:12.997424 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_address"} */

      insert into "postgres"."dbt"."sat_warehouse_address" ("warehouse_address_pk", "warehouse_address_hashdiff", "street", "house", "effective_from", "load_date", "record_source")
    (
        select "warehouse_address_pk", "warehouse_address_hashdiff", "street", "house", "effective_from", "load_date", "record_source"
        from "sat_warehouse_address__dbt_tmp145712871702"
    )


  
[0m14:57:12.998549 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:13.001417 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: COMMIT
[0m14:57:13.002787 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m14:57:13.003953 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: COMMIT
[0m14:57:13.007990 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:13.009690 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_address (execute): 2024-09-01 14:57:12.866580 => 2024-09-01 14:57:13.009625
[0m14:57:13.010924 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: Close
[0m14:57:13.012641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79dc1b20>]}
[0m14:57:13.013774 [info ] [Thread-1  ]: 44 of 45 OK created sql incremental model dbt.sat_warehouse_address ............ [[32mINSERT 0 0[0m in 0.20s]
[0m14:57:13.015183 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_warehouse_address
[0m14:57:13.016461 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_warehouse_params
[0m14:57:13.017636 [info ] [Thread-1  ]: 45 of 45 START sql incremental model dbt.sat_warehouse_params .................. [RUN]
[0m14:57:13.019210 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_warehouse_params'
[0m14:57:13.020396 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_warehouse_params
[0m14:57:13.059488 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.067192 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_params (compile): 2024-09-01 14:57:13.021283 => 2024-09-01 14:57:13.067047
[0m14:57:13.068076 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_warehouse_params
[0m14:57:13.080157 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.081623 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_params"} */

    
  
    

  create temporary table "sat_warehouse_params__dbt_tmp145713074191"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.WAREHOUSE_PARAMS_PK, a.WAREHOUSE_PARAMS_HASHDIFF, a.max_loading_weight, a.max_loading_volume, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse_params" AS a
    WHERE a.WAREHOUSE_PARAMS_PK IS NOT NULL
),

latest_records AS (
    SELECT a.WAREHOUSE_PARAMS_PK, a.WAREHOUSE_PARAMS_HASHDIFF, a.LOAD_DATE
    FROM (
        SELECT current_records.WAREHOUSE_PARAMS_PK, current_records.WAREHOUSE_PARAMS_HASHDIFF, current_records.LOAD_DATE,
            RANK() OVER (
                PARTITION BY current_records.WAREHOUSE_PARAMS_PK
                ORDER BY current_records.LOAD_DATE DESC
            ) AS rank
        FROM "postgres"."dbt"."sat_warehouse_params" AS current_records
            JOIN (
                SELECT DISTINCT source_data.WAREHOUSE_PARAMS_PK
                FROM source_data
            ) AS source_records
                ON current_records.WAREHOUSE_PARAMS_PK = source_records.WAREHOUSE_PARAMS_PK
    ) AS a
    WHERE a.rank = 1
),

records_to_insert AS (
    SELECT DISTINCT stage.WAREHOUSE_PARAMS_PK, stage.WAREHOUSE_PARAMS_HASHDIFF, stage.max_loading_weight, stage.max_loading_volume, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
    LEFT JOIN latest_records
    ON latest_records.WAREHOUSE_PARAMS_PK = stage.WAREHOUSE_PARAMS_PK
        AND latest_records.WAREHOUSE_PARAMS_HASHDIFF = stage.WAREHOUSE_PARAMS_HASHDIFF
    WHERE latest_records.WAREHOUSE_PARAMS_HASHDIFF IS NULL

)

SELECT * FROM records_to_insert
  );
  
  
[0m14:57:13.082830 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:57:13.144470 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0 seconds
[0m14:57:13.151544 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.153005 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: BEGIN
[0m14:57:13.154485 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:57:13.156090 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.157328 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse_params__dbt_tmp145713074191'
        
      order by ordinal_position

  
[0m14:57:13.164820 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:13.172476 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.173780 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:13.177588 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:13.184573 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.185825 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'sat_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m14:57:13.189711 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m14:57:13.194150 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.202215 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.203125 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_params"} */

      insert into "postgres"."dbt"."sat_warehouse_params" ("warehouse_params_pk", "warehouse_params_hashdiff", "max_loading_weight", "max_loading_volume", "effective_from", "load_date", "record_source")
    (
        select "warehouse_params_pk", "warehouse_params_hashdiff", "max_loading_weight", "max_loading_volume", "effective_from", "load_date", "record_source"
        from "sat_warehouse_params__dbt_tmp145713074191"
    )


  
[0m14:57:13.204363 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0 seconds
[0m14:57:13.207103 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: COMMIT
[0m14:57:13.208511 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m14:57:13.209562 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: COMMIT
[0m14:57:13.212419 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:57:13.214008 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_params (execute): 2024-09-01 14:57:13.068769 => 2024-09-01 14:57:13.213915
[0m14:57:13.214945 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: Close
[0m14:57:13.216472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e5de97-8f48-4991-866a-3be3ff768110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7a53ae20>]}
[0m14:57:13.217896 [info ] [Thread-1  ]: 45 of 45 OK created sql incremental model dbt.sat_warehouse_params ............. [[32mINSERT 0 0[0m in 0.20s]
[0m14:57:13.219390 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_warehouse_params
[0m14:57:13.222803 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:57:13.224029 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.225190 [debug] [MainThread]: On master: BEGIN
[0m14:57:13.226471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:13.235521 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:57:13.236883 [debug] [MainThread]: On master: COMMIT
[0m14:57:13.237928 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.238927 [debug] [MainThread]: On master: COMMIT
[0m14:57:13.240219 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:57:13.241609 [debug] [MainThread]: On master: Close
[0m14:57:13.243182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:13.244303 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.sat_warehouse_params' was properly closed.
[0m14:57:13.245497 [info ] [MainThread]: 
[0m14:57:13.246538 [info ] [MainThread]: Finished running 45 incremental models in 0 hours 0 minutes and 30.93 seconds (30.93s).
[0m14:57:13.250817 [debug] [MainThread]: Command end result
[0m14:57:13.285905 [info ] [MainThread]: 
[0m14:57:13.287488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:57:13.288770 [info ] [MainThread]: 
[0m14:57:13.290379 [error] [MainThread]: [33mDatabase Error in model sat_order_status_history (models/raw_vault/sats/sat_order_status_history.sql)[0m
[0m14:57:13.292023 [error] [MainThread]:   column a.order_status_history_hashdiff does not exist
[0m14:57:13.293412 [error] [MainThread]:   LINE 12:     SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY...
[0m14:57:13.294812 [error] [MainThread]:                                                  ^
[0m14:57:13.296420 [info ] [MainThread]: 
[0m14:57:13.297864 [info ] [MainThread]: Done. PASS=44 WARN=0 ERROR=1 SKIP=0 TOTAL=45
[0m14:57:13.299564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7a502a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f7a502370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f79e74df0>]}
[0m14:57:13.301157 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:00:02.057245 | 61f0d352-9e7a-4a7f-94d2-e6283257f478 ==============================
[0m15:00:02.057245 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:00:02.060051 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:00:02.061161 [debug] [MainThread]: Tracking: tracking
[0m15:00:02.066629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8514910100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8514910cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8514910430>]}
[0m15:00:02.070039 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tml_4ba4'
[0m15:00:02.071332 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:00:02.110159 [debug] [MainThread]: STDOUT: "b''"
[0m15:00:02.111745 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\nfatal: unable to access 'https://github.com/kzzzr/dbtvault.git/': Could not resolve host: github.com\n""
[0m15:00:02.112792 [debug] [MainThread]: command return code=128
[0m15:00:02.114945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8514985e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8514985a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8514985d00>]}
[0m15:00:02.116300 [debug] [MainThread]: Flushing usage events
[0m15:00:03.300253 [error] [MainThread]: Encountered an error:
Internal Error
  Error checking out spec='None' for repo https://github.com/kzzzr/dbtvault.git
  Cloning into '8f67def39d1e3209f86c5b38b1f63392'...
  fatal: unable to access 'https://github.com/kzzzr/dbtvault.git/': Could not resolve host: github.com


============================== 2024-09-01 15:03:25.368707 | df57cd43-662b-47c6-a8d7-4bcda8809c5f ==============================
[0m15:03:25.368707 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:03:25.371366 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:03:25.372425 [debug] [MainThread]: Tracking: tracking
[0m15:03:25.377005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cfa2a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cfa2acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cfa2a460>]}
[0m15:03:25.379686 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6syogzk9'
[0m15:03:25.381170 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:03:26.520597 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:26.521814 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m15:03:26.522999 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:03:26.523897 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:03:26.528524 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:03:26.529732 [debug] [MainThread]: STDERR: "b''"
[0m15:03:26.530604 [debug] [MainThread]:   Checking out revision master.
[0m15:03:26.531493 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:03:26.536688 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:26.537831 [debug] [MainThread]: STDERR: "b''"
[0m15:03:26.538796 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:03:27.980323 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:27.981593 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m15:03:27.982488 [debug] [MainThread]: Executing "git tag --list"
[0m15:03:27.987018 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:03:27.988358 [debug] [MainThread]: STDERR: "b''"
[0m15:03:27.989458 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:03:27.999683 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:03:28.001145 [debug] [MainThread]: STDERR: "b''"
[0m15:03:28.002278 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:03:28.006679 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:03:28.008004 [debug] [MainThread]: STDERR: "b''"
[0m15:03:28.009079 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m15:03:28.010611 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:03:28.023958 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:03:28.398170 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:03:28.400042 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:03:28.613589 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:03:28.760105 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:03:28.765577 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:28.767301 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:03:28.768427 [debug] [MainThread]: command return code=128
[0m15:03:28.770218 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:03:28.771334 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:03:28.776497 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:03:28.778087 [debug] [MainThread]: STDERR: "b''"
[0m15:03:28.779272 [debug] [MainThread]:   Checking out revision master.
[0m15:03:28.780350 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:03:28.786141 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:28.787457 [debug] [MainThread]: STDERR: "b''"
[0m15:03:28.788465 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:03:29.576495 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:29.577864 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:03:29.578942 [debug] [MainThread]: Executing "git tag --list"
[0m15:03:29.583681 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:03:29.585072 [debug] [MainThread]: STDERR: "b''"
[0m15:03:29.586004 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:03:29.592838 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:03:29.594205 [debug] [MainThread]: STDERR: "b''"
[0m15:03:29.595264 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:03:29.600328 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:03:29.602196 [debug] [MainThread]: STDERR: "b''"
[0m15:03:29.603261 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:03:29.604918 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:03:29.618470 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m15:03:29.814214 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:03:29.818271 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:29.819601 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:03:29.820784 [debug] [MainThread]: command return code=128
[0m15:03:29.822622 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:03:29.823772 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:03:29.829053 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:03:29.830420 [debug] [MainThread]: STDERR: "b''"
[0m15:03:29.831571 [debug] [MainThread]:   Checking out revision master.
[0m15:03:29.832645 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:03:29.838428 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:29.839977 [debug] [MainThread]: STDERR: "b''"
[0m15:03:29.841085 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:03:30.641320 [debug] [MainThread]: STDOUT: "b''"
[0m15:03:30.642754 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:03:30.643803 [debug] [MainThread]: Executing "git tag --list"
[0m15:03:30.648990 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:03:30.650293 [debug] [MainThread]: STDERR: "b''"
[0m15:03:30.651196 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:03:30.658098 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:03:30.659435 [debug] [MainThread]: STDERR: "b''"
[0m15:03:30.660621 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:03:30.665509 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:03:30.666877 [debug] [MainThread]: STDERR: "b''"
[0m15:03:30.667921 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:03:32.908894 [info ] [MainThread]:   Installed from revision master
[0m15:03:32.910638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'df57cd43-662b-47c6-a8d7-4bcda8809c5f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cfa25220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d01b57c0>]}
[0m15:03:32.911900 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:03:37.201958 [info ] [MainThread]:   Installed from version 1.3.0
[0m15:03:37.202852 [info ] [MainThread]:   Up to date!
[0m15:03:37.203906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'df57cd43-662b-47c6-a8d7-4bcda8809c5f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d0ace7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d01b57c0>]}
[0m15:03:37.205145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cfb26880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7d07c0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7cfa89fd0>]}
[0m15:03:37.206012 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:08:55.208912 | 86bcac7e-b327-4df6-b19c-094a63da5106 ==============================
[0m15:08:55.208912 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:08:55.212845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:08:55.214200 [debug] [MainThread]: Tracking: tracking
[0m15:08:55.221361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c44b26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c44b2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c44b27f0>]}
[0m15:08:58.588815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:58.589652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:58.608699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3fac0d0>]}
[0m15:08:58.659142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c42c5940>]}
[0m15:08:58.660590 [info ] [MainThread]: Found 96 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:08:58.661958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c44af280>]}
[0m15:08:58.673310 [info ] [MainThread]: 
[0m15:08:58.677360 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:58.688011 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:08:58.711111 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:08:58.712656 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:08:58.713899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:58.725353 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:08:58.728225 [debug] [ThreadPool]: On list_postgres: Close
[0m15:08:58.739463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:08:58.751119 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:08:58.752390 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:08:58.753467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:58.761917 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:08:58.763408 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:08:58.764712 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:08:58.768661 [debug] [ThreadPool]: SQL status: SELECT 98 in 0 seconds
[0m15:08:58.773830 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:08:58.775182 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:08:58.802870 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:58.803991 [debug] [MainThread]: On master: BEGIN
[0m15:08:58.804885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:58.814539 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:08:58.816423 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:58.818080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:58.868911 [debug] [MainThread]: SQL status: SELECT 64 in 0 seconds
[0m15:08:58.880737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c5cf67c0>]}
[0m15:08:58.882266 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:58.883694 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:58.884793 [debug] [MainThread]: On master: BEGIN
[0m15:08:58.886322 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:08:58.888017 [debug] [MainThread]: On master: COMMIT
[0m15:08:58.889261 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:58.890349 [debug] [MainThread]: On master: COMMIT
[0m15:08:58.891751 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:08:58.892928 [debug] [MainThread]: On master: Close
[0m15:08:58.894272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:08:58.895296 [info ] [MainThread]: 
[0m15:08:58.899950 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.as_of_date
[0m15:08:58.901116 [info ] [Thread-1  ]: 1 of 96 START sql table model dbt.as_of_date ................................... [RUN]
[0m15:08:58.902590 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.as_of_date'
[0m15:08:58.903400 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.as_of_date
[0m15:08:58.939977 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:08:58.941306 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: BEGIN
[0m15:08:58.942514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:08:58.950601 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:08:58.952305 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:08:58.953458 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */


        select 
        ((TO_DATE('2024-10-01', 'yyyy-mm-dd'))::date - (TO_DATE('2023-12-01', 'yyyy-mm-dd'))::date)
    
[0m15:08:58.955253 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m15:08:58.976472 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.as_of_date"
[0m15:08:58.985320 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (compile): 2024-09-01 15:08:58.904231 => 2024-09-01 15:08:58.985193
[0m15:08:58.986366 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.as_of_date
[0m15:08:59.045788 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.as_of_date"
[0m15:08:59.053379 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:08:59.054107 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */

  
    

  create  table "postgres"."dbt"."as_of_date__dbt_tmp"
  as (
    WITH as_of_date AS (
 





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 305
    order by generated_number



),

all_periods as (

    select (
        

    TO_DATE('2023-12-01', 'yyyy-mm-dd') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= TO_DATE('2024-10-01', 'yyyy-mm-dd')

)

select * from filtered


)
SELECT DATE_day as AS_OF_DATE FROM as_of_date
  );
  
[0m15:08:59.061316 [debug] [Thread-1  ]: SQL status: SELECT 305 in 0 seconds
[0m15:08:59.071436 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:08:59.072677 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date" rename to "as_of_date__dbt_backup"
[0m15:08:59.074140 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:08:59.079468 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:08:59.080680 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date__dbt_tmp" rename to "as_of_date"
[0m15:08:59.082107 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:08:59.113605 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:08:59.114858 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:08:59.116153 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:08:59.119697 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:08:59.128565 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:08:59.129854 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
drop table if exists "postgres"."dbt"."as_of_date__dbt_backup" cascade
[0m15:08:59.133939 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:08:59.136353 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (execute): 2024-09-01 15:08:58.987048 => 2024-09-01 15:08:59.136288
[0m15:08:59.137674 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: Close
[0m15:08:59.139371 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3deadf0>]}
[0m15:08:59.140648 [info ] [Thread-1  ]: 1 of 96 OK created sql table model dbt.as_of_date .............................. [[32mSELECT 305[0m in 0.24s]
[0m15:08:59.143759 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.as_of_date
[0m15:08:59.145014 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_date
[0m15:08:59.146241 [info ] [Thread-1  ]: 2 of 96 START sql view model dbt.cv_date ....................................... [RUN]
[0m15:08:59.147703 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_date'
[0m15:08:59.148716 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_date
[0m15:08:59.153053 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_date"
[0m15:08:59.159768 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (compile): 2024-09-01 15:08:59.149527 => 2024-09-01 15:08:59.159658
[0m15:08:59.160580 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_date
[0m15:08:59.191840 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_date"
[0m15:08:59.200901 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:08:59.201744 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: BEGIN
[0m15:08:59.202464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:08:59.209715 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:08:59.211132 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:08:59.212213 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */

  create view "postgres"."dbt"."cv_date__dbt_tmp" as (
    WITH
RECURSIVE dates AS (
    SELECT
        '2023-12-01'::TIMESTAMP AS date_value
    UNION
    SELECT
        date_value + INTERVAL '1' DAY AS date_value
    FROM dates
    WHERE date_value <= '2024-10-01'
)
select date_value from dates
  );
[0m15:08:59.214852 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:08:59.222420 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:08:59.223805 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date" rename to "cv_date__dbt_backup"
[0m15:08:59.225284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:08:59.231669 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:08:59.232969 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date__dbt_tmp" rename to "cv_date"
[0m15:08:59.235112 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:08:59.239101 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:08:59.240373 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:08:59.241629 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:08:59.244788 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:08:59.252077 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:08:59.253430 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
drop view if exists "postgres"."dbt"."cv_date__dbt_backup" cascade
[0m15:08:59.258283 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:08:59.261118 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (execute): 2024-09-01 15:08:59.161205 => 2024-09-01 15:08:59.261055
[0m15:08:59.262408 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: Close
[0m15:08:59.264189 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3deaca0>]}
[0m15:08:59.266004 [info ] [Thread-1  ]: 2 of 96 OK created sql view model dbt.cv_date .................................. [[32mCREATE VIEW[0m in 0.12s]
[0m15:08:59.267610 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_date
[0m15:08:59.269093 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city
[0m15:08:59.270451 [info ] [Thread-1  ]: 3 of 96 START sql view model dbt.stg_city ...................................... [RUN]
[0m15:08:59.272419 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city'
[0m15:08:59.273540 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city
[0m15:08:59.343174 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.344206 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: BEGIN
[0m15:08:59.345067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:08:59.355979 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:08:59.357942 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.359062 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:08:59.372740 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:08:59.468630 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.469784 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:08:59.473130 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:08:59.557060 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city"
[0m15:08:59.563828 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (compile): 2024-09-01 15:08:59.274477 => 2024-09-01 15:08:59.563712
[0m15:08:59.564921 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city
[0m15:08:59.576426 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city"
[0m15:08:59.584622 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.585362 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

  create view "postgres"."dbt"."stg_city__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    country_id

    FROM "postgres"."dbt"."source_city"
),

derived_columns AS (

    SELECT

    id,
    name,
    country_id,
    id AS CITY_KEY,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CITY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CITY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,
    CITY_PK,
    CITY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:08:59.587655 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:08:59.592871 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.593832 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city" rename to "stg_city__dbt_backup"
[0m15:08:59.595203 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:08:59.638330 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.639439 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city__dbt_tmp" rename to "stg_city"
[0m15:08:59.640759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:08:59.644134 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:08:59.645411 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.646466 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:08:59.650378 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:08:59.655070 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:08:59.656208 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
drop view if exists "postgres"."dbt"."stg_city__dbt_backup" cascade
[0m15:08:59.662549 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:08:59.664607 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (execute): 2024-09-01 15:08:59.565963 => 2024-09-01 15:08:59.664549
[0m15:08:59.665467 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: Close
[0m15:08:59.666901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3ecfe20>]}
[0m15:08:59.668037 [info ] [Thread-1  ]: 3 of 96 OK created sql view model dbt.stg_city ................................. [[32mCREATE VIEW[0m in 0.40s]
[0m15:08:59.669526 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city
[0m15:08:59.670753 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client
[0m15:08:59.672346 [info ] [Thread-1  ]: 4 of 96 START sql view model dbt.stg_client .................................... [RUN]
[0m15:08:59.674126 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client'
[0m15:08:59.675265 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client
[0m15:08:59.688592 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:08:59.690071 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: BEGIN
[0m15:08:59.691715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:08:59.700157 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:08:59.702121 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:08:59.703232 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:08:59.710858 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:08:59.723650 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:08:59.724775 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:08:59.728285 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:08:59.749097 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client"
[0m15:08:59.758656 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (compile): 2024-09-01 15:08:59.676234 => 2024-09-01 15:08:59.758542
[0m15:08:59.759666 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client
[0m15:08:59.769987 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client"
[0m15:08:59.778389 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:08:59.779169 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

  create view "postgres"."dbt"."stg_client__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id

    FROM "postgres"."dbt"."source_client"
),

derived_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CONCAT(
        order_id, '||',
        client_type_code
    ) AS CLIENT_KEY,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS CLIENT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,
    CLIENT_PK,
    CLIENT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:08:59.781987 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:08:59.788166 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:08:59.789346 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client" rename to "stg_client__dbt_backup"
[0m15:09:56.300200 [debug] [Thread-1  ]: Postgres adapter: Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m15:09:56.303108 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: ROLLBACK
[0m15:09:56.305586 [debug] [Thread-1  ]: Failed to rollback 'model.otus_project_dbtvault.stg_client'
[0m15:09:56.307363 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:09:56.308487 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:09:56.310025 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (execute): 2024-09-01 15:08:59.760392 => 2024-09-01 15:09:56.309910
[0m15:09:56.311135 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: Close
[0m15:09:56.314273 [debug] [Thread-1  ]: Database Error in model stg_client (models/stage/stg_client.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled Code at target/run/otus_project_dbtvault/models/stage/stg_client.sql
[0m15:09:56.315512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3e189d0>]}
[0m15:09:56.316641 [error] [Thread-1  ]: 4 of 96 ERROR creating sql view model dbt.stg_client ........................... [[31mERROR[0m in 56.64s]
[0m15:09:56.317972 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client
[0m15:09:56.319347 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address
[0m15:09:56.321002 [info ] [Thread-1  ]: 5 of 96 START sql view model dbt.stg_client_address ............................ [RUN]
[0m15:09:56.323155 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address'
[0m15:09:56.324151 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address
[0m15:09:56.339699 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:09:56.341035 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: BEGIN
[0m15:09:56.342250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:56.347390 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m15:09:56.351049 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:09:56.352518 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:09:56.353757 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m15:09:56.354799 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:09:56.357276 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (compile): 2024-09-01 15:09:56.324968 => 2024-09-01 15:09:56.357143
[0m15:09:56.358795 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: No close available on handle
[0m15:09:56.363351 [debug] [Thread-1  ]: Database Error in model stg_client_address (models/stage/stg_client_address.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m15:09:56.365011 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3e0b910>]}
[0m15:09:56.366582 [error] [Thread-1  ]: 5 of 96 ERROR creating sql view model dbt.stg_client_address ................... [[31mERROR[0m in 0.04s]
[0m15:09:56.368390 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address
[0m15:09:56.370158 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_type
[0m15:09:56.374030 [info ] [Thread-1  ]: 6 of 96 START sql view model dbt.stg_client_type ............................... [RUN]
[0m15:09:56.376294 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_type'
[0m15:09:56.377756 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_type
[0m15:09:56.397940 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:56.399409 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: BEGIN
[0m15:09:56.400251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:57.473767 [debug] [Thread-1  ]: SQL status: BEGIN in 1 seconds
[0m15:09:57.475963 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.477252 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.485617 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:57.499622 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.500567 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.504699 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:57.519322 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.530513 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (compile): 2024-09-01 15:09:56.378970 => 2024-09-01 15:09:57.530366
[0m15:09:57.531750 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_type
[0m15:09:57.549323 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.556481 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.557583 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

  create view "postgres"."dbt"."stg_client_type__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_client_type"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS CLIENT_TYPE_KEY,
    'CSV_CLIENT_TYPE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CLIENT_TYPE_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CLIENT_TYPE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,
    CLIENT_TYPE_PK,
    CLIENT_TYPE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:57.561392 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:57.568828 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.569895 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type" rename to "stg_client_type__dbt_backup"
[0m15:09:57.571483 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:57.577335 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.578410 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type__dbt_tmp" rename to "stg_client_type"
[0m15:09:57.579983 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:57.584503 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:09:57.585547 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.586432 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:09:57.590519 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:57.595785 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:09:57.596820 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_type__dbt_backup" cascade
[0m15:09:57.601165 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:57.604096 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (execute): 2024-09-01 15:09:57.532915 => 2024-09-01 15:09:57.604013
[0m15:09:57.605218 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: Close
[0m15:09:57.606975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1d92e80>]}
[0m15:09:57.608738 [info ] [Thread-1  ]: 6 of 96 OK created sql view model dbt.stg_client_type .......................... [[32mCREATE VIEW[0m in 1.23s]
[0m15:09:57.610554 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_type
[0m15:09:57.612027 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_country
[0m15:09:57.613713 [info ] [Thread-1  ]: 7 of 96 START sql view model dbt.stg_country ................................... [RUN]
[0m15:09:57.615564 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_country'
[0m15:09:57.616658 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_country
[0m15:09:57.633386 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.634422 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: BEGIN
[0m15:09:57.635498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:57.644237 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:57.645534 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.646657 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.655588 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:57.668444 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.669694 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.674574 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:57.686840 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_country"
[0m15:09:57.693852 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (compile): 2024-09-01 15:09:57.617641 => 2024-09-01 15:09:57.693733
[0m15:09:57.694764 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_country
[0m15:09:57.706792 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_country"
[0m15:09:57.713834 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.714695 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

  create view "postgres"."dbt"."stg_country__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_country"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS COUNTRY_KEY,
    'CSV_COUNTRY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS COUNTRY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS COUNTRY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,
    COUNTRY_PK,
    COUNTRY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:57.717115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:57.723447 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.724368 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country" rename to "stg_country__dbt_backup"
[0m15:09:57.725729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:57.733409 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.734589 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country__dbt_tmp" rename to "stg_country"
[0m15:09:57.736188 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:57.747169 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:09:57.748132 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.749081 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:09:57.753044 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:57.759567 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:09:57.760867 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
drop view if exists "postgres"."dbt"."stg_country__dbt_backup" cascade
[0m15:09:57.764776 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:57.767705 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (execute): 2024-09-01 15:09:57.695538 => 2024-09-01 15:09:57.767638
[0m15:09:57.769176 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: Close
[0m15:09:57.770772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1d85dc0>]}
[0m15:09:57.772268 [info ] [Thread-1  ]: 7 of 96 OK created sql view model dbt.stg_country .............................. [[32mCREATE VIEW[0m in 0.16s]
[0m15:09:57.773769 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_country
[0m15:09:57.775182 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency
[0m15:09:57.776636 [info ] [Thread-1  ]: 8 of 96 START sql view model dbt.stg_currency .................................. [RUN]
[0m15:09:57.778716 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency'
[0m15:09:57.779805 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency
[0m15:09:57.795190 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.796209 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: BEGIN
[0m15:09:57.797055 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:57.806772 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:57.808001 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.808982 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.815940 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:57.826496 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.827483 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.832421 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:57.845749 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.851973 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (compile): 2024-09-01 15:09:57.780735 => 2024-09-01 15:09:57.851860
[0m15:09:57.852839 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency
[0m15:09:57.863177 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.869830 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.870595 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

  create view "postgres"."dbt"."stg_currency__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    code,
    name

    FROM "postgres"."dbt"."source_currency"
),

derived_columns AS (

    SELECT

    code,
    name,
    code AS CURRENCY_KEY,
    'CSV_CURRENCY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(code AS VARCHAR))), '')), 'hex') AS CURRENCY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CURRENCY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,
    CURRENCY_PK,
    CURRENCY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:57.873115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:57.879627 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.880748 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency" rename to "stg_currency__dbt_backup"
[0m15:09:57.881927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:57.886734 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.887469 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency__dbt_tmp" rename to "stg_currency"
[0m15:09:57.888657 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:57.891400 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:09:57.892140 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.892783 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:09:57.894778 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:57.899265 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:09:57.900065 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
drop view if exists "postgres"."dbt"."stg_currency__dbt_backup" cascade
[0m15:09:57.904089 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:57.906061 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (execute): 2024-09-01 15:09:57.853483 => 2024-09-01 15:09:57.905998
[0m15:09:57.906762 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: Close
[0m15:09:57.907930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3de3c70>]}
[0m15:09:57.909024 [info ] [Thread-1  ]: 8 of 96 OK created sql view model dbt.stg_currency ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:09:57.910435 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency
[0m15:09:57.912025 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_rate
[0m15:09:57.913804 [info ] [Thread-1  ]: 9 of 96 START sql view model dbt.stg_currency_rate ............................. [RUN]
[0m15:09:57.915340 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_rate'
[0m15:09:57.916177 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_rate
[0m15:09:57.929220 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:57.930366 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: BEGIN
[0m15:09:57.931198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:57.938737 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:57.939932 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:57.941008 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.948294 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:57.960896 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:57.961784 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:57.964829 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:57.978249 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:57.984871 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (compile): 2024-09-01 15:09:57.916883 => 2024-09-01 15:09:57.984765
[0m15:09:57.985751 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_rate
[0m15:09:57.996124 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:58.003705 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:58.004688 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_rate__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end

    FROM "postgres"."dbt"."source_currency_rate"
),

derived_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    id AS CURRENCY_RATE_KEY,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CURRENCY_RATE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_end AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_start AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(relation_to_rur AS VARCHAR))), ''), '^^')
    )), 'hex') AS CURRENCY_RATE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,
    CURRENCY_RATE_PK,
    CURRENCY_RATE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:58.007249 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:58.013104 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:58.014280 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate" rename to "stg_currency_rate__dbt_backup"
[0m15:09:58.015798 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.021634 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:58.022978 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate__dbt_tmp" rename to "stg_currency_rate"
[0m15:09:58.024468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.027630 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:09:58.028762 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:58.029769 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:09:58.033245 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:58.038975 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:09:58.040085 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_rate__dbt_backup" cascade
[0m15:09:58.043600 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:58.045784 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (execute): 2024-09-01 15:09:57.986377 => 2024-09-01 15:09:58.045724
[0m15:09:58.046791 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: Close
[0m15:09:58.048313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c7e730>]}
[0m15:09:58.049563 [info ] [Thread-1  ]: 9 of 96 OK created sql view model dbt.stg_currency_rate ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:09:58.050879 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_rate
[0m15:09:58.052017 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_goods
[0m15:09:58.053492 [info ] [Thread-1  ]: 10 of 96 START sql view model dbt.stg_goods .................................... [RUN]
[0m15:09:58.055218 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_goods'
[0m15:09:58.056221 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_goods
[0m15:09:58.070258 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.071365 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: BEGIN
[0m15:09:58.072289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:58.080123 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:58.081753 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.082976 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.094184 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:58.105491 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.106612 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.110133 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:58.124011 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.131792 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (compile): 2024-09-01 15:09:58.057167 => 2024-09-01 15:09:58.131675
[0m15:09:58.132755 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_goods
[0m15:09:58.143642 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.151240 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.152052 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

  create view "postgres"."dbt"."stg_goods__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count

    FROM "postgres"."dbt"."source_goods"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    id AS GOOD_KEY,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS GOOD_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(cost_per_unit AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(count AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS GOOD_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,
    GOOD_PK,
    GOOD_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:58.154315 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:58.159817 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.161021 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods" rename to "stg_goods__dbt_backup"
[0m15:09:58.162470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.167466 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.168656 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods__dbt_tmp" rename to "stg_goods"
[0m15:09:58.170207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.173199 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:09:58.174132 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.175074 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:09:58.178743 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:58.183896 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:09:58.184936 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
drop view if exists "postgres"."dbt"."stg_goods__dbt_backup" cascade
[0m15:09:58.188796 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:58.191572 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (execute): 2024-09-01 15:09:58.133533 => 2024-09-01 15:09:58.191510
[0m15:09:58.192783 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: Close
[0m15:09:58.194206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1cb8fd0>]}
[0m15:09:58.195260 [info ] [Thread-1  ]: 10 of 96 OK created sql view model dbt.stg_goods ............................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:09:58.196499 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_goods
[0m15:09:58.197859 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status
[0m15:09:58.199097 [info ] [Thread-1  ]: 11 of 96 START sql view model dbt.stg_order_status ............................. [RUN]
[0m15:09:58.200754 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status'
[0m15:09:58.201823 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status
[0m15:09:58.214576 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.215501 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: BEGIN
[0m15:09:58.216233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:58.223861 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:58.225022 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.225881 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.232513 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:58.243746 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.244946 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.248238 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:58.258672 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.266760 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (compile): 2024-09-01 15:09:58.202614 => 2024-09-01 15:09:58.266661
[0m15:09:58.267636 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status
[0m15:09:58.277659 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.286320 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.287102 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

  create view "postgres"."dbt"."stg_order_status__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_order_status"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS ORDER_STATUS_KEY,
    'CSV_ORDER_STATUS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_PK,
    ORDER_STATUS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:58.289281 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:58.294513 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.295780 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status" rename to "stg_order_status__dbt_backup"
[0m15:09:58.297400 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.302778 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.304074 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status__dbt_tmp" rename to "stg_order_status"
[0m15:09:58.305747 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.308612 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:09:58.309952 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.310994 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:09:58.314983 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:58.320899 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:09:58.322081 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
drop view if exists "postgres"."dbt"."stg_order_status__dbt_backup" cascade
[0m15:09:58.325908 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:58.327960 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (execute): 2024-09-01 15:09:58.268559 => 2024-09-01 15:09:58.327903
[0m15:09:58.329039 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: Close
[0m15:09:58.330711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3ecfe20>]}
[0m15:09:58.332130 [info ] [Thread-1  ]: 11 of 96 OK created sql view model dbt.stg_order_status ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:09:58.333850 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status
[0m15:09:58.335181 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_history
[0m15:09:58.336566 [info ] [Thread-1  ]: 12 of 96 START sql view model dbt.stg_order_status_history ..................... [RUN]
[0m15:09:58.338361 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_history'
[0m15:09:58.339627 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_history
[0m15:09:58.353205 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.354363 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: BEGIN
[0m15:09:58.355473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:58.363556 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:58.365063 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.366340 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.374555 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:58.385206 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.386541 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.390400 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:58.401626 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.409874 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (compile): 2024-09-01 15:09:58.340706 => 2024-09-01 15:09:58.409754
[0m15:09:58.410846 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_history
[0m15:09:58.421841 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.430225 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.431063 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_history__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id

    FROM "postgres"."dbt"."source_order_status_history"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    id AS ORDER_STATUS_HISTORY_KEY,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_HISTORY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(status_datetime AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HISTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_HISTORY_PK,
    ORDER_STATUS_HISTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:58.433368 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:58.438516 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.440024 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history" rename to "stg_order_status_history__dbt_backup"
[0m15:09:58.441718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.446737 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.447937 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history__dbt_tmp" rename to "stg_order_status_history"
[0m15:09:58.449594 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.452704 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:09:58.453795 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.454895 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:09:58.458573 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:58.463330 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:09:58.464337 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_status_history__dbt_backup" cascade
[0m15:09:58.468632 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:58.471035 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (execute): 2024-09-01 15:09:58.411508 => 2024-09-01 15:09:58.470975
[0m15:09:58.472158 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: Close
[0m15:09:58.473624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1bc0f40>]}
[0m15:09:58.474915 [info ] [Thread-1  ]: 12 of 96 OK created sql view model dbt.stg_order_status_history ................ [[32mCREATE VIEW[0m in 0.14s]
[0m15:09:58.476422 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_history
[0m15:09:58.477667 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:09:58.479282 [info ] [Thread-1  ]: 13 of 96 START sql view model dbt.stg_order_with_delay ......................... [RUN]
[0m15:09:58.480950 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay'
[0m15:09:58.481934 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay
[0m15:09:58.496146 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.497348 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: BEGIN
[0m15:09:58.498436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:58.506856 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:58.508357 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.509990 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.518173 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:09:58.570717 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.571786 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.574958 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:09:58.585580 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.595739 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (compile): 2024-09-01 15:09:58.482842 => 2024-09-01 15:09:58.595584
[0m15:09:58.597266 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_with_delay
[0m15:09:58.607575 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.618076 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.618817 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

  create view "postgres"."dbt"."stg_order_with_delay__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    reason_for_delay

    FROM "postgres"."dbt"."source_order_with_delay"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    id AS ORDER_WITH_DELAY_KEY,
    'CSV_ORDER_WITH_DELAY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_WITH_DELAY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(reason_for_delay AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_WITH_DELAY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,
    ORDER_WITH_DELAY_PK,
    ORDER_WITH_DELAY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:58.620934 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:58.626311 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.627529 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
alter table "postgres"."dbt"."stg_order_with_delay" rename to "stg_order_with_delay__dbt_backup"
[0m15:09:58.629284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.634418 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.635478 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
alter table "postgres"."dbt"."stg_order_with_delay__dbt_tmp" rename to "stg_order_with_delay"
[0m15:09:58.636948 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.640041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:09:58.641355 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.642643 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:09:58.645663 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:58.651695 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:09:58.653000 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
drop view if exists "postgres"."dbt"."stg_order_with_delay__dbt_backup" cascade
[0m15:09:58.657116 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:58.659942 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (execute): 2024-09-01 15:09:58.598088 => 2024-09-01 15:09:58.659880
[0m15:09:58.661281 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: Close
[0m15:09:58.662950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1d143d0>]}
[0m15:09:58.664223 [info ] [Thread-1  ]: 13 of 96 OK created sql view model dbt.stg_order_with_delay .................... [[32mCREATE VIEW[0m in 0.18s]
[0m15:09:58.665747 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:09:58.667085 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_orders
[0m15:09:58.668605 [info ] [Thread-1  ]: 14 of 96 START sql view model dbt.stg_orders ................................... [RUN]
[0m15:09:58.670400 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_orders'
[0m15:09:58.671512 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_orders
[0m15:09:58.684882 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.686126 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: BEGIN
[0m15:09:58.687207 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:58.695472 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:58.696855 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.697976 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.705510 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:09:58.716951 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.717932 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.721583 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:09:58.739068 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.747884 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (compile): 2024-09-01 15:09:58.672693 => 2024-09-01 15:09:58.747772
[0m15:09:58.749028 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_orders
[0m15:09:58.758670 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.765983 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.766835 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

  create view "postgres"."dbt"."stg_orders__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code

    FROM "postgres"."dbt"."source_orders"
),

derived_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    id AS ORDER_KEY,
    'CSV_ORDERS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(height AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(length AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(weight AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(width AS VARCHAR))), ''), '^^')
    )), 'hex') AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,
    ORDER_PK,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:58.769634 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:58.774855 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.775975 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
alter table "postgres"."dbt"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:09:58.777614 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.783623 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.785855 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
alter table "postgres"."dbt"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:09:58.787151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.790039 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:09:58.791073 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.792056 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:09:58.794392 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:58.798758 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:09:58.800118 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
drop view if exists "postgres"."dbt"."stg_orders__dbt_backup" cascade
[0m15:09:58.804012 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:58.806273 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (execute): 2024-09-01 15:09:58.749840 => 2024-09-01 15:09:58.806214
[0m15:09:58.807315 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: Close
[0m15:09:58.808754 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1d92640>]}
[0m15:09:58.809999 [info ] [Thread-1  ]: 14 of 96 OK created sql view model dbt.stg_orders .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:09:58.811458 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_orders
[0m15:09:58.812915 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse
[0m15:09:58.814954 [info ] [Thread-1  ]: 15 of 96 START sql view model dbt.stg_warehouse ................................ [RUN]
[0m15:09:58.816935 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse'
[0m15:09:58.818088 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse
[0m15:09:58.832647 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.834073 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: BEGIN
[0m15:09:58.835305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:58.845559 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:58.847027 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.848277 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.855180 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:09:58.865631 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.866958 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:58.870616 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:09:58.882540 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.891717 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (compile): 2024-09-01 15:09:58.818970 => 2024-09-01 15:09:58.891605
[0m15:09:58.892648 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse
[0m15:09:58.902526 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.911417 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.912346 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

  create view "postgres"."dbt"."stg_warehouse__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    system_name

    FROM "postgres"."dbt"."source_warehouse"
),

derived_columns AS (

    SELECT

    id,
    name,
    system_name,
    id AS WAREHOUSE_KEY,
    'CSV_WAREHOUSE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(system_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PK,
    WAREHOUSE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:58.914702 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:58.921283 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.922772 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
alter table "postgres"."dbt"."stg_warehouse" rename to "stg_warehouse__dbt_backup"
[0m15:09:58.924404 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.930976 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.932379 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
alter table "postgres"."dbt"."stg_warehouse__dbt_tmp" rename to "stg_warehouse"
[0m15:09:58.934020 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:58.936989 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:09:58.938090 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.939226 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:09:58.943039 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:58.947730 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:09:58.949011 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
drop view if exists "postgres"."dbt"."stg_warehouse__dbt_backup" cascade
[0m15:09:58.953237 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:58.955604 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (execute): 2024-09-01 15:09:58.893277 => 2024-09-01 15:09:58.955546
[0m15:09:58.956745 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: Close
[0m15:09:58.958327 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3e779a0>]}
[0m15:09:58.959655 [info ] [Thread-1  ]: 15 of 96 OK created sql view model dbt.stg_warehouse ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:09:58.961102 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse
[0m15:09:58.962636 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:09:58.964213 [info ] [Thread-1  ]: 16 of 96 START sql view model dbt.stg_warehouse_address ........................ [RUN]
[0m15:09:58.966159 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address'
[0m15:09:58.967321 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address
[0m15:09:58.980103 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:58.981467 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: BEGIN
[0m15:09:58.982567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:58.990642 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:58.992256 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:58.993519 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:59.001427 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:59.011919 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.013165 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:59.016842 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:59.030542 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.038612 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (compile): 2024-09-01 15:09:58.968355 => 2024-09-01 15:09:59.038518
[0m15:09:59.039499 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address
[0m15:09:59.048623 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.056833 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.057577 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

  create view "postgres"."dbt"."stg_warehouse_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house

    FROM "postgres"."dbt"."source_warehouse_address"
),

derived_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    id AS WAREHOUSE_ADDRESS_KEY,
    'CSV_WAREHOUSE_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_ADDRESS_PK,
    WAREHOUSE_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:59.059879 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:59.065530 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.066776 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
alter table "postgres"."dbt"."stg_warehouse_address" rename to "stg_warehouse_address__dbt_backup"
[0m15:09:59.068448 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.074258 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.075576 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
alter table "postgres"."dbt"."stg_warehouse_address__dbt_tmp" rename to "stg_warehouse_address"
[0m15:09:59.077577 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.081215 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:09:59.082523 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.083541 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:09:59.086312 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:59.091137 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:09:59.092532 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address__dbt_backup" cascade
[0m15:09:59.096428 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:59.098605 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (execute): 2024-09-01 15:09:59.040126 => 2024-09-01 15:09:59.098547
[0m15:09:59.099800 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: Close
[0m15:09:59.101337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c43a02b0>]}
[0m15:09:59.102691 [info ] [Thread-1  ]: 16 of 96 OK created sql view model dbt.stg_warehouse_address ................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:09:59.104172 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:09:59.105402 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:09:59.106855 [info ] [Thread-1  ]: 17 of 96 START sql view model dbt.stg_warehouse_params ......................... [RUN]
[0m15:09:59.108553 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_params'
[0m15:09:59.109882 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_params
[0m15:09:59.124022 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.125440 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: BEGIN
[0m15:09:59.126750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:59.134624 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:59.136417 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.137541 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:59.144735 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:59.155480 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.156836 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:09:59.160723 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:09:59.173159 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.181967 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (compile): 2024-09-01 15:09:59.110713 => 2024-09-01 15:09:59.181853
[0m15:09:59.182828 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_params
[0m15:09:59.192623 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.200755 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.201590 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_params__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume

    FROM "postgres"."dbt"."source_warehouse_params"
),

derived_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    id AS WAREHOUSE_PARAMS_KEY,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PARAMS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_volume AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_weight AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_PARAMS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PARAMS_PK,
    WAREHOUSE_PARAMS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:09:59.204672 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:09:59.211514 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.212785 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_params" rename to "stg_warehouse_params__dbt_backup"
[0m15:09:59.214465 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.219909 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.221427 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_params__dbt_tmp" rename to "stg_warehouse_params"
[0m15:09:59.222978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.225840 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:09:59.226888 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.227840 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:09:59.232013 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:59.236769 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:09:59.237920 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_params__dbt_backup" cascade
[0m15:09:59.241538 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:09:59.243764 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (execute): 2024-09-01 15:09:59.183466 => 2024-09-01 15:09:59.243705
[0m15:09:59.244752 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: Close
[0m15:09:59.246200 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1cb8fd0>]}
[0m15:09:59.247487 [info ] [Thread-1  ]: 17 of 96 OK created sql view model dbt.stg_warehouse_params .................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:09:59.248838 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:09:59.250387 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_city
[0m15:09:59.252001 [info ] [Thread-1  ]: 18 of 96 START sql incremental model dbt.hub_city .............................. [RUN]
[0m15:09:59.253829 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_city'
[0m15:09:59.255089 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_city
[0m15:09:59.288894 [info ] [Thread-1  ]: 15:09:59 + Loading postgres.dbt.hub_city from 1 source(s)
[0m15:09:59.405096 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_city"
[0m15:09:59.414920 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_city (compile): 2024-09-01 15:09:59.255890 => 2024-09-01 15:09:59.414801
[0m15:09:59.415990 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_city
[0m15:09:59.464963 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_city"
[0m15:09:59.473294 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:09:59.474168 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: BEGIN
[0m15:09:59.475039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:59.483005 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:59.484472 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:09:59.485577 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_city"} */

      
  
    

  create  table "postgres"."dbt"."hub_city__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CITY_PK) rr.CITY_PK, rr.CITY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_city" AS rr
    WHERE rr.CITY_PK IS NOT NULL
    ORDER BY rr.CITY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CITY_PK, a.CITY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:09:59.505480 [debug] [Thread-1  ]: SQL status: SELECT 2351 in 0 seconds
[0m15:09:59.511209 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:09:59.512590 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_city"} */
alter table "postgres"."dbt"."hub_city" rename to "hub_city__dbt_backup"
[0m15:09:59.514114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.519293 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:09:59.520643 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_city"} */
alter table "postgres"."dbt"."hub_city__dbt_tmp" rename to "hub_city"
[0m15:09:59.522162 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.525441 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: COMMIT
[0m15:09:59.526605 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:09:59.527631 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: COMMIT
[0m15:09:59.531928 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:59.536304 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:09:59.537290 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_city"} */
drop table if exists "postgres"."dbt"."hub_city__dbt_backup" cascade
[0m15:09:59.541488 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:09:59.543928 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_city (execute): 2024-09-01 15:09:59.416811 => 2024-09-01 15:09:59.543868
[0m15:09:59.545042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: Close
[0m15:09:59.546675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c7e730>]}
[0m15:09:59.548125 [info ] [Thread-1  ]: 18 of 96 OK created sql incremental model dbt.hub_city ......................... [[32mSELECT 2351[0m in 0.29s]
[0m15:09:59.549903 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_city
[0m15:09:59.551484 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_city
[0m15:09:59.553075 [info ] [Thread-1  ]: 19 of 96 START sql incremental model dbt.sat_city .............................. [RUN]
[0m15:09:59.554894 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_city'
[0m15:09:59.556219 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_city
[0m15:09:59.638741 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_city"
[0m15:09:59.648051 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_city (compile): 2024-09-01 15:09:59.557235 => 2024-09-01 15:09:59.647944
[0m15:09:59.648886 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_city
[0m15:09:59.659997 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_city"
[0m15:09:59.668285 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:09:59.669001 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: BEGIN
[0m15:09:59.669768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:59.677125 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:59.678593 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:09:59.679868 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_city"} */

      
  
    

  create  table "postgres"."dbt"."sat_city__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CITY_PK, a.CITY_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_city" AS a
    WHERE a.CITY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CITY_PK, stage.CITY_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:09:59.704997 [debug] [Thread-1  ]: SQL status: SELECT 2351 in 0 seconds
[0m15:09:59.710637 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:09:59.711795 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_city"} */
alter table "postgres"."dbt"."sat_city" rename to "sat_city__dbt_backup"
[0m15:09:59.713332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.718479 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:09:59.719856 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_city"} */
alter table "postgres"."dbt"."sat_city__dbt_tmp" rename to "sat_city"
[0m15:09:59.721426 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.724516 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: COMMIT
[0m15:09:59.725624 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:09:59.726667 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: COMMIT
[0m15:09:59.731485 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:59.736979 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:09:59.738282 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_city"} */
drop table if exists "postgres"."dbt"."sat_city__dbt_backup" cascade
[0m15:09:59.742592 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:09:59.744819 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_city (execute): 2024-09-01 15:09:59.649558 => 2024-09-01 15:09:59.744759
[0m15:09:59.745854 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: Close
[0m15:09:59.747271 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1cb8fd0>]}
[0m15:09:59.748671 [info ] [Thread-1  ]: 19 of 96 OK created sql incremental model dbt.sat_city ......................... [[32mSELECT 2351[0m in 0.19s]
[0m15:09:59.750563 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_city
[0m15:09:59.752184 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_client
[0m15:09:59.753409 [info ] [Thread-1  ]: 20 of 96 SKIP relation dbt.hub_client .......................................... [[33mSKIP[0m]
[0m15:09:59.754713 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_client
[0m15:09:59.756150 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_client
[0m15:09:59.757197 [info ] [Thread-1  ]: 21 of 96 SKIP relation dbt.sat_client .......................................... [[33mSKIP[0m]
[0m15:09:59.758417 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_client
[0m15:09:59.759559 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_client_address
[0m15:09:59.760566 [info ] [Thread-1  ]: 22 of 96 SKIP relation dbt.hub_client_address .................................. [[33mSKIP[0m]
[0m15:09:59.761698 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_client_address
[0m15:09:59.762770 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_client_address
[0m15:09:59.763629 [info ] [Thread-1  ]: 23 of 96 SKIP relation dbt.sat_client_address .................................. [[33mSKIP[0m]
[0m15:09:59.764724 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_client_address
[0m15:09:59.766043 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_city
[0m15:09:59.767074 [info ] [Thread-1  ]: 24 of 96 SKIP relation dbt.stg_client_address_city ............................. [[33mSKIP[0m]
[0m15:09:59.768269 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_city
[0m15:09:59.769451 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_client
[0m15:09:59.770436 [info ] [Thread-1  ]: 25 of 96 SKIP relation dbt.stg_client_address_client ........................... [[33mSKIP[0m]
[0m15:09:59.771407 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_client
[0m15:09:59.772388 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_client_type
[0m15:09:59.773426 [info ] [Thread-1  ]: 26 of 96 START sql incremental model dbt.hub_client_type ....................... [RUN]
[0m15:09:59.774765 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_client_type'
[0m15:09:59.775647 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_client_type
[0m15:09:59.784871 [info ] [Thread-1  ]: 15:09:59 + Loading postgres.dbt.hub_client_type from 1 source(s)
[0m15:09:59.796877 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.805002 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client_type (compile): 2024-09-01 15:09:59.776334 => 2024-09-01 15:09:59.804895
[0m15:09:59.805804 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_client_type
[0m15:09:59.817721 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.826420 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.827326 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: BEGIN
[0m15:09:59.828007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:59.835367 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:59.837066 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.838107 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_client_type"} */

      
  
    

  create  table "postgres"."dbt"."hub_client_type__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CLIENT_TYPE_PK) rr.CLIENT_TYPE_PK, rr.CLIENT_TYPE_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client_type" AS rr
    WHERE rr.CLIENT_TYPE_PK IS NOT NULL
    ORDER BY rr.CLIENT_TYPE_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CLIENT_TYPE_PK, a.CLIENT_TYPE_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:09:59.846176 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:59.851821 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.852960 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_client_type"} */
alter table "postgres"."dbt"."hub_client_type" rename to "hub_client_type__dbt_backup"
[0m15:09:59.854328 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.859335 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.860694 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_client_type"} */
alter table "postgres"."dbt"."hub_client_type__dbt_tmp" rename to "hub_client_type"
[0m15:09:59.862059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:09:59.866312 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: COMMIT
[0m15:09:59.867541 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.868586 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: COMMIT
[0m15:09:59.871576 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:09:59.876204 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:09:59.877392 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_client_type"} */
drop table if exists "postgres"."dbt"."hub_client_type__dbt_backup" cascade
[0m15:09:59.880978 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:09:59.883281 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client_type (execute): 2024-09-01 15:09:59.806410 => 2024-09-01 15:09:59.883223
[0m15:09:59.884337 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: Close
[0m15:09:59.885718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3de3d00>]}
[0m15:09:59.887861 [info ] [Thread-1  ]: 26 of 96 OK created sql incremental model dbt.hub_client_type .................. [[32mSELECT 2[0m in 0.11s]
[0m15:09:59.889204 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_client_type
[0m15:09:59.890596 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_client_type
[0m15:09:59.892025 [info ] [Thread-1  ]: 27 of 96 START sql incremental model dbt.sat_client_type ....................... [RUN]
[0m15:09:59.893862 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_client_type'
[0m15:09:59.894931 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_client_type
[0m15:09:59.921194 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_client_type"
[0m15:09:59.931004 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client_type (compile): 2024-09-01 15:09:59.895846 => 2024-09-01 15:09:59.930890
[0m15:09:59.932027 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_client_type
[0m15:09:59.943363 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_client_type"
[0m15:09:59.952125 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:09:59.952900 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: BEGIN
[0m15:09:59.953571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:59.960948 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:59.962216 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:09:59.963401 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_client_type"} */

      
  
    

  create  table "postgres"."dbt"."sat_client_type__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CLIENT_TYPE_PK, a.CLIENT_TYPE_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client_type" AS a
    WHERE a.CLIENT_TYPE_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CLIENT_TYPE_PK, stage.CLIENT_TYPE_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:09:59.971247 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:09:59.976589 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:09:59.977441 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_client_type"} */
alter table "postgres"."dbt"."sat_client_type" rename to "sat_client_type__dbt_backup"
[0m15:09:59.978719 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.025807 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:10:00.027135 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_client_type"} */
alter table "postgres"."dbt"."sat_client_type__dbt_tmp" rename to "sat_client_type"
[0m15:10:00.028599 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.032145 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: COMMIT
[0m15:10:00.033186 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:10:00.034200 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: COMMIT
[0m15:10:00.036988 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:00.041570 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:10:00.042673 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_client_type"} */
drop table if exists "postgres"."dbt"."sat_client_type__dbt_backup" cascade
[0m15:10:00.046771 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:00.049242 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client_type (execute): 2024-09-01 15:09:59.932676 => 2024-09-01 15:10:00.049180
[0m15:10:00.050643 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: Close
[0m15:10:00.052272 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c9a5b0>]}
[0m15:10:00.053694 [info ] [Thread-1  ]: 27 of 96 OK created sql incremental model dbt.sat_client_type .................. [[32mSELECT 2[0m in 0.16s]
[0m15:10:00.055039 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_client_type
[0m15:10:00.056227 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_client_type
[0m15:10:00.057164 [info ] [Thread-1  ]: 28 of 96 SKIP relation dbt.stg_client_client_type .............................. [[33mSKIP[0m]
[0m15:10:00.058351 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_client_type
[0m15:10:00.059658 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_country
[0m15:10:00.061105 [info ] [Thread-1  ]: 29 of 96 START sql incremental model dbt.hub_country ........................... [RUN]
[0m15:10:00.062727 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_country'
[0m15:10:00.063853 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_country
[0m15:10:00.073713 [info ] [Thread-1  ]: 15:10:00 + Loading postgres.dbt.hub_country from 1 source(s)
[0m15:10:00.084704 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_country"
[0m15:10:00.092919 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_country (compile): 2024-09-01 15:10:00.064831 => 2024-09-01 15:10:00.092804
[0m15:10:00.093731 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_country
[0m15:10:00.103868 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_country"
[0m15:10:00.113429 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:10:00.114190 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: BEGIN
[0m15:10:00.114896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:00.122525 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:00.124073 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:10:00.125216 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_country"} */

      
  
    

  create  table "postgres"."dbt"."hub_country__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.COUNTRY_PK) rr.COUNTRY_PK, rr.COUNTRY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_country" AS rr
    WHERE rr.COUNTRY_PK IS NOT NULL
    ORDER BY rr.COUNTRY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.COUNTRY_PK, a.COUNTRY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:00.132808 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0 seconds
[0m15:10:00.138852 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:10:00.140132 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_country"} */
alter table "postgres"."dbt"."hub_country" rename to "hub_country__dbt_backup"
[0m15:10:00.141685 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.147862 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:10:00.149068 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_country"} */
alter table "postgres"."dbt"."hub_country__dbt_tmp" rename to "hub_country"
[0m15:10:00.150716 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.154868 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: COMMIT
[0m15:10:00.156023 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:10:00.156983 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: COMMIT
[0m15:10:00.160303 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:00.164641 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:10:00.165617 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_country"} */
drop table if exists "postgres"."dbt"."hub_country__dbt_backup" cascade
[0m15:10:00.169057 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:00.171658 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_country (execute): 2024-09-01 15:10:00.094367 => 2024-09-01 15:10:00.171597
[0m15:10:00.172729 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: Close
[0m15:10:00.174243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c9a490>]}
[0m15:10:00.176468 [info ] [Thread-1  ]: 29 of 96 OK created sql incremental model dbt.hub_country ...................... [[32mSELECT 28[0m in 0.11s]
[0m15:10:00.178081 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_country
[0m15:10:00.179786 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_country
[0m15:10:00.181120 [info ] [Thread-1  ]: 30 of 96 START sql incremental model dbt.sat_country ........................... [RUN]
[0m15:10:00.182674 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_country'
[0m15:10:00.183694 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_country
[0m15:10:00.209601 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_country"
[0m15:10:00.218704 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_country (compile): 2024-09-01 15:10:00.184634 => 2024-09-01 15:10:00.218597
[0m15:10:00.219513 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_country
[0m15:10:00.229975 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_country"
[0m15:10:00.238325 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:10:00.239212 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: BEGIN
[0m15:10:00.239998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:00.247303 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:00.248674 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:10:00.249773 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_country"} */

      
  
    

  create  table "postgres"."dbt"."sat_country__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.COUNTRY_PK, a.COUNTRY_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_country" AS a
    WHERE a.COUNTRY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.COUNTRY_PK, stage.COUNTRY_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:00.257634 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0 seconds
[0m15:10:00.263975 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:10:00.265012 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_country"} */
alter table "postgres"."dbt"."sat_country" rename to "sat_country__dbt_backup"
[0m15:10:00.266082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.271069 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:10:00.272247 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_country"} */
alter table "postgres"."dbt"."sat_country__dbt_tmp" rename to "sat_country"
[0m15:10:00.273473 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.276693 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: COMMIT
[0m15:10:00.277647 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:10:00.278719 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: COMMIT
[0m15:10:00.281469 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:00.285956 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:10:00.286953 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_country"} */
drop table if exists "postgres"."dbt"."sat_country__dbt_backup" cascade
[0m15:10:00.290383 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:00.292576 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_country (execute): 2024-09-01 15:10:00.220292 => 2024-09-01 15:10:00.292517
[0m15:10:00.293480 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: Close
[0m15:10:00.295280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3ed2160>]}
[0m15:10:00.296692 [info ] [Thread-1  ]: 30 of 96 OK created sql incremental model dbt.sat_country ...................... [[32mSELECT 28[0m in 0.11s]
[0m15:10:00.298233 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_country
[0m15:10:00.299499 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city_country
[0m15:10:00.300716 [info ] [Thread-1  ]: 31 of 96 START sql view model dbt.stg_city_country ............................. [RUN]
[0m15:10:00.302376 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city_country'
[0m15:10:00.303498 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city_country
[0m15:10:00.309109 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city_country"
[0m15:10:00.316881 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (compile): 2024-09-01 15:10:00.304341 => 2024-09-01 15:10:00.316766
[0m15:10:00.317912 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city_country
[0m15:10:00.327738 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city_country"
[0m15:10:00.336209 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:00.337005 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: BEGIN
[0m15:10:00.337671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:00.345256 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:00.346914 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:00.348192 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */

  create view "postgres"."dbt"."stg_city_country__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, country_id from "postgres"."dbt"."stg_city"
),

stg_country as (
    select id, COUNTRY_KEY, COUNTRY_PK from "postgres"."dbt"."stg_country"
)

select  CITY_KEY, COUNTRY_KEY, CITY_PK, COUNTRY_PK from stg_city sci
JOIN stg_country sc ON sc.id = sci.country_id
  );
[0m15:10:00.351252 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:00.357092 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:00.358130 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
alter table "postgres"."dbt"."stg_city_country__dbt_tmp" rename to "stg_city_country"
[0m15:10:00.359606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.362447 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:10:00.363495 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:00.364503 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:10:00.367429 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:00.373171 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:00.374476 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
drop view if exists "postgres"."dbt"."stg_city_country__dbt_backup" cascade
[0m15:10:00.375926 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:00.378114 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (execute): 2024-09-01 15:10:00.318659 => 2024-09-01 15:10:00.378057
[0m15:10:00.379199 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: Close
[0m15:10:00.380867 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c9ac40>]}
[0m15:10:00.382127 [info ] [Thread-1  ]: 31 of 96 OK created sql view model dbt.stg_city_country ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:00.383415 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city_country
[0m15:10:00.384859 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_currency
[0m15:10:00.386120 [info ] [Thread-1  ]: 32 of 96 START sql incremental model dbt.hub_currency .......................... [RUN]
[0m15:10:00.387811 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_currency'
[0m15:10:00.389027 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_currency
[0m15:10:00.398387 [info ] [Thread-1  ]: 15:10:00 + Loading postgres.dbt.hub_currency from 1 source(s)
[0m15:10:00.409566 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.418142 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency (compile): 2024-09-01 15:10:00.390257 => 2024-09-01 15:10:00.418035
[0m15:10:00.419011 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_currency
[0m15:10:00.429220 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.438052 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.438825 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: BEGIN
[0m15:10:00.439529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:00.447112 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:00.448676 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.449860 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency"} */

      
  
    

  create  table "postgres"."dbt"."hub_currency__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CURRENCY_PK) rr.CURRENCY_PK, rr.CURRENCY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency" AS rr
    WHERE rr.CURRENCY_PK IS NOT NULL
    ORDER BY rr.CURRENCY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CURRENCY_PK, a.CURRENCY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:00.457488 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0 seconds
[0m15:10:00.463118 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.464247 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency"} */
alter table "postgres"."dbt"."hub_currency" rename to "hub_currency__dbt_backup"
[0m15:10:00.465675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.472358 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.473672 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency"} */
alter table "postgres"."dbt"."hub_currency__dbt_tmp" rename to "hub_currency"
[0m15:10:00.475189 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:00.478601 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: COMMIT
[0m15:10:00.479768 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.480947 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: COMMIT
[0m15:10:00.484003 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:00.488458 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:10:00.489372 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency"} */
drop table if exists "postgres"."dbt"."hub_currency__dbt_backup" cascade
[0m15:10:00.493254 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:00.495597 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency (execute): 2024-09-01 15:10:00.419834 => 2024-09-01 15:10:00.495538
[0m15:10:00.496744 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: Close
[0m15:10:00.498454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c9a640>]}
[0m15:10:01.482941 [info ] [Thread-1  ]: 32 of 96 OK created sql incremental model dbt.hub_currency ..................... [[32mSELECT 19[0m in 0.11s]
[0m15:10:01.484800 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_currency
[0m15:10:01.486339 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_currency
[0m15:10:01.487615 [info ] [Thread-1  ]: 33 of 96 START sql incremental model dbt.sat_currency .......................... [RUN]
[0m15:10:01.489495 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_currency'
[0m15:10:01.490859 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_currency
[0m15:10:01.518267 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.528615 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency (compile): 2024-09-01 15:10:01.491947 => 2024-09-01 15:10:01.528504
[0m15:10:01.529458 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_currency
[0m15:10:01.539748 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.548692 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.549644 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: BEGIN
[0m15:10:01.550701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:01.559062 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:01.560717 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.561857 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */

      
  
    

  create  table "postgres"."dbt"."sat_currency__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CURRENCY_PK, a.CURRENCY_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency" AS a
    WHERE a.CURRENCY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CURRENCY_PK, stage.CURRENCY_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:01.569289 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0 seconds
[0m15:10:01.574990 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.576194 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */
alter table "postgres"."dbt"."sat_currency" rename to "sat_currency__dbt_backup"
[0m15:10:01.577662 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:01.583944 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.585191 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */
alter table "postgres"."dbt"."sat_currency__dbt_tmp" rename to "sat_currency"
[0m15:10:01.586731 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:01.590425 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: COMMIT
[0m15:10:01.591908 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.593078 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: COMMIT
[0m15:10:01.596119 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:01.600976 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:10:01.602706 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */
drop table if exists "postgres"."dbt"."sat_currency__dbt_backup" cascade
[0m15:10:01.606416 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:01.608663 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency (execute): 2024-09-01 15:10:01.530090 => 2024-09-01 15:10:01.608604
[0m15:10:01.609689 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: Close
[0m15:10:01.611441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c9a550>]}
[0m15:10:01.613024 [info ] [Thread-1  ]: 33 of 96 OK created sql incremental model dbt.sat_currency ..................... [[32mSELECT 19[0m in 0.12s]
[0m15:10:01.614559 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_currency
[0m15:10:01.615849 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_currency_rate
[0m15:10:01.617242 [info ] [Thread-1  ]: 34 of 96 START sql incremental model dbt.hub_currency_rate ..................... [RUN]
[0m15:10:01.618908 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_currency_rate'
[0m15:10:01.620113 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_currency_rate
[0m15:10:01.629193 [info ] [Thread-1  ]: 15:10:01 + Loading postgres.dbt.hub_currency_rate from 1 source(s)
[0m15:10:01.640387 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.649372 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency_rate (compile): 2024-09-01 15:10:01.621028 => 2024-09-01 15:10:01.649250
[0m15:10:01.650360 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_currency_rate
[0m15:10:01.661236 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.669593 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.670322 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: BEGIN
[0m15:10:01.671074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:01.679090 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:01.680783 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.682125 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency_rate"} */

      
  
    

  create  table "postgres"."dbt"."hub_currency_rate__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CURRENCY_RATE_PK) rr.CURRENCY_RATE_PK, rr.CURRENCY_RATE_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency_rate" AS rr
    WHERE rr.CURRENCY_RATE_PK IS NOT NULL
    ORDER BY rr.CURRENCY_RATE_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CURRENCY_RATE_PK, a.CURRENCY_RATE_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:01.712951 [debug] [Thread-1  ]: SQL status: SELECT 4982 in 0 seconds
[0m15:10:01.719602 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.720861 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency_rate"} */
alter table "postgres"."dbt"."hub_currency_rate" rename to "hub_currency_rate__dbt_backup"
[0m15:10:01.722419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:01.727941 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.729342 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency_rate"} */
alter table "postgres"."dbt"."hub_currency_rate__dbt_tmp" rename to "hub_currency_rate"
[0m15:10:01.731049 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:01.734655 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: COMMIT
[0m15:10:01.735773 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.736774 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: COMMIT
[0m15:10:01.742387 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:01.746863 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:10:01.748025 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency_rate"} */
drop table if exists "postgres"."dbt"."hub_currency_rate__dbt_backup" cascade
[0m15:10:01.751801 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:01.754310 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency_rate (execute): 2024-09-01 15:10:01.651109 => 2024-09-01 15:10:01.754232
[0m15:10:01.755153 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: Close
[0m15:10:01.757081 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1c9a6a0>]}
[0m15:10:01.758586 [info ] [Thread-1  ]: 34 of 96 OK created sql incremental model dbt.hub_currency_rate ................ [[32mSELECT 4982[0m in 0.14s]
[0m15:10:01.760040 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_currency_rate
[0m15:10:01.761450 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_currency_rate
[0m15:10:01.762705 [info ] [Thread-1  ]: 35 of 96 START sql incremental model dbt.sat_currency_rate ..................... [RUN]
[0m15:10:01.764397 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_currency_rate'
[0m15:10:01.765436 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_currency_rate
[0m15:10:01.792875 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.801484 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency_rate (compile): 2024-09-01 15:10:01.766323 => 2024-09-01 15:10:01.801340
[0m15:10:01.802455 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_currency_rate
[0m15:10:01.812497 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.821511 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.822658 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: BEGIN
[0m15:10:01.823381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:01.830616 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:01.832003 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.833259 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */

      
  
    

  create  table "postgres"."dbt"."sat_currency_rate__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CURRENCY_RATE_PK, a.CURRENCY_RATE_HASHDIFF, a.relation_to_rur, a.date_start, a.date_end, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency_rate" AS a
    WHERE a.CURRENCY_RATE_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CURRENCY_RATE_PK, stage.CURRENCY_RATE_HASHDIFF, stage.relation_to_rur, stage.date_start, stage.date_end, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:01.883747 [debug] [Thread-1  ]: SQL status: SELECT 4982 in 0 seconds
[0m15:10:01.890678 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.892044 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */
alter table "postgres"."dbt"."sat_currency_rate" rename to "sat_currency_rate__dbt_backup"
[0m15:10:01.893660 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:01.898877 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.899927 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */
alter table "postgres"."dbt"."sat_currency_rate__dbt_tmp" rename to "sat_currency_rate"
[0m15:10:01.901339 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:01.904684 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: COMMIT
[0m15:10:01.905631 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.906585 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: COMMIT
[0m15:10:01.909131 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:01.913769 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:10:01.914922 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */
drop table if exists "postgres"."dbt"."sat_currency_rate__dbt_backup" cascade
[0m15:10:01.919040 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:01.921338 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency_rate (execute): 2024-09-01 15:10:01.803085 => 2024-09-01 15:10:01.921263
[0m15:10:01.922428 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: Close
[0m15:10:01.923847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1d65e50>]}
[0m15:10:01.925224 [info ] [Thread-1  ]: 35 of 96 OK created sql incremental model dbt.sat_currency_rate ................ [[32mSELECT 4982[0m in 0.16s]
[0m15:10:01.926780 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_currency_rate
[0m15:10:01.928090 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:01.929481 [info ] [Thread-1  ]: 36 of 96 START sql view model dbt.stg_currency_currency_rate ................... [RUN]
[0m15:10:01.931450 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_currency_rate'
[0m15:10:01.932579 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:01.938037 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:01.945273 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (compile): 2024-09-01 15:10:01.933513 => 2024-09-01 15:10:01.945164
[0m15:10:01.946056 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:01.955303 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:01.963554 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:01.964304 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: BEGIN
[0m15:10:01.964959 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:01.972611 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:01.974327 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:01.975443 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" as (
    with stg_currency as (
    select code, CURRENCY_KEY, CURRENCY_PK from "postgres"."dbt"."stg_currency"
),

stg_currency_rate as (
    select currency_code, CURRENCY_RATE_KEY, CURRENCY_RATE_PK from "postgres"."dbt"."stg_currency_rate"
)

select  CURRENCY_KEY, CURRENCY_RATE_KEY, CURRENCY_PK, CURRENCY_RATE_PK from stg_currency sc
JOIN stg_currency_rate scr ON sc.code = scr.currency_code
  );
[0m15:10:01.978287 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:01.985060 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:01.986327 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" rename to "stg_currency_currency_rate"
[0m15:10:01.987953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:01.990553 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:10:01.991828 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:01.992874 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:10:01.995556 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:01.999916 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:02.001086 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_currency_rate__dbt_backup" cascade
[0m15:10:02.002534 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:02.005000 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (execute): 2024-09-01 15:10:01.946645 => 2024-09-01 15:10:02.004939
[0m15:10:02.006157 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: Close
[0m15:10:02.007749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1ce8550>]}
[0m15:10:02.009167 [info ] [Thread-1  ]: 36 of 96 OK created sql view model dbt.stg_currency_currency_rate .............. [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:02.010734 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:02.012481 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_good
[0m15:10:02.014041 [info ] [Thread-1  ]: 37 of 96 START sql incremental model dbt.hub_good .............................. [RUN]
[0m15:10:02.015897 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_good'
[0m15:10:02.017247 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_good
[0m15:10:02.026533 [info ] [Thread-1  ]: 15:10:02 + Loading postgres.dbt.hub_good from 1 source(s)
[0m15:10:02.038927 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_good"
[0m15:10:02.047053 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_good (compile): 2024-09-01 15:10:02.018220 => 2024-09-01 15:10:02.046945
[0m15:10:02.048030 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_good
[0m15:10:02.058607 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_good"
[0m15:10:02.068372 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:10:02.069144 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: BEGIN
[0m15:10:02.069835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:02.077054 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:02.078802 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:10:02.080059 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_good"} */

      
  
    

  create  table "postgres"."dbt"."hub_good__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.GOOD_PK) rr.GOOD_PK, rr.GOOD_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_goods" AS rr
    WHERE rr.GOOD_PK IS NOT NULL
    ORDER BY rr.GOOD_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.GOOD_PK, a.GOOD_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:02.563781 [debug] [Thread-1  ]: SQL status: SELECT 105759 in 0 seconds
[0m15:10:02.569555 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:10:02.571156 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_good"} */
alter table "postgres"."dbt"."hub_good" rename to "hub_good__dbt_backup"
[0m15:10:02.573053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:02.579523 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:10:02.580686 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_good"} */
alter table "postgres"."dbt"."hub_good__dbt_tmp" rename to "hub_good"
[0m15:10:02.582338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:02.586317 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: COMMIT
[0m15:10:02.587389 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:10:02.588259 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: COMMIT
[0m15:10:02.642399 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:02.647250 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:10:02.648426 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_good"} */
drop table if exists "postgres"."dbt"."hub_good__dbt_backup" cascade
[0m15:10:02.653057 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:02.655376 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_good (execute): 2024-09-01 15:10:02.048738 => 2024-09-01 15:10:02.655317
[0m15:10:02.656434 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: Close
[0m15:10:02.658007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1d65e50>]}
[0m15:10:02.659218 [info ] [Thread-1  ]: 37 of 96 OK created sql incremental model dbt.hub_good ......................... [[32mSELECT 105759[0m in 0.64s]
[0m15:10:02.660569 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_good
[0m15:10:02.662168 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_good
[0m15:10:02.663659 [info ] [Thread-1  ]: 38 of 96 START sql incremental model dbt.sat_good .............................. [RUN]
[0m15:10:02.665441 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_good'
[0m15:10:02.666773 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_good
[0m15:10:02.695000 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_good"
[0m15:10:02.703357 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_good (compile): 2024-09-01 15:10:02.667839 => 2024-09-01 15:10:02.703254
[0m15:10:02.704141 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_good
[0m15:10:02.719984 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_good"
[0m15:10:02.729465 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:10:02.730225 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: BEGIN
[0m15:10:02.730914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:02.738376 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:02.740036 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:10:02.741372 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */

      
  
    

  create  table "postgres"."dbt"."sat_good__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.GOOD_PK, a.GOOD_HASHDIFF, a.name, a.cost_per_unit, a.count, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_goods" AS a
    WHERE a.GOOD_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.GOOD_PK, stage.GOOD_HASHDIFF, stage.name, stage.cost_per_unit, stage.count, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:03.385979 [debug] [Thread-1  ]: SQL status: SELECT 105759 in 1 seconds
[0m15:10:03.392662 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:10:03.393903 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */
alter table "postgres"."dbt"."sat_good" rename to "sat_good__dbt_backup"
[0m15:10:03.395476 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:03.400587 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:10:03.401916 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */
alter table "postgres"."dbt"."sat_good__dbt_tmp" rename to "sat_good"
[0m15:10:03.403493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:03.406793 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: COMMIT
[0m15:10:03.407899 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:10:03.408803 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: COMMIT
[0m15:10:03.417103 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:03.421884 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:10:03.423118 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */
drop table if exists "postgres"."dbt"."sat_good__dbt_backup" cascade
[0m15:10:03.428268 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:03.430828 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_good (execute): 2024-09-01 15:10:02.704775 => 2024-09-01 15:10:03.430770
[0m15:10:03.432060 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: Close
[0m15:10:03.434310 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1ce8550>]}
[0m15:10:03.435738 [info ] [Thread-1  ]: 38 of 96 OK created sql incremental model dbt.sat_good ......................... [[32mSELECT 105759[0m in 0.77s]
[0m15:10:03.437213 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_good
[0m15:10:03.438644 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_order_status
[0m15:10:03.439963 [info ] [Thread-1  ]: 39 of 96 START sql incremental model dbt.hub_order_status ...................... [RUN]
[0m15:10:03.442029 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_order_status'
[0m15:10:03.443352 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_order_status
[0m15:10:03.452206 [info ] [Thread-1  ]: 15:10:03 + Loading postgres.dbt.hub_order_status from 1 source(s)
[0m15:10:03.462772 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.471240 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status (compile): 2024-09-01 15:10:03.444482 => 2024-09-01 15:10:03.471109
[0m15:10:03.472232 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_order_status
[0m15:10:03.482590 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.491727 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.492555 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: BEGIN
[0m15:10:03.493250 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:03.500590 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:03.502346 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.503983 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_status"} */

      
  
    

  create  table "postgres"."dbt"."hub_order_status__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ORDER_STATUS_PK) rr.ORDER_STATUS_PK, rr.ORDER_STATUS_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status" AS rr
    WHERE rr.ORDER_STATUS_PK IS NOT NULL
    ORDER BY rr.ORDER_STATUS_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.ORDER_STATUS_PK, a.ORDER_STATUS_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:03.512190 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:10:03.559646 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.560941 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_status"} */
alter table "postgres"."dbt"."hub_order_status" rename to "hub_order_status__dbt_backup"
[0m15:10:03.562432 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:03.567689 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.568722 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_status"} */
alter table "postgres"."dbt"."hub_order_status__dbt_tmp" rename to "hub_order_status"
[0m15:10:03.569998 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:03.573450 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: COMMIT
[0m15:10:03.574564 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.575448 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: COMMIT
[0m15:10:03.578192 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:03.583080 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:10:03.584131 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_status"} */
drop table if exists "postgres"."dbt"."hub_order_status__dbt_backup" cascade
[0m15:10:03.587418 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:03.589690 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status (execute): 2024-09-01 15:10:03.472894 => 2024-09-01 15:10:03.589632
[0m15:10:03.590660 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: Close
[0m15:10:03.592219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1aebee0>]}
[0m15:10:03.593441 [info ] [Thread-1  ]: 39 of 96 OK created sql incremental model dbt.hub_order_status ................. [[32mSELECT 7[0m in 0.15s]
[0m15:10:03.595169 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_order_status
[0m15:10:03.596852 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_status
[0m15:10:03.598091 [info ] [Thread-1  ]: 40 of 96 START sql incremental model dbt.sat_order_status ...................... [RUN]
[0m15:10:03.599784 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_status'
[0m15:10:03.600841 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_status
[0m15:10:03.626735 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.635860 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status (compile): 2024-09-01 15:10:03.601778 => 2024-09-01 15:10:03.635746
[0m15:10:03.636647 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_status
[0m15:10:03.647882 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.657147 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.658014 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: BEGIN
[0m15:10:03.658741 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:03.665931 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:03.667388 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.668371 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */

      
  
    

  create  table "postgres"."dbt"."sat_order_status__dbt_tmp"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_STATUS_PK, a.ORDER_STATUS_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status" AS a
    WHERE a.ORDER_STATUS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_STATUS_PK, stage.ORDER_STATUS_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:03.676580 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:10:03.682116 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.683208 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */
alter table "postgres"."dbt"."sat_order_status" rename to "sat_order_status__dbt_backup"
[0m15:10:03.684484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:03.689254 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.690346 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */
alter table "postgres"."dbt"."sat_order_status__dbt_tmp" rename to "sat_order_status"
[0m15:10:03.692176 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:03.695923 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: COMMIT
[0m15:10:03.697035 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.698050 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: COMMIT
[0m15:10:03.700898 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:03.705603 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:10:03.707099 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */
drop table if exists "postgres"."dbt"."sat_order_status__dbt_backup" cascade
[0m15:10:03.710958 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:10:03.713678 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status (execute): 2024-09-01 15:10:03.637243 => 2024-09-01 15:10:03.713615
[0m15:10:03.714885 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: Close
[0m15:10:03.716399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c1aebb20>]}
[0m15:10:03.717892 [info ] [Thread-1  ]: 40 of 96 OK created sql incremental model dbt.sat_order_status ................. [[32mSELECT 7[0m in 0.12s]
[0m15:10:03.719302 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order_status
[0m15:10:03.720592 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_order_status_history
[0m15:10:03.722093 [info ] [Thread-1  ]: 41 of 96 START sql incremental model dbt.hub_order_status_history .............. [RUN]
[0m15:10:03.724014 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_order_status_history'
[0m15:10:03.725061 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_order_status_history
[0m15:10:03.734473 [info ] [Thread-1  ]: 15:10:03 + Loading postgres.dbt.hub_order_status_history from 1 source(s)
[0m15:10:03.745995 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_order_status_history"
[0m15:10:03.753792 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status_history (compile): 2024-09-01 15:10:03.725970 => 2024-09-01 15:10:03.753680
[0m15:10:03.754663 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_order_status_history
[0m15:10:03.766556 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_order_status_history"
[0m15:10:03.776282 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status_history"
[0m15:10:03.777075 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: BEGIN
[0m15:10:03.777856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:03.786195 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:03.787896 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status_history"
[0m15:10:03.789015 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_status_history"} */

      
  
    

  create  table "postgres"."dbt"."hub_order_status_history"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ORDER_STATUS_HISTORY_PK) rr.ORDER_STATUS_HISTORY_PK, rr.ORDER_STATUS_HISTORY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status_history" AS rr
    WHERE rr.ORDER_STATUS_HISTORY_PK IS NOT NULL
    ORDER BY rr.ORDER_STATUS_HISTORY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:10:05.127741 [debug] [Thread-1  ]: SQL status: SELECT 249912 in 1 seconds
[0m15:10:05.130916 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: COMMIT
[0m15:10:05.132025 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status_history"
[0m15:10:05.133339 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: COMMIT
[0m15:10:05.166365 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:05.168399 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status_history (execute): 2024-09-01 15:10:03.755300 => 2024-09-01 15:10:05.168310
[0m15:10:05.169685 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: Close
[0m15:10:05.171613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86bcac7e-b327-4df6-b19c-094a63da5106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c4354940>]}
[0m15:10:05.173295 [info ] [Thread-1  ]: 41 of 96 OK created sql incremental model dbt.hub_order_status_history ......... [[32mSELECT 249912[0m in 1.45s]
[0m15:10:05.174801 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_order_status_history
[0m15:10:05.176437 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_status_history
[0m15:10:05.177747 [info ] [Thread-1  ]: 42 of 96 START sql incremental model dbt.sat_order_status_history .............. [RUN]
[0m15:10:05.179455 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_status_history'
[0m15:10:05.180670 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_status_history
[0m15:10:05.206801 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_status_history"
[0m15:10:05.215378 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status_history (compile): 2024-09-01 15:10:05.181872 => 2024-09-01 15:10:05.215270
[0m15:10:05.216186 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_status_history
[0m15:10:05.226452 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order_status_history"
[0m15:10:05.235714 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status_history"
[0m15:10:05.236452 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: BEGIN
[0m15:10:05.237125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:05.244790 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:05.246274 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status_history"
[0m15:10:05.247453 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status_history"} */

      
  
    

  create  table "postgres"."dbt"."sat_order_status_history"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY_HASHDIFF, a.status_datetime, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status_history" AS a
    WHERE a.ORDER_STATUS_HISTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_STATUS_HISTORY_PK, stage.ORDER_STATUS_HISTORY_HASHDIFF, stage.status_datetime, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  


============================== 2024-09-01 15:10:25.263577 | 1eecb2bf-27f0-43df-9023-704570dd92f5 ==============================
[0m15:10:25.263577 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:10:25.266054 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:10:25.267201 [debug] [MainThread]: Tracking: tracking
[0m15:10:25.272139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e07af6100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e07af6cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e07af6460>]}
[0m15:10:25.275642 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-oo3so22p'
[0m15:10:25.277121 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:10:26.353010 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:26.354376 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m15:10:26.355894 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:10:26.356878 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:10:26.361383 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:10:26.362886 [debug] [MainThread]: STDERR: "b''"
[0m15:10:26.364000 [debug] [MainThread]:   Checking out revision master.
[0m15:10:26.365059 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:10:26.370390 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:26.371866 [debug] [MainThread]: STDERR: "b''"
[0m15:10:26.372989 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:10:27.845214 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:27.846619 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m15:10:27.847511 [debug] [MainThread]: Executing "git tag --list"
[0m15:10:27.852603 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:10:27.854080 [debug] [MainThread]: STDERR: "b''"
[0m15:10:27.855200 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:10:27.865993 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:10:27.867513 [debug] [MainThread]: STDERR: "b''"
[0m15:10:27.868691 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:10:27.873661 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:10:27.875126 [debug] [MainThread]: STDERR: "b''"
[0m15:10:27.876362 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m15:10:27.878100 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:10:27.891323 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:10:28.217564 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:10:28.219516 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:10:28.421221 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:10:28.565930 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:10:28.570777 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:28.572200 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:10:28.573225 [debug] [MainThread]: command return code=128
[0m15:10:28.574927 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:10:28.575864 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:10:28.580439 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:10:28.581733 [debug] [MainThread]: STDERR: "b''"
[0m15:10:28.582736 [debug] [MainThread]:   Checking out revision master.
[0m15:10:28.583676 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:10:28.589453 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:28.590720 [debug] [MainThread]: STDERR: "b''"
[0m15:10:28.591682 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:10:29.351162 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:29.352691 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:10:29.354167 [debug] [MainThread]: Executing "git tag --list"
[0m15:10:29.360007 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:10:29.361456 [debug] [MainThread]: STDERR: "b''"
[0m15:10:29.362579 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:10:29.371734 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:10:29.373147 [debug] [MainThread]: STDERR: "b''"
[0m15:10:29.374172 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:10:29.379359 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:10:29.380697 [debug] [MainThread]: STDERR: "b''"
[0m15:10:29.381753 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:10:29.383270 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:10:29.399651 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m15:10:29.605757 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:10:29.609916 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:29.611386 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:10:29.612617 [debug] [MainThread]: command return code=128
[0m15:10:29.614205 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:10:29.615321 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:10:29.619968 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:10:29.621434 [debug] [MainThread]: STDERR: "b''"
[0m15:10:29.622733 [debug] [MainThread]:   Checking out revision master.
[0m15:10:29.623912 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:10:29.629487 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:29.630769 [debug] [MainThread]: STDERR: "b''"
[0m15:10:29.631815 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:10:30.453526 [debug] [MainThread]: STDOUT: "b''"
[0m15:10:30.454919 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:10:30.455947 [debug] [MainThread]: Executing "git tag --list"
[0m15:10:30.461298 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:10:30.462744 [debug] [MainThread]: STDERR: "b''"
[0m15:10:30.463814 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:10:30.470483 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:10:30.471850 [debug] [MainThread]: STDERR: "b''"
[0m15:10:30.472798 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:10:30.477135 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:10:30.478498 [debug] [MainThread]: STDERR: "b''"
[0m15:10:30.479422 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:10:33.145125 [info ] [MainThread]:   Installed from revision master
[0m15:10:33.146872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eecb2bf-27f0-43df-9023-704570dd92f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e07af23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e082837c0>]}
[0m15:10:33.148215 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:10:37.717493 [info ] [MainThread]:   Installed from version 1.3.0
[0m15:10:37.718334 [info ] [MainThread]:   Up to date!
[0m15:10:37.719443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1eecb2bf-27f0-43df-9023-704570dd92f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e08b9c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e082837c0>]}
[0m15:10:37.720701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e07bf2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0888cb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e07b55670>]}
[0m15:10:37.721674 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:10:44.087750 | 097e84ef-56ca-4b6d-8ebf-5abdaa799de1 ==============================
[0m15:10:44.087750 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:10:44.090756 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stage'], 'full_refresh': True, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:10:44.091913 [debug] [MainThread]: Tracking: tracking
[0m15:10:44.097703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147db46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147db4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147db47f0>]}
[0m15:10:47.368602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:10:47.369668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:10:47.387825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1478ae0d0>]}
[0m15:10:47.437292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147bda940>]}
[0m15:10:47.438539 [info ] [MainThread]: Found 96 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:10:47.439579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147db3280>]}
[0m15:10:47.447973 [info ] [MainThread]: 
[0m15:10:47.451132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:47.456575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:10:47.473347 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:10:47.474576 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:10:47.475620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:47.484560 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:10:47.487424 [debug] [ThreadPool]: On list_postgres: Close
[0m15:10:47.497662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:10:47.507012 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:10:47.508303 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:10:47.509445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:47.517705 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:10:47.519041 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:10:47.520215 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:10:47.523893 [debug] [ThreadPool]: SQL status: SELECT 72 in 0 seconds
[0m15:10:47.528589 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:10:47.530075 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:10:47.554951 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:47.556337 [debug] [MainThread]: On master: BEGIN
[0m15:10:47.557627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:47.565575 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:10:47.567240 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:47.568537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:47.596308 [debug] [MainThread]: SQL status: SELECT 21 in 0 seconds
[0m15:10:47.601801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147db4ac0>]}
[0m15:10:47.603070 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:47.604328 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:47.605364 [debug] [MainThread]: On master: BEGIN
[0m15:10:47.606903 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:10:47.608162 [debug] [MainThread]: On master: COMMIT
[0m15:10:47.609211 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:47.610168 [debug] [MainThread]: On master: COMMIT
[0m15:10:47.611302 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:10:47.612259 [debug] [MainThread]: On master: Close
[0m15:10:47.613631 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:47.614722 [info ] [MainThread]: 
[0m15:10:47.619697 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city
[0m15:10:47.621055 [info ] [Thread-1  ]: 1 of 45 START sql view model dbt.stg_city ...................................... [RUN]
[0m15:10:47.622505 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city'
[0m15:10:47.623509 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city
[0m15:10:47.682860 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:47.684384 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: BEGIN
[0m15:10:47.685779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:47.694137 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:47.695773 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:47.696811 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:47.704417 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:10:47.807566 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:47.808749 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:47.814135 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:10:47.921027 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city"
[0m15:10:47.928577 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (compile): 2024-09-01 15:10:47.624281 => 2024-09-01 15:10:47.928449
[0m15:10:47.929424 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city
[0m15:10:47.986039 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city"
[0m15:10:47.993359 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:47.994306 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

  create view "postgres"."dbt"."stg_city__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    country_id

    FROM "postgres"."dbt"."source_city"
),

derived_columns AS (

    SELECT

    id,
    name,
    country_id,
    id AS CITY_KEY,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CITY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CITY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,
    CITY_PK,
    CITY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:47.996738 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:48.006306 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:48.007774 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city" rename to "stg_city__dbt_backup"
[0m15:10:48.009420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.014823 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:48.016102 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city__dbt_tmp" rename to "stg_city"
[0m15:10:48.017759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.043723 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:10:48.044893 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:48.045873 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:10:48.048974 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:48.058560 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:10:48.059823 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
drop view if exists "postgres"."dbt"."stg_city__dbt_backup" cascade
[0m15:10:48.063975 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:48.066196 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (execute): 2024-09-01 15:10:47.930079 => 2024-09-01 15:10:48.066135
[0m15:10:48.067385 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: Close
[0m15:10:48.068971 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476cf0a0>]}
[0m15:10:48.070158 [info ] [Thread-1  ]: 1 of 45 OK created sql view model dbt.stg_city ................................. [[32mCREATE VIEW[0m in 0.45s]
[0m15:10:48.073840 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city
[0m15:10:48.075279 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client
[0m15:10:48.076545 [info ] [Thread-1  ]: 2 of 45 START sql view model dbt.stg_client .................................... [RUN]
[0m15:10:48.078510 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client'
[0m15:10:48.079627 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client
[0m15:10:48.093241 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.094383 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: BEGIN
[0m15:10:48.095268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:48.102919 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:48.104537 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.105685 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.113619 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:48.124220 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.125344 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.128928 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:48.149127 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client"
[0m15:10:48.156931 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (compile): 2024-09-01 15:10:48.080410 => 2024-09-01 15:10:48.156797
[0m15:10:48.157825 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client
[0m15:10:48.168407 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client"
[0m15:10:48.175673 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.176453 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

  create view "postgres"."dbt"."stg_client__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id

    FROM "postgres"."dbt"."source_client"
),

derived_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CONCAT(
        order_id, '||',
        client_type_code
    ) AS CLIENT_KEY,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS CLIENT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,
    CLIENT_PK,
    CLIENT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:48.178772 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:48.184131 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.185109 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client" rename to "stg_client__dbt_backup"
[0m15:10:48.186654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.192574 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.193515 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client__dbt_tmp" rename to "stg_client"
[0m15:10:48.194745 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.197546 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:10:48.198494 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.199322 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:10:48.204227 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:48.209046 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:10:48.210334 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
drop view if exists "postgres"."dbt"."stg_client__dbt_backup" cascade
[0m15:10:48.215703 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:48.218465 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (execute): 2024-09-01 15:10:48.158446 => 2024-09-01 15:10:48.218404
[0m15:10:48.219539 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: Close
[0m15:10:48.221027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476c79d0>]}
[0m15:10:48.222320 [info ] [Thread-1  ]: 2 of 45 OK created sql view model dbt.stg_client ............................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:10:48.223695 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client
[0m15:10:48.225133 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address
[0m15:10:48.226431 [info ] [Thread-1  ]: 3 of 45 START sql view model dbt.stg_client_address ............................ [RUN]
[0m15:10:48.228321 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address'
[0m15:10:48.229705 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address
[0m15:10:48.244370 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.245528 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: BEGIN
[0m15:10:48.246561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:48.254492 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:48.255884 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.257023 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.264906 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:48.311828 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.313135 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.316648 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:48.331672 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.339718 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (compile): 2024-09-01 15:10:48.230556 => 2024-09-01 15:10:48.339610
[0m15:10:48.340611 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address
[0m15:10:48.350127 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.357613 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.358559 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

  create view "postgres"."dbt"."stg_client_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid

    FROM "postgres"."dbt"."source_client_address"
),

derived_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    id AS CLIENT_ADDRESS_KEY,
    'CSV_CLIENT_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), ''), '^^')
    ), '^^')), 'hex') AS CLIENT_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(is_valid AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,
    CLIENT_ADDRESS_PK,
    CLIENT_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:48.360979 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:48.366104 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.367226 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
alter table "postgres"."dbt"."stg_client_address" rename to "stg_client_address__dbt_backup"
[0m15:10:48.368706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.374408 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.375578 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
alter table "postgres"."dbt"."stg_client_address__dbt_tmp" rename to "stg_client_address"
[0m15:10:48.377106 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.380053 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:10:48.381067 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.382097 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:10:48.398850 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:48.403594 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:10:48.404760 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
drop view if exists "postgres"."dbt"."stg_client_address__dbt_backup" cascade
[0m15:10:48.408651 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:48.411000 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (execute): 2024-09-01 15:10:48.341247 => 2024-09-01 15:10:48.410941
[0m15:10:48.412108 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: Close
[0m15:10:48.413703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476c7c70>]}
[0m15:10:48.415130 [info ] [Thread-1  ]: 3 of 45 OK created sql view model dbt.stg_client_address ....................... [[32mCREATE VIEW[0m in 0.19s]
[0m15:10:48.416607 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address
[0m15:10:48.418117 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_type
[0m15:10:48.419267 [info ] [Thread-1  ]: 4 of 45 START sql view model dbt.stg_client_type ............................... [RUN]
[0m15:10:48.420953 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_type'
[0m15:10:48.422146 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_type
[0m15:10:48.435278 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.436739 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: BEGIN
[0m15:10:48.438023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:48.445772 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:48.447344 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.448599 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.456168 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:48.466649 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.468199 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.471960 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:48.482398 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.490785 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (compile): 2024-09-01 15:10:48.423074 => 2024-09-01 15:10:48.490660
[0m15:10:48.491700 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_type
[0m15:10:48.503170 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.512568 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.513416 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

  create view "postgres"."dbt"."stg_client_type__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_client_type"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS CLIENT_TYPE_KEY,
    'CSV_CLIENT_TYPE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CLIENT_TYPE_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CLIENT_TYPE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,
    CLIENT_TYPE_PK,
    CLIENT_TYPE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:48.515966 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:48.521434 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.522723 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type" rename to "stg_client_type__dbt_backup"
[0m15:10:48.524270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.530155 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.531583 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type__dbt_tmp" rename to "stg_client_type"
[0m15:10:48.533196 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.536052 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:10:48.537141 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.538310 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:10:48.541746 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:48.546379 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:10:48.547684 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_type__dbt_backup" cascade
[0m15:10:48.550979 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:48.553197 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (execute): 2024-09-01 15:10:48.492502 => 2024-09-01 15:10:48.553120
[0m15:10:48.554163 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: Close
[0m15:10:48.555641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147d02b50>]}
[0m15:10:48.556807 [info ] [Thread-1  ]: 4 of 45 OK created sql view model dbt.stg_client_type .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:10:48.558590 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_type
[0m15:10:48.560016 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_country
[0m15:10:48.561582 [info ] [Thread-1  ]: 5 of 45 START sql view model dbt.stg_country ................................... [RUN]
[0m15:10:48.563516 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_country'
[0m15:10:48.564696 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_country
[0m15:10:48.579146 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.580398 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: BEGIN
[0m15:10:48.581432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:48.589541 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:48.590963 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.591941 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.600053 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:48.610129 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.611421 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.614950 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:48.625138 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_country"
[0m15:10:48.633211 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (compile): 2024-09-01 15:10:48.565624 => 2024-09-01 15:10:48.633099
[0m15:10:48.634199 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_country
[0m15:10:48.644007 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_country"
[0m15:10:48.652543 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.653606 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

  create view "postgres"."dbt"."stg_country__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_country"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS COUNTRY_KEY,
    'CSV_COUNTRY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS COUNTRY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS COUNTRY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,
    COUNTRY_PK,
    COUNTRY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:48.655854 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:48.661013 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.662247 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country" rename to "stg_country__dbt_backup"
[0m15:10:48.663883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.670371 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.671650 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country__dbt_tmp" rename to "stg_country"
[0m15:10:48.673198 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.676185 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:10:48.677561 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.678681 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:10:48.682352 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:48.687119 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:10:48.688373 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
drop view if exists "postgres"."dbt"."stg_country__dbt_backup" cascade
[0m15:10:48.691703 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:48.693927 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (execute): 2024-09-01 15:10:48.634877 => 2024-09-01 15:10:48.693868
[0m15:10:48.694992 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: Close
[0m15:10:48.696411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14773f4f0>]}
[0m15:10:48.697800 [info ] [Thread-1  ]: 5 of 45 OK created sql view model dbt.stg_country .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:48.699377 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_country
[0m15:10:48.701005 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency
[0m15:10:48.702593 [info ] [Thread-1  ]: 6 of 45 START sql view model dbt.stg_currency .................................. [RUN]
[0m15:10:48.704695 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency'
[0m15:10:48.705779 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency
[0m15:10:48.720296 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.721404 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: BEGIN
[0m15:10:48.722445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:48.730320 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:48.731856 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.733049 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.740387 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:48.751167 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.752455 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.755835 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:48.768162 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.776466 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (compile): 2024-09-01 15:10:48.706642 => 2024-09-01 15:10:48.776324
[0m15:10:48.777578 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency
[0m15:10:48.787195 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.798817 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.799845 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

  create view "postgres"."dbt"."stg_currency__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    code,
    name

    FROM "postgres"."dbt"."source_currency"
),

derived_columns AS (

    SELECT

    code,
    name,
    code AS CURRENCY_KEY,
    'CSV_CURRENCY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(code AS VARCHAR))), '')), 'hex') AS CURRENCY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CURRENCY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,
    CURRENCY_PK,
    CURRENCY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:48.802420 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:48.807970 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.809372 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency" rename to "stg_currency__dbt_backup"
[0m15:10:48.811076 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.816278 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.817226 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency__dbt_tmp" rename to "stg_currency"
[0m15:10:48.818886 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.821705 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:10:48.823942 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.824922 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:10:48.828400 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:48.833088 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:10:48.834148 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
drop view if exists "postgres"."dbt"."stg_currency__dbt_backup" cascade
[0m15:10:48.837568 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:48.839874 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (execute): 2024-09-01 15:10:48.778225 => 2024-09-01 15:10:48.839815
[0m15:10:48.840870 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: Close
[0m15:10:48.842416 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476e1850>]}
[0m15:10:48.843598 [info ] [Thread-1  ]: 6 of 45 OK created sql view model dbt.stg_currency ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:10:48.844992 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency
[0m15:10:48.846325 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_rate
[0m15:10:48.847583 [info ] [Thread-1  ]: 7 of 45 START sql view model dbt.stg_currency_rate ............................. [RUN]
[0m15:10:48.849669 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_rate'
[0m15:10:48.850791 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_rate
[0m15:10:48.864732 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.865902 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: BEGIN
[0m15:10:48.866860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:48.874871 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:48.876355 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.877586 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.884468 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:48.895055 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.896261 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:48.899914 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:48.913486 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.921842 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (compile): 2024-09-01 15:10:48.851746 => 2024-09-01 15:10:48.921724
[0m15:10:48.922645 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_rate
[0m15:10:48.932093 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.939412 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.940238 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_rate__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end

    FROM "postgres"."dbt"."source_currency_rate"
),

derived_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    id AS CURRENCY_RATE_KEY,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CURRENCY_RATE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_end AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_start AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(relation_to_rur AS VARCHAR))), ''), '^^')
    )), 'hex') AS CURRENCY_RATE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,
    CURRENCY_RATE_PK,
    CURRENCY_RATE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:48.942777 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:48.949107 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.950335 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate" rename to "stg_currency_rate__dbt_backup"
[0m15:10:48.951858 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.957779 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.958958 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate__dbt_tmp" rename to "stg_currency_rate"
[0m15:10:48.960462 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:48.963580 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:10:48.964594 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.965534 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:10:48.968933 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:48.973365 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:10:48.974370 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_rate__dbt_backup" cascade
[0m15:10:48.977677 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:48.980010 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (execute): 2024-09-01 15:10:48.923222 => 2024-09-01 15:10:48.979926
[0m15:10:48.980986 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: Close
[0m15:10:48.982429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1478718e0>]}
[0m15:10:48.983578 [info ] [Thread-1  ]: 7 of 45 OK created sql view model dbt.stg_currency_rate ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:48.984992 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_rate
[0m15:10:48.986274 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_goods
[0m15:10:48.987706 [info ] [Thread-1  ]: 8 of 45 START sql view model dbt.stg_goods ..................................... [RUN]
[0m15:10:48.989412 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_goods'
[0m15:10:48.990438 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_goods
[0m15:10:49.003345 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.004577 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: BEGIN
[0m15:10:49.005563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:49.013370 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:49.014900 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.015993 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.023152 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:49.034718 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.035838 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.039686 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:49.053517 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.061716 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (compile): 2024-09-01 15:10:48.991217 => 2024-09-01 15:10:49.061601
[0m15:10:49.062627 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_goods
[0m15:10:49.071787 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.080549 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.081384 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

  create view "postgres"."dbt"."stg_goods__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count

    FROM "postgres"."dbt"."source_goods"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    id AS GOOD_KEY,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS GOOD_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(cost_per_unit AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(count AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS GOOD_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,
    GOOD_PK,
    GOOD_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:49.083612 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:49.091042 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.092402 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods" rename to "stg_goods__dbt_backup"
[0m15:10:49.093980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.099364 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.100361 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods__dbt_tmp" rename to "stg_goods"
[0m15:10:49.102063 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.105118 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:10:49.106094 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.107103 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:10:49.109999 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:49.114485 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:10:49.115626 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
drop view if exists "postgres"."dbt"."stg_goods__dbt_backup" cascade
[0m15:10:49.119079 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:49.121276 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (execute): 2024-09-01 15:10:49.063322 => 2024-09-01 15:10:49.121217
[0m15:10:49.122328 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: Close
[0m15:10:49.123822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb145672be0>]}
[0m15:10:49.124941 [info ] [Thread-1  ]: 8 of 45 OK created sql view model dbt.stg_goods ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:49.126613 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_goods
[0m15:10:49.128060 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status
[0m15:10:49.129243 [info ] [Thread-1  ]: 9 of 45 START sql view model dbt.stg_order_status .............................. [RUN]
[0m15:10:49.130759 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status'
[0m15:10:49.131836 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status
[0m15:10:49.145955 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.147291 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: BEGIN
[0m15:10:49.148468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:49.156605 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:49.158474 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.159625 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.166608 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:49.177130 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.178518 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.182093 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:10:49.192121 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.201369 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (compile): 2024-09-01 15:10:49.132808 => 2024-09-01 15:10:49.201251
[0m15:10:49.202301 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status
[0m15:10:49.212644 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.221112 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.221921 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

  create view "postgres"."dbt"."stg_order_status__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_order_status"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS ORDER_STATUS_KEY,
    'CSV_ORDER_STATUS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_PK,
    ORDER_STATUS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:49.223993 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:49.231025 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.232356 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status" rename to "stg_order_status__dbt_backup"
[0m15:10:49.233906 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.239196 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.240480 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status__dbt_tmp" rename to "stg_order_status"
[0m15:10:49.242154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.245043 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:10:49.246109 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.247118 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:10:49.250098 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:49.254606 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:10:49.255473 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
drop view if exists "postgres"."dbt"."stg_order_status__dbt_backup" cascade
[0m15:10:49.259023 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:49.261494 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (execute): 2024-09-01 15:10:49.202960 => 2024-09-01 15:10:49.261407
[0m15:10:49.262652 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: Close
[0m15:10:49.264173 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14773f4f0>]}
[0m15:10:49.265416 [info ] [Thread-1  ]: 9 of 45 OK created sql view model dbt.stg_order_status ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:49.266814 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status
[0m15:10:49.268210 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_history
[0m15:10:49.269461 [info ] [Thread-1  ]: 10 of 45 START sql view model dbt.stg_order_status_history ..................... [RUN]
[0m15:10:49.271148 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_history'
[0m15:10:49.272316 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_history
[0m15:10:49.285161 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.286460 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: BEGIN
[0m15:10:49.287739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:49.295493 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:49.296961 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.298308 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.306767 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:49.364410 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.365802 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.369928 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:49.381671 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.397535 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (compile): 2024-09-01 15:10:49.273291 => 2024-09-01 15:10:49.397345
[0m15:10:49.400681 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_history
[0m15:10:49.427128 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.435120 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.436081 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_history__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id

    FROM "postgres"."dbt"."source_order_status_history"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    id AS ORDER_STATUS_HISTORY_KEY,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_HISTORY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(status_datetime AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HISTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_HISTORY_PK,
    ORDER_STATUS_HISTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:49.439119 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:49.445209 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.446102 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history" rename to "stg_order_status_history__dbt_backup"
[0m15:10:49.447326 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.452556 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.453444 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history__dbt_tmp" rename to "stg_order_status_history"
[0m15:10:49.454750 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.457833 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:10:49.458819 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.459648 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:10:49.462342 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:49.466786 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:10:49.467687 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_status_history__dbt_backup" cascade
[0m15:10:49.470424 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:49.472512 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (execute): 2024-09-01 15:10:49.402649 => 2024-09-01 15:10:49.472425
[0m15:10:49.473321 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: Close
[0m15:10:49.474653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb145590160>]}
[0m15:10:49.475857 [info ] [Thread-1  ]: 10 of 45 OK created sql view model dbt.stg_order_status_history ................ [[32mCREATE VIEW[0m in 0.20s]
[0m15:10:49.477073 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_history
[0m15:10:49.478377 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:10:49.479551 [info ] [Thread-1  ]: 11 of 45 START sql view model dbt.stg_order_with_delay ......................... [RUN]
[0m15:10:49.481066 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay'
[0m15:10:49.481994 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay
[0m15:10:49.496401 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.497285 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: BEGIN
[0m15:10:49.498094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:49.505069 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:49.506232 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.507057 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.513615 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:10:49.523954 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.524785 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.527789 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:10:49.537738 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.545875 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (compile): 2024-09-01 15:10:49.482681 => 2024-09-01 15:10:49.545745
[0m15:10:49.546742 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_with_delay
[0m15:10:49.557853 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.566227 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.567086 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

  create view "postgres"."dbt"."stg_order_with_delay__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    reason_for_delay

    FROM "postgres"."dbt"."source_order_with_delay"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    id AS ORDER_WITH_DELAY_KEY,
    'CSV_ORDER_WITH_DELAY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_WITH_DELAY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(reason_for_delay AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_WITH_DELAY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,
    ORDER_WITH_DELAY_PK,
    ORDER_WITH_DELAY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:49.569447 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:49.575548 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.576643 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
alter table "postgres"."dbt"."stg_order_with_delay" rename to "stg_order_with_delay__dbt_backup"
[0m15:10:49.578507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.583578 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.584809 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
alter table "postgres"."dbt"."stg_order_with_delay__dbt_tmp" rename to "stg_order_with_delay"
[0m15:10:49.586593 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.590023 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:10:49.591260 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.592342 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:10:49.595887 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:49.601582 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:10:49.602867 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
drop view if exists "postgres"."dbt"."stg_order_with_delay__dbt_backup" cascade
[0m15:10:49.606108 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:49.608953 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (execute): 2024-09-01 15:10:49.547826 => 2024-09-01 15:10:49.608884
[0m15:10:49.610221 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: Close
[0m15:10:49.611886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147ca64c0>]}
[0m15:10:49.613128 [info ] [Thread-1  ]: 11 of 45 OK created sql view model dbt.stg_order_with_delay .................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:49.614804 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:10:49.616050 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_orders
[0m15:10:49.617376 [info ] [Thread-1  ]: 12 of 45 START sql view model dbt.stg_orders ................................... [RUN]
[0m15:10:49.619213 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_orders'
[0m15:10:49.620411 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_orders
[0m15:10:49.633932 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.635277 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: BEGIN
[0m15:10:49.636304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:49.644027 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:49.645467 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.646568 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.654021 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:10:49.666678 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.667997 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.671308 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:10:49.687360 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.695882 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (compile): 2024-09-01 15:10:49.621237 => 2024-09-01 15:10:49.695735
[0m15:10:49.696661 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_orders
[0m15:10:49.705953 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.715350 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.716084 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

  create view "postgres"."dbt"."stg_orders__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code

    FROM "postgres"."dbt"."source_orders"
),

derived_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    id AS ORDER_KEY,
    'CSV_ORDERS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(height AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(length AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(weight AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(width AS VARCHAR))), ''), '^^')
    )), 'hex') AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,
    ORDER_PK,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:49.718531 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:49.723640 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.724917 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
alter table "postgres"."dbt"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:10:49.726610 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.732113 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.733338 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
alter table "postgres"."dbt"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:10:49.735004 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.737951 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:10:49.739067 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.740248 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:10:49.743520 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:49.749028 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:10:49.750160 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
drop view if exists "postgres"."dbt"."stg_orders__dbt_backup" cascade
[0m15:10:49.753263 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:49.755380 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (execute): 2024-09-01 15:10:49.697274 => 2024-09-01 15:10:49.755321
[0m15:10:49.756424 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: Close
[0m15:10:49.758229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1477cd610>]}
[0m15:10:49.759577 [info ] [Thread-1  ]: 12 of 45 OK created sql view model dbt.stg_orders .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:10:49.761139 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_orders
[0m15:10:49.762646 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse
[0m15:10:49.764095 [info ] [Thread-1  ]: 13 of 45 START sql view model dbt.stg_warehouse ................................ [RUN]
[0m15:10:49.765617 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse'
[0m15:10:49.766778 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse
[0m15:10:49.779987 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.781164 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: BEGIN
[0m15:10:49.782183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:49.789852 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:49.791542 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.792533 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.799589 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:10:49.810432 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.811637 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.815013 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:10:49.827111 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.835423 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (compile): 2024-09-01 15:10:49.767686 => 2024-09-01 15:10:49.835309
[0m15:10:49.836248 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse
[0m15:10:49.846577 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.855620 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.856391 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

  create view "postgres"."dbt"."stg_warehouse__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    system_name

    FROM "postgres"."dbt"."source_warehouse"
),

derived_columns AS (

    SELECT

    id,
    name,
    system_name,
    id AS WAREHOUSE_KEY,
    'CSV_WAREHOUSE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(system_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PK,
    WAREHOUSE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:49.858602 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:49.864058 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.865434 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
alter table "postgres"."dbt"."stg_warehouse" rename to "stg_warehouse__dbt_backup"
[0m15:10:49.867115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.872431 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.873767 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
alter table "postgres"."dbt"."stg_warehouse__dbt_tmp" rename to "stg_warehouse"
[0m15:10:49.875303 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:49.878288 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:10:49.879406 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.880439 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:10:49.884466 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:49.889291 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:10:49.890247 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
drop view if exists "postgres"."dbt"."stg_warehouse__dbt_backup" cascade
[0m15:10:49.893570 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:49.896095 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (execute): 2024-09-01 15:10:49.836897 => 2024-09-01 15:10:49.896033
[0m15:10:49.897399 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: Close
[0m15:10:49.899222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14780d1f0>]}
[0m15:10:49.900933 [info ] [Thread-1  ]: 13 of 45 OK created sql view model dbt.stg_warehouse ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:49.902375 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse
[0m15:10:49.903627 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:10:49.904921 [info ] [Thread-1  ]: 14 of 45 START sql view model dbt.stg_warehouse_address ........................ [RUN]
[0m15:10:49.906647 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address'
[0m15:10:49.908059 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address
[0m15:10:49.921682 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:49.922938 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: BEGIN
[0m15:10:49.924013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:49.932345 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:49.933852 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:49.935151 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.942774 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:49.954485 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:49.955719 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:49.959516 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:49.971932 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:49.980161 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (compile): 2024-09-01 15:10:49.909127 => 2024-09-01 15:10:49.980052
[0m15:10:49.980973 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address
[0m15:10:49.990208 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:49.998327 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:49.999221 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

  create view "postgres"."dbt"."stg_warehouse_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house

    FROM "postgres"."dbt"."source_warehouse_address"
),

derived_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    id AS WAREHOUSE_ADDRESS_KEY,
    'CSV_WAREHOUSE_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_ADDRESS_PK,
    WAREHOUSE_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:50.001525 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.006647 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:50.007664 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
alter table "postgres"."dbt"."stg_warehouse_address" rename to "stg_warehouse_address__dbt_backup"
[0m15:10:50.009297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.014359 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:50.015351 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
alter table "postgres"."dbt"."stg_warehouse_address__dbt_tmp" rename to "stg_warehouse_address"
[0m15:10:50.016674 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.020977 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:10:50.022064 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:50.022958 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:10:50.025706 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.030706 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:10:50.031712 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address__dbt_backup" cascade
[0m15:10:50.034768 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.037071 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (execute): 2024-09-01 15:10:49.981650 => 2024-09-01 15:10:50.037008
[0m15:10:50.038233 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: Close
[0m15:10:50.040073 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14777b490>]}
[0m15:10:50.041339 [info ] [Thread-1  ]: 14 of 45 OK created sql view model dbt.stg_warehouse_address ................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:50.042773 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:10:50.044169 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:10:50.045412 [info ] [Thread-1  ]: 15 of 45 START sql view model dbt.stg_warehouse_params ......................... [RUN]
[0m15:10:50.047104 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_params'
[0m15:10:50.048221 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_params
[0m15:10:50.062160 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.063279 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: BEGIN
[0m15:10:50.064166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.072246 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.073625 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.074871 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:50.082942 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:50.093225 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.094328 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:50.097750 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:10:50.110848 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.118655 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (compile): 2024-09-01 15:10:50.049005 => 2024-09-01 15:10:50.118514
[0m15:10:50.119568 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_params
[0m15:10:50.128519 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.137037 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.137803 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_params__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume

    FROM "postgres"."dbt"."source_warehouse_params"
),

derived_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    id AS WAREHOUSE_PARAMS_KEY,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PARAMS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_volume AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_weight AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_PARAMS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PARAMS_PK,
    WAREHOUSE_PARAMS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:10:50.140115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.146010 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.147275 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_params" rename to "stg_warehouse_params__dbt_backup"
[0m15:10:50.149029 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.154469 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.155541 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_params__dbt_tmp" rename to "stg_warehouse_params"
[0m15:10:50.156937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.160100 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:10:50.161397 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.162531 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:10:50.166091 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.171015 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:10:50.172125 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_params__dbt_backup" cascade
[0m15:10:50.175168 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.177477 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (execute): 2024-09-01 15:10:50.120161 => 2024-09-01 15:10:50.177415
[0m15:10:50.178370 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: Close
[0m15:10:50.179922 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14780d1f0>]}
[0m15:10:50.181103 [info ] [Thread-1  ]: 15 of 45 OK created sql view model dbt.stg_warehouse_params .................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:50.182445 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:10:50.183676 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_city
[0m15:10:50.184773 [info ] [Thread-1  ]: 16 of 45 START sql view model dbt.stg_client_address_city ...................... [RUN]
[0m15:10:50.186367 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_city'
[0m15:10:50.187350 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_city
[0m15:10:50.193400 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:10:50.201328 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (compile): 2024-09-01 15:10:50.188460 => 2024-09-01 15:10:50.201222
[0m15:10:50.202158 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_city
[0m15:10:50.212747 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:10:50.220914 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:10:50.221697 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: BEGIN
[0m15:10:50.222388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.229851 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.231173 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:10:50.232441 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */

  create view "postgres"."dbt"."stg_client_address_city__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, id from "postgres"."dbt"."stg_city"
),

stg_client_address as (
    select CLIENT_ADDRESS_KEY, CLIENT_ADDRESS_PK, city_id::bigint AS city_id from "postgres"."dbt"."stg_client_address"
)

select  CLIENT_ADDRESS_KEY, CITY_KEY, CLIENT_ADDRESS_PK, CITY_PK from stg_city sc
JOIN stg_client_address sca ON sc.id = sca.city_id
  );
[0m15:10:50.235339 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.240676 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:10:50.241817 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */
alter table "postgres"."dbt"."stg_client_address_city__dbt_tmp" rename to "stg_client_address_city"
[0m15:10:50.243224 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.245656 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: COMMIT
[0m15:10:50.246657 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:10:50.247643 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: COMMIT
[0m15:10:50.250657 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.255201 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:10:50.256357 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */
drop view if exists "postgres"."dbt"."stg_client_address_city__dbt_backup" cascade
[0m15:10:50.257643 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.259940 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (execute): 2024-09-01 15:10:50.202784 => 2024-09-01 15:10:50.259882
[0m15:10:50.260983 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: Close
[0m15:10:50.262397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476c7760>]}
[0m15:10:50.263670 [info ] [Thread-1  ]: 16 of 45 OK created sql view model dbt.stg_client_address_city ................. [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.265188 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_city
[0m15:10:50.266480 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_client
[0m15:10:50.267744 [info ] [Thread-1  ]: 17 of 45 START sql view model dbt.stg_client_address_client .................... [RUN]
[0m15:10:50.269940 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_client'
[0m15:10:50.270932 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_client
[0m15:10:50.276602 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:10:50.284383 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_client (compile): 2024-09-01 15:10:50.271727 => 2024-09-01 15:10:50.284273
[0m15:10:50.285217 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_client
[0m15:10:50.294438 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:10:50.303515 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:10:50.304281 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: BEGIN
[0m15:10:50.304953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.312763 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.314377 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:10:50.315612 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */

  create view "postgres"."dbt"."stg_client_address_client__dbt_tmp" as (
    with stg_client as (
    select CLIENT_KEY, CLIENT_PK, client_address_id from "postgres"."dbt"."stg_client"
),

stg_client_address as (
    select CLIENT_ADDRESS_KEY, CLIENT_ADDRESS_PK, id::bigint AS id from "postgres"."dbt"."stg_client_address"
)

select  CLIENT_ADDRESS_KEY, CLIENT_KEY, CLIENT_ADDRESS_PK, CLIENT_PK from stg_client sc
JOIN stg_client_address sca ON sca.id = sc.client_address_id
  );
[0m15:10:50.319247 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.325914 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:10:50.327096 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */
alter table "postgres"."dbt"."stg_client_address_client__dbt_tmp" rename to "stg_client_address_client"
[0m15:10:50.328773 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.331560 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: COMMIT
[0m15:10:50.332733 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:10:50.333753 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: COMMIT
[0m15:10:50.336366 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.340832 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:10:50.341965 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */
drop view if exists "postgres"."dbt"."stg_client_address_client__dbt_backup" cascade
[0m15:10:50.343300 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.345437 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_client (execute): 2024-09-01 15:10:50.285927 => 2024-09-01 15:10:50.345380
[0m15:10:50.346309 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: Close
[0m15:10:50.347777 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14780d1f0>]}
[0m15:10:50.349169 [info ] [Thread-1  ]: 17 of 45 OK created sql view model dbt.stg_client_address_client ............... [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.350538 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_client
[0m15:10:50.351817 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_client_type
[0m15:10:50.353032 [info ] [Thread-1  ]: 18 of 45 START sql view model dbt.stg_client_client_type ....................... [RUN]
[0m15:10:50.354527 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_client_type'
[0m15:10:50.355601 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_client_type
[0m15:10:50.361294 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_client_type"
[0m15:10:50.368362 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_client_type (compile): 2024-09-01 15:10:50.356360 => 2024-09-01 15:10:50.368244
[0m15:10:50.369221 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_client_type
[0m15:10:50.378533 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_client_type"
[0m15:10:50.386954 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:10:50.387674 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: BEGIN
[0m15:10:50.388470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.395682 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.397152 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:10:50.398634 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */

  create view "postgres"."dbt"."stg_client_client_type__dbt_tmp" as (
    with stg_client_type as (
    select CLIENT_TYPE_KEY, CLIENT_TYPE_PK, id from "postgres"."dbt"."stg_client_type"
),

stg_client as (
    select CLIENT_KEY, CLIENT_PK, type_id from "postgres"."dbt"."stg_client"
)

select  CLIENT_TYPE_KEY, CLIENT_KEY, CLIENT_TYPE_PK, CLIENT_PK from stg_client_type ct
JOIN stg_client sc ON sc.type_id = ct.id
  );
[0m15:10:50.401811 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.407208 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:10:50.408158 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */
alter table "postgres"."dbt"."stg_client_client_type__dbt_tmp" rename to "stg_client_client_type"
[0m15:10:50.409635 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.412159 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: COMMIT
[0m15:10:50.413033 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:10:50.413931 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: COMMIT
[0m15:10:50.416523 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.421987 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:10:50.423194 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_client_type__dbt_backup" cascade
[0m15:10:50.424569 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.426894 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_client_type (execute): 2024-09-01 15:10:50.369866 => 2024-09-01 15:10:50.426836
[0m15:10:50.428214 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: Close
[0m15:10:50.429766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476dfd30>]}
[0m15:10:50.430955 [info ] [Thread-1  ]: 18 of 45 OK created sql view model dbt.stg_client_client_type .................. [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.432239 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_client_type
[0m15:10:50.433353 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city_country
[0m15:10:50.434665 [info ] [Thread-1  ]: 19 of 45 START sql view model dbt.stg_city_country ............................. [RUN]
[0m15:10:50.436298 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city_country'
[0m15:10:50.437310 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city_country
[0m15:10:50.443494 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city_country"
[0m15:10:50.451144 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (compile): 2024-09-01 15:10:50.438314 => 2024-09-01 15:10:50.451020
[0m15:10:50.452050 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city_country
[0m15:10:50.461381 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city_country"
[0m15:10:50.469056 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:50.469834 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: BEGIN
[0m15:10:50.470531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.478242 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.480020 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:50.481208 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */

  create view "postgres"."dbt"."stg_city_country__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, country_id from "postgres"."dbt"."stg_city"
),

stg_country as (
    select id, COUNTRY_KEY, COUNTRY_PK from "postgres"."dbt"."stg_country"
)

select  CITY_KEY, COUNTRY_KEY, CITY_PK, COUNTRY_PK from stg_city sci
JOIN stg_country sc ON sc.id = sci.country_id
  );
[0m15:10:50.484286 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.490250 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:50.491621 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
alter table "postgres"."dbt"."stg_city_country__dbt_tmp" rename to "stg_city_country"
[0m15:10:50.492982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.495329 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:10:50.496479 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:50.497305 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:10:50.500682 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.505334 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:10:50.506346 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
drop view if exists "postgres"."dbt"."stg_city_country__dbt_backup" cascade
[0m15:10:50.507725 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.510574 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (execute): 2024-09-01 15:10:50.452743 => 2024-09-01 15:10:50.510514
[0m15:10:50.511728 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: Close
[0m15:10:50.513366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14772ae80>]}
[0m15:10:50.514827 [info ] [Thread-1  ]: 19 of 45 OK created sql view model dbt.stg_city_country ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.516556 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city_country
[0m15:10:50.517758 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:50.519149 [info ] [Thread-1  ]: 20 of 45 START sql view model dbt.stg_currency_currency_rate ................... [RUN]
[0m15:10:50.520825 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_currency_rate'
[0m15:10:50.521992 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:50.529004 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:50.537308 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (compile): 2024-09-01 15:10:50.522994 => 2024-09-01 15:10:50.537192
[0m15:10:50.538304 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:50.587217 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:50.594295 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:50.595044 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: BEGIN
[0m15:10:50.595702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.604587 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.605969 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:50.607032 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" as (
    with stg_currency as (
    select code, CURRENCY_KEY, CURRENCY_PK from "postgres"."dbt"."stg_currency"
),

stg_currency_rate as (
    select currency_code, CURRENCY_RATE_KEY, CURRENCY_RATE_PK from "postgres"."dbt"."stg_currency_rate"
)

select  CURRENCY_KEY, CURRENCY_RATE_KEY, CURRENCY_PK, CURRENCY_RATE_PK from stg_currency sc
JOIN stg_currency_rate scr ON sc.code = scr.currency_code
  );
[0m15:10:50.610196 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.615749 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:50.616841 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" rename to "stg_currency_currency_rate"
[0m15:10:50.618188 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.620803 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:10:50.621839 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:50.622779 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:10:50.625276 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.629904 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:10:50.630953 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_currency_rate__dbt_backup" cascade
[0m15:10:50.632177 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.634144 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (execute): 2024-09-01 15:10:50.539000 => 2024-09-01 15:10:50.634086
[0m15:10:50.635146 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: Close
[0m15:10:50.636491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147c75dc0>]}
[0m15:10:50.637726 [info ] [Thread-1  ]: 20 of 45 OK created sql view model dbt.stg_currency_currency_rate .............. [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:50.639058 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:10:50.640619 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:10:50.641933 [info ] [Thread-1  ]: 21 of 45 START sql view model dbt.stg_order_status_order_status_history ........ [RUN]
[0m15:10:50.643766 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_order_status_history'
[0m15:10:50.644960 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:10:50.650601 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:10:50.658635 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_order_status_history (compile): 2024-09-01 15:10:50.645865 => 2024-09-01 15:10:50.658507
[0m15:10:50.659546 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:10:50.669138 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:10:50.676665 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:10:50.677577 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: BEGIN
[0m15:10:50.678459 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.686017 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.687586 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:10:50.688865 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_order_status_history__dbt_tmp" as (
    with stg_order_status as (
    select ORDER_STATUS_KEY, ORDER_STATUS_PK, id from "postgres"."dbt"."stg_order_status"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, status_id from "postgres"."dbt"."stg_order_status_history"
)

select  ORDER_STATUS_KEY, ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_PK, ORDER_STATUS_HISTORY_PK from stg_order_status os
JOIN stg_order_status_history sh ON sh.status_id = os.id
  );
[0m15:10:50.691923 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.699112 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:10:50.700273 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_order_status_history__dbt_tmp" rename to "stg_order_status_order_status_history"
[0m15:10:50.701610 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.704139 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: COMMIT
[0m15:10:50.705144 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:10:50.706159 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: COMMIT
[0m15:10:50.709039 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.713705 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:10:50.714671 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_status_order_status_history__dbt_backup" cascade
[0m15:10:50.715892 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.717986 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_order_status_history (execute): 2024-09-01 15:10:50.660314 => 2024-09-01 15:10:50.717928
[0m15:10:50.719127 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: Close
[0m15:10:50.720562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476e5070>]}
[0m15:10:50.721934 [info ] [Thread-1  ]: 21 of 45 OK created sql view model dbt.stg_order_status_order_status_history ... [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.723341 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:10:50.724707 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_client
[0m15:10:50.725985 [info ] [Thread-1  ]: 22 of 45 START sql view model dbt.stg_order_client ............................. [RUN]
[0m15:10:50.727730 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_client'
[0m15:10:50.729114 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_client
[0m15:10:50.734785 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_client"
[0m15:10:50.742162 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_client (compile): 2024-09-01 15:10:50.730105 => 2024-09-01 15:10:50.742044
[0m15:10:50.743013 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_client
[0m15:10:50.752701 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_client"
[0m15:10:50.761194 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:10:50.762082 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: BEGIN
[0m15:10:50.762806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.770394 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.771914 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:10:50.772862 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */

  create view "postgres"."dbt"."stg_order_client__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, id from "postgres"."dbt"."stg_orders"
),

stg_client as (
    select CLIENT_KEY, CLIENT_PK, order_id::bigint AS order_id from "postgres"."dbt"."stg_client"
)

select  ORDER_KEY, CLIENT_KEY, ORDER_PK, CLIENT_PK from stg_orders o
JOIN stg_client sc ON sc.order_id = o.id
  );
[0m15:10:50.776046 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.781895 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:10:50.782984 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */
alter table "postgres"."dbt"."stg_order_client__dbt_tmp" rename to "stg_order_client"
[0m15:10:50.784314 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.786798 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: COMMIT
[0m15:10:50.787673 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:10:50.788796 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: COMMIT
[0m15:10:50.792021 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.797698 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:10:50.799041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */
drop view if exists "postgres"."dbt"."stg_order_client__dbt_backup" cascade
[0m15:10:50.800593 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.802841 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_client (execute): 2024-09-01 15:10:50.743673 => 2024-09-01 15:10:50.802781
[0m15:10:50.804020 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: Close
[0m15:10:50.805509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14564d520>]}
[0m15:10:50.806729 [info ] [Thread-1  ]: 22 of 45 OK created sql view model dbt.stg_order_client ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.808308 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_client
[0m15:10:50.809756 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_currency
[0m15:10:50.811078 [info ] [Thread-1  ]: 23 of 45 START sql view model dbt.stg_order_currency ........................... [RUN]
[0m15:10:50.812756 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_currency'
[0m15:10:50.813975 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_currency
[0m15:10:50.821337 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_currency"
[0m15:10:50.828572 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_currency (compile): 2024-09-01 15:10:50.814909 => 2024-09-01 15:10:50.828412
[0m15:10:50.829691 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_currency
[0m15:10:50.839629 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_currency"
[0m15:10:50.848623 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:10:50.849379 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: BEGIN
[0m15:10:50.850049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.857144 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.858838 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:10:50.860038 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */

  create view "postgres"."dbt"."stg_order_currency__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, currency_code from "postgres"."dbt"."stg_orders"
),

stg_currency as (
    select code, CURRENCY_KEY, CURRENCY_PK from "postgres"."dbt"."stg_currency"
)

select  ORDER_KEY, CURRENCY_KEY, ORDER_PK, CURRENCY_PK from stg_orders o
JOIN stg_currency sc ON sc.code = o.currency_code
  );
[0m15:10:50.863270 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.868868 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:10:50.869898 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */
alter table "postgres"."dbt"."stg_order_currency__dbt_tmp" rename to "stg_order_currency"
[0m15:10:50.871266 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.873697 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: COMMIT
[0m15:10:50.874547 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:10:50.875433 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: COMMIT
[0m15:10:50.878503 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.883199 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:10:50.884397 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */
drop view if exists "postgres"."dbt"."stg_order_currency__dbt_backup" cascade
[0m15:10:50.885747 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.887628 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_currency (execute): 2024-09-01 15:10:50.830518 => 2024-09-01 15:10:50.887570
[0m15:10:50.888745 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: Close
[0m15:10:50.890123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14564d520>]}
[0m15:10:50.891454 [info ] [Thread-1  ]: 23 of 45 OK created sql view model dbt.stg_order_currency ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.893160 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_currency
[0m15:10:50.894502 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_goods
[0m15:10:50.895764 [info ] [Thread-1  ]: 24 of 45 START sql view model dbt.stg_order_goods .............................. [RUN]
[0m15:10:50.897211 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_goods'
[0m15:10:50.898136 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_goods
[0m15:10:50.905144 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_goods"
[0m15:10:50.912429 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_goods (compile): 2024-09-01 15:10:50.898887 => 2024-09-01 15:10:50.912316
[0m15:10:50.913259 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_goods
[0m15:10:50.922776 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_goods"
[0m15:10:50.931443 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:10:50.932247 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: BEGIN
[0m15:10:50.932887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:50.940108 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:50.941776 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:10:50.942988 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */

  create view "postgres"."dbt"."stg_order_goods__dbt_tmp" as (
    with stg_orders as (
    select id, ORDER_KEY, ORDER_PK from "postgres"."dbt"."stg_orders"
),

stg_goods as (
    select GOOD_KEY, GOOD_PK, order_id::bigint AS order_id from "postgres"."dbt"."stg_goods"
)

select  ORDER_KEY, GOOD_KEY, ORDER_PK, GOOD_PK from stg_orders o
JOIN stg_goods g ON g.order_id = o.id
  );
[0m15:10:50.945921 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:50.951839 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:10:50.952825 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */
alter table "postgres"."dbt"."stg_order_goods__dbt_tmp" rename to "stg_order_goods"
[0m15:10:50.954191 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:50.956562 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: COMMIT
[0m15:10:50.957663 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:10:50.958625 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: COMMIT
[0m15:10:50.961445 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:50.966033 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:10:50.967166 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */
drop view if exists "postgres"."dbt"."stg_order_goods__dbt_backup" cascade
[0m15:10:50.968716 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:50.970873 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_goods (execute): 2024-09-01 15:10:50.913889 => 2024-09-01 15:10:50.970817
[0m15:10:50.971846 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: Close
[0m15:10:50.973615 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb145688400>]}
[0m15:10:50.975073 [info ] [Thread-1  ]: 24 of 45 OK created sql view model dbt.stg_order_goods ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:50.976401 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_goods
[0m15:10:50.977915 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:10:50.979194 [info ] [Thread-1  ]: 25 of 45 START sql view model dbt.stg_order_order_status_history ............... [RUN]
[0m15:10:50.981058 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_order_status_history'
[0m15:10:50.982267 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:10:50.988667 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:10:50.996429 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_order_status_history (compile): 2024-09-01 15:10:50.983290 => 2024-09-01 15:10:50.996306
[0m15:10:50.997198 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:10:51.007993 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:10:51.016753 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:10:51.017460 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: BEGIN
[0m15:10:51.018217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:51.026208 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:51.027756 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:10:51.029182 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */

  create view "postgres"."dbt"."stg_order_order_status_history__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, id from "postgres"."dbt"."stg_orders"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, order_id from "postgres"."dbt"."stg_order_status_history"
)

select  ORDER_KEY, ORDER_STATUS_HISTORY_KEY, ORDER_PK, ORDER_STATUS_HISTORY_PK from stg_orders o
JOIN stg_order_status_history sh ON sh.order_id = o.id
  );
[0m15:10:51.032256 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:51.037814 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:10:51.039257 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */
alter table "postgres"."dbt"."stg_order_order_status_history__dbt_tmp" rename to "stg_order_order_status_history"
[0m15:10:51.040776 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:51.043480 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: COMMIT
[0m15:10:51.044465 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:10:51.045535 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: COMMIT
[0m15:10:51.048009 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:51.052926 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:10:51.053926 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_order_status_history__dbt_backup" cascade
[0m15:10:51.055104 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:51.057104 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_order_status_history (execute): 2024-09-01 15:10:50.997781 => 2024-09-01 15:10:51.057046
[0m15:10:51.058022 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: Close
[0m15:10:51.059719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147882dc0>]}
[0m15:10:51.909918 [info ] [Thread-1  ]: 25 of 45 OK created sql view model dbt.stg_order_order_status_history .......... [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:51.911723 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:10:51.913241 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:10:51.914819 [info ] [Thread-1  ]: 26 of 45 START sql view model dbt.stg_order_with_delay_order ................... [RUN]
[0m15:10:51.916556 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay_order'
[0m15:10:51.917662 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:10:51.923414 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:10:51.931432 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay_order (compile): 2024-09-01 15:10:51.918555 => 2024-09-01 15:10:51.931326
[0m15:10:51.932369 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:10:51.942120 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:10:51.950117 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:10:51.951238 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: BEGIN
[0m15:10:51.952054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:51.959466 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:51.960934 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:10:51.961895 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */

  create view "postgres"."dbt"."stg_order_with_delay_order__dbt_tmp" as (
    with stg_order as (
    select id, ORDER_KEY, ORDER_PK from "postgres"."dbt"."stg_orders"
),

stg_order_with_delay as (
    select ORDER_WITH_DELAY_KEY, ORDER_WITH_DELAY_PK, order_id from "postgres"."dbt"."stg_order_with_delay"
)

select  ORDER_KEY, ORDER_WITH_DELAY_KEY, ORDER_PK, ORDER_WITH_DELAY_PK from stg_order o
JOIN stg_order_with_delay od ON o.id = od.order_id
  );
[0m15:10:51.964768 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:51.971180 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:10:51.972456 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */
alter table "postgres"."dbt"."stg_order_with_delay_order__dbt_tmp" rename to "stg_order_with_delay_order"
[0m15:10:51.973917 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:51.976447 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: COMMIT
[0m15:10:51.977451 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:10:51.978379 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: COMMIT
[0m15:10:51.981679 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:51.986298 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:10:51.987466 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */
drop view if exists "postgres"."dbt"."stg_order_with_delay_order__dbt_backup" cascade
[0m15:10:51.988790 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:51.991079 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay_order (execute): 2024-09-01 15:10:51.933054 => 2024-09-01 15:10:51.991019
[0m15:10:51.992103 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: Close
[0m15:10:51.993509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1477324f0>]}
[0m15:10:51.994774 [info ] [Thread-1  ]: 26 of 45 OK created sql view model dbt.stg_order_with_delay_order .............. [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:51.996202 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:10:51.997540 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:10:51.998810 [info ] [Thread-1  ]: 27 of 45 START sql view model dbt.stg_warehouse_order_status_history ........... [RUN]
[0m15:10:52.000782 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_order_status_history'
[0m15:10:52.001987 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:10:52.007531 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:10:52.014799 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_order_status_history (compile): 2024-09-01 15:10:52.002954 => 2024-09-01 15:10:52.014690
[0m15:10:52.015616 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:10:52.024971 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:10:52.034887 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:10:52.035818 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: BEGIN
[0m15:10:52.036513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.043908 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.045425 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:10:52.046799 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */

  create view "postgres"."dbt"."stg_warehouse_order_status_history__dbt_tmp" as (
    with stg_warehouse as (
    select WAREHOUSE_KEY, WAREHOUSE_PK, id from "postgres"."dbt"."stg_warehouse"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, warehouse_id from "postgres"."dbt"."stg_order_status_history"
)

select  WAREHOUSE_KEY, ORDER_STATUS_HISTORY_KEY, WAREHOUSE_PK, ORDER_STATUS_HISTORY_PK from stg_warehouse w
JOIN stg_order_status_history sh ON sh.warehouse_id = w.id
  );
[0m15:10:52.050706 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.056641 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:10:52.057710 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */
alter table "postgres"."dbt"."stg_warehouse_order_status_history__dbt_tmp" rename to "stg_warehouse_order_status_history"
[0m15:10:52.059125 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.062385 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: COMMIT
[0m15:10:52.063299 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:10:52.064245 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: COMMIT
[0m15:10:52.066825 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.071259 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:10:52.072531 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_warehouse_order_status_history__dbt_backup" cascade
[0m15:10:52.074041 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.077115 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_order_status_history (execute): 2024-09-01 15:10:52.016219 => 2024-09-01 15:10:52.077050
[0m15:10:52.078249 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: Close
[0m15:10:52.080141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147729730>]}
[0m15:10:52.081388 [info ] [Thread-1  ]: 27 of 45 OK created sql view model dbt.stg_warehouse_order_status_history ...... [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:52.082631 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:10:52.083927 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:10:52.085032 [info ] [Thread-1  ]: 28 of 45 START sql view model dbt.stg_warehouse_address_city ................... [RUN]
[0m15:10:52.086654 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address_city'
[0m15:10:52.087537 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:10:52.095726 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:10:52.103108 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_city (compile): 2024-09-01 15:10:52.088276 => 2024-09-01 15:10:52.102991
[0m15:10:52.104075 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:10:52.114137 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:10:52.122487 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:10:52.123340 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: BEGIN
[0m15:10:52.124016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.131544 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.133217 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:10:52.134504 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */

  create view "postgres"."dbt"."stg_warehouse_address_city__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, id from "postgres"."dbt"."stg_city"
),

stg_warehouse_address as (
    select WAREHOUSE_ADDRESS_KEY, WAREHOUSE_ADDRESS_PK, city_id from "postgres"."dbt"."stg_warehouse_address"
)

select  WAREHOUSE_ADDRESS_KEY, CITY_KEY, WAREHOUSE_ADDRESS_PK, CITY_PK from stg_city sc
JOIN stg_warehouse_address swa ON sc.id = swa.city_id
  );
[0m15:10:52.137720 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.143564 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:10:52.144734 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */
alter table "postgres"."dbt"."stg_warehouse_address_city__dbt_tmp" rename to "stg_warehouse_address_city"
[0m15:10:52.146127 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.148705 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: COMMIT
[0m15:10:52.149927 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:10:52.150993 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: COMMIT
[0m15:10:52.153832 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.158308 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:10:52.159557 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address_city__dbt_backup" cascade
[0m15:10:52.160894 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.163328 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_city (execute): 2024-09-01 15:10:52.104816 => 2024-09-01 15:10:52.163269
[0m15:10:52.164415 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: Close
[0m15:10:52.166022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1455f77c0>]}
[0m15:10:52.167331 [info ] [Thread-1  ]: 28 of 45 OK created sql view model dbt.stg_warehouse_address_city .............. [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:52.168936 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:10:52.170597 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:10:52.172052 [info ] [Thread-1  ]: 29 of 45 START sql view model dbt.stg_warehouse_address_warehouse_params ....... [RUN]
[0m15:10:52.174036 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address_warehouse_params'
[0m15:10:52.175514 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:10:52.181388 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:10:52.188675 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_warehouse_params (compile): 2024-09-01 15:10:52.176468 => 2024-09-01 15:10:52.188571
[0m15:10:52.189562 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:10:52.200535 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:10:52.210169 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:10:52.210957 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: BEGIN
[0m15:10:52.211675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.219272 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.220965 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:10:52.222202 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_tmp" as (
    with stg_warehouse_address as (
    select WAREHOUSE_ADDRESS_KEY, WAREHOUSE_ADDRESS_PK, id from "postgres"."dbt"."stg_warehouse_address"
),

stg_warehouse_params as (
    select WAREHOUSE_PARAMS_KEY, WAREHOUSE_PARAMS_PK, address_id from "postgres"."dbt"."stg_warehouse_params"
)

select  WAREHOUSE_ADDRESS_KEY, WAREHOUSE_PARAMS_KEY, WAREHOUSE_ADDRESS_PK, WAREHOUSE_PARAMS_PK from stg_warehouse_address wa
JOIN stg_warehouse_params wp ON wp.address_id = wa.id
  );
[0m15:10:52.225197 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.231225 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:10:52.232289 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_tmp" rename to "stg_warehouse_address_warehouse_params"
[0m15:10:52.233697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.236353 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: COMMIT
[0m15:10:52.237367 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:10:52.238295 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: COMMIT
[0m15:10:52.241620 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.246250 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:10:52.247486 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_backup" cascade
[0m15:10:52.248819 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.251176 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_warehouse_params (execute): 2024-09-01 15:10:52.190238 => 2024-09-01 15:10:52.251117
[0m15:10:52.252342 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: Close
[0m15:10:52.253826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476e1c10>]}
[0m15:10:52.255099 [info ] [Thread-1  ]: 29 of 45 OK created sql view model dbt.stg_warehouse_address_warehouse_params .. [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:52.256549 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:10:52.257977 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:10:52.259294 [info ] [Thread-1  ]: 30 of 45 START sql view model dbt.stg_warehouse_warehouse_params ............... [RUN]
[0m15:10:52.260974 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_warehouse_params'
[0m15:10:52.262062 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:10:52.267782 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:10:52.276160 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_warehouse_params (compile): 2024-09-01 15:10:52.262969 => 2024-09-01 15:10:52.275952
[0m15:10:52.277192 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:10:52.286658 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:10:52.294906 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:10:52.295794 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: BEGIN
[0m15:10:52.296519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.303928 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.305515 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:10:52.306753 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_tmp" as (
    with stg_warehouse as (
    select WAREHOUSE_KEY, WAREHOUSE_PK, id from "postgres"."dbt"."stg_warehouse"
),

stg_warehouse_params as (
    select WAREHOUSE_PARAMS_KEY, WAREHOUSE_PARAMS_PK, warehouse_id from "postgres"."dbt"."stg_warehouse_params"
)

select  WAREHOUSE_KEY, WAREHOUSE_PARAMS_KEY, WAREHOUSE_PK, WAREHOUSE_PARAMS_PK from stg_warehouse w
JOIN stg_warehouse_params wp ON wp.warehouse_id = w.id
  );
[0m15:10:52.310004 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.316664 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:10:52.317842 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_tmp" rename to "stg_warehouse_warehouse_params"
[0m15:10:52.319382 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.322046 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: COMMIT
[0m15:10:52.322951 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:10:52.323909 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: COMMIT
[0m15:10:52.326581 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.331089 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:10:52.332306 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_backup" cascade
[0m15:10:52.333677 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.335798 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_warehouse_params (execute): 2024-09-01 15:10:52.277831 => 2024-09-01 15:10:52.335740
[0m15:10:52.336849 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: Close
[0m15:10:52.338398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14558c100>]}
[0m15:10:52.339849 [info ] [Thread-1  ]: 30 of 45 OK created sql view model dbt.stg_warehouse_warehouse_params .......... [[32mCREATE VIEW[0m in 0.08s]
[0m15:10:52.341419 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:10:52.342813 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:10:52.344300 [info ] [Thread-1  ]: 31 of 45 START sql view model dbt.stg_link_client_address_city ................. [RUN]
[0m15:10:52.346241 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_address_city'
[0m15:10:52.347494 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:10:52.360718 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.362245 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: BEGIN
[0m15:10:52.363330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.371318 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.372881 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.374195 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.382159 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.392801 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.394080 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.397506 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.407913 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.415552 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_city (compile): 2024-09-01 15:10:52.348495 => 2024-09-01 15:10:52.415441
[0m15:10:52.416358 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:10:52.427350 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.436002 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.436771 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

  create view "postgres"."dbt"."stg_link_client_address_city__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk

    FROM "postgres"."dbt"."stg_client_address_city"
),

derived_columns AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    'CSV_CLIENT_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_ADDRESS_CITY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    RECORD_SOURCE,
    LINK_CLIENT_ADDRESS_CITY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:52.438933 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.444322 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.445762 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */
alter table "postgres"."dbt"."stg_link_client_address_city__dbt_tmp" rename to "stg_link_client_address_city"
[0m15:10:52.447556 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.450625 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: COMMIT
[0m15:10:52.451971 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.453137 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: COMMIT
[0m15:10:52.456394 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.460946 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:10:52.462205 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */
drop view if exists "postgres"."dbt"."stg_link_client_address_city__dbt_backup" cascade
[0m15:10:52.463715 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.465897 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_city (execute): 2024-09-01 15:10:52.417163 => 2024-09-01 15:10:52.465839
[0m15:10:52.466956 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: Close
[0m15:10:52.468403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476c7940>]}
[0m15:10:52.469779 [info ] [Thread-1  ]: 31 of 45 OK created sql view model dbt.stg_link_client_address_city ............ [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:52.471396 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:10:52.472878 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:10:52.474118 [info ] [Thread-1  ]: 32 of 45 START sql view model dbt.stg_link_client_address_client ............... [RUN]
[0m15:10:52.475765 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_address_client'
[0m15:10:52.476672 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:10:52.490489 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.491823 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: BEGIN
[0m15:10:52.493003 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.500793 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.502189 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.503526 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.511290 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.521641 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.522939 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.526569 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.536025 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.543803 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_client (compile): 2024-09-01 15:10:52.477428 => 2024-09-01 15:10:52.543690
[0m15:10:52.544660 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:10:52.555031 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.563463 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.564268 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

  create view "postgres"."dbt"."stg_link_client_address_client__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk

    FROM "postgres"."dbt"."stg_client_address_client"
),

derived_columns AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_ADDRESS_CLIENT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_CLIENT_ADDRESS_CLIENT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:52.566504 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.571595 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.573086 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */
alter table "postgres"."dbt"."stg_link_client_address_client__dbt_tmp" rename to "stg_link_client_address_client"
[0m15:10:52.574682 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.577341 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: COMMIT
[0m15:10:52.578490 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.579582 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: COMMIT
[0m15:10:52.582618 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.586924 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:10:52.587951 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */
drop view if exists "postgres"."dbt"."stg_link_client_address_client__dbt_backup" cascade
[0m15:10:52.589329 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.591539 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_client (execute): 2024-09-01 15:10:52.545319 => 2024-09-01 15:10:52.591479
[0m15:10:52.592508 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: Close
[0m15:10:52.593911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14558c100>]}
[0m15:10:52.595093 [info ] [Thread-1  ]: 32 of 45 OK created sql view model dbt.stg_link_client_address_client .......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:52.596567 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:10:52.597813 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:10:52.598972 [info ] [Thread-1  ]: 33 of 45 START sql view model dbt.stg_link_client_client_type .................. [RUN]
[0m15:10:52.600756 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_client_type'
[0m15:10:52.601840 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:10:52.615807 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.617042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: BEGIN
[0m15:10:52.618131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.626273 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.627833 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.628894 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.637151 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.647575 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.648869 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.652769 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.662181 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.669508 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_client_type (compile): 2024-09-01 15:10:52.602677 => 2024-09-01 15:10:52.669348
[0m15:10:52.670561 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:10:52.680473 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.689047 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.689888 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

  create view "postgres"."dbt"."stg_link_client_client_type__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk

    FROM "postgres"."dbt"."stg_client_client_type"
),

derived_columns AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_TYPE_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_CLIENT_TYPE_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_CLIENT_CLIENT_TYPE_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:52.692168 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.698402 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.699908 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */
alter table "postgres"."dbt"."stg_link_client_client_type__dbt_tmp" rename to "stg_link_client_client_type"
[0m15:10:52.701551 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.743567 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: COMMIT
[0m15:10:52.744943 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.746071 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: COMMIT
[0m15:10:52.748784 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.753635 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:10:52.754664 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */
drop view if exists "postgres"."dbt"."stg_link_client_client_type__dbt_backup" cascade
[0m15:10:52.755951 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.758211 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_client_type (execute): 2024-09-01 15:10:52.671271 => 2024-09-01 15:10:52.758151
[0m15:10:52.759336 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: Close
[0m15:10:52.761141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14554ffd0>]}
[0m15:10:52.762983 [info ] [Thread-1  ]: 33 of 45 OK created sql view model dbt.stg_link_client_client_type ............. [[32mCREATE VIEW[0m in 0.16s]
[0m15:10:52.764882 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:10:52.766379 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_city_country
[0m15:10:52.767945 [info ] [Thread-1  ]: 34 of 45 START sql view model dbt.stg_link_city_country ........................ [RUN]
[0m15:10:52.769821 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_city_country'
[0m15:10:52.771350 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_city_country
[0m15:10:52.784888 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.786041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: BEGIN
[0m15:10:52.787112 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.795233 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.796669 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.797688 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_city_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.805480 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.815995 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.817225 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_city_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.820810 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.832252 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.840473 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_city_country (compile): 2024-09-01 15:10:52.772346 => 2024-09-01 15:10:52.840343
[0m15:10:52.841988 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_city_country
[0m15:10:52.852213 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.860116 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.860988 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

  create view "postgres"."dbt"."stg_link_city_country__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk

    FROM "postgres"."dbt"."stg_city_country"
),

derived_columns AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(COUNTRY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CITY_COUNTRY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    RECORD_SOURCE,
    LINK_CITY_COUNTRY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:52.863223 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.867984 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.869043 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */
alter table "postgres"."dbt"."stg_link_city_country__dbt_tmp" rename to "stg_link_city_country"
[0m15:10:52.870748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.873213 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: COMMIT
[0m15:10:52.874282 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.875205 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: COMMIT
[0m15:10:52.878482 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:52.883061 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:10:52.883994 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */
drop view if exists "postgres"."dbt"."stg_link_city_country__dbt_backup" cascade
[0m15:10:52.885155 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:52.887315 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_city_country (execute): 2024-09-01 15:10:52.842855 => 2024-09-01 15:10:52.887255
[0m15:10:52.888266 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: Close
[0m15:10:52.889884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1477b3ac0>]}
[0m15:10:52.891098 [info ] [Thread-1  ]: 34 of 45 OK created sql view model dbt.stg_link_city_country ................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:52.892510 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_city_country
[0m15:10:52.893727 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:10:52.894834 [info ] [Thread-1  ]: 35 of 45 START sql view model dbt.stg_link_currency_currency_rate .............. [RUN]
[0m15:10:52.896231 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_currency_currency_rate'
[0m15:10:52.897115 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:10:52.910227 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:52.911555 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: BEGIN
[0m15:10:52.912535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:52.920328 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:52.923961 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:52.925082 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_currency_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.932185 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.943653 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:52.944953 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_currency_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:52.948516 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:52.957968 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:52.966323 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_currency_currency_rate (compile): 2024-09-01 15:10:52.897968 => 2024-09-01 15:10:52.966212
[0m15:10:52.967294 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:10:52.976983 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:52.985207 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:52.985981 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

  create view "postgres"."dbt"."stg_link_currency_currency_rate__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk

    FROM "postgres"."dbt"."stg_currency_currency_rate"
),

derived_columns AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_RATE_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CURRENCY_CURRENCY_RATE_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    RECORD_SOURCE,
    LINK_CURRENCY_CURRENCY_RATE_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:52.988241 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:52.993537 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:52.995037 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */
alter table "postgres"."dbt"."stg_link_currency_currency_rate__dbt_tmp" rename to "stg_link_currency_currency_rate"
[0m15:10:52.996647 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:52.999268 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: COMMIT
[0m15:10:53.000454 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:53.001407 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: COMMIT
[0m15:10:53.004817 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.009158 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:10:53.010645 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_link_currency_currency_rate__dbt_backup" cascade
[0m15:10:53.012331 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.014735 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_currency_currency_rate (execute): 2024-09-01 15:10:52.968031 => 2024-09-01 15:10:53.014675
[0m15:10:53.015896 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: Close
[0m15:10:53.017520 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb149c261f0>]}
[0m15:10:53.018864 [info ] [Thread-1  ]: 35 of 45 OK created sql view model dbt.stg_link_currency_currency_rate ......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:53.020338 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:10:53.021713 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:10:53.023180 [info ] [Thread-1  ]: 36 of 45 START sql view model dbt.stg_link_order_status_order_status_history ... [RUN]
[0m15:10:53.025196 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_status_order_status_history'
[0m15:10:53.026704 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:10:53.042016 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.043482 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: BEGIN
[0m15:10:53.044655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.052890 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.054295 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.055426 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_status_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.062938 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.073263 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.074610 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_status_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.078084 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.087655 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.095636 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_status_order_status_history (compile): 2024-09-01 15:10:53.027761 => 2024-09-01 15:10:53.095527
[0m15:10:53.096478 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:10:53.106527 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.114543 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.115299 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

  create view "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_order_status_order_status_history"
),

derived_columns AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:53.117740 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:53.124183 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.125531 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */
alter table "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_tmp" rename to "stg_link_order_status_order_status_history"
[0m15:10:53.127216 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:53.130062 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: COMMIT
[0m15:10:53.131098 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.132125 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: COMMIT
[0m15:10:53.136073 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.140804 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:10:53.141959 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_backup" cascade
[0m15:10:53.143243 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.145346 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_status_order_status_history (execute): 2024-09-01 15:10:53.097091 => 2024-09-01 15:10:53.145287
[0m15:10:53.146333 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: Close
[0m15:10:53.148205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1477da0d0>]}
[0m15:10:53.149653 [info ] [Thread-1  ]: 36 of 45 OK created sql view model dbt.stg_link_order_status_order_status_history  [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:53.151361 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:10:53.152729 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_client
[0m15:10:53.153733 [info ] [Thread-1  ]: 37 of 45 START sql view model dbt.stg_link_order_client ........................ [RUN]
[0m15:10:53.155284 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_client'
[0m15:10:53.156312 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_client
[0m15:10:53.168702 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.170127 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: BEGIN
[0m15:10:53.171262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.179257 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.180775 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.182078 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.189453 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.199814 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.201096 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.204556 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.215336 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.224003 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_client (compile): 2024-09-01 15:10:53.157011 => 2024-09-01 15:10:53.223890
[0m15:10:53.224783 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_client
[0m15:10:53.234396 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.241068 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.241800 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

  create view "postgres"."dbt"."stg_link_order_client__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk

    FROM "postgres"."dbt"."stg_order_client"
),

derived_columns AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_CLIENT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_ORDER_CLIENT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:53.243933 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:53.249013 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.250196 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */
alter table "postgres"."dbt"."stg_link_order_client__dbt_tmp" rename to "stg_link_order_client"
[0m15:10:53.251755 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:53.254276 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: COMMIT
[0m15:10:53.255278 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.256304 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: COMMIT
[0m15:10:53.260250 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.264938 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:10:53.265854 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */
drop view if exists "postgres"."dbt"."stg_link_order_client__dbt_backup" cascade
[0m15:10:53.267108 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.269051 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_client (execute): 2024-09-01 15:10:53.225379 => 2024-09-01 15:10:53.268995
[0m15:10:53.270184 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: Close
[0m15:10:53.271705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb149c261f0>]}
[0m15:10:53.272951 [info ] [Thread-1  ]: 37 of 45 OK created sql view model dbt.stg_link_order_client ................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:53.274474 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_client
[0m15:10:53.275616 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_currency
[0m15:10:53.276716 [info ] [Thread-1  ]: 38 of 45 START sql view model dbt.stg_link_order_currency ...................... [RUN]
[0m15:10:53.278331 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_currency'
[0m15:10:53.279285 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_currency
[0m15:10:53.292022 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.293321 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: BEGIN
[0m15:10:53.294359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.302071 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.303465 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.304606 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.312343 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.324834 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.326170 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.329544 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.339194 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.347381 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_currency (compile): 2024-09-01 15:10:53.280198 => 2024-09-01 15:10:53.347270
[0m15:10:53.348150 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_currency
[0m15:10:53.358020 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.366551 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.367321 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

  create view "postgres"."dbt"."stg_link_order_currency__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk

    FROM "postgres"."dbt"."stg_order_currency"
),

derived_columns AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    'CSV_ORDERS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_CURRENCY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    RECORD_SOURCE,
    LINK_ORDER_CURRENCY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:53.369505 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:53.374810 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.376210 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */
alter table "postgres"."dbt"."stg_link_order_currency__dbt_tmp" rename to "stg_link_order_currency"
[0m15:10:53.377922 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:53.381016 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: COMMIT
[0m15:10:53.382401 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.383488 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: COMMIT
[0m15:10:53.386342 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.391047 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:10:53.392161 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */
drop view if exists "postgres"."dbt"."stg_link_order_currency__dbt_backup" cascade
[0m15:10:53.393318 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.395428 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_currency (execute): 2024-09-01 15:10:53.348745 => 2024-09-01 15:10:53.395369
[0m15:10:53.396433 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: Close
[0m15:10:53.397892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1455cf3a0>]}
[0m15:10:53.399197 [info ] [Thread-1  ]: 38 of 45 OK created sql view model dbt.stg_link_order_currency ................. [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:53.400663 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_currency
[0m15:10:53.402243 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_goods
[0m15:10:53.403457 [info ] [Thread-1  ]: 39 of 45 START sql view model dbt.stg_link_order_goods ......................... [RUN]
[0m15:10:53.405123 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_goods'
[0m15:10:53.406207 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_goods
[0m15:10:53.420832 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.422305 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: BEGIN
[0m15:10:53.423470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.431532 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.432939 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.434150 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.441385 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.451775 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.453020 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.456685 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.466042 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.475018 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_goods (compile): 2024-09-01 15:10:53.407076 => 2024-09-01 15:10:53.474905
[0m15:10:53.475798 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_goods
[0m15:10:53.485588 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.494184 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.494999 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

  create view "postgres"."dbt"."stg_link_order_goods__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk

    FROM "postgres"."dbt"."stg_order_goods"
),

derived_columns AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(GOOD_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_GOOD_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    RECORD_SOURCE,
    LINK_ORDER_GOOD_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:53.497271 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:53.503534 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.505006 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */
alter table "postgres"."dbt"."stg_link_order_goods__dbt_tmp" rename to "stg_link_order_goods"
[0m15:10:53.506872 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:53.509723 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: COMMIT
[0m15:10:53.511043 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.512108 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: COMMIT
[0m15:10:53.514721 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.519098 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:10:53.520328 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */
drop view if exists "postgres"."dbt"."stg_link_order_goods__dbt_backup" cascade
[0m15:10:53.521806 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.524026 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_goods (execute): 2024-09-01 15:10:53.476410 => 2024-09-01 15:10:53.523968
[0m15:10:53.525047 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: Close
[0m15:10:53.526570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb145550af0>]}
[0m15:10:53.527867 [info ] [Thread-1  ]: 39 of 45 OK created sql view model dbt.stg_link_order_goods .................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:53.529038 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_goods
[0m15:10:53.530560 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:10:53.531816 [info ] [Thread-1  ]: 40 of 45 START sql view model dbt.stg_link_order_order_status_history .......... [RUN]
[0m15:10:53.533685 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_order_status_history'
[0m15:10:53.534777 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:10:53.548969 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.550664 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: BEGIN
[0m15:10:53.552126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.560416 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.561777 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.563011 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.570298 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.580513 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.581786 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.585347 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.596024 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.605057 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_order_status_history (compile): 2024-09-01 15:10:53.535771 => 2024-09-01 15:10:53.604940
[0m15:10:53.605877 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:10:53.616323 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.624664 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.625393 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

  create view "postgres"."dbt"."stg_link_order_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_order_order_status_history"
),

derived_columns AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_ORDER_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:53.627548 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:53.632570 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.633674 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */
alter table "postgres"."dbt"."stg_link_order_order_status_history__dbt_tmp" rename to "stg_link_order_order_status_history"
[0m15:10:53.635316 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:53.638006 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: COMMIT
[0m15:10:53.639134 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.640305 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: COMMIT
[0m15:10:53.644266 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.648981 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:10:53.650397 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_order_order_status_history__dbt_backup" cascade
[0m15:10:53.651952 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.654132 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_order_status_history (execute): 2024-09-01 15:10:53.606523 => 2024-09-01 15:10:53.654073
[0m15:10:53.655126 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: Close
[0m15:10:53.656572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1455c4b80>]}
[0m15:10:53.657771 [info ] [Thread-1  ]: 40 of 45 OK created sql view model dbt.stg_link_order_order_status_history ..... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:53.659381 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:10:53.661019 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:10:53.662530 [info ] [Thread-1  ]: 41 of 45 START sql view model dbt.stg_link_order_with_delay_order .............. [RUN]
[0m15:10:53.664456 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_with_delay_order'
[0m15:10:53.665612 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:10:53.678316 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.679530 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: BEGIN
[0m15:10:53.680653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.688388 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.689826 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.691180 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_with_delay_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.698522 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.710086 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.711552 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_with_delay_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.714952 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.724564 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.733888 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_with_delay_order (compile): 2024-09-01 15:10:53.666677 => 2024-09-01 15:10:53.733721
[0m15:10:53.734869 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:10:53.745722 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.754605 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.755379 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

  create view "postgres"."dbt"."stg_link_order_with_delay_order__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk

    FROM "postgres"."dbt"."stg_order_with_delay_order"
),

derived_columns AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    'CSV_ORDER_WITH_DELAY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_WITH_DELAY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_WITH_DELAY_ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    RECORD_SOURCE,
    LINK_ORDER_WITH_DELAY_ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:53.757772 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:53.763119 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.764536 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */
alter table "postgres"."dbt"."stg_link_order_with_delay_order__dbt_tmp" rename to "stg_link_order_with_delay_order"
[0m15:10:53.766197 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:53.769182 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: COMMIT
[0m15:10:53.770496 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.771531 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: COMMIT
[0m15:10:53.775034 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.779687 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:10:53.781015 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */
drop view if exists "postgres"."dbt"."stg_link_order_with_delay_order__dbt_backup" cascade
[0m15:10:53.782300 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.784521 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_with_delay_order (execute): 2024-09-01 15:10:53.735656 => 2024-09-01 15:10:53.784457
[0m15:10:53.785550 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: Close
[0m15:10:53.787058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1476fb2e0>]}
[0m15:10:53.788191 [info ] [Thread-1  ]: 41 of 45 OK created sql view model dbt.stg_link_order_with_delay_order ......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:53.789525 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:10:53.791023 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:10:53.792148 [info ] [Thread-1  ]: 42 of 45 START sql view model dbt.stg_link_warehouse_order_status_history ...... [RUN]
[0m15:10:53.793673 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_order_status_history'
[0m15:10:53.794984 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:10:53.809411 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.810720 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: BEGIN
[0m15:10:53.811703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.820127 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.821665 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.822919 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.830708 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.841239 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.842672 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.846272 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.855989 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.864361 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_order_status_history (compile): 2024-09-01 15:10:53.795761 => 2024-09-01 15:10:53.864247
[0m15:10:53.865190 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:10:53.875218 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.884387 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.885277 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

  create view "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_warehouse_order_status_history"
),

derived_columns AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:53.887588 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:53.894446 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.895714 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */
alter table "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_tmp" rename to "stg_link_warehouse_order_status_history"
[0m15:10:53.897298 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:53.900149 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: COMMIT
[0m15:10:53.901281 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.902184 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: COMMIT
[0m15:10:53.906666 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:53.911685 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:10:53.912874 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_backup" cascade
[0m15:10:53.914139 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:53.916254 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_order_status_history (execute): 2024-09-01 15:10:53.865798 => 2024-09-01 15:10:53.916196
[0m15:10:53.917332 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: Close
[0m15:10:53.918841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147811760>]}
[0m15:10:53.920201 [info ] [Thread-1  ]: 42 of 45 OK created sql view model dbt.stg_link_warehouse_order_status_history . [[32mCREATE VIEW[0m in 0.13s]
[0m15:10:53.921900 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:10:53.923202 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:10:53.924324 [info ] [Thread-1  ]: 43 of 45 START sql view model dbt.stg_link_warehouse_address_city .............. [RUN]
[0m15:10:53.926112 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_address_city'
[0m15:10:53.927173 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:10:53.939736 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:53.941361 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: BEGIN
[0m15:10:53.942618 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:53.950187 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:53.951799 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:53.953115 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.961642 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.971789 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:53.973071 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:53.976441 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:53.987165 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:53.995373 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_city (compile): 2024-09-01 15:10:53.927992 => 2024-09-01 15:10:53.995261
[0m15:10:53.996192 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:10:54.006461 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:54.015380 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:54.016093 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

  create view "postgres"."dbt"."stg_link_warehouse_address_city__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk

    FROM "postgres"."dbt"."stg_warehouse_address_city"
),

derived_columns AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    'CSV_WAREHOUSE_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ADDRESS_CITY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ADDRESS_CITY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:54.018201 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:54.023143 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:54.024453 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */
alter table "postgres"."dbt"."stg_link_warehouse_address_city__dbt_tmp" rename to "stg_link_warehouse_address_city"
[0m15:10:54.026149 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:54.028759 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: COMMIT
[0m15:10:54.029817 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:54.030898 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: COMMIT
[0m15:10:54.034516 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:54.039643 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:10:54.041045 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_address_city__dbt_backup" cascade
[0m15:10:54.042483 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:54.044621 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_city (execute): 2024-09-01 15:10:53.996856 => 2024-09-01 15:10:54.044563
[0m15:10:54.045646 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: Close
[0m15:10:54.047147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14556b190>]}
[0m15:10:54.048348 [info ] [Thread-1  ]: 43 of 45 OK created sql view model dbt.stg_link_warehouse_address_city ......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:54.049650 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:10:54.051138 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:10:54.052360 [info ] [Thread-1  ]: 44 of 45 START sql view model dbt.stg_link_warehouse_address_warehouse_params .. [RUN]
[0m15:10:54.054117 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params'
[0m15:10:54.055190 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:10:54.068093 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.069323 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: BEGIN
[0m15:10:54.070426 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:54.078322 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:54.079765 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.081284 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:54.088717 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:54.139072 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.140451 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:54.143987 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:54.153401 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.161637 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params (compile): 2024-09-01 15:10:54.056253 => 2024-09-01 15:10:54.161508
[0m15:10:54.162467 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:10:54.172555 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.180543 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.181403 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

  create view "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk

    FROM "postgres"."dbt"."stg_warehouse_address_warehouse_params"
),

derived_columns AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_ADDRESS_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_PARAMS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:54.183648 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:54.188709 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.189892 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */
alter table "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_tmp" rename to "stg_link_warehouse_address_warehouse_params"
[0m15:10:54.191993 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:54.194742 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: COMMIT
[0m15:10:54.195822 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.196802 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: COMMIT
[0m15:10:54.200210 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:54.204872 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:10:54.205857 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_backup" cascade
[0m15:10:54.207398 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:54.209572 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params (execute): 2024-09-01 15:10:54.163091 => 2024-09-01 15:10:54.209514
[0m15:10:54.210923 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: Close
[0m15:10:54.212511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb14775dd90>]}
[0m15:10:54.213683 [info ] [Thread-1  ]: 44 of 45 OK created sql view model dbt.stg_link_warehouse_address_warehouse_params  [[32mCREATE VIEW[0m in 0.16s]
[0m15:10:54.215094 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:10:54.216455 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:10:54.217708 [info ] [Thread-1  ]: 45 of 45 START sql view model dbt.stg_link_warehouse_warehouse_params .......... [RUN]
[0m15:10:54.219188 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_warehouse_params'
[0m15:10:54.220370 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:10:54.234508 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.235708 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: BEGIN
[0m15:10:54.236751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:10:54.244539 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:10:54.245968 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.247092 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:54.254684 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:54.264814 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.266142 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:10:54.269634 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:10:54.279114 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.288568 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_warehouse_params (compile): 2024-09-01 15:10:54.221365 => 2024-09-01 15:10:54.288435
[0m15:10:54.289544 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:10:54.299747 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.309439 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.310195 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

  create view "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk

    FROM "postgres"."dbt"."stg_warehouse_warehouse_params"
),

derived_columns AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_PARAMS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:10:54.312435 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:10:54.317359 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.319736 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */
alter table "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_tmp" rename to "stg_link_warehouse_warehouse_params"
[0m15:10:54.321550 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:10:54.324549 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: COMMIT
[0m15:10:54.325727 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.326802 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: COMMIT
[0m15:10:54.330638 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:10:54.335617 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:10:54.336641 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_backup" cascade
[0m15:10:54.338054 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:10:54.340268 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_warehouse_params (execute): 2024-09-01 15:10:54.290415 => 2024-09-01 15:10:54.340173
[0m15:10:54.341364 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: Close
[0m15:10:54.342958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '097e84ef-56ca-4b6d-8ebf-5abdaa799de1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb145595280>]}
[0m15:10:54.344306 [info ] [Thread-1  ]: 45 of 45 OK created sql view model dbt.stg_link_warehouse_warehouse_params ..... [[32mCREATE VIEW[0m in 0.12s]
[0m15:10:54.345848 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:10:54.348935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:54.349980 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:54.351256 [debug] [MainThread]: On master: BEGIN
[0m15:10:54.352285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:54.359851 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:10:54.361582 [debug] [MainThread]: On master: COMMIT
[0m15:10:54.362891 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:54.364179 [debug] [MainThread]: On master: COMMIT
[0m15:10:54.365439 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:10:54.366405 [debug] [MainThread]: On master: Close
[0m15:10:54.367783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:54.368714 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.stg_link_warehouse_warehouse_params' was properly closed.
[0m15:10:54.369947 [info ] [MainThread]: 
[0m15:10:54.371104 [info ] [MainThread]: Finished running 45 view models in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m15:10:54.375108 [debug] [MainThread]: Command end result
[0m15:10:54.408539 [info ] [MainThread]: 
[0m15:10:54.409863 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:54.411909 [info ] [MainThread]: 
[0m15:10:54.413321 [info ] [MainThread]: Done. PASS=45 WARN=0 ERROR=0 SKIP=0 TOTAL=45
[0m15:10:54.414798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb149c261f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb147705b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1477059d0>]}
[0m15:10:54.415911 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:12:56.697760 | 6505ba5d-222d-4d78-889b-5c8b9be6f933 ==============================
[0m15:12:56.697760 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:12:56.700148 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'clean', 'indirect_selection': 'eager'}
[0m15:12:56.700999 [debug] [MainThread]: Tracking: tracking
[0m15:12:56.705436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8a92c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8a92ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8a92c490>]}
[0m15:12:56.962516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8a92c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8a92c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d8a92c4f0>]}
[0m15:12:56.963487 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:13:11.664228 | 6d5adb41-7163-4fce-8a0e-7578446ff07d ==============================
[0m15:13:11.664228 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:13:11.667408 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:stage'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:13:11.668571 [debug] [MainThread]: Tracking: tracking
[0m15:13:11.674150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe132743520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe132743130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe132743a30>]}
[0m15:13:11.749056 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:13:11.750263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe132743880>]}
[0m15:13:17.888242 [debug] [MainThread]: 1603: static parser failed on business_vault/as_of_date.sql
[0m15:13:17.951924 [debug] [MainThread]: 1602: parser fallback to jinja rendering on business_vault/as_of_date.sql
[0m15:13:17.956660 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_city_country.sql
[0m15:13:17.962142 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_currency_rate_by_date.sql
[0m15:13:17.967027 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_date.sql
[0m15:13:17.972562 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_last_order_status.sql
[0m15:13:17.980875 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_sender.sql
[0m15:13:17.985798 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_city.sql
[0m15:13:18.107750 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_city.sql
[0m15:13:18.110648 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_client.sql
[0m15:13:18.124148 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_client.sql
[0m15:13:18.127196 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_client_address.sql
[0m15:13:18.141222 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_client_address.sql
[0m15:13:18.144520 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_client_type.sql
[0m15:13:18.161844 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_client_type.sql
[0m15:13:18.165034 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_country.sql
[0m15:13:18.179461 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_country.sql
[0m15:13:18.182477 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_currency.sql
[0m15:13:18.197870 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_currency.sql
[0m15:13:18.200706 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_currency_rate.sql
[0m15:13:18.214236 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_currency_rate.sql
[0m15:13:18.216969 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_good.sql
[0m15:13:18.231669 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_good.sql
[0m15:13:18.271188 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m15:13:18.285818 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m15:13:18.289288 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order_status.sql
[0m15:13:18.302757 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order_status.sql
[0m15:13:18.307276 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order_status_history.sql
[0m15:13:18.322167 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order_status_history.sql
[0m15:13:18.325514 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order_with_delay.sql
[0m15:13:18.341102 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order_with_delay.sql
[0m15:13:18.344262 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_warehouse.sql
[0m15:13:18.358369 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_warehouse.sql
[0m15:13:18.361935 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_warehouse_address.sql
[0m15:13:18.375859 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_warehouse_address.sql
[0m15:13:18.378808 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_warehouse_params.sql
[0m15:13:18.392889 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_warehouse_params.sql
[0m15:13:18.395825 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_city_country.sql
[0m15:13:18.440869 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_city_country.sql
[0m15:13:18.443918 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_client_address_city.sql
[0m15:13:18.458189 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_client_address_city.sql
[0m15:13:18.461238 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_client_address_client.sql
[0m15:13:18.475186 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_client_address_client.sql
[0m15:13:18.477999 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_client_client_type.sql
[0m15:13:18.492897 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_client_client_type.sql
[0m15:13:18.496116 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_currency_currency_rate.sql
[0m15:13:18.509894 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_currency_currency_rate.sql
[0m15:13:18.513160 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_client.sql
[0m15:13:18.526923 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_client.sql
[0m15:13:18.529851 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_currency.sql
[0m15:13:18.543800 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_currency.sql
[0m15:13:18.546714 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_goods.sql
[0m15:13:18.561529 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_goods.sql
[0m15:13:18.564463 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_order_status_history.sql
[0m15:13:18.578442 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_order_status_history.sql
[0m15:13:18.581397 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_status_order_status_history.sql
[0m15:13:18.598212 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_status_order_status_history.sql
[0m15:13:18.601554 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_with_delay_order.sql
[0m15:13:18.616909 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_with_delay_order.sql
[0m15:13:18.620019 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_address_city.sql
[0m15:13:18.635516 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_address_city.sql
[0m15:13:18.639052 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_address_warehouse_params.sql
[0m15:13:18.655129 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_address_warehouse_params.sql
[0m15:13:18.658293 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_order_status_history.sql
[0m15:13:18.673006 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_order_status_history.sql
[0m15:13:18.675944 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_warehouse_params.sql
[0m15:13:18.691523 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_warehouse_params.sql
[0m15:13:18.694471 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_city.sql
[0m15:13:18.770955 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_city.sql
[0m15:13:18.774347 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_client.sql
[0m15:13:18.793624 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_client.sql
[0m15:13:18.796607 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_client_address.sql
[0m15:13:18.818743 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_client_address.sql
[0m15:13:18.822120 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_client_type.sql
[0m15:13:18.840085 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_client_type.sql
[0m15:13:18.843116 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_country.sql
[0m15:13:18.860459 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_country.sql
[0m15:13:18.863376 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_currency.sql
[0m15:13:18.882019 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_currency.sql
[0m15:13:18.884850 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_currency_rate.sql
[0m15:13:18.903973 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_currency_rate.sql
[0m15:13:18.907108 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_good.sql
[0m15:13:18.930901 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_good.sql
[0m15:13:18.933959 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order.sql
[0m15:13:18.955000 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order.sql
[0m15:13:18.957945 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_status.sql
[0m15:13:18.975714 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_status.sql
[0m15:13:18.978603 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_status_history.sql
[0m15:13:18.997096 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_status_history.sql
[0m15:13:19.000224 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_with_delay.sql
[0m15:13:19.018302 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_with_delay.sql
[0m15:13:19.021412 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_warehouse.sql
[0m15:13:19.039820 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_warehouse.sql
[0m15:13:19.042932 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_warehouse_address.sql
[0m15:13:19.063503 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_warehouse_address.sql
[0m15:13:19.066729 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_warehouse_params.sql
[0m15:13:19.086323 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_warehouse_params.sql
[0m15:13:19.089563 [debug] [MainThread]: 1603: static parser failed on stage/stg_city.sql
[0m15:13:19.296379 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_city.sql
[0m15:13:19.299834 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_city_country.sql
[0m15:13:19.304771 [debug] [MainThread]: 1603: static parser failed on stage/stg_client.sql
[0m15:13:19.336490 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_client.sql
[0m15:13:19.339297 [debug] [MainThread]: 1603: static parser failed on stage/stg_client_address.sql
[0m15:13:19.366241 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_client_address.sql
[0m15:13:19.369982 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_client_address_city.sql
[0m15:13:19.375361 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_client_address_client.sql
[0m15:13:19.380525 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_client_client_type.sql
[0m15:13:19.385356 [debug] [MainThread]: 1603: static parser failed on stage/stg_client_type.sql
[0m15:13:19.407568 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_client_type.sql
[0m15:13:19.410625 [debug] [MainThread]: 1603: static parser failed on stage/stg_country.sql
[0m15:13:19.436607 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_country.sql
[0m15:13:19.439554 [debug] [MainThread]: 1603: static parser failed on stage/stg_currency.sql
[0m15:13:19.468214 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_currency.sql
[0m15:13:19.471740 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_currency_currency_rate.sql
[0m15:13:19.477729 [debug] [MainThread]: 1603: static parser failed on stage/stg_currency_rate.sql
[0m15:13:19.505012 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_currency_rate.sql
[0m15:13:19.508093 [debug] [MainThread]: 1603: static parser failed on stage/stg_goods.sql
[0m15:13:19.536162 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_goods.sql
[0m15:13:19.539333 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_city_country.sql
[0m15:13:19.570410 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_city_country.sql
[0m15:13:19.573232 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_client_address_city.sql
[0m15:13:19.634660 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_client_address_city.sql
[0m15:13:19.637500 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_client_address_client.sql
[0m15:13:19.658829 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_client_address_client.sql
[0m15:13:19.661829 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_client_client_type.sql
[0m15:13:19.682738 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_client_client_type.sql
[0m15:13:19.685751 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_currency_currency_rate.sql
[0m15:13:19.707951 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_currency_currency_rate.sql
[0m15:13:19.710988 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_client.sql
[0m15:13:19.732314 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_client.sql
[0m15:13:19.735243 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_currency.sql
[0m15:13:19.757264 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_currency.sql
[0m15:13:19.760171 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_goods.sql
[0m15:13:19.782108 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_goods.sql
[0m15:13:19.784930 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_order_status_history.sql
[0m15:13:19.806117 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_order_status_history.sql
[0m15:13:19.809218 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_status_order_status_history.sql
[0m15:13:19.833457 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_status_order_status_history.sql
[0m15:13:19.836524 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_with_delay_order.sql
[0m15:13:19.857577 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_with_delay_order.sql
[0m15:13:19.860515 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_address_city.sql
[0m15:13:19.881707 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_address_city.sql
[0m15:13:19.884856 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_address_warehouse_params.sql
[0m15:13:19.906518 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_address_warehouse_params.sql
[0m15:13:19.909804 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_order_status_history.sql
[0m15:13:19.931495 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_order_status_history.sql
[0m15:13:19.934500 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_warehouse_params.sql
[0m15:13:19.956187 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_warehouse_params.sql
[0m15:13:19.959343 [debug] [MainThread]: 1603: static parser failed on stage/stg_orders.sql
[0m15:13:19.987578 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_orders.sql
[0m15:13:19.991161 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_client.sql
[0m15:13:19.996702 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_currency.sql
[0m15:13:20.001593 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_goods.sql
[0m15:13:20.006492 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_order_status_history.sql
[0m15:13:20.011114 [debug] [MainThread]: 1603: static parser failed on stage/stg_order_status.sql
[0m15:13:20.033847 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_order_status.sql
[0m15:13:20.036754 [debug] [MainThread]: 1603: static parser failed on stage/stg_order_status_history.sql
[0m15:13:20.059125 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_order_status_history.sql
[0m15:13:20.062360 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_status_order_status_history.sql
[0m15:13:20.067036 [debug] [MainThread]: 1603: static parser failed on stage/stg_order_with_delay.sql
[0m15:13:20.089165 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_order_with_delay.sql
[0m15:13:20.092518 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_with_delay_order.sql
[0m15:13:20.097537 [debug] [MainThread]: 1603: static parser failed on stage/stg_warehouse.sql
[0m15:13:20.122288 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_warehouse.sql
[0m15:13:20.125365 [debug] [MainThread]: 1603: static parser failed on stage/stg_warehouse_address.sql
[0m15:13:20.149171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_warehouse_address.sql
[0m15:13:20.152759 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_address_city.sql
[0m15:13:20.157828 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_address_warehouse_params.sql
[0m15:13:20.162645 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_order_status_history.sql
[0m15:13:20.167784 [debug] [MainThread]: 1603: static parser failed on stage/stg_warehouse_params.sql
[0m15:13:20.192170 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_warehouse_params.sql
[0m15:13:20.195623 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_warehouse_params.sql
[0m15:13:20.511158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1324a9ac0>]}
[0m15:13:20.560255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1311d0c10>]}
[0m15:13:20.561395 [info ] [MainThread]: Found 96 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:13:20.562577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1312f4af0>]}
[0m15:13:20.570134 [info ] [MainThread]: 
[0m15:13:20.573545 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:13:20.579318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:13:20.588982 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:13:20.590254 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:13:20.591400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:20.600338 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:13:20.602879 [debug] [ThreadPool]: On list_postgres: Close
[0m15:13:20.613121 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:13:20.622687 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:13:20.623967 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:13:20.625265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:20.633261 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:13:20.634821 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:13:20.636031 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:13:20.639414 [debug] [ThreadPool]: SQL status: SELECT 99 in 0 seconds
[0m15:13:20.644916 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:13:20.646381 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:13:20.672960 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:20.674378 [debug] [MainThread]: On master: BEGIN
[0m15:13:20.675533 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:20.683541 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:13:20.685520 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:20.686925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:13:20.734530 [debug] [MainThread]: SQL status: SELECT 60 in 0 seconds
[0m15:13:20.745164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1324971f0>]}
[0m15:13:20.746531 [debug] [MainThread]: On master: ROLLBACK
[0m15:13:20.747920 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:20.749019 [debug] [MainThread]: On master: BEGIN
[0m15:13:20.750447 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:13:20.751693 [debug] [MainThread]: On master: COMMIT
[0m15:13:20.752812 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:20.753784 [debug] [MainThread]: On master: COMMIT
[0m15:13:20.754947 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:13:20.755938 [debug] [MainThread]: On master: Close
[0m15:13:20.757333 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:20.758390 [info ] [MainThread]: 
[0m15:13:20.763686 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city
[0m15:13:20.764952 [info ] [Thread-1  ]: 1 of 45 START sql view model dbt.stg_city ...................................... [RUN]
[0m15:13:20.766310 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city'
[0m15:13:20.767197 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city
[0m15:13:20.785741 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.787067 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: BEGIN
[0m15:13:20.788218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:20.796008 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:20.797562 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.798527 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:20.805079 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:13:20.819608 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.820869 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:20.824592 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:13:20.835429 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city"
[0m15:13:20.851845 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (compile): 2024-09-01 15:13:20.767882 => 2024-09-01 15:13:20.851722
[0m15:13:20.852829 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city
[0m15:13:20.905755 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city"
[0m15:13:20.920001 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.920965 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

  create view "postgres"."dbt"."stg_city__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    country_id

    FROM "postgres"."dbt"."source_city"
),

derived_columns AS (

    SELECT

    id,
    name,
    country_id,
    id AS CITY_KEY,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CITY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CITY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,
    CITY_PK,
    CITY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:20.923155 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:20.932403 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.933657 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city" rename to "stg_city__dbt_backup"
[0m15:13:20.935249 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:20.941081 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.942252 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city__dbt_tmp" rename to "stg_city"
[0m15:13:20.943832 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:20.968605 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:13:20.969942 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.971027 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:13:20.975154 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:20.983568 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:13:20.984834 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
drop view if exists "postgres"."dbt"."stg_city__dbt_backup" cascade
[0m15:13:20.989625 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:20.992003 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (execute): 2024-09-01 15:13:20.853481 => 2024-09-01 15:13:20.991943
[0m15:13:20.993099 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: Close
[0m15:13:20.994464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131462c40>]}
[0m15:13:20.995708 [info ] [Thread-1  ]: 1 of 45 OK created sql view model dbt.stg_city ................................. [[32mCREATE VIEW[0m in 0.23s]
[0m15:13:20.999093 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city
[0m15:13:21.000520 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client
[0m15:13:21.001661 [info ] [Thread-1  ]: 2 of 45 START sql view model dbt.stg_client .................................... [RUN]
[0m15:13:21.003054 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client'
[0m15:13:21.003953 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client
[0m15:13:21.017138 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.018387 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: BEGIN
[0m15:13:21.019579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:21.027670 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:21.029090 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.030212 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.038335 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.050077 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.051370 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.055119 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.070621 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client"
[0m15:13:21.078363 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (compile): 2024-09-01 15:13:21.004616 => 2024-09-01 15:13:21.078255
[0m15:13:21.079176 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client
[0m15:13:21.088974 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client"
[0m15:13:21.096813 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.097577 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

  create view "postgres"."dbt"."stg_client__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id

    FROM "postgres"."dbt"."source_client"
),

derived_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CONCAT(
        order_id, '||',
        client_type_code
    ) AS CLIENT_KEY,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS CLIENT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,
    CLIENT_PK,
    CLIENT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:21.099847 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:21.105002 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.106296 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client" rename to "stg_client__dbt_backup"
[0m15:13:21.108115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.113247 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.114379 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client__dbt_tmp" rename to "stg_client"
[0m15:13:21.116069 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.119200 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:13:21.120359 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.121460 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:13:21.124842 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:21.130137 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:13:21.131361 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
drop view if exists "postgres"."dbt"."stg_client__dbt_backup" cascade
[0m15:13:21.136135 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:21.138752 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (execute): 2024-09-01 15:13:21.079808 => 2024-09-01 15:13:21.138691
[0m15:13:21.140003 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: Close
[0m15:13:21.141775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131089070>]}
[0m15:13:21.143144 [info ] [Thread-1  ]: 2 of 45 OK created sql view model dbt.stg_client ............................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:13:21.144761 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client
[0m15:13:21.146252 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address
[0m15:13:21.147672 [info ] [Thread-1  ]: 3 of 45 START sql view model dbt.stg_client_address ............................ [RUN]
[0m15:13:21.149591 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address'
[0m15:13:21.150710 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address
[0m15:13:21.163551 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.164926 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: BEGIN
[0m15:13:21.166010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:21.173487 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:21.174904 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.176047 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.182722 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.193131 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.194384 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.197872 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.212741 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.220630 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (compile): 2024-09-01 15:13:21.151484 => 2024-09-01 15:13:21.220488
[0m15:13:21.221432 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address
[0m15:13:21.232373 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.240902 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.241761 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

  create view "postgres"."dbt"."stg_client_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid

    FROM "postgres"."dbt"."source_client_address"
),

derived_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    id AS CLIENT_ADDRESS_KEY,
    'CSV_CLIENT_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), ''), '^^')
    ), '^^')), 'hex') AS CLIENT_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(is_valid AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,
    CLIENT_ADDRESS_PK,
    CLIENT_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:21.244358 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:21.284316 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.285723 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
alter table "postgres"."dbt"."stg_client_address" rename to "stg_client_address__dbt_backup"
[0m15:13:21.287555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.292697 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.294195 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
alter table "postgres"."dbt"."stg_client_address__dbt_tmp" rename to "stg_client_address"
[0m15:13:21.295850 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.298761 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:13:21.299831 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.300876 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:13:21.303719 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:21.308158 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:13:21.309375 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
drop view if exists "postgres"."dbt"."stg_client_address__dbt_backup" cascade
[0m15:13:21.312813 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:21.314959 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (execute): 2024-09-01 15:13:21.222140 => 2024-09-01 15:13:21.314902
[0m15:13:21.315880 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: Close
[0m15:13:21.317246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f32520>]}
[0m15:13:21.318433 [info ] [Thread-1  ]: 3 of 45 OK created sql view model dbt.stg_client_address ....................... [[32mCREATE VIEW[0m in 0.17s]
[0m15:13:21.319780 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address
[0m15:13:21.320897 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_type
[0m15:13:21.322160 [info ] [Thread-1  ]: 4 of 45 START sql view model dbt.stg_client_type ............................... [RUN]
[0m15:13:21.323569 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_type'
[0m15:13:21.324512 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_type
[0m15:13:21.336882 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.338073 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: BEGIN
[0m15:13:21.339279 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:21.347094 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:21.348614 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.349749 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.357299 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:21.368487 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.369764 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.373441 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:21.383833 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.391459 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (compile): 2024-09-01 15:13:21.325319 => 2024-09-01 15:13:21.391347
[0m15:13:21.392390 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_type
[0m15:13:21.402180 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.410179 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.410956 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

  create view "postgres"."dbt"."stg_client_type__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_client_type"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS CLIENT_TYPE_KEY,
    'CSV_CLIENT_TYPE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CLIENT_TYPE_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CLIENT_TYPE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,
    CLIENT_TYPE_PK,
    CLIENT_TYPE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:21.412954 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:21.417973 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.419211 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type" rename to "stg_client_type__dbt_backup"
[0m15:13:21.420910 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.425860 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.427042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type__dbt_tmp" rename to "stg_client_type"
[0m15:13:21.428526 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.431416 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:13:21.432453 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.433503 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:13:21.437276 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:21.442996 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:13:21.444298 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_type__dbt_backup" cascade
[0m15:13:21.447717 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:21.450193 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (execute): 2024-09-01 15:13:21.393061 => 2024-09-01 15:13:21.450135
[0m15:13:21.451226 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: Close
[0m15:13:21.452902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f32340>]}
[0m15:13:21.454146 [info ] [Thread-1  ]: 4 of 45 OK created sql view model dbt.stg_client_type .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:13:21.455461 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_type
[0m15:13:21.456871 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_country
[0m15:13:21.458107 [info ] [Thread-1  ]: 5 of 45 START sql view model dbt.stg_country ................................... [RUN]
[0m15:13:21.459680 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_country'
[0m15:13:21.460665 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_country
[0m15:13:21.473058 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.474361 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: BEGIN
[0m15:13:21.475530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:21.483540 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:21.484962 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.486376 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.493995 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:21.504412 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.505758 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.509159 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:21.519008 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_country"
[0m15:13:21.526915 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (compile): 2024-09-01 15:13:21.461327 => 2024-09-01 15:13:21.526806
[0m15:13:21.528074 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_country
[0m15:13:21.539273 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_country"
[0m15:13:21.547327 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.548074 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

  create view "postgres"."dbt"."stg_country__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_country"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS COUNTRY_KEY,
    'CSV_COUNTRY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS COUNTRY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS COUNTRY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,
    COUNTRY_PK,
    COUNTRY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:21.550083 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:21.555165 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.556406 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country" rename to "stg_country__dbt_backup"
[0m15:13:21.558031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.563616 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.564929 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country__dbt_tmp" rename to "stg_country"
[0m15:13:21.566499 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.569273 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:13:21.570294 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.571306 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:13:21.575002 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:21.579518 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:13:21.580631 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
drop view if exists "postgres"."dbt"."stg_country__dbt_backup" cascade
[0m15:13:21.583825 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:21.585958 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (execute): 2024-09-01 15:13:21.528816 => 2024-09-01 15:13:21.585900
[0m15:13:21.586953 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: Close
[0m15:13:21.588424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f32100>]}
[0m15:13:21.589776 [info ] [Thread-1  ]: 5 of 45 OK created sql view model dbt.stg_country .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:13:21.591287 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_country
[0m15:13:21.592701 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency
[0m15:13:21.594120 [info ] [Thread-1  ]: 6 of 45 START sql view model dbt.stg_currency .................................. [RUN]
[0m15:13:21.595948 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency'
[0m15:13:21.597128 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency
[0m15:13:21.610970 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.612355 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: BEGIN
[0m15:13:21.613503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:21.621066 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:21.622731 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.623974 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.630740 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:21.640934 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.642202 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.645665 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:21.656055 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.664450 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (compile): 2024-09-01 15:13:21.598156 => 2024-09-01 15:13:21.664342
[0m15:13:21.665294 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency
[0m15:13:21.675870 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.684112 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.685000 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

  create view "postgres"."dbt"."stg_currency__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    code,
    name

    FROM "postgres"."dbt"."source_currency"
),

derived_columns AS (

    SELECT

    code,
    name,
    code AS CURRENCY_KEY,
    'CSV_CURRENCY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(code AS VARCHAR))), '')), 'hex') AS CURRENCY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CURRENCY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,
    CURRENCY_PK,
    CURRENCY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:21.687050 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:21.692040 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.693337 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency" rename to "stg_currency__dbt_backup"
[0m15:13:21.694916 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.699922 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.701129 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency__dbt_tmp" rename to "stg_currency"
[0m15:13:21.702759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.705634 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:13:21.706709 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.707794 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:13:21.711684 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:21.717443 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:13:21.718679 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
drop view if exists "postgres"."dbt"."stg_currency__dbt_backup" cascade
[0m15:13:21.723119 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:21.725492 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (execute): 2024-09-01 15:13:21.665940 => 2024-09-01 15:13:21.725433
[0m15:13:21.726673 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: Close
[0m15:13:21.728230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f3ad60>]}
[0m15:13:21.729616 [info ] [Thread-1  ]: 6 of 45 OK created sql view model dbt.stg_currency ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:13:21.731083 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency
[0m15:13:21.732552 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_rate
[0m15:13:21.733823 [info ] [Thread-1  ]: 7 of 45 START sql view model dbt.stg_currency_rate ............................. [RUN]
[0m15:13:21.735806 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_rate'
[0m15:13:21.737120 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_rate
[0m15:13:21.749918 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.751263 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: BEGIN
[0m15:13:21.752472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:21.760197 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:21.761805 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.762996 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.769794 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.781213 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.782570 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.786041 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.799374 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.808041 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (compile): 2024-09-01 15:13:21.738110 => 2024-09-01 15:13:21.807854
[0m15:13:21.809420 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_rate
[0m15:13:21.822088 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.830308 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.831094 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_rate__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end

    FROM "postgres"."dbt"."source_currency_rate"
),

derived_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    id AS CURRENCY_RATE_KEY,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CURRENCY_RATE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_end AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_start AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(relation_to_rur AS VARCHAR))), ''), '^^')
    )), 'hex') AS CURRENCY_RATE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,
    CURRENCY_RATE_PK,
    CURRENCY_RATE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:21.833336 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:21.838483 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.839641 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate" rename to "stg_currency_rate__dbt_backup"
[0m15:13:21.841235 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.846151 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.847314 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate__dbt_tmp" rename to "stg_currency_rate"
[0m15:13:21.848865 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.851690 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:13:21.852911 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.853963 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:13:21.856780 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:21.861293 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:13:21.862393 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_rate__dbt_backup" cascade
[0m15:13:21.865955 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:21.868594 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (execute): 2024-09-01 15:13:21.810842 => 2024-09-01 15:13:21.868499
[0m15:13:21.870106 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: Close
[0m15:13:21.871791 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f3de20>]}
[0m15:13:21.873180 [info ] [Thread-1  ]: 7 of 45 OK created sql view model dbt.stg_currency_rate ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m15:13:21.874730 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_rate
[0m15:13:21.876064 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_goods
[0m15:13:21.877395 [info ] [Thread-1  ]: 8 of 45 START sql view model dbt.stg_goods ..................................... [RUN]
[0m15:13:21.878906 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_goods'
[0m15:13:21.879937 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_goods
[0m15:13:21.894151 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.895475 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: BEGIN
[0m15:13:21.896623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:21.905265 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:21.906949 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.908015 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.915380 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.926409 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.927733 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:21.931350 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:21.945572 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.953652 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (compile): 2024-09-01 15:13:21.880664 => 2024-09-01 15:13:21.953541
[0m15:13:21.954505 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_goods
[0m15:13:21.964072 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.972045 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.972770 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

  create view "postgres"."dbt"."stg_goods__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count

    FROM "postgres"."dbt"."source_goods"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    id AS GOOD_KEY,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS GOOD_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(cost_per_unit AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(count AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS GOOD_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,
    GOOD_PK,
    GOOD_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:21.974980 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:21.979903 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.980974 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods" rename to "stg_goods__dbt_backup"
[0m15:13:21.982455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.988418 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.989459 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods__dbt_tmp" rename to "stg_goods"
[0m15:13:21.990863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:21.993702 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:13:21.994646 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:21.995841 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:13:21.998774 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:22.005681 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:13:22.006880 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
drop view if exists "postgres"."dbt"."stg_goods__dbt_backup" cascade
[0m15:13:22.010786 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:22.013108 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (execute): 2024-09-01 15:13:21.955115 => 2024-09-01 15:13:22.013047
[0m15:13:22.014094 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: Close
[0m15:13:22.015588 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1313f2f70>]}
[0m15:13:22.016803 [info ] [Thread-1  ]: 8 of 45 OK created sql view model dbt.stg_goods ................................ [[32mCREATE VIEW[0m in 0.14s]
[0m15:13:22.018348 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_goods
[0m15:13:22.019615 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status
[0m15:13:22.020985 [info ] [Thread-1  ]: 9 of 45 START sql view model dbt.stg_order_status .............................. [RUN]
[0m15:13:22.022525 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status'
[0m15:13:22.023656 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status
[0m15:13:22.036633 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.037956 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: BEGIN
[0m15:13:22.038982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:22.046783 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:22.048248 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.049583 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.057464 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:22.067707 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.068974 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.072543 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:13:22.083797 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.091900 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (compile): 2024-09-01 15:13:22.024533 => 2024-09-01 15:13:22.091786
[0m15:13:22.092749 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status
[0m15:13:22.102396 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.110037 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.110781 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

  create view "postgres"."dbt"."stg_order_status__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_order_status"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS ORDER_STATUS_KEY,
    'CSV_ORDER_STATUS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_PK,
    ORDER_STATUS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:22.112854 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:22.117778 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.118866 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status" rename to "stg_order_status__dbt_backup"
[0m15:13:22.120309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.125836 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.126992 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status__dbt_tmp" rename to "stg_order_status"
[0m15:13:22.128470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.131270 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:13:22.132372 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.133400 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:13:22.137454 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:22.142199 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:13:22.143388 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
drop view if exists "postgres"."dbt"."stg_order_status__dbt_backup" cascade
[0m15:13:22.147014 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:22.149337 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (execute): 2024-09-01 15:13:22.093360 => 2024-09-01 15:13:22.149273
[0m15:13:22.150454 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: Close
[0m15:13:22.152337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f3de20>]}
[0m15:13:22.153584 [info ] [Thread-1  ]: 9 of 45 OK created sql view model dbt.stg_order_status ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:13:22.155135 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status
[0m15:13:22.156557 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_history
[0m15:13:22.157608 [info ] [Thread-1  ]: 10 of 45 START sql view model dbt.stg_order_status_history ..................... [RUN]
[0m15:13:22.159245 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_history'
[0m15:13:22.160363 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_history
[0m15:13:22.174470 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.175669 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: BEGIN
[0m15:13:22.176687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:22.184496 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:22.185810 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.186879 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.193880 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:22.204592 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.205810 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.209273 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:22.219670 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.228185 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (compile): 2024-09-01 15:13:22.161217 => 2024-09-01 15:13:22.228077
[0m15:13:22.229299 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_history
[0m15:13:22.238934 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.246996 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.247757 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_history__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id

    FROM "postgres"."dbt"."source_order_status_history"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    id AS ORDER_STATUS_HISTORY_KEY,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_HISTORY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(status_datetime AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HISTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_HISTORY_PK,
    ORDER_STATUS_HISTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:22.250002 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:22.254980 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.256158 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history" rename to "stg_order_status_history__dbt_backup"
[0m15:13:22.257800 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.263834 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.264964 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history__dbt_tmp" rename to "stg_order_status_history"
[0m15:13:22.266309 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.268971 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:13:22.269906 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.270836 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:13:22.273432 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:22.278024 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:13:22.278903 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_status_history__dbt_backup" cascade
[0m15:13:22.282679 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:22.284665 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (execute): 2024-09-01 15:13:22.229964 => 2024-09-01 15:13:22.284608
[0m15:13:22.285501 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: Close
[0m15:13:22.286849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1313f27f0>]}
[0m15:13:22.288096 [info ] [Thread-1  ]: 10 of 45 OK created sql view model dbt.stg_order_status_history ................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:13:22.289454 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_history
[0m15:13:22.290954 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:13:22.292268 [info ] [Thread-1  ]: 11 of 45 START sql view model dbt.stg_order_with_delay ......................... [RUN]
[0m15:13:22.293735 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay'
[0m15:13:22.294814 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay
[0m15:13:22.307614 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.308623 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: BEGIN
[0m15:13:22.309516 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:22.317168 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:22.318702 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.319839 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.327435 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:13:22.337981 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.339194 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.342579 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:13:22.392421 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.400818 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (compile): 2024-09-01 15:13:22.295509 => 2024-09-01 15:13:22.400698
[0m15:13:22.401934 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_with_delay
[0m15:13:22.411645 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.419863 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.420654 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

  create view "postgres"."dbt"."stg_order_with_delay__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    reason_for_delay

    FROM "postgres"."dbt"."source_order_with_delay"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    id AS ORDER_WITH_DELAY_KEY,
    'CSV_ORDER_WITH_DELAY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_WITH_DELAY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(reason_for_delay AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_WITH_DELAY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,
    ORDER_WITH_DELAY_PK,
    ORDER_WITH_DELAY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:22.422724 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:22.427680 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.428615 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
alter table "postgres"."dbt"."stg_order_with_delay" rename to "stg_order_with_delay__dbt_backup"
[0m15:13:22.430064 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.435396 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.436691 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
alter table "postgres"."dbt"."stg_order_with_delay__dbt_tmp" rename to "stg_order_with_delay"
[0m15:13:22.438323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.441106 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:13:22.442254 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.443220 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:13:22.446604 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:22.451244 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:13:22.452407 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
drop view if exists "postgres"."dbt"."stg_order_with_delay__dbt_backup" cascade
[0m15:13:22.456436 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:22.458657 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (execute): 2024-09-01 15:13:22.402747 => 2024-09-01 15:13:22.458599
[0m15:13:22.459680 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: Close
[0m15:13:22.461332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131004f70>]}
[0m15:13:22.462715 [info ] [Thread-1  ]: 11 of 45 OK created sql view model dbt.stg_order_with_delay .................... [[32mCREATE VIEW[0m in 0.17s]
[0m15:13:22.464294 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:13:22.465413 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_orders
[0m15:13:22.466534 [info ] [Thread-1  ]: 12 of 45 START sql view model dbt.stg_orders ................................... [RUN]
[0m15:13:22.468302 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_orders'
[0m15:13:22.469423 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_orders
[0m15:13:22.483578 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.484891 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: BEGIN
[0m15:13:22.486001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:22.493738 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:22.495354 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.496424 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.503431 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:13:22.514442 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.515582 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.519020 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:13:22.535088 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.543820 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (compile): 2024-09-01 15:13:22.470392 => 2024-09-01 15:13:22.543693
[0m15:13:22.545298 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_orders
[0m15:13:22.554978 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.564462 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.565436 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

  create view "postgres"."dbt"."stg_orders__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code

    FROM "postgres"."dbt"."source_orders"
),

derived_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    id AS ORDER_KEY,
    'CSV_ORDERS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(height AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(length AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(weight AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(width AS VARCHAR))), ''), '^^')
    )), 'hex') AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,
    ORDER_PK,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:22.568149 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:22.574270 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.575408 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
alter table "postgres"."dbt"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:13:22.576876 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.581887 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.582935 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
alter table "postgres"."dbt"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:13:22.584452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.587236 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:13:22.588180 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.589075 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:13:22.592544 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:22.597203 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:13:22.598176 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
drop view if exists "postgres"."dbt"."stg_orders__dbt_backup" cascade
[0m15:13:22.601184 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:22.603395 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (execute): 2024-09-01 15:13:22.546132 => 2024-09-01 15:13:22.603236
[0m15:13:22.604428 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: Close
[0m15:13:22.605986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1310d65b0>]}
[0m15:13:22.607269 [info ] [Thread-1  ]: 12 of 45 OK created sql view model dbt.stg_orders .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:13:22.608750 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_orders
[0m15:13:22.609894 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse
[0m15:13:22.611354 [info ] [Thread-1  ]: 13 of 45 START sql view model dbt.stg_warehouse ................................ [RUN]
[0m15:13:22.613063 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse'
[0m15:13:22.614041 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse
[0m15:13:22.629319 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.630510 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: BEGIN
[0m15:13:22.631577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:22.639459 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:22.640924 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.641963 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.649540 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:13:22.661937 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.663053 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.666421 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:13:22.678483 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.686136 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (compile): 2024-09-01 15:13:22.614871 => 2024-09-01 15:13:22.686011
[0m15:13:22.686975 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse
[0m15:13:22.696179 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.705281 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.706135 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

  create view "postgres"."dbt"."stg_warehouse__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    system_name

    FROM "postgres"."dbt"."source_warehouse"
),

derived_columns AS (

    SELECT

    id,
    name,
    system_name,
    id AS WAREHOUSE_KEY,
    'CSV_WAREHOUSE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(system_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PK,
    WAREHOUSE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:22.708271 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:22.713508 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.714697 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
alter table "postgres"."dbt"."stg_warehouse" rename to "stg_warehouse__dbt_backup"
[0m15:13:22.716251 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.721211 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.722456 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
alter table "postgres"."dbt"."stg_warehouse__dbt_tmp" rename to "stg_warehouse"
[0m15:13:22.724115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.727163 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:13:22.728239 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.729295 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:13:22.733346 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:22.738496 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:13:22.739408 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
drop view if exists "postgres"."dbt"."stg_warehouse__dbt_backup" cascade
[0m15:13:22.742808 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:22.745008 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (execute): 2024-09-01 15:13:22.687614 => 2024-09-01 15:13:22.744950
[0m15:13:22.745958 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: Close
[0m15:13:22.747353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13108f400>]}
[0m15:13:22.748456 [info ] [Thread-1  ]: 13 of 45 OK created sql view model dbt.stg_warehouse ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:13:22.749846 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse
[0m15:13:22.751130 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:13:22.752410 [info ] [Thread-1  ]: 14 of 45 START sql view model dbt.stg_warehouse_address ........................ [RUN]
[0m15:13:22.753990 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address'
[0m15:13:22.755107 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address
[0m15:13:22.769247 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.770539 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: BEGIN
[0m15:13:22.771595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:22.779434 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:22.780947 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.782089 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.789489 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:22.800172 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.801517 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.805053 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:22.818585 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.827412 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (compile): 2024-09-01 15:13:22.755919 => 2024-09-01 15:13:22.827219
[0m15:13:22.828790 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address
[0m15:13:22.838678 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.848826 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.849572 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

  create view "postgres"."dbt"."stg_warehouse_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house

    FROM "postgres"."dbt"."source_warehouse_address"
),

derived_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    id AS WAREHOUSE_ADDRESS_KEY,
    'CSV_WAREHOUSE_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_ADDRESS_PK,
    WAREHOUSE_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:22.851913 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:22.858403 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.859733 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
alter table "postgres"."dbt"."stg_warehouse_address" rename to "stg_warehouse_address__dbt_backup"
[0m15:13:22.861395 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.866665 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.867926 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
alter table "postgres"."dbt"."stg_warehouse_address__dbt_tmp" rename to "stg_warehouse_address"
[0m15:13:22.869484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:22.872472 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:13:22.873605 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.874635 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:13:22.877259 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:22.881738 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:13:22.882786 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address__dbt_backup" cascade
[0m15:13:22.886392 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:22.888574 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (execute): 2024-09-01 15:13:22.829709 => 2024-09-01 15:13:22.888516
[0m15:13:22.889476 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: Close
[0m15:13:22.890892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1310f08e0>]}
[0m15:13:22.892203 [info ] [Thread-1  ]: 14 of 45 OK created sql view model dbt.stg_warehouse_address ................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:13:22.893441 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:13:22.894822 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:13:22.896438 [info ] [Thread-1  ]: 15 of 45 START sql view model dbt.stg_warehouse_params ......................... [RUN]
[0m15:13:22.897998 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_params'
[0m15:13:22.899185 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_params
[0m15:13:22.912068 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:22.913178 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: BEGIN
[0m15:13:22.914329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:22.922108 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:22.923519 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:22.924671 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.932582 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:22.944141 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:22.945300 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:22.948731 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:13:22.960968 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:22.968875 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (compile): 2024-09-01 15:13:22.900122 => 2024-09-01 15:13:22.968753
[0m15:13:22.969744 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_params
[0m15:13:22.979621 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:22.987445 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:22.988214 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_params__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume

    FROM "postgres"."dbt"."source_warehouse_params"
),

derived_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    id AS WAREHOUSE_PARAMS_KEY,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PARAMS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_volume AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_weight AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_PARAMS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PARAMS_PK,
    WAREHOUSE_PARAMS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:13:22.990473 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:22.996005 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:22.997340 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_params" rename to "stg_warehouse_params__dbt_backup"
[0m15:13:22.999120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.004747 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:23.005815 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_params__dbt_tmp" rename to "stg_warehouse_params"
[0m15:13:23.007376 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.010262 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:13:23.011385 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:23.012565 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:13:23.016367 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.022584 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:13:23.023745 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_params__dbt_backup" cascade
[0m15:13:23.026762 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.028986 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (execute): 2024-09-01 15:13:22.970522 => 2024-09-01 15:13:23.028926
[0m15:13:23.030081 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: Close
[0m15:13:23.031808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13266bc10>]}
[0m15:13:23.033069 [info ] [Thread-1  ]: 15 of 45 OK created sql view model dbt.stg_warehouse_params .................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:13:23.034489 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:13:23.036016 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_city
[0m15:13:23.037439 [info ] [Thread-1  ]: 16 of 45 START sql view model dbt.stg_client_address_city ...................... [RUN]
[0m15:13:23.039182 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_city'
[0m15:13:23.040429 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_city
[0m15:13:23.046159 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:13:23.053928 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (compile): 2024-09-01 15:13:23.041528 => 2024-09-01 15:13:23.053822
[0m15:13:23.054721 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_city
[0m15:13:23.063768 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:13:23.071304 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:13:23.072161 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: BEGIN
[0m15:13:23.073063 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.080458 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.081701 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:13:23.082922 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */

  create view "postgres"."dbt"."stg_client_address_city__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, id from "postgres"."dbt"."stg_city"
),

stg_client_address as (
    select CLIENT_ADDRESS_KEY, CLIENT_ADDRESS_PK, city_id::bigint AS city_id from "postgres"."dbt"."stg_client_address"
)

select  CLIENT_ADDRESS_KEY, CITY_KEY, CLIENT_ADDRESS_PK, CITY_PK from stg_city sc
JOIN stg_client_address sca ON sc.id = sca.city_id
  );
[0m15:13:23.086383 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.092764 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:13:23.094017 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */
alter table "postgres"."dbt"."stg_client_address_city__dbt_tmp" rename to "stg_client_address_city"
[0m15:13:23.095466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.097995 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: COMMIT
[0m15:13:23.098943 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:13:23.099819 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: COMMIT
[0m15:13:23.102257 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.106749 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:13:23.107780 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */
drop view if exists "postgres"."dbt"."stg_client_address_city__dbt_backup" cascade
[0m15:13:23.109102 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.111485 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (execute): 2024-09-01 15:13:23.055336 => 2024-09-01 15:13:23.111413
[0m15:13:23.112635 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: Close
[0m15:13:23.114170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131324250>]}
[0m15:13:23.115371 [info ] [Thread-1  ]: 16 of 45 OK created sql view model dbt.stg_client_address_city ................. [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:23.116742 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_city
[0m15:13:23.118138 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_client
[0m15:13:23.119753 [info ] [Thread-1  ]: 17 of 45 START sql view model dbt.stg_client_address_client .................... [RUN]
[0m15:13:23.121840 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_client'
[0m15:13:23.123046 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_client
[0m15:13:23.128726 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:13:23.135654 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_client (compile): 2024-09-01 15:13:23.124221 => 2024-09-01 15:13:23.135528
[0m15:13:23.136506 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_client
[0m15:13:23.148238 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:13:23.156834 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:13:23.157825 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: BEGIN
[0m15:13:23.158622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.166066 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.167501 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:13:23.168653 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */

  create view "postgres"."dbt"."stg_client_address_client__dbt_tmp" as (
    with stg_client as (
    select CLIENT_KEY, CLIENT_PK, client_address_id from "postgres"."dbt"."stg_client"
),

stg_client_address as (
    select CLIENT_ADDRESS_KEY, CLIENT_ADDRESS_PK, id::bigint AS id from "postgres"."dbt"."stg_client_address"
)

select  CLIENT_ADDRESS_KEY, CLIENT_KEY, CLIENT_ADDRESS_PK, CLIENT_PK from stg_client sc
JOIN stg_client_address sca ON sca.id = sc.client_address_id
  );
[0m15:13:23.171456 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.177033 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:13:23.178227 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */
alter table "postgres"."dbt"."stg_client_address_client__dbt_tmp" rename to "stg_client_address_client"
[0m15:13:23.179733 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.182458 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: COMMIT
[0m15:13:23.183587 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:13:23.184578 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: COMMIT
[0m15:13:23.187030 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.191218 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:13:23.192199 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */
drop view if exists "postgres"."dbt"."stg_client_address_client__dbt_backup" cascade
[0m15:13:23.193540 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.195692 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_client (execute): 2024-09-01 15:13:23.137124 => 2024-09-01 15:13:23.195635
[0m15:13:23.196729 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: Close
[0m15:13:23.198210 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1310e2fa0>]}
[0m15:13:23.199632 [info ] [Thread-1  ]: 17 of 45 OK created sql view model dbt.stg_client_address_client ............... [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:23.201134 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_client
[0m15:13:23.202498 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_client_type
[0m15:13:23.204044 [info ] [Thread-1  ]: 18 of 45 START sql view model dbt.stg_client_client_type ....................... [RUN]
[0m15:13:23.205856 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_client_type'
[0m15:13:23.207384 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_client_type
[0m15:13:23.213482 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_client_type"
[0m15:13:23.221439 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_client_type (compile): 2024-09-01 15:13:23.208396 => 2024-09-01 15:13:23.221329
[0m15:13:23.222341 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_client_type
[0m15:13:23.231595 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_client_type"
[0m15:13:23.239642 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:13:23.240565 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: BEGIN
[0m15:13:23.241344 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.248733 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.250255 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:13:23.251318 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */

  create view "postgres"."dbt"."stg_client_client_type__dbt_tmp" as (
    with stg_client_type as (
    select CLIENT_TYPE_KEY, CLIENT_TYPE_PK, id from "postgres"."dbt"."stg_client_type"
),

stg_client as (
    select CLIENT_KEY, CLIENT_PK, type_id from "postgres"."dbt"."stg_client"
)

select  CLIENT_TYPE_KEY, CLIENT_KEY, CLIENT_TYPE_PK, CLIENT_PK from stg_client_type ct
JOIN stg_client sc ON sc.type_id = ct.id
  );
[0m15:13:23.254552 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.261863 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:13:23.262724 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */
alter table "postgres"."dbt"."stg_client_client_type__dbt_tmp" rename to "stg_client_client_type"
[0m15:13:23.263845 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.266863 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: COMMIT
[0m15:13:23.267784 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:13:23.268663 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: COMMIT
[0m15:13:23.280912 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.285630 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:13:23.286883 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_client_type__dbt_backup" cascade
[0m15:13:23.288213 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.290749 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_client_type (execute): 2024-09-01 15:13:23.222966 => 2024-09-01 15:13:23.290669
[0m15:13:23.292237 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: Close
[0m15:13:23.293966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13131e790>]}
[0m15:13:23.295369 [info ] [Thread-1  ]: 18 of 45 OK created sql view model dbt.stg_client_client_type .................. [[32mCREATE VIEW[0m in 0.09s]
[0m15:13:23.296876 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_client_type
[0m15:13:23.298093 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city_country
[0m15:13:23.299136 [info ] [Thread-1  ]: 19 of 45 START sql view model dbt.stg_city_country ............................. [RUN]
[0m15:13:23.300768 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city_country'
[0m15:13:23.301814 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city_country
[0m15:13:23.308196 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city_country"
[0m15:13:23.316648 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (compile): 2024-09-01 15:13:23.302659 => 2024-09-01 15:13:23.316536
[0m15:13:23.317645 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city_country
[0m15:13:23.327268 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city_country"
[0m15:13:23.335765 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:13:23.336633 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: BEGIN
[0m15:13:23.337303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.344807 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.346305 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:13:23.347436 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */

  create view "postgres"."dbt"."stg_city_country__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, country_id from "postgres"."dbt"."stg_city"
),

stg_country as (
    select id, COUNTRY_KEY, COUNTRY_PK from "postgres"."dbt"."stg_country"
)

select  CITY_KEY, COUNTRY_KEY, CITY_PK, COUNTRY_PK from stg_city sci
JOIN stg_country sc ON sc.id = sci.country_id
  );
[0m15:13:23.350090 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.356031 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:13:23.357187 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
alter table "postgres"."dbt"."stg_city_country__dbt_tmp" rename to "stg_city_country"
[0m15:13:23.358585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.360953 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:13:23.361777 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:13:23.362705 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:13:23.365253 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.370682 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:13:23.371906 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
drop view if exists "postgres"."dbt"."stg_city_country__dbt_backup" cascade
[0m15:13:23.373305 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.375454 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (execute): 2024-09-01 15:13:23.318282 => 2024-09-01 15:13:23.375397
[0m15:13:23.376556 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: Close
[0m15:13:23.377962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1310e2fa0>]}
[0m15:13:23.379205 [info ] [Thread-1  ]: 19 of 45 OK created sql view model dbt.stg_city_country ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:23.380572 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city_country
[0m15:13:23.381709 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:13:23.382949 [info ] [Thread-1  ]: 20 of 45 START sql view model dbt.stg_currency_currency_rate ................... [RUN]
[0m15:13:23.384626 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_currency_rate'
[0m15:13:23.385690 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:13:23.390950 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:13:23.398603 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (compile): 2024-09-01 15:13:23.386478 => 2024-09-01 15:13:23.398469
[0m15:13:23.399427 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:13:23.408532 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:13:23.416426 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:13:23.417201 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: BEGIN
[0m15:13:23.417860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.425480 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.426951 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:13:23.428322 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" as (
    with stg_currency as (
    select code, CURRENCY_KEY, CURRENCY_PK from "postgres"."dbt"."stg_currency"
),

stg_currency_rate as (
    select currency_code, CURRENCY_RATE_KEY, CURRENCY_RATE_PK from "postgres"."dbt"."stg_currency_rate"
)

select  CURRENCY_KEY, CURRENCY_RATE_KEY, CURRENCY_PK, CURRENCY_RATE_PK from stg_currency sc
JOIN stg_currency_rate scr ON sc.code = scr.currency_code
  );
[0m15:13:23.431535 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.436716 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:13:23.437774 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" rename to "stg_currency_currency_rate"
[0m15:13:23.439212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.441919 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:13:23.442916 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:13:23.443874 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:13:23.446700 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.450883 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:13:23.451948 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_currency_rate__dbt_backup" cascade
[0m15:13:23.453350 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.455462 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (execute): 2024-09-01 15:13:23.400038 => 2024-09-01 15:13:23.455405
[0m15:13:23.456320 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: Close
[0m15:13:23.457709 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13266bc10>]}
[0m15:13:23.459838 [info ] [Thread-1  ]: 20 of 45 OK created sql view model dbt.stg_currency_currency_rate .............. [[32mCREATE VIEW[0m in 0.07s]
[0m15:13:23.461204 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:13:23.462652 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:13:23.463962 [info ] [Thread-1  ]: 21 of 45 START sql view model dbt.stg_order_status_order_status_history ........ [RUN]
[0m15:13:23.465760 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_order_status_history'
[0m15:13:23.466942 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:13:23.473916 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:13:23.481410 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_order_status_history (compile): 2024-09-01 15:13:23.468035 => 2024-09-01 15:13:23.481302
[0m15:13:23.482267 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:13:23.528985 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:13:23.537839 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:13:23.538677 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: BEGIN
[0m15:13:23.539324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.547259 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.548779 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:13:23.550162 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_order_status_history__dbt_tmp" as (
    with stg_order_status as (
    select ORDER_STATUS_KEY, ORDER_STATUS_PK, id from "postgres"."dbt"."stg_order_status"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, status_id from "postgres"."dbt"."stg_order_status_history"
)

select  ORDER_STATUS_KEY, ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_PK, ORDER_STATUS_HISTORY_PK from stg_order_status os
JOIN stg_order_status_history sh ON sh.status_id = os.id
  );
[0m15:13:23.553578 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.559965 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:13:23.561155 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_order_status_history__dbt_tmp" rename to "stg_order_status_order_status_history"
[0m15:13:23.562620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.565289 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: COMMIT
[0m15:13:23.566258 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:13:23.567097 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: COMMIT
[0m15:13:23.570493 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.575077 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:13:23.576184 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_status_order_status_history__dbt_backup" cascade
[0m15:13:23.577508 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.579452 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_order_status_history (execute): 2024-09-01 15:13:23.483002 => 2024-09-01 15:13:23.579396
[0m15:13:23.580364 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: Close
[0m15:13:23.581781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130fa6a60>]}
[0m15:13:23.582779 [info ] [Thread-1  ]: 21 of 45 OK created sql view model dbt.stg_order_status_order_status_history ... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:23.584217 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:13:23.585288 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_client
[0m15:13:23.586424 [info ] [Thread-1  ]: 22 of 45 START sql view model dbt.stg_order_client ............................. [RUN]
[0m15:13:23.588072 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_client'
[0m15:13:23.589089 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_client
[0m15:13:23.595033 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_client"
[0m15:13:23.602035 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_client (compile): 2024-09-01 15:13:23.589907 => 2024-09-01 15:13:23.601924
[0m15:13:23.602873 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_client
[0m15:13:23.612092 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_client"
[0m15:13:23.620138 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:13:23.621065 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: BEGIN
[0m15:13:23.621894 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.629212 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.630688 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:13:23.631911 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */

  create view "postgres"."dbt"."stg_order_client__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, id from "postgres"."dbt"."stg_orders"
),

stg_client as (
    select CLIENT_KEY, CLIENT_PK, order_id::bigint AS order_id from "postgres"."dbt"."stg_client"
)

select  ORDER_KEY, CLIENT_KEY, ORDER_PK, CLIENT_PK from stg_orders o
JOIN stg_client sc ON sc.order_id = o.id
  );
[0m15:13:23.635200 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.641899 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:13:23.643023 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */
alter table "postgres"."dbt"."stg_order_client__dbt_tmp" rename to "stg_order_client"
[0m15:13:23.644722 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.647451 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: COMMIT
[0m15:13:23.648362 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:13:23.649208 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: COMMIT
[0m15:13:23.651916 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.656590 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:13:23.657817 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */
drop view if exists "postgres"."dbt"."stg_order_client__dbt_backup" cascade
[0m15:13:23.659237 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.661322 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_client (execute): 2024-09-01 15:13:23.603570 => 2024-09-01 15:13:23.661260
[0m15:13:23.662478 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: Close
[0m15:13:23.664007 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131147a00>]}
[0m15:13:23.665236 [info ] [Thread-1  ]: 22 of 45 OK created sql view model dbt.stg_order_client ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:23.666661 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_client
[0m15:13:23.668015 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_currency
[0m15:13:23.669416 [info ] [Thread-1  ]: 23 of 45 START sql view model dbt.stg_order_currency ........................... [RUN]
[0m15:13:23.671002 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_currency'
[0m15:13:23.671935 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_currency
[0m15:13:23.677213 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_currency"
[0m15:13:23.684616 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_currency (compile): 2024-09-01 15:13:23.672717 => 2024-09-01 15:13:23.684496
[0m15:13:23.685465 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_currency
[0m15:13:23.694762 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_currency"
[0m15:13:23.703044 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:13:23.704005 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: BEGIN
[0m15:13:23.704856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.712360 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.713830 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:13:23.715074 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */

  create view "postgres"."dbt"."stg_order_currency__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, currency_code from "postgres"."dbt"."stg_orders"
),

stg_currency as (
    select code, CURRENCY_KEY, CURRENCY_PK from "postgres"."dbt"."stg_currency"
)

select  ORDER_KEY, CURRENCY_KEY, ORDER_PK, CURRENCY_PK from stg_orders o
JOIN stg_currency sc ON sc.code = o.currency_code
  );
[0m15:13:23.718124 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.723543 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:13:23.724703 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */
alter table "postgres"."dbt"."stg_order_currency__dbt_tmp" rename to "stg_order_currency"
[0m15:13:23.726245 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.728789 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: COMMIT
[0m15:13:23.729739 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:13:23.730608 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: COMMIT
[0m15:13:23.733883 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.740657 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:13:23.741914 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */
drop view if exists "postgres"."dbt"."stg_order_currency__dbt_backup" cascade
[0m15:13:23.743342 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.745652 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_currency (execute): 2024-09-01 15:13:23.686118 => 2024-09-01 15:13:23.745582
[0m15:13:23.746740 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: Close
[0m15:13:23.748351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1306c3d90>]}
[0m15:13:23.749638 [info ] [Thread-1  ]: 23 of 45 OK created sql view model dbt.stg_order_currency ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:23.751003 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_currency
[0m15:13:23.752472 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_goods
[0m15:13:23.753924 [info ] [Thread-1  ]: 24 of 45 START sql view model dbt.stg_order_goods .............................. [RUN]
[0m15:13:23.755834 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_goods'
[0m15:13:23.757088 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_goods
[0m15:13:23.762770 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_goods"
[0m15:13:23.770468 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_goods (compile): 2024-09-01 15:13:23.758067 => 2024-09-01 15:13:23.770340
[0m15:13:23.771806 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_goods
[0m15:13:23.781367 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_goods"
[0m15:13:23.789957 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:13:23.790677 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: BEGIN
[0m15:13:23.791318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:23.798983 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:23.800312 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:13:23.801200 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */

  create view "postgres"."dbt"."stg_order_goods__dbt_tmp" as (
    with stg_orders as (
    select id, ORDER_KEY, ORDER_PK from "postgres"."dbt"."stg_orders"
),

stg_goods as (
    select GOOD_KEY, GOOD_PK, order_id::bigint AS order_id from "postgres"."dbt"."stg_goods"
)

select  ORDER_KEY, GOOD_KEY, ORDER_PK, GOOD_PK from stg_orders o
JOIN stg_goods g ON g.order_id = o.id
  );
[0m15:13:23.804149 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:23.809311 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:13:23.810415 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */
alter table "postgres"."dbt"."stg_order_goods__dbt_tmp" rename to "stg_order_goods"
[0m15:13:23.811984 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:23.814636 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: COMMIT
[0m15:13:23.815723 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:13:23.816705 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: COMMIT
[0m15:13:23.819876 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:23.825320 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:13:23.826741 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */
drop view if exists "postgres"."dbt"."stg_order_goods__dbt_backup" cascade
[0m15:13:23.828079 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:23.830144 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_goods (execute): 2024-09-01 15:13:23.772689 => 2024-09-01 15:13:23.830088
[0m15:13:23.831079 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: Close
[0m15:13:23.832521 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f33220>]}
[0m15:13:24.690598 [info ] [Thread-1  ]: 24 of 45 OK created sql view model dbt.stg_order_goods ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:24.692190 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_goods
[0m15:13:24.693648 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:13:24.695101 [info ] [Thread-1  ]: 25 of 45 START sql view model dbt.stg_order_order_status_history ............... [RUN]
[0m15:13:24.696808 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_order_status_history'
[0m15:13:24.697976 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:13:24.705021 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:13:24.712503 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_order_status_history (compile): 2024-09-01 15:13:24.698994 => 2024-09-01 15:13:24.712390
[0m15:13:24.713365 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:13:24.722750 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:13:24.730566 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:13:24.731277 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: BEGIN
[0m15:13:24.732073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:24.739755 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:24.741227 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:13:24.742493 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */

  create view "postgres"."dbt"."stg_order_order_status_history__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, id from "postgres"."dbt"."stg_orders"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, order_id from "postgres"."dbt"."stg_order_status_history"
)

select  ORDER_KEY, ORDER_STATUS_HISTORY_KEY, ORDER_PK, ORDER_STATUS_HISTORY_PK from stg_orders o
JOIN stg_order_status_history sh ON sh.order_id = o.id
  );
[0m15:13:24.745894 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:24.752078 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:13:24.753331 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */
alter table "postgres"."dbt"."stg_order_order_status_history__dbt_tmp" rename to "stg_order_order_status_history"
[0m15:13:24.754737 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:24.757374 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: COMMIT
[0m15:13:24.758424 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:13:24.759538 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: COMMIT
[0m15:13:24.762175 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:24.766844 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:13:24.767875 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_order_status_history__dbt_backup" cascade
[0m15:13:24.769225 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:24.771302 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_order_status_history (execute): 2024-09-01 15:13:24.713971 => 2024-09-01 15:13:24.771245
[0m15:13:24.772363 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: Close
[0m15:13:24.773866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1306c3d90>]}
[0m15:13:24.775099 [info ] [Thread-1  ]: 25 of 45 OK created sql view model dbt.stg_order_order_status_history .......... [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:24.776531 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:13:24.778079 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:13:24.779366 [info ] [Thread-1  ]: 26 of 45 START sql view model dbt.stg_order_with_delay_order ................... [RUN]
[0m15:13:24.781130 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay_order'
[0m15:13:24.782415 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:13:24.787860 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:13:24.795250 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay_order (compile): 2024-09-01 15:13:24.783220 => 2024-09-01 15:13:24.795139
[0m15:13:24.796114 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:13:24.806711 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:13:24.817300 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:13:24.818566 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: BEGIN
[0m15:13:24.819611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:24.827498 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:24.829067 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:13:24.830353 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */

  create view "postgres"."dbt"."stg_order_with_delay_order__dbt_tmp" as (
    with stg_order as (
    select id, ORDER_KEY, ORDER_PK from "postgres"."dbt"."stg_orders"
),

stg_order_with_delay as (
    select ORDER_WITH_DELAY_KEY, ORDER_WITH_DELAY_PK, order_id from "postgres"."dbt"."stg_order_with_delay"
)

select  ORDER_KEY, ORDER_WITH_DELAY_KEY, ORDER_PK, ORDER_WITH_DELAY_PK from stg_order o
JOIN stg_order_with_delay od ON o.id = od.order_id
  );
[0m15:13:24.833192 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:24.838373 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:13:24.839471 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */
alter table "postgres"."dbt"."stg_order_with_delay_order__dbt_tmp" rename to "stg_order_with_delay_order"
[0m15:13:24.840852 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:24.843600 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: COMMIT
[0m15:13:24.844596 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:13:24.845574 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: COMMIT
[0m15:13:24.848751 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:24.853312 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:13:24.854362 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */
drop view if exists "postgres"."dbt"."stg_order_with_delay_order__dbt_backup" cascade
[0m15:13:24.855643 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:24.858416 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay_order (execute): 2024-09-01 15:13:24.796712 => 2024-09-01 15:13:24.858353
[0m15:13:24.859629 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: Close
[0m15:13:24.861294 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131425100>]}
[0m15:13:24.862794 [info ] [Thread-1  ]: 26 of 45 OK created sql view model dbt.stg_order_with_delay_order .............. [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:24.864319 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:13:24.866065 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:13:24.867702 [info ] [Thread-1  ]: 27 of 45 START sql view model dbt.stg_warehouse_order_status_history ........... [RUN]
[0m15:13:24.869432 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_order_status_history'
[0m15:13:24.870561 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:13:24.876493 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:13:24.883746 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_order_status_history (compile): 2024-09-01 15:13:24.871436 => 2024-09-01 15:13:24.883628
[0m15:13:24.884661 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:13:24.894240 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:13:24.901683 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:13:24.902616 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: BEGIN
[0m15:13:24.903528 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:24.910905 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:24.912389 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:13:24.913524 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */

  create view "postgres"."dbt"."stg_warehouse_order_status_history__dbt_tmp" as (
    with stg_warehouse as (
    select WAREHOUSE_KEY, WAREHOUSE_PK, id from "postgres"."dbt"."stg_warehouse"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, warehouse_id from "postgres"."dbt"."stg_order_status_history"
)

select  WAREHOUSE_KEY, ORDER_STATUS_HISTORY_KEY, WAREHOUSE_PK, ORDER_STATUS_HISTORY_PK from stg_warehouse w
JOIN stg_order_status_history sh ON sh.warehouse_id = w.id
  );
[0m15:13:24.916323 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:24.923441 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:13:24.924513 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */
alter table "postgres"."dbt"."stg_warehouse_order_status_history__dbt_tmp" rename to "stg_warehouse_order_status_history"
[0m15:13:24.926139 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:24.928729 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: COMMIT
[0m15:13:24.929773 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:13:24.930733 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: COMMIT
[0m15:13:24.933517 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:24.937995 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:13:24.939315 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_warehouse_order_status_history__dbt_backup" cascade
[0m15:13:24.940692 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:24.943022 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_order_status_history (execute): 2024-09-01 15:13:24.885350 => 2024-09-01 15:13:24.942963
[0m15:13:24.944167 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: Close
[0m15:13:24.945740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1306c3d90>]}
[0m15:13:24.947018 [info ] [Thread-1  ]: 27 of 45 OK created sql view model dbt.stg_warehouse_order_status_history ...... [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:24.948439 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:13:24.949859 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:13:24.951338 [info ] [Thread-1  ]: 28 of 45 START sql view model dbt.stg_warehouse_address_city ................... [RUN]
[0m15:13:24.953098 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address_city'
[0m15:13:24.954359 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:13:24.960133 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:13:24.967207 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_city (compile): 2024-09-01 15:13:24.955371 => 2024-09-01 15:13:24.967096
[0m15:13:24.968180 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:13:24.978038 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:13:24.986214 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:13:24.986993 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: BEGIN
[0m15:13:24.987651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:24.994704 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:24.996210 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:13:24.997560 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */

  create view "postgres"."dbt"."stg_warehouse_address_city__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, id from "postgres"."dbt"."stg_city"
),

stg_warehouse_address as (
    select WAREHOUSE_ADDRESS_KEY, WAREHOUSE_ADDRESS_PK, city_id from "postgres"."dbt"."stg_warehouse_address"
)

select  WAREHOUSE_ADDRESS_KEY, CITY_KEY, WAREHOUSE_ADDRESS_PK, CITY_PK from stg_city sc
JOIN stg_warehouse_address swa ON sc.id = swa.city_id
  );
[0m15:13:25.000744 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.006096 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:13:25.007154 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */
alter table "postgres"."dbt"."stg_warehouse_address_city__dbt_tmp" rename to "stg_warehouse_address_city"
[0m15:13:25.008498 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.010954 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: COMMIT
[0m15:13:25.011862 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:13:25.012756 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: COMMIT
[0m15:13:25.015479 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.020997 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:13:25.022095 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address_city__dbt_backup" cascade
[0m15:13:25.023525 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.025617 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_city (execute): 2024-09-01 15:13:24.968975 => 2024-09-01 15:13:25.025559
[0m15:13:25.026639 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: Close
[0m15:13:25.028146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131425580>]}
[0m15:13:25.029660 [info ] [Thread-1  ]: 28 of 45 OK created sql view model dbt.stg_warehouse_address_city .............. [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:25.031317 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:13:25.032862 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:13:25.034300 [info ] [Thread-1  ]: 29 of 45 START sql view model dbt.stg_warehouse_address_warehouse_params ....... [RUN]
[0m15:13:25.035961 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address_warehouse_params'
[0m15:13:25.037192 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:13:25.042846 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:13:25.049685 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_warehouse_params (compile): 2024-09-01 15:13:25.038246 => 2024-09-01 15:13:25.049575
[0m15:13:25.050543 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:13:25.059765 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:13:25.068750 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:13:25.069528 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: BEGIN
[0m15:13:25.070247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.077956 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.079442 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:13:25.080649 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_tmp" as (
    with stg_warehouse_address as (
    select WAREHOUSE_ADDRESS_KEY, WAREHOUSE_ADDRESS_PK, id from "postgres"."dbt"."stg_warehouse_address"
),

stg_warehouse_params as (
    select WAREHOUSE_PARAMS_KEY, WAREHOUSE_PARAMS_PK, address_id from "postgres"."dbt"."stg_warehouse_params"
)

select  WAREHOUSE_ADDRESS_KEY, WAREHOUSE_PARAMS_KEY, WAREHOUSE_ADDRESS_PK, WAREHOUSE_PARAMS_PK from stg_warehouse_address wa
JOIN stg_warehouse_params wp ON wp.address_id = wa.id
  );
[0m15:13:25.083900 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.089481 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:13:25.090341 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_tmp" rename to "stg_warehouse_address_warehouse_params"
[0m15:13:25.091694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.094242 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: COMMIT
[0m15:13:25.095293 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:13:25.096246 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: COMMIT
[0m15:13:25.099251 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.103572 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:13:25.104640 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_backup" cascade
[0m15:13:25.105990 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.108410 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_warehouse_params (execute): 2024-09-01 15:13:25.051176 => 2024-09-01 15:13:25.108351
[0m15:13:25.109644 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: Close
[0m15:13:25.111279 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1306c3d90>]}
[0m15:13:25.112717 [info ] [Thread-1  ]: 29 of 45 OK created sql view model dbt.stg_warehouse_address_warehouse_params .. [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:25.114099 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:13:25.115550 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:13:25.117117 [info ] [Thread-1  ]: 30 of 45 START sql view model dbt.stg_warehouse_warehouse_params ............... [RUN]
[0m15:13:25.118866 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_warehouse_params'
[0m15:13:25.120251 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:13:25.126597 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:13:25.134184 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_warehouse_params (compile): 2024-09-01 15:13:25.121107 => 2024-09-01 15:13:25.134082
[0m15:13:25.135246 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:13:25.146176 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:13:25.155105 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:13:25.156276 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: BEGIN
[0m15:13:25.157172 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.164363 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.165927 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:13:25.167110 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_tmp" as (
    with stg_warehouse as (
    select WAREHOUSE_KEY, WAREHOUSE_PK, id from "postgres"."dbt"."stg_warehouse"
),

stg_warehouse_params as (
    select WAREHOUSE_PARAMS_KEY, WAREHOUSE_PARAMS_PK, warehouse_id from "postgres"."dbt"."stg_warehouse_params"
)

select  WAREHOUSE_KEY, WAREHOUSE_PARAMS_KEY, WAREHOUSE_PK, WAREHOUSE_PARAMS_PK from stg_warehouse w
JOIN stg_warehouse_params wp ON wp.warehouse_id = w.id
  );
[0m15:13:25.169982 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.175972 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:13:25.176991 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_tmp" rename to "stg_warehouse_warehouse_params"
[0m15:13:25.178361 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.180829 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: COMMIT
[0m15:13:25.181902 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:13:25.182809 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: COMMIT
[0m15:13:25.185310 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.189580 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:13:25.190555 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_backup" cascade
[0m15:13:25.191742 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.193798 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_warehouse_params (execute): 2024-09-01 15:13:25.135884 => 2024-09-01 15:13:25.193725
[0m15:13:25.194789 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: Close
[0m15:13:25.196301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131147a00>]}
[0m15:13:25.197506 [info ] [Thread-1  ]: 30 of 45 OK created sql view model dbt.stg_warehouse_warehouse_params .......... [[32mCREATE VIEW[0m in 0.08s]
[0m15:13:25.198750 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:13:25.200153 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:13:25.201588 [info ] [Thread-1  ]: 31 of 45 START sql view model dbt.stg_link_client_address_city ................. [RUN]
[0m15:13:25.203354 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_address_city'
[0m15:13:25.204598 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:13:25.217167 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.218316 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: BEGIN
[0m15:13:25.219239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.226762 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.228155 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.229373 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.237365 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.249470 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.250707 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.254145 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.263842 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.272238 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_city (compile): 2024-09-01 15:13:25.205472 => 2024-09-01 15:13:25.272127
[0m15:13:25.273223 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:13:25.283653 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.291758 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.292610 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

  create view "postgres"."dbt"."stg_link_client_address_city__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk

    FROM "postgres"."dbt"."stg_client_address_city"
),

derived_columns AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    'CSV_CLIENT_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_ADDRESS_CITY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    RECORD_SOURCE,
    LINK_CLIENT_ADDRESS_CITY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:25.295093 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.300559 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.301911 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */
alter table "postgres"."dbt"."stg_link_client_address_city__dbt_tmp" rename to "stg_link_client_address_city"
[0m15:13:25.303516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.306208 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: COMMIT
[0m15:13:25.307305 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.308351 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: COMMIT
[0m15:13:25.311137 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.315696 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:13:25.316967 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */
drop view if exists "postgres"."dbt"."stg_link_client_address_city__dbt_backup" cascade
[0m15:13:25.318383 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.320555 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_city (execute): 2024-09-01 15:13:25.274018 => 2024-09-01 15:13:25.320498
[0m15:13:25.321604 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: Close
[0m15:13:25.323242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1312dbf40>]}
[0m15:13:25.324553 [info ] [Thread-1  ]: 31 of 45 OK created sql view model dbt.stg_link_client_address_city ............ [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:25.326315 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:13:25.328023 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:13:25.329383 [info ] [Thread-1  ]: 32 of 45 START sql view model dbt.stg_link_client_address_client ............... [RUN]
[0m15:13:25.331273 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_address_client'
[0m15:13:25.332435 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:13:25.346755 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.348029 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: BEGIN
[0m15:13:25.348993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.356515 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.358134 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.359275 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.366782 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.376881 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.378042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.381620 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.390966 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.399318 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_client (compile): 2024-09-01 15:13:25.333438 => 2024-09-01 15:13:25.399212
[0m15:13:25.400226 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:13:25.410623 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.418679 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.419578 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

  create view "postgres"."dbt"."stg_link_client_address_client__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk

    FROM "postgres"."dbt"."stg_client_address_client"
),

derived_columns AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_ADDRESS_CLIENT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_CLIENT_ADDRESS_CLIENT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:25.421790 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.427327 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.428615 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */
alter table "postgres"."dbt"."stg_link_client_address_client__dbt_tmp" rename to "stg_link_client_address_client"
[0m15:13:25.431347 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.434087 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: COMMIT
[0m15:13:25.435400 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.436669 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: COMMIT
[0m15:13:25.439835 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.444405 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:13:25.445526 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */
drop view if exists "postgres"."dbt"."stg_link_client_address_client__dbt_backup" cascade
[0m15:13:25.446745 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.448835 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_client (execute): 2024-09-01 15:13:25.400841 => 2024-09-01 15:13:25.448779
[0m15:13:25.449953 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: Close
[0m15:13:25.451545 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe131324190>]}
[0m15:13:25.453086 [info ] [Thread-1  ]: 32 of 45 OK created sql view model dbt.stg_link_client_address_client .......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:25.454720 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:13:25.455662 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:13:25.456811 [info ] [Thread-1  ]: 33 of 45 START sql view model dbt.stg_link_client_client_type .................. [RUN]
[0m15:13:25.458641 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_client_type'
[0m15:13:25.459928 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:13:25.473285 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.474615 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: BEGIN
[0m15:13:25.475729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.483827 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.485451 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.486482 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.493107 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.503382 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.504690 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.508112 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.517663 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.525774 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_client_type (compile): 2024-09-01 15:13:25.460841 => 2024-09-01 15:13:25.525661
[0m15:13:25.526613 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:13:25.537589 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.546386 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.547433 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

  create view "postgres"."dbt"."stg_link_client_client_type__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk

    FROM "postgres"."dbt"."stg_client_client_type"
),

derived_columns AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_TYPE_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_CLIENT_TYPE_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_CLIENT_CLIENT_TYPE_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:25.549628 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.554736 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.555890 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */
alter table "postgres"."dbt"."stg_link_client_client_type__dbt_tmp" rename to "stg_link_client_client_type"
[0m15:13:25.557343 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.559958 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: COMMIT
[0m15:13:25.561113 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.562167 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: COMMIT
[0m15:13:25.566083 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.570334 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:13:25.571446 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */
drop view if exists "postgres"."dbt"."stg_link_client_client_type__dbt_backup" cascade
[0m15:13:25.572675 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.574804 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_client_type (execute): 2024-09-01 15:13:25.527219 => 2024-09-01 15:13:25.574748
[0m15:13:25.575782 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: Close
[0m15:13:25.577377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1312dbf40>]}
[0m15:13:25.578573 [info ] [Thread-1  ]: 33 of 45 OK created sql view model dbt.stg_link_client_client_type ............. [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:25.580104 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:13:25.581478 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_city_country
[0m15:13:25.582606 [info ] [Thread-1  ]: 34 of 45 START sql view model dbt.stg_link_city_country ........................ [RUN]
[0m15:13:25.584073 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_city_country'
[0m15:13:25.585136 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_city_country
[0m15:13:25.598463 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.599810 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: BEGIN
[0m15:13:25.600866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.608922 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.610526 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.611681 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_city_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.619828 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.631523 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.632699 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_city_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.636197 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.647837 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.655566 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_city_country (compile): 2024-09-01 15:13:25.585960 => 2024-09-01 15:13:25.655443
[0m15:13:25.656452 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_city_country
[0m15:13:25.666253 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.674851 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.675684 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

  create view "postgres"."dbt"."stg_link_city_country__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk

    FROM "postgres"."dbt"."stg_city_country"
),

derived_columns AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(COUNTRY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CITY_COUNTRY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    RECORD_SOURCE,
    LINK_CITY_COUNTRY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:25.677805 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.682833 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.684015 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */
alter table "postgres"."dbt"."stg_link_city_country__dbt_tmp" rename to "stg_link_city_country"
[0m15:13:25.685734 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.688653 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: COMMIT
[0m15:13:25.689848 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.690789 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: COMMIT
[0m15:13:25.694350 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.698904 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:13:25.699960 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */
drop view if exists "postgres"."dbt"."stg_link_city_country__dbt_backup" cascade
[0m15:13:25.701189 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.703357 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_city_country (execute): 2024-09-01 15:13:25.657130 => 2024-09-01 15:13:25.703299
[0m15:13:25.704349 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: Close
[0m15:13:25.705839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1313eca30>]}
[0m15:13:25.707015 [info ] [Thread-1  ]: 34 of 45 OK created sql view model dbt.stg_link_city_country ................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:25.708451 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_city_country
[0m15:13:25.709848 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:13:25.711013 [info ] [Thread-1  ]: 35 of 45 START sql view model dbt.stg_link_currency_currency_rate .............. [RUN]
[0m15:13:25.712649 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_currency_currency_rate'
[0m15:13:25.713685 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:13:25.764553 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.765994 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: BEGIN
[0m15:13:25.767218 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.775212 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.776692 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.777922 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_currency_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.785426 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.795646 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.796837 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_currency_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.800201 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.809254 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.820418 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_currency_currency_rate (compile): 2024-09-01 15:13:25.714524 => 2024-09-01 15:13:25.820280
[0m15:13:25.821393 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:13:25.831766 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.840094 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.840971 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

  create view "postgres"."dbt"."stg_link_currency_currency_rate__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk

    FROM "postgres"."dbt"."stg_currency_currency_rate"
),

derived_columns AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_RATE_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CURRENCY_CURRENCY_RATE_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    RECORD_SOURCE,
    LINK_CURRENCY_CURRENCY_RATE_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:25.843371 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.848476 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.849547 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */
alter table "postgres"."dbt"."stg_link_currency_currency_rate__dbt_tmp" rename to "stg_link_currency_currency_rate"
[0m15:13:25.851182 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.853844 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: COMMIT
[0m15:13:25.854906 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.855925 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: COMMIT
[0m15:13:25.860539 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.865883 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:13:25.866924 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_link_currency_currency_rate__dbt_backup" cascade
[0m15:13:25.868353 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.870560 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_currency_currency_rate (execute): 2024-09-01 15:13:25.822136 => 2024-09-01 15:13:25.870504
[0m15:13:25.871646 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: Close
[0m15:13:25.873111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1312b7dc0>]}
[0m15:13:25.874625 [info ] [Thread-1  ]: 35 of 45 OK created sql view model dbt.stg_link_currency_currency_rate ......... [[32mCREATE VIEW[0m in 0.16s]
[0m15:13:25.876321 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:13:25.877674 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:13:25.878860 [info ] [Thread-1  ]: 36 of 45 START sql view model dbt.stg_link_order_status_order_status_history ... [RUN]
[0m15:13:25.880691 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_status_order_status_history'
[0m15:13:25.882134 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:13:25.895485 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.896882 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: BEGIN
[0m15:13:25.897986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:25.905946 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:25.907278 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.908781 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_status_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.915988 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.926139 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.927336 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_status_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:25.930781 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:25.940498 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.948860 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_status_order_status_history (compile): 2024-09-01 15:13:25.883038 => 2024-09-01 15:13:25.948750
[0m15:13:25.949823 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:13:25.961522 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.970520 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.971317 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

  create view "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_order_status_order_status_history"
),

derived_columns AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:25.973475 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:25.978569 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.979711 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */
alter table "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_tmp" rename to "stg_link_order_status_order_status_history"
[0m15:13:25.981355 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:25.984591 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: COMMIT
[0m15:13:25.985906 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.986964 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: COMMIT
[0m15:13:25.990084 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:25.994320 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:13:25.995528 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_backup" cascade
[0m15:13:25.996879 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:25.999370 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_status_order_status_history (execute): 2024-09-01 15:13:25.950609 => 2024-09-01 15:13:25.999312
[0m15:13:26.000647 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: Close
[0m15:13:26.002333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1313f2fd0>]}
[0m15:13:26.003550 [info ] [Thread-1  ]: 36 of 45 OK created sql view model dbt.stg_link_order_status_order_status_history  [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:26.005239 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:13:26.006490 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_client
[0m15:13:26.007687 [info ] [Thread-1  ]: 37 of 45 START sql view model dbt.stg_link_order_client ........................ [RUN]
[0m15:13:26.009445 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_client'
[0m15:13:26.010456 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_client
[0m15:13:26.023702 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.024885 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: BEGIN
[0m15:13:26.025944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:26.033822 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:26.035383 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.036764 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.044215 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.055542 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.056624 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.059953 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.069147 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.077117 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_client (compile): 2024-09-01 15:13:26.011337 => 2024-09-01 15:13:26.076999
[0m15:13:26.077940 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_client
[0m15:13:26.087665 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.096389 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.097239 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

  create view "postgres"."dbt"."stg_link_order_client__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk

    FROM "postgres"."dbt"."stg_order_client"
),

derived_columns AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_CLIENT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_ORDER_CLIENT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:26.099478 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:26.104625 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.105556 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */
alter table "postgres"."dbt"."stg_link_order_client__dbt_tmp" rename to "stg_link_order_client"
[0m15:13:26.107156 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:26.110069 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: COMMIT
[0m15:13:26.111299 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.112412 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: COMMIT
[0m15:13:26.114967 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:26.119167 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:13:26.120217 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */
drop view if exists "postgres"."dbt"."stg_link_order_client__dbt_backup" cascade
[0m15:13:26.121626 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:26.124862 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_client (execute): 2024-09-01 15:13:26.078574 => 2024-09-01 15:13:26.124699
[0m15:13:26.126593 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: Close
[0m15:13:26.128513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe132735400>]}
[0m15:13:26.129899 [info ] [Thread-1  ]: 37 of 45 OK created sql view model dbt.stg_link_order_client ................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:26.131403 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_client
[0m15:13:26.132617 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_currency
[0m15:13:26.133832 [info ] [Thread-1  ]: 38 of 45 START sql view model dbt.stg_link_order_currency ...................... [RUN]
[0m15:13:26.135521 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_currency'
[0m15:13:26.137036 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_currency
[0m15:13:26.151840 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.153087 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: BEGIN
[0m15:13:26.154263 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:26.162563 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:26.163975 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.165181 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.172531 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.182958 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.184223 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.187748 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.197045 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.205292 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_currency (compile): 2024-09-01 15:13:26.138071 => 2024-09-01 15:13:26.205137
[0m15:13:26.206235 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_currency
[0m15:13:26.216210 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.223960 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.224768 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

  create view "postgres"."dbt"."stg_link_order_currency__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk

    FROM "postgres"."dbt"."stg_order_currency"
),

derived_columns AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    'CSV_ORDERS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_CURRENCY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    RECORD_SOURCE,
    LINK_ORDER_CURRENCY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:26.226950 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:26.232010 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.233257 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */
alter table "postgres"."dbt"."stg_link_order_currency__dbt_tmp" rename to "stg_link_order_currency"
[0m15:13:26.234941 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:26.237626 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: COMMIT
[0m15:13:26.238754 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.239732 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: COMMIT
[0m15:13:26.243262 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:26.248865 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:13:26.250259 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */
drop view if exists "postgres"."dbt"."stg_link_order_currency__dbt_backup" cascade
[0m15:13:26.251649 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:26.253914 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_currency (execute): 2024-09-01 15:13:26.206906 => 2024-09-01 15:13:26.253856
[0m15:13:26.255059 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: Close
[0m15:13:26.256602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1312b7dc0>]}
[0m15:13:26.257902 [info ] [Thread-1  ]: 38 of 45 OK created sql view model dbt.stg_link_order_currency ................. [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:26.259543 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_currency
[0m15:13:26.261139 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_goods
[0m15:13:26.262482 [info ] [Thread-1  ]: 39 of 45 START sql view model dbt.stg_link_order_goods ......................... [RUN]
[0m15:13:26.263985 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_goods'
[0m15:13:26.265062 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_goods
[0m15:13:26.278161 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.279541 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: BEGIN
[0m15:13:26.280655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:26.288300 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:26.289994 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.291314 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.298534 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.308668 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.309967 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.313322 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.322739 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.331036 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_goods (compile): 2024-09-01 15:13:26.265884 => 2024-09-01 15:13:26.330919
[0m15:13:26.332069 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_goods
[0m15:13:26.343734 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.351515 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.352300 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

  create view "postgres"."dbt"."stg_link_order_goods__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk

    FROM "postgres"."dbt"."stg_order_goods"
),

derived_columns AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(GOOD_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_GOOD_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    RECORD_SOURCE,
    LINK_ORDER_GOOD_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:26.354459 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:26.359291 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.360490 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */
alter table "postgres"."dbt"."stg_link_order_goods__dbt_tmp" rename to "stg_link_order_goods"
[0m15:13:26.362138 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:26.364679 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: COMMIT
[0m15:13:26.365681 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.366618 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: COMMIT
[0m15:13:26.369329 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:26.374130 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:13:26.375426 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */
drop view if exists "postgres"."dbt"."stg_link_order_goods__dbt_backup" cascade
[0m15:13:26.376730 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:26.378975 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_goods (execute): 2024-09-01 15:13:26.332817 => 2024-09-01 15:13:26.378917
[0m15:13:26.379923 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: Close
[0m15:13:26.381510 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f2f2b0>]}
[0m15:13:26.382666 [info ] [Thread-1  ]: 39 of 45 OK created sql view model dbt.stg_link_order_goods .................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:26.384071 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_goods
[0m15:13:26.385382 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:13:26.386585 [info ] [Thread-1  ]: 40 of 45 START sql view model dbt.stg_link_order_order_status_history .......... [RUN]
[0m15:13:26.388403 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_order_status_history'
[0m15:13:26.389569 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:13:26.401801 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.403021 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: BEGIN
[0m15:13:26.403973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:26.411566 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:26.413192 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.414379 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.422059 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.433276 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.434640 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.438195 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.447443 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.455722 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_order_status_history (compile): 2024-09-01 15:13:26.390389 => 2024-09-01 15:13:26.455610
[0m15:13:26.456555 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:13:26.466454 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.475937 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.476662 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

  create view "postgres"."dbt"."stg_link_order_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_order_order_status_history"
),

derived_columns AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_ORDER_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:26.478805 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:26.483868 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.484995 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */
alter table "postgres"."dbt"."stg_link_order_order_status_history__dbt_tmp" rename to "stg_link_order_order_status_history"
[0m15:13:26.486616 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:26.489199 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: COMMIT
[0m15:13:26.490277 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.491398 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: COMMIT
[0m15:13:26.495117 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:26.499979 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:13:26.501263 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_order_order_status_history__dbt_backup" cascade
[0m15:13:26.502576 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:26.504791 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_order_status_history (execute): 2024-09-01 15:13:26.457170 => 2024-09-01 15:13:26.504734
[0m15:13:26.505836 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: Close
[0m15:13:26.507302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1306f76d0>]}
[0m15:13:26.508445 [info ] [Thread-1  ]: 40 of 45 OK created sql view model dbt.stg_link_order_order_status_history ..... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:26.510059 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:13:26.511792 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:13:26.513256 [info ] [Thread-1  ]: 41 of 45 START sql view model dbt.stg_link_order_with_delay_order .............. [RUN]
[0m15:13:26.515152 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_with_delay_order'
[0m15:13:26.516366 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:13:26.530077 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.531370 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: BEGIN
[0m15:13:26.532479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:26.539987 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:26.541419 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.542765 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_with_delay_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.550052 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.560401 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.561545 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_with_delay_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.564899 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.574475 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.582753 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_with_delay_order (compile): 2024-09-01 15:13:26.517416 => 2024-09-01 15:13:26.582614
[0m15:13:26.583740 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:13:26.593875 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.601997 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.602979 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

  create view "postgres"."dbt"."stg_link_order_with_delay_order__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk

    FROM "postgres"."dbt"."stg_order_with_delay_order"
),

derived_columns AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    'CSV_ORDER_WITH_DELAY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_WITH_DELAY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_WITH_DELAY_ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    RECORD_SOURCE,
    LINK_ORDER_WITH_DELAY_ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:26.605514 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:26.610668 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.611987 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */
alter table "postgres"."dbt"."stg_link_order_with_delay_order__dbt_tmp" rename to "stg_link_order_with_delay_order"
[0m15:13:26.613615 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:26.616196 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: COMMIT
[0m15:13:26.617250 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.618194 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: COMMIT
[0m15:13:26.621509 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:26.626703 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:13:26.627871 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */
drop view if exists "postgres"."dbt"."stg_link_order_with_delay_order__dbt_backup" cascade
[0m15:13:26.629250 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:26.631517 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_with_delay_order (execute): 2024-09-01 15:13:26.584401 => 2024-09-01 15:13:26.631461
[0m15:13:26.632597 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: Close
[0m15:13:26.633982 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe130f2f2b0>]}
[0m15:13:26.635387 [info ] [Thread-1  ]: 41 of 45 OK created sql view model dbt.stg_link_order_with_delay_order ......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:26.637113 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:13:26.638439 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:13:26.639750 [info ] [Thread-1  ]: 42 of 45 START sql view model dbt.stg_link_warehouse_order_status_history ...... [RUN]
[0m15:13:26.641505 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_order_status_history'
[0m15:13:26.642640 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:13:26.655618 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.656885 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: BEGIN
[0m15:13:26.657898 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:26.665849 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:26.667324 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.668495 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.676563 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.686863 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.688123 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.691656 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.701474 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.709583 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_order_status_history (compile): 2024-09-01 15:13:26.643616 => 2024-09-01 15:13:26.709464
[0m15:13:26.710398 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:13:26.721516 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.729545 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.730401 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

  create view "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_warehouse_order_status_history"
),

derived_columns AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:26.732865 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:26.738170 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.739544 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */
alter table "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_tmp" rename to "stg_link_warehouse_order_status_history"
[0m15:13:26.741375 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:26.744391 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: COMMIT
[0m15:13:26.745818 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.747080 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: COMMIT
[0m15:13:26.751577 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:26.756475 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:13:26.757667 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_backup" cascade
[0m15:13:26.758982 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:26.761343 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_order_status_history (execute): 2024-09-01 15:13:26.711053 => 2024-09-01 15:13:26.761281
[0m15:13:26.762608 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: Close
[0m15:13:26.764839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1306f76d0>]}
[0m15:13:26.766407 [info ] [Thread-1  ]: 42 of 45 OK created sql view model dbt.stg_link_warehouse_order_status_history . [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:26.767992 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:13:26.769326 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:13:26.770697 [info ] [Thread-1  ]: 43 of 45 START sql view model dbt.stg_link_warehouse_address_city .............. [RUN]
[0m15:13:26.772806 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_address_city'
[0m15:13:26.774164 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:13:26.788935 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.790262 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: BEGIN
[0m15:13:26.791237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:26.801034 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:26.802469 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.803691 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.814155 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.829833 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.830738 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:26.834439 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:26.919163 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.926934 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_city (compile): 2024-09-01 15:13:26.775416 => 2024-09-01 15:13:26.926805
[0m15:13:26.927932 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:13:26.939736 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.948591 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.949653 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

  create view "postgres"."dbt"."stg_link_warehouse_address_city__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk

    FROM "postgres"."dbt"."stg_warehouse_address_city"
),

derived_columns AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    'CSV_WAREHOUSE_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ADDRESS_CITY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ADDRESS_CITY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:26.952278 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:26.960270 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.962863 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */
alter table "postgres"."dbt"."stg_link_warehouse_address_city__dbt_tmp" rename to "stg_link_warehouse_address_city"
[0m15:13:26.964538 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:26.967321 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: COMMIT
[0m15:13:26.967996 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.968629 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: COMMIT
[0m15:13:26.970814 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:26.975262 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:13:26.975992 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_address_city__dbt_backup" cascade
[0m15:13:26.976822 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:26.978571 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_city (execute): 2024-09-01 15:13:26.928584 => 2024-09-01 15:13:26.978515
[0m15:13:26.979165 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: Close
[0m15:13:26.980258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1306e5eb0>]}
[0m15:13:26.981141 [info ] [Thread-1  ]: 43 of 45 OK created sql view model dbt.stg_link_warehouse_address_city ......... [[32mCREATE VIEW[0m in 0.21s]
[0m15:13:26.982070 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:13:26.982974 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:13:26.983737 [info ] [Thread-1  ]: 44 of 45 START sql view model dbt.stg_link_warehouse_address_warehouse_params .. [RUN]
[0m15:13:26.984952 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params'
[0m15:13:26.985809 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:13:26.999605 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.000473 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: BEGIN
[0m15:13:27.001204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:27.009266 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:27.010279 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.010984 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:27.017462 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:27.027749 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.028665 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:27.031884 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:27.041342 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.049316 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params (compile): 2024-09-01 15:13:26.986386 => 2024-09-01 15:13:27.049213
[0m15:13:27.050152 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:13:27.060685 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.068251 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.069045 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

  create view "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk

    FROM "postgres"."dbt"."stg_warehouse_address_warehouse_params"
),

derived_columns AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_ADDRESS_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_PARAMS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:27.071334 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:27.076158 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.077349 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */
alter table "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_tmp" rename to "stg_link_warehouse_address_warehouse_params"
[0m15:13:27.078890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:27.081608 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: COMMIT
[0m15:13:27.082729 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.083771 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: COMMIT
[0m15:13:27.087740 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:27.092205 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:13:27.094375 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_backup" cascade
[0m15:13:27.095790 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:27.098045 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params (execute): 2024-09-01 15:13:27.050772 => 2024-09-01 15:13:27.097987
[0m15:13:27.099241 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: Close
[0m15:13:27.100792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1313b4880>]}
[0m15:13:27.102194 [info ] [Thread-1  ]: 44 of 45 OK created sql view model dbt.stg_link_warehouse_address_warehouse_params  [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:27.103642 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:13:27.105039 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:13:27.106112 [info ] [Thread-1  ]: 45 of 45 START sql view model dbt.stg_link_warehouse_warehouse_params .......... [RUN]
[0m15:13:27.107721 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_warehouse_params'
[0m15:13:27.108801 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:13:27.122586 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.123780 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: BEGIN
[0m15:13:27.124754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:27.133883 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:13:27.135654 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.137064 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:27.144617 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:27.154985 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.156247 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:13:27.159705 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:13:27.169123 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.177649 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_warehouse_params (compile): 2024-09-01 15:13:27.109694 => 2024-09-01 15:13:27.177537
[0m15:13:27.178490 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:13:27.188419 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.197383 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.198153 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

  create view "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk

    FROM "postgres"."dbt"."stg_warehouse_warehouse_params"
),

derived_columns AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_PARAMS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:13:27.200382 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:13:27.206610 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.207805 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */
alter table "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_tmp" rename to "stg_link_warehouse_warehouse_params"
[0m15:13:27.209412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:13:27.212212 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: COMMIT
[0m15:13:27.213285 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.214201 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: COMMIT
[0m15:13:27.217443 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:13:27.222064 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:13:27.223638 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_backup" cascade
[0m15:13:27.225166 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:13:27.227452 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_warehouse_params (execute): 2024-09-01 15:13:27.179118 => 2024-09-01 15:13:27.227395
[0m15:13:27.228499 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: Close
[0m15:13:27.229905 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d5adb41-7163-4fce-8a0e-7578446ff07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13114d880>]}
[0m15:13:27.231378 [info ] [Thread-1  ]: 45 of 45 OK created sql view model dbt.stg_link_warehouse_warehouse_params ..... [[32mCREATE VIEW[0m in 0.12s]
[0m15:13:27.232991 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:13:27.235768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:13:27.236926 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:27.238002 [debug] [MainThread]: On master: BEGIN
[0m15:13:27.238899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:27.247023 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:13:27.248650 [debug] [MainThread]: On master: COMMIT
[0m15:13:27.249919 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:27.250991 [debug] [MainThread]: On master: COMMIT
[0m15:13:27.252305 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:13:27.253358 [debug] [MainThread]: On master: Close
[0m15:13:27.254668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:27.255464 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.stg_link_warehouse_warehouse_params' was properly closed.
[0m15:13:27.256326 [info ] [MainThread]: 
[0m15:13:27.257319 [info ] [MainThread]: Finished running 45 view models in 0 hours 0 minutes and 6.68 seconds (6.68s).
[0m15:13:27.261241 [debug] [MainThread]: Command end result
[0m15:13:27.294532 [info ] [MainThread]: 
[0m15:13:27.295756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:27.297013 [info ] [MainThread]: 
[0m15:13:27.298394 [info ] [MainThread]: Done. PASS=45 WARN=0 ERROR=0 SKIP=0 TOTAL=45
[0m15:13:27.299861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1313b6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe132785a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1312003a0>]}
[0m15:13:27.301050 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:14:17.939262 | dc96a037-e8ea-4609-acd4-dd94842ba29d ==============================
[0m15:14:17.939262 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:14:17.942212 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:stage'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:14:17.943330 [debug] [MainThread]: Tracking: tracking
[0m15:14:17.949067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc51565bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e585310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e585e50>]}
[0m15:14:21.173504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:14:21.174937 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/stage/stg_order_status_history1.sql
[0m15:14:21.202625 [debug] [MainThread]: 1603: static parser failed on stage/stg_order_status_history1.sql
[0m15:14:21.429578 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_order_status_history1.sql
[0m15:14:21.473266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e45d0d0>]}
[0m15:14:21.522650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e57fc10>]}
[0m15:14:21.523851 [info ] [MainThread]: Found 97 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:14:21.524979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e5857f0>]}
[0m15:14:21.532960 [info ] [MainThread]: 
[0m15:14:21.536253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:21.541363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:14:21.557408 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:14:21.558796 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:14:21.560021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:21.570246 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:14:21.572807 [debug] [ThreadPool]: On list_postgres: Close
[0m15:14:21.583022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:14:21.592421 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:14:21.593719 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:14:21.594890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:21.602669 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:14:21.604166 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:14:21.605548 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:14:21.609424 [debug] [ThreadPool]: SQL status: SELECT 99 in 0 seconds
[0m15:14:21.615014 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:14:21.616280 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:14:21.642906 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:21.644171 [debug] [MainThread]: On master: BEGIN
[0m15:14:21.645405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:21.653278 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:14:21.654742 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:21.655938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:21.703145 [debug] [MainThread]: SQL status: SELECT 60 in 0 seconds
[0m15:14:21.714187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e593280>]}
[0m15:14:21.715754 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:21.717331 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:21.718578 [debug] [MainThread]: On master: BEGIN
[0m15:14:21.720236 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:14:21.721513 [debug] [MainThread]: On master: COMMIT
[0m15:14:21.722540 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:21.723526 [debug] [MainThread]: On master: COMMIT
[0m15:14:21.724607 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:14:21.725549 [debug] [MainThread]: On master: Close
[0m15:14:21.726837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:21.727981 [info ] [MainThread]: 
[0m15:14:21.733981 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city
[0m15:14:21.735386 [info ] [Thread-1  ]: 1 of 46 START sql view model dbt.stg_city ...................................... [RUN]
[0m15:14:21.737348 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city'
[0m15:14:21.738693 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city
[0m15:14:21.757009 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.758255 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: BEGIN
[0m15:14:21.759456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:21.768579 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:21.769975 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.771188 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:21.779692 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:14:21.795811 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.797152 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:21.800699 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:14:21.812022 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city"
[0m15:14:21.820160 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (compile): 2024-09-01 15:14:21.739470 => 2024-09-01 15:14:21.820028
[0m15:14:21.820986 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city
[0m15:14:21.880150 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city"
[0m15:14:21.886297 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.887118 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

  create view "postgres"."dbt"."stg_city__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    country_id

    FROM "postgres"."dbt"."source_city"
),

derived_columns AS (

    SELECT

    id,
    name,
    country_id,
    id AS CITY_KEY,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CITY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CITY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,
    CITY_PK,
    CITY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:21.889404 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:21.898839 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.900144 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city" rename to "stg_city__dbt_backup"
[0m15:14:21.901856 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:21.907877 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.909041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city__dbt_tmp" rename to "stg_city"
[0m15:14:21.910485 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:21.971614 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:14:21.972930 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.973961 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:14:21.976848 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:21.985416 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:14:21.986564 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
drop view if exists "postgres"."dbt"."stg_city__dbt_backup" cascade
[0m15:14:21.990899 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:21.993176 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (execute): 2024-09-01 15:14:21.821678 => 2024-09-01 15:14:21.993099
[0m15:14:21.994163 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: Close
[0m15:14:21.995691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e052610>]}
[0m15:14:21.996927 [info ] [Thread-1  ]: 1 of 46 OK created sql view model dbt.stg_city ................................. [[32mCREATE VIEW[0m in 0.26s]
[0m15:14:21.999936 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city
[0m15:14:22.001314 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client
[0m15:14:22.002577 [info ] [Thread-1  ]: 2 of 46 START sql view model dbt.stg_client .................................... [RUN]
[0m15:14:22.004360 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client'
[0m15:14:22.005553 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client
[0m15:14:22.018253 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.019453 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: BEGIN
[0m15:14:22.020500 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:22.028585 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:22.029987 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.031357 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.039222 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.049723 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.051125 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.054720 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.074940 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client"
[0m15:14:22.083221 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (compile): 2024-09-01 15:14:22.006523 => 2024-09-01 15:14:22.083115
[0m15:14:22.084075 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client
[0m15:14:22.094113 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client"
[0m15:14:22.102747 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.103442 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

  create view "postgres"."dbt"."stg_client__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id

    FROM "postgres"."dbt"."source_client"
),

derived_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CONCAT(
        order_id, '||',
        client_type_code
    ) AS CLIENT_KEY,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS CLIENT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,
    CLIENT_PK,
    CLIENT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:22.105733 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:22.111113 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.112259 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client" rename to "stg_client__dbt_backup"
[0m15:14:22.113776 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.118567 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.119549 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client__dbt_tmp" rename to "stg_client"
[0m15:14:22.120910 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.124151 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:14:22.125257 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.126185 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:14:22.129887 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:22.134521 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:14:22.135450 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
drop view if exists "postgres"."dbt"."stg_client__dbt_backup" cascade
[0m15:14:22.139823 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:22.142229 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (execute): 2024-09-01 15:14:22.084688 => 2024-09-01 15:14:22.142167
[0m15:14:22.143211 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: Close
[0m15:14:22.144584 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e06d4f0>]}
[0m15:14:22.145709 [info ] [Thread-1  ]: 2 of 46 OK created sql view model dbt.stg_client ............................... [[32mCREATE VIEW[0m in 0.14s]
[0m15:14:22.147005 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client
[0m15:14:22.148416 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address
[0m15:14:22.149672 [info ] [Thread-1  ]: 3 of 46 START sql view model dbt.stg_client_address ............................ [RUN]
[0m15:14:22.151643 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address'
[0m15:14:22.152971 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address
[0m15:14:22.166521 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.167751 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: BEGIN
[0m15:14:22.168852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:22.176867 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:22.178355 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.179484 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.186291 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.196742 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.197734 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.201280 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.215820 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.224231 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (compile): 2024-09-01 15:14:22.153837 => 2024-09-01 15:14:22.224127
[0m15:14:22.225000 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address
[0m15:14:22.234876 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.242919 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.243848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

  create view "postgres"."dbt"."stg_client_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid

    FROM "postgres"."dbt"."source_client_address"
),

derived_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    id AS CLIENT_ADDRESS_KEY,
    'CSV_CLIENT_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), ''), '^^')
    ), '^^')), 'hex') AS CLIENT_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(is_valid AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,
    CLIENT_ADDRESS_PK,
    CLIENT_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:22.246078 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:22.252255 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.253529 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
alter table "postgres"."dbt"."stg_client_address" rename to "stg_client_address__dbt_backup"
[0m15:14:22.255236 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.260180 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.261238 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
alter table "postgres"."dbt"."stg_client_address__dbt_tmp" rename to "stg_client_address"
[0m15:14:22.262784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.265902 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:14:22.266928 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.267982 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:14:22.271698 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:22.276127 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:14:22.277229 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
drop view if exists "postgres"."dbt"."stg_client_address__dbt_backup" cascade
[0m15:14:22.280734 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:22.283186 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (execute): 2024-09-01 15:14:22.225632 => 2024-09-01 15:14:22.283125
[0m15:14:22.284312 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: Close
[0m15:14:22.285901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e052370>]}
[0m15:14:22.287166 [info ] [Thread-1  ]: 3 of 46 OK created sql view model dbt.stg_client_address ....................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:22.288752 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address
[0m15:14:22.290218 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_type
[0m15:14:22.291814 [info ] [Thread-1  ]: 4 of 46 START sql view model dbt.stg_client_type ............................... [RUN]
[0m15:14:22.293606 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_type'
[0m15:14:22.294793 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_type
[0m15:14:22.307777 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.309079 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: BEGIN
[0m15:14:22.310353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:22.318314 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:22.319771 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.320960 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.328564 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:22.339679 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.341051 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.344610 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:22.354567 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.362750 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (compile): 2024-09-01 15:14:22.295647 => 2024-09-01 15:14:22.362647
[0m15:14:22.363551 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_type
[0m15:14:22.373470 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.381515 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.382257 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

  create view "postgres"."dbt"."stg_client_type__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_client_type"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS CLIENT_TYPE_KEY,
    'CSV_CLIENT_TYPE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CLIENT_TYPE_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CLIENT_TYPE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,
    CLIENT_TYPE_PK,
    CLIENT_TYPE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:22.384240 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:22.389565 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.390570 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type" rename to "stg_client_type__dbt_backup"
[0m15:14:22.391888 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.396759 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.397990 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type__dbt_tmp" rename to "stg_client_type"
[0m15:14:22.399520 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.402414 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:14:22.403512 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.404440 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:14:22.407583 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:22.413078 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:14:22.414281 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_type__dbt_backup" cascade
[0m15:14:22.417662 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:22.419940 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (execute): 2024-09-01 15:14:22.364153 => 2024-09-01 15:14:22.419880
[0m15:14:22.420989 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: Close
[0m15:14:22.422398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4dd6a850>]}
[0m15:14:22.423476 [info ] [Thread-1  ]: 4 of 46 OK created sql view model dbt.stg_client_type .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:22.424891 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_type
[0m15:14:22.426112 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_country
[0m15:14:22.427357 [info ] [Thread-1  ]: 5 of 46 START sql view model dbt.stg_country ................................... [RUN]
[0m15:14:22.429067 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_country'
[0m15:14:22.430035 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_country
[0m15:14:22.442741 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.444002 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: BEGIN
[0m15:14:22.445109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:22.453044 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:22.454603 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.455862 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.463155 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:22.473195 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.474453 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.477714 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:22.487772 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_country"
[0m15:14:22.495803 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (compile): 2024-09-01 15:14:22.430864 => 2024-09-01 15:14:22.495703
[0m15:14:22.496601 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_country
[0m15:14:22.508703 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_country"
[0m15:14:22.515888 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.516803 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

  create view "postgres"."dbt"."stg_country__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_country"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS COUNTRY_KEY,
    'CSV_COUNTRY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS COUNTRY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS COUNTRY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,
    COUNTRY_PK,
    COUNTRY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:22.519157 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:22.524346 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.525523 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country" rename to "stg_country__dbt_backup"
[0m15:14:22.527204 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.533006 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.534268 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country__dbt_tmp" rename to "stg_country"
[0m15:14:22.535770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.538874 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:14:22.539922 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.541054 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:14:22.544474 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:22.549137 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:14:22.550319 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
drop view if exists "postgres"."dbt"."stg_country__dbt_backup" cascade
[0m15:14:22.553653 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:22.555836 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (execute): 2024-09-01 15:14:22.497208 => 2024-09-01 15:14:22.555776
[0m15:14:22.556848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: Close
[0m15:14:22.558353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e04c070>]}
[0m15:14:22.559721 [info ] [Thread-1  ]: 5 of 46 OK created sql view model dbt.stg_country .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:22.561206 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_country
[0m15:14:22.562621 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency
[0m15:14:22.564240 [info ] [Thread-1  ]: 6 of 46 START sql view model dbt.stg_currency .................................. [RUN]
[0m15:14:22.566007 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency'
[0m15:14:22.567245 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency
[0m15:14:22.579847 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.581081 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: BEGIN
[0m15:14:22.582234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:22.589833 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:22.591405 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.592662 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.599774 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:22.610889 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.612334 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.615824 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:22.626046 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.634284 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (compile): 2024-09-01 15:14:22.568172 => 2024-09-01 15:14:22.634181
[0m15:14:22.635125 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency
[0m15:14:22.644997 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.653084 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.653846 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

  create view "postgres"."dbt"."stg_currency__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    code,
    name

    FROM "postgres"."dbt"."source_currency"
),

derived_columns AS (

    SELECT

    code,
    name,
    code AS CURRENCY_KEY,
    'CSV_CURRENCY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(code AS VARCHAR))), '')), 'hex') AS CURRENCY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CURRENCY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,
    CURRENCY_PK,
    CURRENCY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:22.655824 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:22.660745 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.661826 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency" rename to "stg_currency__dbt_backup"
[0m15:14:22.663425 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.668530 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.669682 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency__dbt_tmp" rename to "stg_currency"
[0m15:14:22.671154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.674037 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:14:22.675068 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.676061 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:14:22.680006 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:22.685867 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:14:22.687043 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
drop view if exists "postgres"."dbt"."stg_currency__dbt_backup" cascade
[0m15:14:22.691266 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:22.693469 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (execute): 2024-09-01 15:14:22.635794 => 2024-09-01 15:14:22.693410
[0m15:14:22.694627 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: Close
[0m15:14:22.696150 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4ded3400>]}
[0m15:14:22.697503 [info ] [Thread-1  ]: 6 of 46 OK created sql view model dbt.stg_currency ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:22.699134 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency
[0m15:14:22.700326 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_rate
[0m15:14:22.701306 [info ] [Thread-1  ]: 7 of 46 START sql view model dbt.stg_currency_rate ............................. [RUN]
[0m15:14:22.702949 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_rate'
[0m15:14:22.703841 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_rate
[0m15:14:22.716841 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.718172 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: BEGIN
[0m15:14:22.719335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:22.727173 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:22.728854 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.730063 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.738098 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.749161 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.750575 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.754206 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.767706 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.775654 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (compile): 2024-09-01 15:14:22.704593 => 2024-09-01 15:14:22.775554
[0m15:14:22.776417 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_rate
[0m15:14:22.786856 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.795303 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.796192 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_rate__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end

    FROM "postgres"."dbt"."source_currency_rate"
),

derived_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    id AS CURRENCY_RATE_KEY,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CURRENCY_RATE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_end AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_start AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(relation_to_rur AS VARCHAR))), ''), '^^')
    )), 'hex') AS CURRENCY_RATE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,
    CURRENCY_RATE_PK,
    CURRENCY_RATE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:22.798535 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:22.803765 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.804920 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate" rename to "stg_currency_rate__dbt_backup"
[0m15:14:22.806558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.811655 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.812808 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate__dbt_tmp" rename to "stg_currency_rate"
[0m15:14:22.814461 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.817532 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:14:22.818643 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.819688 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:14:22.823005 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:22.829726 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:14:22.830936 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_rate__dbt_backup" cascade
[0m15:14:22.834341 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:22.836627 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (execute): 2024-09-01 15:14:22.777123 => 2024-09-01 15:14:22.836539
[0m15:14:22.837747 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: Close
[0m15:14:22.839368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4dffcaf0>]}
[0m15:14:22.840828 [info ] [Thread-1  ]: 7 of 46 OK created sql view model dbt.stg_currency_rate ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m15:14:22.842485 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_rate
[0m15:14:22.844015 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_goods
[0m15:14:22.845439 [info ] [Thread-1  ]: 8 of 46 START sql view model dbt.stg_goods ..................................... [RUN]
[0m15:14:22.847334 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_goods'
[0m15:14:22.848563 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_goods
[0m15:14:22.862897 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.864173 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: BEGIN
[0m15:14:22.865225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:22.872901 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:22.874442 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.875521 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.882683 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.893433 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.894511 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:22.897911 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:22.911005 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.919592 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (compile): 2024-09-01 15:14:22.849671 => 2024-09-01 15:14:22.919490
[0m15:14:22.920380 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_goods
[0m15:14:22.929882 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.937448 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.938117 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

  create view "postgres"."dbt"."stg_goods__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count

    FROM "postgres"."dbt"."source_goods"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    id AS GOOD_KEY,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS GOOD_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(cost_per_unit AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(count AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS GOOD_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,
    GOOD_PK,
    GOOD_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:22.940290 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:22.945228 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.946134 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods" rename to "stg_goods__dbt_backup"
[0m15:14:22.947711 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.953495 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.954616 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods__dbt_tmp" rename to "stg_goods"
[0m15:14:22.956134 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:22.958925 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:14:22.959809 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.960656 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:14:22.963969 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:22.968472 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:14:22.969503 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
drop view if exists "postgres"."dbt"."stg_goods__dbt_backup" cascade
[0m15:14:22.973287 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:22.975455 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (execute): 2024-09-01 15:14:22.921004 => 2024-09-01 15:14:22.975396
[0m15:14:22.976377 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: Close
[0m15:14:22.977772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4de99610>]}
[0m15:14:22.979039 [info ] [Thread-1  ]: 8 of 46 OK created sql view model dbt.stg_goods ................................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:14:22.980547 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_goods
[0m15:14:22.981961 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status
[0m15:14:22.983330 [info ] [Thread-1  ]: 9 of 46 START sql view model dbt.stg_order_status .............................. [RUN]
[0m15:14:22.985018 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status'
[0m15:14:22.986146 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status
[0m15:14:22.999154 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.000438 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: BEGIN
[0m15:14:23.001515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:23.009188 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:23.010705 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.012122 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:23.019198 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:23.029640 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.030880 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:23.034119 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:14:23.045429 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.054051 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (compile): 2024-09-01 15:14:22.987005 => 2024-09-01 15:14:23.053944
[0m15:14:23.054840 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status
[0m15:14:23.102483 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.110438 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.111149 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

  create view "postgres"."dbt"."stg_order_status__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_order_status"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS ORDER_STATUS_KEY,
    'CSV_ORDER_STATUS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_PK,
    ORDER_STATUS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:23.113196 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:23.118252 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.119213 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status" rename to "stg_order_status__dbt_backup"
[0m15:14:23.120689 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:23.125615 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.126711 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status__dbt_tmp" rename to "stg_order_status"
[0m15:14:23.128222 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:14:23.131178 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:14:23.132341 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.133390 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:14:23.136805 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:14:23.141666 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:14:23.142774 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
drop view if exists "postgres"."dbt"."stg_order_status__dbt_backup" cascade
[0m15:14:23.146979 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:14:23.149314 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (execute): 2024-09-01 15:14:23.055465 => 2024-09-01 15:14:23.149256
[0m15:14:23.150167 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: Close
[0m15:14:23.151618 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4de61be0>]}
[0m15:14:23.152883 [info ] [Thread-1  ]: 9 of 46 OK created sql view model dbt.stg_order_status ......................... [[32mCREATE VIEW[0m in 0.17s]
[0m15:14:23.154281 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status
[0m15:14:23.155750 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_history
[0m15:14:23.157113 [info ] [Thread-1  ]: 10 of 46 START sql view model dbt.stg_order_status_history ..................... [RUN]
[0m15:14:23.158842 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_history'
[0m15:14:23.160061 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_history
[0m15:14:23.174485 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:14:23.175737 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: BEGIN
[0m15:14:23.176825 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:14:23.184269 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:14:23.185723 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:14:23.186776 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:23.193551 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:23.203729 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:14:23.204854 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:14:23.208081 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:14:23.218342 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:14:23.226291 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (compile): 2024-09-01 15:14:23.160933 => 2024-09-01 15:14:23.226193
[0m15:14:23.227058 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_history
[0m15:14:23.237611 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:14:23.245735 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:14:23.246475 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_history__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id

    FROM "postgres"."dbt"."source_order_status_history"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    id AS ORDER_STATUS_HISTORY_KEY,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_HISTORY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(status_datetime AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HISTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_HISTORY_PK,
    ORDER_STATUS_HISTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:14:23.248995 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:14:23.254248 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:14:23.255289 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history" rename to "stg_order_status_history__dbt_backup"
[0m15:15:21.997778 [debug] [Thread-1  ]: Postgres adapter: Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m15:15:22.000461 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: ROLLBACK
[0m15:15:22.002371 [debug] [Thread-1  ]: Failed to rollback 'model.otus_project_dbtvault.stg_order_status_history'
[0m15:15:22.003815 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:15:22.005026 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.006531 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (execute): 2024-09-01 15:14:23.227663 => 2024-09-01 15:15:22.006398
[0m15:15:22.007884 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: Close
[0m15:15:22.011879 [debug] [Thread-1  ]: Database Error in model stg_order_status_history (models/stage/stg_order_status_history.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled Code at target/run/otus_project_dbtvault/models/stage/stg_order_status_history.sql
[0m15:15:22.013393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4dfda4f0>]}
[0m15:15:22.014775 [error] [Thread-1  ]: 10 of 46 ERROR creating sql view model dbt.stg_order_status_history ............ [[31mERROR[0m in 58.85s]
[0m15:15:22.016611 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_history
[0m15:15:22.018028 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_history1
[0m15:15:22.019713 [info ] [Thread-1  ]: 11 of 46 START sql view model dbt.stg_order_status_history1 .................... [RUN]
[0m15:15:22.022092 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_history1'
[0m15:15:22.023602 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_history1
[0m15:15:22.040109 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:15:22.041042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: BEGIN
[0m15:15:22.041961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:22.044375 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down

[0m15:15:22.047594 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:15:22.048982 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.049975 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m15:15:22.050891 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.052780 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history1 (compile): 2024-09-01 15:15:22.024652 => 2024-09-01 15:15:22.052689
[0m15:15:22.053745 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: No close available on handle
[0m15:15:22.056233 [debug] [Thread-1  ]: Database Error in model stg_order_status_history1 (models/stage/stg_order_status_history1.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down
  
[0m15:15:22.057228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4dd6b190>]}
[0m15:15:22.058195 [error] [Thread-1  ]: 11 of 46 ERROR creating sql view model dbt.stg_order_status_history1 ........... [[31mERROR[0m in 0.04s]
[0m15:15:22.059073 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_history1
[0m15:15:22.060037 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:15:22.061048 [info ] [Thread-1  ]: 12 of 46 START sql view model dbt.stg_order_with_delay ......................... [RUN]
[0m15:15:22.062615 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay'
[0m15:15:22.063468 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay
[0m15:15:22.076562 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:15:22.077465 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: BEGIN
[0m15:15:22.078253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:22.081259 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down

[0m15:15:22.085669 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:15:22.087005 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.088056 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m15:15:22.088874 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.090584 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (compile): 2024-09-01 15:15:22.064222 => 2024-09-01 15:15:22.090492
[0m15:15:22.091700 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: No close available on handle
[0m15:15:22.093598 [debug] [Thread-1  ]: Database Error in model stg_order_with_delay (models/stage/stg_order_with_delay.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down
  
[0m15:15:22.094665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e24f970>]}
[0m15:15:22.095757 [error] [Thread-1  ]: 12 of 46 ERROR creating sql view model dbt.stg_order_with_delay ................ [[31mERROR[0m in 0.03s]
[0m15:15:22.097108 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:15:22.098240 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_orders
[0m15:15:22.099230 [info ] [Thread-1  ]: 13 of 46 START sql view model dbt.stg_orders ................................... [RUN]
[0m15:15:22.100892 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_orders'
[0m15:15:22.101995 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_orders
[0m15:15:22.116784 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:15:22.117729 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: BEGIN
[0m15:15:22.118492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:22.120788 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down

[0m15:15:22.124099 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:15:22.125217 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.126045 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m15:15:22.126746 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.128462 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (compile): 2024-09-01 15:15:22.102757 => 2024-09-01 15:15:22.128372
[0m15:15:22.129285 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: No close available on handle
[0m15:15:22.131088 [debug] [Thread-1  ]: Database Error in model stg_orders (models/stage/stg_orders.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down
  
[0m15:15:22.131944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4de90c70>]}
[0m15:15:22.132827 [error] [Thread-1  ]: 13 of 46 ERROR creating sql view model dbt.stg_orders .......................... [[31mERROR[0m in 0.03s]
[0m15:15:22.133773 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_orders
[0m15:15:22.134725 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse
[0m15:15:22.135780 [info ] [Thread-1  ]: 14 of 46 START sql view model dbt.stg_warehouse ................................ [RUN]
[0m15:15:22.137067 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse'
[0m15:15:22.137838 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse
[0m15:15:22.150180 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:15:22.151009 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: BEGIN
[0m15:15:22.151694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:22.153759 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down

[0m15:15:22.156741 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:15:22.158186 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.159276 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m15:15:22.160055 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.162241 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (compile): 2024-09-01 15:15:22.138523 => 2024-09-01 15:15:22.162077
[0m15:15:22.163490 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: No close available on handle
[0m15:15:22.165599 [debug] [Thread-1  ]: Database Error in model stg_warehouse (models/stage/stg_warehouse.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down
  
[0m15:15:22.166427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4de5fa60>]}
[0m15:15:22.167320 [error] [Thread-1  ]: 14 of 46 ERROR creating sql view model dbt.stg_warehouse ....................... [[31mERROR[0m in 0.03s]
[0m15:15:22.168327 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse
[0m15:15:22.169277 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:15:22.170288 [info ] [Thread-1  ]: 15 of 46 START sql view model dbt.stg_warehouse_address ........................ [RUN]
[0m15:15:22.171536 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address'
[0m15:15:22.172441 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address
[0m15:15:22.185005 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:15:22.185772 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: BEGIN
[0m15:15:22.186436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:22.188608 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down

[0m15:15:22.191427 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:15:22.192823 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.193600 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m15:15:22.194293 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.197289 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (compile): 2024-09-01 15:15:22.173082 => 2024-09-01 15:15:22.197202
[0m15:15:22.198169 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: No close available on handle
[0m15:15:22.199785 [debug] [Thread-1  ]: Database Error in model stg_warehouse_address (models/stage/stg_warehouse_address.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down
  
[0m15:15:22.200601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4de92040>]}
[0m15:15:22.201477 [error] [Thread-1  ]: 15 of 46 ERROR creating sql view model dbt.stg_warehouse_address ............... [[31mERROR[0m in 0.03s]
[0m15:15:22.202533 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:15:22.203491 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:15:22.204385 [info ] [Thread-1  ]: 16 of 46 START sql view model dbt.stg_warehouse_params ......................... [RUN]
[0m15:15:22.205893 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_params'
[0m15:15:22.206754 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_params
[0m15:15:22.220576 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:15:22.221757 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: BEGIN
[0m15:15:22.222705 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:22.225126 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down

[0m15:15:22.228498 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:15:22.230015 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.231245 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro get_columns_in_relation
[0m15:15:22.232266 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.233924 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (compile): 2024-09-01 15:15:22.207386 => 2024-09-01 15:15:22.233836
[0m15:15:22.234830 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: No close available on handle
[0m15:15:22.237170 [debug] [Thread-1  ]: Database Error in model stg_warehouse_params (models/stage/stg_warehouse_params.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: FATAL:  the database system is shutting down
  
[0m15:15:22.238365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4e04ce20>]}
[0m15:15:22.239243 [error] [Thread-1  ]: 16 of 46 ERROR creating sql view model dbt.stg_warehouse_params ................ [[31mERROR[0m in 0.03s]
[0m15:15:22.240223 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:15:22.241229 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_city
[0m15:15:22.242228 [info ] [Thread-1  ]: 17 of 46 START sql view model dbt.stg_client_address_city ...................... [RUN]
[0m15:15:22.243616 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_city'
[0m15:15:22.244479 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_city
[0m15:15:22.249776 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:15:22.256918 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (compile): 2024-09-01 15:15:22.245150 => 2024-09-01 15:15:22.256798
[0m15:15:22.257933 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_city
[0m15:15:22.269672 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:15:22.279568 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:15:22.280841 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: BEGIN
[0m15:15:22.282082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:15:22.283988 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.2), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:15:22.285932 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:15:22.286847 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:15:22.287955 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (execute): 2024-09-01 15:15:22.258853 => 2024-09-01 15:15:22.287819
[0m15:15:22.290020 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: No close available on handle
[0m15:15:22.293041 [debug] [Thread-1  ]: Database Error in model stg_client_address_city (models/stage/stg_client_address_city.sql)
  connection to server at "postgres" (172.19.0.2), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
  compiled Code at target/run/otus_project_dbtvault/models/stage/stg_client_address_city.sql
[0m15:15:22.294590 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc96a037-e8ea-4609-acd4-dd94842ba29d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4de92970>]}
[0m15:15:22.296317 [error] [Thread-1  ]: 17 of 46 ERROR creating sql view model dbt.stg_client_address_city ............. [[31mERROR[0m in 0.05s]
[0m15:15:22.298043 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_city
[0m15:15:22.299368 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_client
[0m15:15:22.300624 [info ] [Thread-1  ]: 18 of 46 START sql view model dbt.stg_client_address_client .................... [RUN]
[0m15:15:22.302294 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_client'
[0m15:15:22.303495 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_client
[0m15:15:22.311004 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:15:22.318708 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_client (compile): 2024-09-01 15:15:22.304420 => 2024-09-01 15:15:22.318584
[0m15:15:22.319529 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_client
[0m15:15:22.329280 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:15:22.338556 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:15:22.339262 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: BEGIN
[0m15:15:22.339883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed


============================== 2024-09-01 15:16:07.500236 | 02e3992e-6e07-4bc4-bdf1-7cf8e963eb82 ==============================
[0m15:16:07.500236 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:16:07.503397 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:16:07.504756 [debug] [MainThread]: Tracking: tracking
[0m15:16:07.512177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb5c1a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb5c1acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb5c1a460>]}
[0m15:16:07.515871 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fs5ra1_1'
[0m15:16:07.518306 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:16:10.245769 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:10.247463 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m15:16:10.249222 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:16:10.250609 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:16:10.256520 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:16:10.258163 [debug] [MainThread]: STDERR: "b''"
[0m15:16:10.259524 [debug] [MainThread]:   Checking out revision master.
[0m15:16:10.260851 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:16:10.267804 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:10.269250 [debug] [MainThread]: STDERR: "b''"
[0m15:16:10.270479 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:16:11.754553 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:11.756058 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m15:16:11.757172 [debug] [MainThread]: Executing "git tag --list"
[0m15:16:11.762270 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:16:11.763813 [debug] [MainThread]: STDERR: "b''"
[0m15:16:11.765119 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:16:11.775430 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:16:11.776866 [debug] [MainThread]: STDERR: "b''"
[0m15:16:11.777973 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:16:11.783067 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:16:11.784684 [debug] [MainThread]: STDERR: "b''"
[0m15:16:11.785799 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m15:16:11.787463 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:16:11.800013 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:16:12.802321 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:16:12.804406 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:16:13.040719 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:16:13.191337 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:16:13.196129 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:13.198027 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:16:13.199208 [debug] [MainThread]: command return code=128
[0m15:16:13.200907 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:16:13.201957 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:16:13.206565 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:16:13.207869 [debug] [MainThread]: STDERR: "b''"
[0m15:16:13.208929 [debug] [MainThread]:   Checking out revision master.
[0m15:16:13.210068 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:16:13.216324 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:13.218044 [debug] [MainThread]: STDERR: "b''"
[0m15:16:13.219351 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:16:14.201330 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:14.202841 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:16:14.203811 [debug] [MainThread]: Executing "git tag --list"
[0m15:16:14.209276 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:16:14.210766 [debug] [MainThread]: STDERR: "b''"
[0m15:16:14.211634 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:16:14.218958 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:16:14.220152 [debug] [MainThread]: STDERR: "b''"
[0m15:16:14.221069 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:16:14.225526 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:16:14.226843 [debug] [MainThread]: STDERR: "b''"
[0m15:16:14.227841 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:16:14.229353 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:16:14.243833 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m15:16:14.449416 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:16:14.454233 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:14.455606 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:16:14.456490 [debug] [MainThread]: command return code=128
[0m15:16:14.458097 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:16:14.458841 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:16:14.463047 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:16:14.464377 [debug] [MainThread]: STDERR: "b''"
[0m15:16:14.465300 [debug] [MainThread]:   Checking out revision master.
[0m15:16:14.466271 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:16:14.471829 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:14.473373 [debug] [MainThread]: STDERR: "b''"
[0m15:16:14.474314 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:16:15.266670 [debug] [MainThread]: STDOUT: "b''"
[0m15:16:15.268221 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:16:15.269249 [debug] [MainThread]: Executing "git tag --list"
[0m15:16:15.275174 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:16:15.276583 [debug] [MainThread]: STDERR: "b''"
[0m15:16:15.277761 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:16:15.285420 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:16:15.286800 [debug] [MainThread]: STDERR: "b''"
[0m15:16:15.287954 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:16:15.293284 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:16:15.294565 [debug] [MainThread]: STDERR: "b''"
[0m15:16:15.295409 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:16:18.029023 [info ] [MainThread]:   Installed from revision master
[0m15:16:18.030844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '02e3992e-6e07-4bc4-bdf1-7cf8e963eb82', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb5c173a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb63a67c0>]}
[0m15:16:18.032300 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:16:22.070627 [info ] [MainThread]:   Installed from version 1.3.0
[0m15:16:22.071655 [info ] [MainThread]:   Up to date!
[0m15:16:22.072954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '02e3992e-6e07-4bc4-bdf1-7cf8e963eb82', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb6cc07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb63a67c0>]}
[0m15:16:22.075524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb5ca00a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb69b1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eb5c7ba60>]}
[0m15:16:22.076870 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:19:35.593420 | b7fb9a26-7d9d-40c9-89ec-8ff40a935a60 ==============================
[0m15:19:35.593420 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:19:35.596587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:stage'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:19:35.597694 [debug] [MainThread]: Tracking: tracking
[0m15:19:35.604118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5acb96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5acb9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5acb97f0>]}
[0m15:19:38.789347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:38.790151 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:38.808989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a7b70d0>]}
[0m15:19:38.856569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a996d00>]}
[0m15:19:38.857711 [info ] [MainThread]: Found 97 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:19:38.858680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5acb5280>]}
[0m15:19:38.866409 [info ] [MainThread]: 
[0m15:19:38.870105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:38.875757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:19:38.892329 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:19:38.893620 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:19:38.894668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:38.904981 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:19:38.907438 [debug] [ThreadPool]: On list_postgres: Close
[0m15:19:38.917670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:19:38.926718 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:19:38.927928 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:19:38.929009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:38.937027 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:19:38.938519 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:19:38.939725 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:19:38.943242 [debug] [ThreadPool]: SQL status: SELECT 15 in 0 seconds
[0m15:19:38.946268 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:19:38.947346 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:19:38.966948 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:38.968166 [debug] [MainThread]: On master: BEGIN
[0m15:19:38.969238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:38.977857 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:19:38.979383 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:38.980480 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:19:38.986891 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m15:19:38.989019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5c4b5640>]}
[0m15:19:38.990225 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:38.991394 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:38.992493 [debug] [MainThread]: On master: BEGIN
[0m15:19:38.993895 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:19:38.994975 [debug] [MainThread]: On master: COMMIT
[0m15:19:38.996042 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:38.997114 [debug] [MainThread]: On master: COMMIT
[0m15:19:38.997952 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:19:38.998630 [debug] [MainThread]: On master: Close
[0m15:19:38.999749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:39.000777 [info ] [MainThread]: 
[0m15:19:39.004990 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city
[0m15:19:39.006021 [info ] [Thread-1  ]: 1 of 46 START sql view model dbt.stg_city ...................................... [RUN]
[0m15:19:39.007312 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city'
[0m15:19:39.008354 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city
[0m15:19:39.064923 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:19:39.066045 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: BEGIN
[0m15:19:39.067007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:39.074989 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:39.076170 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:19:39.077064 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.084528 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:19:39.176859 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:19:39.178077 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.181579 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:19:39.262473 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city"
[0m15:19:39.268993 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (compile): 2024-09-01 15:19:39.009175 => 2024-09-01 15:19:39.268872
[0m15:19:39.269783 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city
[0m15:19:39.320687 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city"
[0m15:19:39.328186 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:19:39.328968 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */

  create view "postgres"."dbt"."stg_city__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    country_id

    FROM "postgres"."dbt"."source_city"
),

derived_columns AS (

    SELECT

    id,
    name,
    country_id,
    id AS CITY_KEY,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CITY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CITY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    country_id,
    CITY_KEY,
    RECORD_SOURCE,
    CITY_PK,
    CITY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:39.331163 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:39.340201 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:19:39.341149 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
alter table "postgres"."dbt"."stg_city__dbt_tmp" rename to "stg_city"
[0m15:19:39.342517 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:39.365565 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:19:39.366636 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:19:39.367466 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: COMMIT
[0m15:19:39.369881 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:39.377765 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city"
[0m15:19:39.378893 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city"} */
drop view if exists "postgres"."dbt"."stg_city__dbt_backup" cascade
[0m15:19:39.380196 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:39.382283 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city (execute): 2024-09-01 15:19:39.270335 => 2024-09-01 15:19:39.382222
[0m15:19:39.383251 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city: Close
[0m15:19:39.384570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a5c6220>]}
[0m15:19:39.385839 [info ] [Thread-1  ]: 1 of 46 OK created sql view model dbt.stg_city ................................. [[32mCREATE VIEW[0m in 0.38s]
[0m15:19:39.388973 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city
[0m15:19:39.390217 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client
[0m15:19:39.391315 [info ] [Thread-1  ]: 2 of 46 START sql view model dbt.stg_client .................................... [RUN]
[0m15:19:39.392885 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client'
[0m15:19:39.393907 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client
[0m15:19:39.408865 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:19:39.410073 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: BEGIN
[0m15:19:39.411041 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:39.419410 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:39.420863 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:19:39.422009 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.428619 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:39.439391 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:19:39.440632 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.444196 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:39.464503 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client"
[0m15:19:39.472532 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (compile): 2024-09-01 15:19:39.394752 => 2024-09-01 15:19:39.472428
[0m15:19:39.473472 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client
[0m15:19:39.480988 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client"
[0m15:19:39.488422 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:19:39.489160 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */

  create view "postgres"."dbt"."stg_client__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id

    FROM "postgres"."dbt"."source_client"
),

derived_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CONCAT(
        order_id, '||',
        client_type_code
    ) AS CLIENT_KEY,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_id AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS CLIENT_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(client_type_code AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_id,
    client_type_code,
    name,
    type_id,
    client_address_id,
    CLIENT_KEY,
    RECORD_SOURCE,
    CLIENT_PK,
    CLIENT_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:39.491493 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:39.497993 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:19:39.499204 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
alter table "postgres"."dbt"."stg_client__dbt_tmp" rename to "stg_client"
[0m15:19:39.500804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:39.503461 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:19:39.504433 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:19:39.505461 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: COMMIT
[0m15:19:39.508444 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:39.512917 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client"
[0m15:19:39.514011 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client"} */
drop view if exists "postgres"."dbt"."stg_client__dbt_backup" cascade
[0m15:19:39.515420 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:39.517653 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client (execute): 2024-09-01 15:19:39.474138 => 2024-09-01 15:19:39.517595
[0m15:19:39.518686 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client: Close
[0m15:19:39.520074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a68a310>]}
[0m15:19:39.521460 [info ] [Thread-1  ]: 2 of 46 OK created sql view model dbt.stg_client ............................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:19:39.522897 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client
[0m15:19:39.524082 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address
[0m15:19:39.525317 [info ] [Thread-1  ]: 3 of 46 START sql view model dbt.stg_client_address ............................ [RUN]
[0m15:19:39.526885 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address'
[0m15:19:39.528084 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address
[0m15:19:39.540688 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.541910 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: BEGIN
[0m15:19:39.542812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:39.550246 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:39.551848 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.553103 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.560539 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:39.571040 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.572378 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.575882 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:39.627174 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.636844 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (compile): 2024-09-01 15:19:39.528988 => 2024-09-01 15:19:39.636721
[0m15:19:39.637963 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address
[0m15:19:39.645565 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.654366 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.655108 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */

  create view "postgres"."dbt"."stg_client_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid

    FROM "postgres"."dbt"."source_client_address"
),

derived_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    id AS CLIENT_ADDRESS_KEY,
    'CSV_CLIENT_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), ''), '^^')
    ), '^^')), 'hex') AS CLIENT_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(is_valid AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS CLIENT_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    city_id,
    street,
    house,
    is_valid,
    CLIENT_ADDRESS_KEY,
    RECORD_SOURCE,
    CLIENT_ADDRESS_PK,
    CLIENT_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:39.657339 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:39.662115 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.663317 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
alter table "postgres"."dbt"."stg_client_address__dbt_tmp" rename to "stg_client_address"
[0m15:19:39.664939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:39.667689 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:19:39.668955 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.670082 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: COMMIT
[0m15:19:39.673426 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:39.677932 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address"
[0m15:19:39.679042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address"} */
drop view if exists "postgres"."dbt"."stg_client_address__dbt_backup" cascade
[0m15:19:39.680365 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:39.682612 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address (execute): 2024-09-01 15:19:39.638848 => 2024-09-01 15:19:39.682554
[0m15:19:39.683715 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address: Close
[0m15:19:39.685367 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5c521220>]}
[0m15:19:39.687243 [info ] [Thread-1  ]: 3 of 46 OK created sql view model dbt.stg_client_address ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:19:39.688710 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address
[0m15:19:39.690116 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_type
[0m15:19:39.691514 [info ] [Thread-1  ]: 4 of 46 START sql view model dbt.stg_client_type ............................... [RUN]
[0m15:19:39.693284 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_type'
[0m15:19:39.694404 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_type
[0m15:19:39.707198 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.708445 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: BEGIN
[0m15:19:39.709542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:39.717311 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:39.718911 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.720098 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.728641 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:39.738517 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.739634 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.743270 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:39.753407 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.761306 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (compile): 2024-09-01 15:19:39.695487 => 2024-09-01 15:19:39.761205
[0m15:19:39.762294 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_type
[0m15:19:39.769963 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.778087 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.778817 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */

  create view "postgres"."dbt"."stg_client_type__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_client_type"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS CLIENT_TYPE_KEY,
    'CSV_CLIENT_TYPE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CLIENT_TYPE_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CLIENT_TYPE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    CLIENT_TYPE_KEY,
    RECORD_SOURCE,
    CLIENT_TYPE_PK,
    CLIENT_TYPE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:39.780847 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:39.785696 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.786943 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
alter table "postgres"."dbt"."stg_client_type__dbt_tmp" rename to "stg_client_type"
[0m15:19:39.788440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:39.791222 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:19:39.792375 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.793356 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: COMMIT
[0m15:19:39.796387 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:39.800907 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_type"
[0m15:19:39.802025 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_type__dbt_backup" cascade
[0m15:19:39.803329 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:39.805457 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_type (execute): 2024-09-01 15:19:39.762974 => 2024-09-01 15:19:39.805398
[0m15:19:39.806536 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_type: Close
[0m15:19:39.807959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6c6e20>]}
[0m15:19:39.809209 [info ] [Thread-1  ]: 4 of 46 OK created sql view model dbt.stg_client_type .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:39.810827 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_type
[0m15:19:39.811942 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_country
[0m15:19:39.813242 [info ] [Thread-1  ]: 5 of 46 START sql view model dbt.stg_country ................................... [RUN]
[0m15:19:39.814758 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_country'
[0m15:19:39.815624 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_country
[0m15:19:39.829599 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:19:39.830844 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: BEGIN
[0m15:19:39.832111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:39.839889 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:39.841346 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:19:39.842464 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.848818 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:39.858834 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:19:39.859994 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.863455 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:39.873452 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_country"
[0m15:19:39.881061 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (compile): 2024-09-01 15:19:39.816383 => 2024-09-01 15:19:39.880954
[0m15:19:39.882162 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_country
[0m15:19:39.889769 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_country"
[0m15:19:39.898320 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:19:39.899086 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */

  create view "postgres"."dbt"."stg_country__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_country"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS COUNTRY_KEY,
    'CSV_COUNTRY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS COUNTRY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS COUNTRY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    COUNTRY_KEY,
    RECORD_SOURCE,
    COUNTRY_PK,
    COUNTRY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:39.901097 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:39.907099 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:19:39.908278 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
alter table "postgres"."dbt"."stg_country__dbt_tmp" rename to "stg_country"
[0m15:19:39.909790 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:39.912431 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:19:39.913504 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:19:39.914561 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: COMMIT
[0m15:19:39.917831 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:39.922226 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_country"
[0m15:19:39.923324 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_country"} */
drop view if exists "postgres"."dbt"."stg_country__dbt_backup" cascade
[0m15:19:39.924665 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:39.926752 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_country (execute): 2024-09-01 15:19:39.883003 => 2024-09-01 15:19:39.926694
[0m15:19:39.927728 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_country: Close
[0m15:19:39.929809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5c521220>]}
[0m15:19:39.931552 [info ] [Thread-1  ]: 5 of 46 OK created sql view model dbt.stg_country .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:39.933219 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_country
[0m15:19:39.934602 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency
[0m15:19:39.935737 [info ] [Thread-1  ]: 6 of 46 START sql view model dbt.stg_currency .................................. [RUN]
[0m15:19:39.937391 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency'
[0m15:19:39.938398 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency
[0m15:19:39.951078 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:19:39.952460 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: BEGIN
[0m15:19:39.953569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:39.961540 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:39.963021 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:19:39.964328 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.971846 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:39.982169 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:19:39.983539 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:39.987075 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:39.998337 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency"
[0m15:19:40.006241 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (compile): 2024-09-01 15:19:39.939262 => 2024-09-01 15:19:40.006142
[0m15:19:40.007109 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency
[0m15:19:40.014210 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency"
[0m15:19:40.021879 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:19:40.022726 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */

  create view "postgres"."dbt"."stg_currency__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    code,
    name

    FROM "postgres"."dbt"."source_currency"
),

derived_columns AS (

    SELECT

    code,
    name,
    code AS CURRENCY_KEY,
    'CSV_CURRENCY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(code AS VARCHAR))), '')), 'hex') AS CURRENCY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS CURRENCY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    code,
    name,
    CURRENCY_KEY,
    RECORD_SOURCE,
    CURRENCY_PK,
    CURRENCY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.024808 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.029653 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:19:40.030876 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
alter table "postgres"."dbt"."stg_currency__dbt_tmp" rename to "stg_currency"
[0m15:19:40.032452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.035048 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:19:40.036133 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:19:40.037146 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: COMMIT
[0m15:19:40.041143 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.045877 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency"
[0m15:19:40.046902 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency"} */
drop view if exists "postgres"."dbt"."stg_currency__dbt_backup" cascade
[0m15:19:40.048206 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.050328 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency (execute): 2024-09-01 15:19:40.007719 => 2024-09-01 15:19:40.050271
[0m15:19:40.051392 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency: Close
[0m15:19:40.053141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a698cd0>]}
[0m15:19:40.054556 [info ] [Thread-1  ]: 6 of 46 OK created sql view model dbt.stg_currency ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:40.055964 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency
[0m15:19:40.057302 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_rate
[0m15:19:40.058273 [info ] [Thread-1  ]: 7 of 46 START sql view model dbt.stg_currency_rate ............................. [RUN]
[0m15:19:40.059692 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_rate'
[0m15:19:40.060625 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_rate
[0m15:19:40.074544 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.075968 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: BEGIN
[0m15:19:40.077054 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.085103 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:40.086781 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.088186 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.096080 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.106573 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.107897 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.111585 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.125129 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.133293 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (compile): 2024-09-01 15:19:40.061389 => 2024-09-01 15:19:40.133186
[0m15:19:40.134147 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_rate
[0m15:19:40.141728 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.150118 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.150874 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_rate__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end

    FROM "postgres"."dbt"."source_currency_rate"
),

derived_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    id AS CURRENCY_RATE_KEY,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS CURRENCY_RATE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_end AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(date_start AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(relation_to_rur AS VARCHAR))), ''), '^^')
    )), 'hex') AS CURRENCY_RATE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    currency_code,
    relation_to_rur,
    date_start,
    date_end,
    CURRENCY_RATE_KEY,
    RECORD_SOURCE,
    CURRENCY_RATE_PK,
    CURRENCY_RATE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.153151 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.157931 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.158876 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_rate__dbt_tmp" rename to "stg_currency_rate"
[0m15:19:40.160255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.162834 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:19:40.163829 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.164793 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: COMMIT
[0m15:19:40.167290 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.172382 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_rate"
[0m15:19:40.173393 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_rate__dbt_backup" cascade
[0m15:19:40.174614 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.176629 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_rate (execute): 2024-09-01 15:19:40.134760 => 2024-09-01 15:19:40.176573
[0m15:19:40.177574 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_rate: Close
[0m15:19:40.179188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6dd730>]}
[0m15:19:40.180661 [info ] [Thread-1  ]: 7 of 46 OK created sql view model dbt.stg_currency_rate ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:40.182141 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_rate
[0m15:19:40.183573 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_goods
[0m15:19:40.184937 [info ] [Thread-1  ]: 8 of 46 START sql view model dbt.stg_goods ..................................... [RUN]
[0m15:19:40.186634 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_goods'
[0m15:19:40.187814 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_goods
[0m15:19:40.201580 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.202688 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: BEGIN
[0m15:19:40.203691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.211646 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:40.213180 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.214202 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.221821 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.232905 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.234064 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.237536 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.251166 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.260133 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (compile): 2024-09-01 15:19:40.188718 => 2024-09-01 15:19:40.260026
[0m15:19:40.260954 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_goods
[0m15:19:40.269187 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.277137 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.278033 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */

  create view "postgres"."dbt"."stg_goods__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count

    FROM "postgres"."dbt"."source_goods"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    id AS GOOD_KEY,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS GOOD_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(cost_per_unit AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(count AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')
    )), 'hex') AS GOOD_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    name,
    cost_per_unit,
    count,
    GOOD_KEY,
    RECORD_SOURCE,
    GOOD_PK,
    GOOD_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.280287 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.285196 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.286409 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
alter table "postgres"."dbt"."stg_goods__dbt_tmp" rename to "stg_goods"
[0m15:19:40.287965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.290679 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:19:40.291893 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.293030 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: COMMIT
[0m15:19:40.296334 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.300698 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_goods"
[0m15:19:40.301851 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_goods"} */
drop view if exists "postgres"."dbt"."stg_goods__dbt_backup" cascade
[0m15:19:40.303157 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.305275 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_goods (execute): 2024-09-01 15:19:40.261553 => 2024-09-01 15:19:40.305217
[0m15:19:40.306366 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_goods: Close
[0m15:19:40.307784 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f585ba100>]}
[0m15:19:40.309107 [info ] [Thread-1  ]: 8 of 46 OK created sql view model dbt.stg_goods ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:40.310813 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_goods
[0m15:19:40.312110 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status
[0m15:19:40.313388 [info ] [Thread-1  ]: 9 of 46 START sql view model dbt.stg_order_status .............................. [RUN]
[0m15:19:40.314975 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status'
[0m15:19:40.316124 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status
[0m15:19:40.328948 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.330249 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: BEGIN
[0m15:19:40.331473 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.339190 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:40.340615 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.341719 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.348700 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:40.359703 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.360962 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.364559 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:19:40.374637 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.383739 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (compile): 2024-09-01 15:19:40.317081 => 2024-09-01 15:19:40.383638
[0m15:19:40.384644 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status
[0m15:19:40.392228 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.400128 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.400874 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */

  create view "postgres"."dbt"."stg_order_status__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name

    FROM "postgres"."dbt"."source_order_status"
),

derived_columns AS (

    SELECT

    id,
    name,
    id AS ORDER_STATUS_KEY,
    'CSV_ORDER_STATUS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    ORDER_STATUS_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_PK,
    ORDER_STATUS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.402978 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.408081 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.409137 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
alter table "postgres"."dbt"."stg_order_status__dbt_tmp" rename to "stg_order_status"
[0m15:19:40.410635 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.413289 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:19:40.414163 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.415063 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: COMMIT
[0m15:19:40.418355 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.422744 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status"
[0m15:19:40.423633 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status"} */
drop view if exists "postgres"."dbt"."stg_order_status__dbt_backup" cascade
[0m15:19:40.424788 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.426979 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status (execute): 2024-09-01 15:19:40.385327 => 2024-09-01 15:19:40.426915
[0m15:19:40.428066 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status: Close
[0m15:19:40.429653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6210a0>]}
[0m15:19:40.431050 [info ] [Thread-1  ]: 9 of 46 OK created sql view model dbt.stg_order_status ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:40.432565 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status
[0m15:19:40.433797 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_history
[0m15:19:40.434872 [info ] [Thread-1  ]: 10 of 46 START sql view model dbt.stg_order_status_history ..................... [RUN]
[0m15:19:40.436589 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_history'
[0m15:19:40.437789 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_history
[0m15:19:40.452141 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.453152 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: BEGIN
[0m15:19:40.454046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.461588 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:40.463057 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.464033 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.471847 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.482520 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.483708 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.487265 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.498335 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.507368 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (compile): 2024-09-01 15:19:40.438563 => 2024-09-01 15:19:40.507248
[0m15:19:40.508179 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_history
[0m15:19:40.515870 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.524730 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.525491 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_history__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id

    FROM "postgres"."dbt"."source_order_status_history"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    id AS ORDER_STATUS_HISTORY_KEY,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_HISTORY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(status_datetime AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HISTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_HISTORY_PK,
    ORDER_STATUS_HISTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.527569 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.532440 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.533456 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_history__dbt_tmp" rename to "stg_order_status_history"
[0m15:19:40.534951 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.537585 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:19:40.538614 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.539513 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: COMMIT
[0m15:19:40.542860 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.548221 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history"
[0m15:19:40.549299 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_status_history__dbt_backup" cascade
[0m15:19:40.550602 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.553100 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history (execute): 2024-09-01 15:19:40.508850 => 2024-09-01 15:19:40.553040
[0m15:19:40.553919 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history: Close
[0m15:19:40.555344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5855cb50>]}
[0m15:19:40.556477 [info ] [Thread-1  ]: 10 of 46 OK created sql view model dbt.stg_order_status_history ................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:40.557851 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_history
[0m15:19:40.559215 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_history1
[0m15:19:40.560590 [info ] [Thread-1  ]: 11 of 46 START sql view model dbt.stg_order_status_history1 .................... [RUN]
[0m15:19:40.562416 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_history1'
[0m15:19:40.563409 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_history1
[0m15:19:40.576227 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.577319 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: BEGIN
[0m15:19:40.578266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.586052 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:40.587407 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.588434 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history1"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.596331 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.606774 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.608119 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history1"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.612047 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:40.622597 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.630572 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history1 (compile): 2024-09-01 15:19:40.564381 => 2024-09-01 15:19:40.630464
[0m15:19:40.631479 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_history1
[0m15:19:40.639863 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.648115 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.648865 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history1"} */

  create view "postgres"."dbt"."stg_order_status_history1__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id

    FROM "postgres"."dbt"."source_order_status_history"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    id AS ORDER_STATUS_HISTORY_KEY,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_STATUS_HISTORY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(status_datetime AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_STATUS_HISTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    status_id,
    status_datetime,
    warehouse_id,
    ORDER_STATUS_HISTORY_KEY,
    RECORD_SOURCE,
    ORDER_STATUS_HISTORY_PK,
    ORDER_STATUS_HISTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.651124 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.692927 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.694131 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history1"} */
alter table "postgres"."dbt"."stg_order_status_history1__dbt_tmp" rename to "stg_order_status_history1"
[0m15:19:40.695630 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.698170 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: COMMIT
[0m15:19:40.699117 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.700003 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: COMMIT
[0m15:19:40.702603 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.707027 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_history1"
[0m15:19:40.708244 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_history1"} */
drop view if exists "postgres"."dbt"."stg_order_status_history1__dbt_backup" cascade
[0m15:19:40.709494 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.711661 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_history1 (execute): 2024-09-01 15:19:40.632093 => 2024-09-01 15:19:40.711603
[0m15:19:40.712789 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_history1: Close
[0m15:19:40.714356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58485fa0>]}
[0m15:19:40.715548 [info ] [Thread-1  ]: 11 of 46 OK created sql view model dbt.stg_order_status_history1 ............... [[32mCREATE VIEW[0m in 0.15s]
[0m15:19:40.716931 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_history1
[0m15:19:40.718323 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:19:40.719512 [info ] [Thread-1  ]: 12 of 46 START sql view model dbt.stg_order_with_delay ......................... [RUN]
[0m15:19:40.721071 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay'
[0m15:19:40.722114 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay
[0m15:19:40.736939 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.738456 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: BEGIN
[0m15:19:40.739634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.747413 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:40.748868 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.749994 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.757173 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:19:40.768144 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.769347 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_order_with_delay'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.773132 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:19:40.783180 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.791415 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (compile): 2024-09-01 15:19:40.723011 => 2024-09-01 15:19:40.791311
[0m15:19:40.792295 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_with_delay
[0m15:19:40.800172 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.808209 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.808932 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */

  create view "postgres"."dbt"."stg_order_with_delay__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_id,
    reason_for_delay

    FROM "postgres"."dbt"."source_order_with_delay"
),

derived_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    id AS ORDER_WITH_DELAY_KEY,
    'CSV_ORDER_WITH_DELAY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_WITH_DELAY_PK,

    DECODE(MD5(COALESCE(NULLIF(UPPER(TRIM(CAST(reason_for_delay AS VARCHAR))), ''), '^^')), 'hex') AS ORDER_WITH_DELAY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_id,
    reason_for_delay,
    ORDER_WITH_DELAY_KEY,
    RECORD_SOURCE,
    ORDER_WITH_DELAY_PK,
    ORDER_WITH_DELAY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.810999 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.815840 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.817238 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
alter table "postgres"."dbt"."stg_order_with_delay__dbt_tmp" rename to "stg_order_with_delay"
[0m15:19:40.819007 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.822219 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:19:40.823572 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.824697 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: COMMIT
[0m15:19:40.828861 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.833984 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay"
[0m15:19:40.835161 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay"} */
drop view if exists "postgres"."dbt"."stg_order_with_delay__dbt_backup" cascade
[0m15:19:40.836475 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.838835 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay (execute): 2024-09-01 15:19:40.792941 => 2024-09-01 15:19:40.838774
[0m15:19:40.839774 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay: Close
[0m15:19:40.841344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58485520>]}
[0m15:19:40.842505 [info ] [Thread-1  ]: 12 of 46 OK created sql view model dbt.stg_order_with_delay .................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:40.843907 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay
[0m15:19:40.845320 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_orders
[0m15:19:40.846455 [info ] [Thread-1  ]: 13 of 46 START sql view model dbt.stg_orders ................................... [RUN]
[0m15:19:40.848312 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_orders'
[0m15:19:40.849721 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_orders
[0m15:19:40.863555 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.864929 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: BEGIN
[0m15:19:40.866134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:40.873583 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:40.875218 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.876364 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.883305 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:19:40.893831 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.895160 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_orders'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:40.899019 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:19:40.915277 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.923344 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (compile): 2024-09-01 15:19:40.850620 => 2024-09-01 15:19:40.923244
[0m15:19:40.924190 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_orders
[0m15:19:40.932375 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.940435 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.941161 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */

  create view "postgres"."dbt"."stg_orders__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code

    FROM "postgres"."dbt"."source_orders"
),

derived_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    id AS ORDER_KEY,
    'CSV_ORDERS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS ORDER_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(height AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(length AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(order_date AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(weight AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(width AS VARCHAR))), ''), '^^')
    )), 'hex') AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    order_date,
    length,
    height,
    width,
    weight,
    currency_code,
    ORDER_KEY,
    RECORD_SOURCE,
    ORDER_PK,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:40.943873 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:40.948843 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.950115 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
alter table "postgres"."dbt"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:19:40.951683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:40.954494 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:19:40.955531 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.956510 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: COMMIT
[0m15:19:40.959227 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:40.964680 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_orders"
[0m15:19:40.965922 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_orders"} */
drop view if exists "postgres"."dbt"."stg_orders__dbt_backup" cascade
[0m15:19:40.967254 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:40.969406 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_orders (execute): 2024-09-01 15:19:40.924817 => 2024-09-01 15:19:40.969348
[0m15:19:40.970414 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_orders: Close
[0m15:19:40.971921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f585ba100>]}
[0m15:19:40.973331 [info ] [Thread-1  ]: 13 of 46 OK created sql view model dbt.stg_orders .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:40.974845 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_orders
[0m15:19:40.976058 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse
[0m15:19:40.977923 [info ] [Thread-1  ]: 14 of 46 START sql view model dbt.stg_warehouse ................................ [RUN]
[0m15:19:40.979595 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse'
[0m15:19:40.980605 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse
[0m15:19:40.993042 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:40.994340 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: BEGIN
[0m15:19:40.995432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.002912 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.004220 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.005320 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:41.012738 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:19:41.022889 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.024068 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:41.027550 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0 seconds
[0m15:19:41.039870 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.048478 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (compile): 2024-09-01 15:19:40.981607 => 2024-09-01 15:19:41.048369
[0m15:19:41.049436 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse
[0m15:19:41.058719 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.067317 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.068232 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */

  create view "postgres"."dbt"."stg_warehouse__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    name,
    system_name

    FROM "postgres"."dbt"."source_warehouse"
),

derived_columns AS (

    SELECT

    id,
    name,
    system_name,
    id AS WAREHOUSE_KEY,
    'CSV_WAREHOUSE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(name AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(system_name AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    name,
    system_name,
    WAREHOUSE_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PK,
    WAREHOUSE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:41.070341 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.075763 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.077090 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
alter table "postgres"."dbt"."stg_warehouse__dbt_tmp" rename to "stg_warehouse"
[0m15:19:41.078714 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.081403 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:19:41.082473 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.083445 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: COMMIT
[0m15:19:41.086531 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.090904 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse"
[0m15:19:41.092084 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse"} */
drop view if exists "postgres"."dbt"."stg_warehouse__dbt_backup" cascade
[0m15:19:41.093439 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.095523 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse (execute): 2024-09-01 15:19:41.050197 => 2024-09-01 15:19:41.095465
[0m15:19:41.096708 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse: Close
[0m15:19:41.098352 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5ab75a60>]}
[0m15:19:41.099759 [info ] [Thread-1  ]: 14 of 46 OK created sql view model dbt.stg_warehouse ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:41.101064 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse
[0m15:19:41.102298 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:19:41.103463 [info ] [Thread-1  ]: 15 of 46 START sql view model dbt.stg_warehouse_address ........................ [RUN]
[0m15:19:41.104753 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address'
[0m15:19:41.105800 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address
[0m15:19:41.118597 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.119930 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: BEGIN
[0m15:19:41.121038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.128903 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.130342 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.131591 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:41.139296 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:41.150935 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.152197 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_address'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:41.155925 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:41.167613 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.175632 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (compile): 2024-09-01 15:19:41.106577 => 2024-09-01 15:19:41.175487
[0m15:19:41.176594 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address
[0m15:19:41.184371 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.192779 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.193634 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */

  create view "postgres"."dbt"."stg_warehouse_address__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house

    FROM "postgres"."dbt"."source_warehouse_address"
),

derived_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    id AS WAREHOUSE_ADDRESS_KEY,
    'CSV_WAREHOUSE_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_ADDRESS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(house AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(street AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_ADDRESS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    warehouse_id,
    city_id,
    street,
    house,
    WAREHOUSE_ADDRESS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_ADDRESS_PK,
    WAREHOUSE_ADDRESS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:41.195931 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.200701 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.201873 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
alter table "postgres"."dbt"."stg_warehouse_address__dbt_tmp" rename to "stg_warehouse_address"
[0m15:19:41.203541 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.206232 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:19:41.207584 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.208688 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: COMMIT
[0m15:19:41.212344 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.216782 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address"
[0m15:19:41.217786 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address__dbt_backup" cascade
[0m15:19:41.218969 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.221109 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address (execute): 2024-09-01 15:19:41.177303 => 2024-09-01 15:19:41.221051
[0m15:19:41.222306 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address: Close
[0m15:19:41.223946 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f584a9a90>]}
[0m15:19:41.225356 [info ] [Thread-1  ]: 15 of 46 OK created sql view model dbt.stg_warehouse_address ................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:41.226971 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address
[0m15:19:41.228481 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:19:41.229778 [info ] [Thread-1  ]: 16 of 46 START sql view model dbt.stg_warehouse_params ......................... [RUN]
[0m15:19:41.231332 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_params'
[0m15:19:41.232345 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_params
[0m15:19:41.246038 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.247370 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: BEGIN
[0m15:19:41.248547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.256332 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.257656 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.258784 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:41.266714 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:41.277193 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.278387 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'source_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:41.282124 [debug] [Thread-1  ]: SQL status: SELECT 5 in 0 seconds
[0m15:19:41.294056 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.302524 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (compile): 2024-09-01 15:19:41.233121 => 2024-09-01 15:19:41.302401
[0m15:19:41.303621 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_params
[0m15:19:41.311629 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.320686 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.321463 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_params__dbt_tmp" as (
    








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume

    FROM "postgres"."dbt"."source_warehouse_params"
),

derived_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    id AS WAREHOUSE_PARAMS_KEY,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(UPPER(TRIM(CAST(id AS VARCHAR))), '')), 'hex') AS WAREHOUSE_PARAMS_PK,

    DECODE(MD5(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_volume AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(max_loading_weight AS VARCHAR))), ''), '^^')
    )), 'hex') AS WAREHOUSE_PARAMS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    id,
    address_id,
    warehouse_id,
    max_loading_weight,
    max_loading_volume,
    WAREHOUSE_PARAMS_KEY,
    RECORD_SOURCE,
    WAREHOUSE_PARAMS_PK,
    WAREHOUSE_PARAMS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
    current_timestamp AS LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM
FROM staging
  );
[0m15:19:41.323703 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.329871 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.331165 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_params__dbt_tmp" rename to "stg_warehouse_params"
[0m15:19:41.332950 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.335730 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:19:41.336925 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.337964 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: COMMIT
[0m15:19:41.341787 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.346230 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_params"
[0m15:19:41.347328 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_params__dbt_backup" cascade
[0m15:19:41.348758 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.351092 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_params (execute): 2024-09-01 15:19:41.304494 => 2024-09-01 15:19:41.351033
[0m15:19:41.352278 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_params: Close
[0m15:19:41.353860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a5c0910>]}
[0m15:19:41.355245 [info ] [Thread-1  ]: 16 of 46 OK created sql view model dbt.stg_warehouse_params .................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:41.356657 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_params
[0m15:19:41.358185 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_city
[0m15:19:41.359430 [info ] [Thread-1  ]: 17 of 46 START sql view model dbt.stg_client_address_city ...................... [RUN]
[0m15:19:41.361456 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_city'
[0m15:19:41.362706 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_city
[0m15:19:41.368312 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:19:41.375349 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (compile): 2024-09-01 15:19:41.363694 => 2024-09-01 15:19:41.375258
[0m15:19:41.376236 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_city
[0m15:19:41.383978 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_city"
[0m15:19:41.392067 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:19:41.392992 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: BEGIN
[0m15:19:41.393765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.401335 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.402773 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:19:41.403915 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */

  create view "postgres"."dbt"."stg_client_address_city__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, id from "postgres"."dbt"."stg_city"
),

stg_client_address as (
    select CLIENT_ADDRESS_KEY, CLIENT_ADDRESS_PK, city_id::bigint AS city_id from "postgres"."dbt"."stg_client_address"
)

select  CLIENT_ADDRESS_KEY, CITY_KEY, CLIENT_ADDRESS_PK, CITY_PK from stg_city sc
JOIN stg_client_address sca ON sc.id = sca.city_id
  );
[0m15:19:41.406684 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.412129 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:19:41.413239 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */
alter table "postgres"."dbt"."stg_client_address_city__dbt_tmp" rename to "stg_client_address_city"
[0m15:19:41.414633 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.417150 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: COMMIT
[0m15:19:41.418112 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:19:41.419038 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: COMMIT
[0m15:19:41.421540 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.426843 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_city"
[0m15:19:41.428096 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_city"} */
drop view if exists "postgres"."dbt"."stg_client_address_city__dbt_backup" cascade
[0m15:19:41.429396 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.431467 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_city (execute): 2024-09-01 15:19:41.376863 => 2024-09-01 15:19:41.431408
[0m15:19:41.432417 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_city: Close
[0m15:19:41.433852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5ab75a60>]}
[0m15:19:41.435034 [info ] [Thread-1  ]: 17 of 46 OK created sql view model dbt.stg_client_address_city ................. [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:41.436435 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_city
[0m15:19:41.437810 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_address_client
[0m15:19:41.439114 [info ] [Thread-1  ]: 18 of 46 START sql view model dbt.stg_client_address_client .................... [RUN]
[0m15:19:41.440875 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_address_client'
[0m15:19:41.442086 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_address_client
[0m15:19:41.447961 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:19:41.454878 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_client (compile): 2024-09-01 15:19:41.443060 => 2024-09-01 15:19:41.454786
[0m15:19:41.455664 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_address_client
[0m15:19:41.463328 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_address_client"
[0m15:19:41.470818 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:19:41.471544 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: BEGIN
[0m15:19:41.472371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.479977 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.481563 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:19:41.483001 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */

  create view "postgres"."dbt"."stg_client_address_client__dbt_tmp" as (
    with stg_client as (
    select CLIENT_KEY, CLIENT_PK, client_address_id from "postgres"."dbt"."stg_client"
),

stg_client_address as (
    select CLIENT_ADDRESS_KEY, CLIENT_ADDRESS_PK, id::bigint AS id from "postgres"."dbt"."stg_client_address"
)

select  CLIENT_ADDRESS_KEY, CLIENT_KEY, CLIENT_ADDRESS_PK, CLIENT_PK from stg_client sc
JOIN stg_client_address sca ON sca.id = sc.client_address_id
  );
[0m15:19:41.486030 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.491569 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:19:41.492766 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */
alter table "postgres"."dbt"."stg_client_address_client__dbt_tmp" rename to "stg_client_address_client"
[0m15:19:41.494081 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.496597 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: COMMIT
[0m15:19:41.497604 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:19:41.498580 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: COMMIT
[0m15:19:41.501082 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.505524 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_address_client"
[0m15:19:41.506612 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_address_client"} */
drop view if exists "postgres"."dbt"."stg_client_address_client__dbt_backup" cascade
[0m15:19:41.507832 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.509903 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_address_client (execute): 2024-09-01 15:19:41.456270 => 2024-09-01 15:19:41.509845
[0m15:19:41.510944 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_address_client: Close
[0m15:19:41.512511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58582f40>]}
[0m15:19:41.513846 [info ] [Thread-1  ]: 18 of 46 OK created sql view model dbt.stg_client_address_client ............... [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:41.515364 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_address_client
[0m15:19:41.516628 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_client_client_type
[0m15:19:41.517887 [info ] [Thread-1  ]: 19 of 46 START sql view model dbt.stg_client_client_type ....................... [RUN]
[0m15:19:41.519568 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_client_client_type'
[0m15:19:41.520671 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_client_client_type
[0m15:19:41.526119 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_client_client_type"
[0m15:19:41.534385 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_client_type (compile): 2024-09-01 15:19:41.521668 => 2024-09-01 15:19:41.534273
[0m15:19:41.535475 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_client_client_type
[0m15:19:41.544682 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_client_client_type"
[0m15:19:41.553307 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:19:41.554168 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: BEGIN
[0m15:19:41.554926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.562789 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.564348 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:19:41.565598 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */

  create view "postgres"."dbt"."stg_client_client_type__dbt_tmp" as (
    with stg_client_type as (
    select CLIENT_TYPE_KEY, CLIENT_TYPE_PK, id from "postgres"."dbt"."stg_client_type"
),

stg_client as (
    select CLIENT_KEY, CLIENT_PK, type_id from "postgres"."dbt"."stg_client"
)

select  CLIENT_TYPE_KEY, CLIENT_KEY, CLIENT_TYPE_PK, CLIENT_PK from stg_client_type ct
JOIN stg_client sc ON sc.type_id = ct.id
  );
[0m15:19:41.569594 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.575226 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:19:41.576353 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */
alter table "postgres"."dbt"."stg_client_client_type__dbt_tmp" rename to "stg_client_client_type"
[0m15:19:41.577949 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.580931 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: COMMIT
[0m15:19:41.582087 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:19:41.583177 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: COMMIT
[0m15:19:41.585743 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.590214 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_client_client_type"
[0m15:19:41.591257 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_client_client_type"} */
drop view if exists "postgres"."dbt"."stg_client_client_type__dbt_backup" cascade
[0m15:19:41.592560 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.594842 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_client_client_type (execute): 2024-09-01 15:19:41.536305 => 2024-09-01 15:19:41.594781
[0m15:19:41.596042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_client_client_type: Close
[0m15:19:41.597745 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f584c9d00>]}
[0m15:19:41.599121 [info ] [Thread-1  ]: 19 of 46 OK created sql view model dbt.stg_client_client_type .................. [[32mCREATE VIEW[0m in 0.08s]
[0m15:19:41.600835 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_client_client_type
[0m15:19:41.602036 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_city_country
[0m15:19:41.603270 [info ] [Thread-1  ]: 20 of 46 START sql view model dbt.stg_city_country ............................. [RUN]
[0m15:19:41.604920 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_city_country'
[0m15:19:41.606008 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_city_country
[0m15:19:41.612196 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_city_country"
[0m15:19:41.619686 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (compile): 2024-09-01 15:19:41.606875 => 2024-09-01 15:19:41.619588
[0m15:19:41.620688 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_city_country
[0m15:19:41.630162 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_city_country"
[0m15:19:41.638201 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:19:41.638934 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: BEGIN
[0m15:19:41.639608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.647012 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.648606 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:19:41.649721 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */

  create view "postgres"."dbt"."stg_city_country__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, country_id from "postgres"."dbt"."stg_city"
),

stg_country as (
    select id, COUNTRY_KEY, COUNTRY_PK from "postgres"."dbt"."stg_country"
)

select  CITY_KEY, COUNTRY_KEY, CITY_PK, COUNTRY_PK from stg_city sci
JOIN stg_country sc ON sc.id = sci.country_id
  );
[0m15:19:41.653074 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.659961 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:19:41.661211 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
alter table "postgres"."dbt"."stg_city_country__dbt_tmp" rename to "stg_city_country"
[0m15:19:41.662720 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.665168 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:19:41.666198 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:19:41.667087 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: COMMIT
[0m15:19:41.669900 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.674236 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_city_country"
[0m15:19:41.675275 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_city_country"} */
drop view if exists "postgres"."dbt"."stg_city_country__dbt_backup" cascade
[0m15:19:41.676613 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.678720 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_city_country (execute): 2024-09-01 15:19:41.621482 => 2024-09-01 15:19:41.678662
[0m15:19:41.679861 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_city_country: Close
[0m15:19:41.681384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6cebe0>]}
[0m15:19:41.682746 [info ] [Thread-1  ]: 20 of 46 OK created sql view model dbt.stg_city_country ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:19:41.684280 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_city_country
[0m15:19:41.685658 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:19:41.686930 [info ] [Thread-1  ]: 21 of 46 START sql view model dbt.stg_currency_currency_rate ................... [RUN]
[0m15:19:41.688594 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_currency_currency_rate'
[0m15:19:41.689908 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:19:41.696409 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:19:41.704325 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (compile): 2024-09-01 15:19:41.691163 => 2024-09-01 15:19:41.704181
[0m15:19:41.705191 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:19:41.712891 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:19:41.721084 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:19:41.722010 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: BEGIN
[0m15:19:41.722916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.730284 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.731907 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:19:41.733055 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */

  create view "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" as (
    with stg_currency as (
    select code, CURRENCY_KEY, CURRENCY_PK from "postgres"."dbt"."stg_currency"
),

stg_currency_rate as (
    select currency_code, CURRENCY_RATE_KEY, CURRENCY_RATE_PK from "postgres"."dbt"."stg_currency_rate"
)

select  CURRENCY_KEY, CURRENCY_RATE_KEY, CURRENCY_PK, CURRENCY_RATE_PK from stg_currency sc
JOIN stg_currency_rate scr ON sc.code = scr.currency_code
  );
[0m15:19:41.736127 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.742332 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:19:41.743445 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
alter table "postgres"."dbt"."stg_currency_currency_rate__dbt_tmp" rename to "stg_currency_currency_rate"
[0m15:19:41.744878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.747533 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:19:41.748647 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:19:41.749574 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: COMMIT
[0m15:19:41.752318 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.793924 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_currency_currency_rate"
[0m15:19:41.795131 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_currency_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_currency_currency_rate__dbt_backup" cascade
[0m15:19:41.796499 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.798752 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_currency_currency_rate (execute): 2024-09-01 15:19:41.705787 => 2024-09-01 15:19:41.798693
[0m15:19:41.799768 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_currency_currency_rate: Close
[0m15:19:41.801364 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f585337f0>]}
[0m15:19:41.803489 [info ] [Thread-1  ]: 21 of 46 OK created sql view model dbt.stg_currency_currency_rate .............. [[32mCREATE VIEW[0m in 0.11s]
[0m15:19:41.804740 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_currency_currency_rate
[0m15:19:41.805924 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:19:41.807294 [info ] [Thread-1  ]: 22 of 46 START sql view model dbt.stg_order_status_order_status_history ........ [RUN]
[0m15:19:41.808866 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_status_order_status_history'
[0m15:19:41.809982 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:19:41.816146 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:19:41.823309 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_order_status_history (compile): 2024-09-01 15:19:41.810885 => 2024-09-01 15:19:41.823216
[0m15:19:41.824099 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:19:41.832060 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:19:41.839594 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:19:41.840318 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: BEGIN
[0m15:19:41.841000 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.848327 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.849865 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:19:41.851001 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */

  create view "postgres"."dbt"."stg_order_status_order_status_history__dbt_tmp" as (
    with stg_order_status as (
    select ORDER_STATUS_KEY, ORDER_STATUS_PK, id from "postgres"."dbt"."stg_order_status"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, status_id from "postgres"."dbt"."stg_order_status_history"
)

select  ORDER_STATUS_KEY, ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_PK, ORDER_STATUS_HISTORY_PK from stg_order_status os
JOIN stg_order_status_history sh ON sh.status_id = os.id
  );
[0m15:19:41.853820 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.859022 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:19:41.860091 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */
alter table "postgres"."dbt"."stg_order_status_order_status_history__dbt_tmp" rename to "stg_order_status_order_status_history"
[0m15:19:41.861677 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.864755 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: COMMIT
[0m15:19:41.865948 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:19:41.866992 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: COMMIT
[0m15:19:41.870993 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.875566 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_status_order_status_history"
[0m15:19:41.877013 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_status_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_status_order_status_history__dbt_backup" cascade
[0m15:19:41.878441 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.880622 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_status_order_status_history (execute): 2024-09-01 15:19:41.824695 => 2024-09-01 15:19:41.880564
[0m15:19:41.881731 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_status_order_status_history: Close
[0m15:19:41.883154 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58533190>]}
[0m15:19:41.884325 [info ] [Thread-1  ]: 22 of 46 OK created sql view model dbt.stg_order_status_order_status_history ... [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:41.885749 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_status_order_status_history
[0m15:19:41.887183 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_client
[0m15:19:41.888486 [info ] [Thread-1  ]: 23 of 46 START sql view model dbt.stg_order_client ............................. [RUN]
[0m15:19:41.889855 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_client'
[0m15:19:41.890859 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_client
[0m15:19:41.896220 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_client"
[0m15:19:41.902561 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_client (compile): 2024-09-01 15:19:41.891686 => 2024-09-01 15:19:41.902467
[0m15:19:41.903335 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_client
[0m15:19:41.913048 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_client"
[0m15:19:41.921618 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:19:41.922338 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: BEGIN
[0m15:19:41.922941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:41.930269 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:41.931744 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:19:41.932898 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */

  create view "postgres"."dbt"."stg_order_client__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, id from "postgres"."dbt"."stg_orders"
),

stg_client as (
    select CLIENT_KEY, CLIENT_PK, order_id::bigint AS order_id from "postgres"."dbt"."stg_client"
)

select  ORDER_KEY, CLIENT_KEY, ORDER_PK, CLIENT_PK from stg_orders o
JOIN stg_client sc ON sc.order_id = o.id
  );
[0m15:19:41.935789 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:41.942435 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:19:41.943678 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */
alter table "postgres"."dbt"."stg_order_client__dbt_tmp" rename to "stg_order_client"
[0m15:19:41.945167 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:41.947711 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: COMMIT
[0m15:19:41.948673 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:19:41.949580 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: COMMIT
[0m15:19:41.952201 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:41.956668 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_client"
[0m15:19:41.957712 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_client"} */
drop view if exists "postgres"."dbt"."stg_order_client__dbt_backup" cascade
[0m15:19:41.958892 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:41.960928 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_client (execute): 2024-09-01 15:19:41.903942 => 2024-09-01 15:19:41.960855
[0m15:19:41.961822 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_client: Close
[0m15:19:41.963116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5ab6c670>]}
[0m15:19:41.964309 [info ] [Thread-1  ]: 23 of 46 OK created sql view model dbt.stg_order_client ........................ [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:41.965818 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_client
[0m15:19:41.967120 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_currency
[0m15:19:41.968380 [info ] [Thread-1  ]: 24 of 46 START sql view model dbt.stg_order_currency ........................... [RUN]
[0m15:19:41.969952 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_currency'
[0m15:19:41.971602 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_currency
[0m15:19:41.977737 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_currency"
[0m15:19:41.985184 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_currency (compile): 2024-09-01 15:19:41.972816 => 2024-09-01 15:19:41.985081
[0m15:19:41.986043 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_currency
[0m15:19:41.994023 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_currency"
[0m15:19:42.002116 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:19:42.003022 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: BEGIN
[0m15:19:42.003770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:42.010906 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:42.012422 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:19:42.013549 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */

  create view "postgres"."dbt"."stg_order_currency__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, currency_code from "postgres"."dbt"."stg_orders"
),

stg_currency as (
    select code, CURRENCY_KEY, CURRENCY_PK from "postgres"."dbt"."stg_currency"
)

select  ORDER_KEY, CURRENCY_KEY, ORDER_PK, CURRENCY_PK from stg_orders o
JOIN stg_currency sc ON sc.code = o.currency_code
  );
[0m15:19:42.016467 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:42.022782 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:19:42.023885 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */
alter table "postgres"."dbt"."stg_order_currency__dbt_tmp" rename to "stg_order_currency"
[0m15:19:42.025258 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:42.027865 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: COMMIT
[0m15:19:42.028731 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:19:42.029611 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: COMMIT
[0m15:19:42.032323 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:42.036969 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_currency"
[0m15:19:42.038028 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_currency"} */
drop view if exists "postgres"."dbt"."stg_order_currency__dbt_backup" cascade
[0m15:19:42.039356 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:42.041473 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_currency (execute): 2024-09-01 15:19:41.986677 => 2024-09-01 15:19:42.041414
[0m15:19:42.042458 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_currency: Close
[0m15:19:42.044068 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58597eb0>]}
[0m15:19:42.045252 [info ] [Thread-1  ]: 24 of 46 OK created sql view model dbt.stg_order_currency ...................... [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:42.046665 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_currency
[0m15:19:42.048099 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_goods
[0m15:19:42.049562 [info ] [Thread-1  ]: 25 of 46 START sql view model dbt.stg_order_goods .............................. [RUN]
[0m15:19:42.051255 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_goods'
[0m15:19:42.052330 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_goods
[0m15:19:42.057934 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_goods"
[0m15:19:42.065353 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_goods (compile): 2024-09-01 15:19:42.053353 => 2024-09-01 15:19:42.065255
[0m15:19:42.066154 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_goods
[0m15:19:42.074158 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_goods"
[0m15:19:42.082209 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:19:42.082927 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: BEGIN
[0m15:19:42.083554 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:42.090511 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:42.091986 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:19:42.093269 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */

  create view "postgres"."dbt"."stg_order_goods__dbt_tmp" as (
    with stg_orders as (
    select id, ORDER_KEY, ORDER_PK from "postgres"."dbt"."stg_orders"
),

stg_goods as (
    select GOOD_KEY, GOOD_PK, order_id::bigint AS order_id from "postgres"."dbt"."stg_goods"
)

select  ORDER_KEY, GOOD_KEY, ORDER_PK, GOOD_PK from stg_orders o
JOIN stg_goods g ON g.order_id = o.id
  );
[0m15:19:42.096252 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:42.101979 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:19:42.102960 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */
alter table "postgres"."dbt"."stg_order_goods__dbt_tmp" rename to "stg_order_goods"
[0m15:19:42.104300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:42.106672 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: COMMIT
[0m15:19:42.107692 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:19:42.108602 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: COMMIT
[0m15:19:42.111514 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:42.117217 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_goods"
[0m15:19:42.118382 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_goods"} */
drop view if exists "postgres"."dbt"."stg_order_goods__dbt_backup" cascade
[0m15:19:42.119689 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:42.121979 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_goods (execute): 2024-09-01 15:19:42.066811 => 2024-09-01 15:19:42.121903
[0m15:19:42.122978 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_goods: Close
[0m15:19:42.124707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6d8d00>]}
[0m15:19:43.181967 [info ] [Thread-1  ]: 25 of 46 OK created sql view model dbt.stg_order_goods ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:43.183678 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_goods
[0m15:19:43.185417 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:19:43.187313 [info ] [Thread-1  ]: 26 of 46 START sql view model dbt.stg_order_order_status_history ............... [RUN]
[0m15:19:43.189435 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_order_status_history'
[0m15:19:43.190986 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:19:43.197498 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:19:43.204978 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_order_status_history (compile): 2024-09-01 15:19:43.192065 => 2024-09-01 15:19:43.204866
[0m15:19:43.205877 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:19:43.214353 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:19:43.221969 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:19:43.223221 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: BEGIN
[0m15:19:43.224194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.233121 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.234385 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:19:43.235405 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */

  create view "postgres"."dbt"."stg_order_order_status_history__dbt_tmp" as (
    with stg_orders as (
    select ORDER_KEY, ORDER_PK, id from "postgres"."dbt"."stg_orders"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, order_id from "postgres"."dbt"."stg_order_status_history"
)

select  ORDER_KEY, ORDER_STATUS_HISTORY_KEY, ORDER_PK, ORDER_STATUS_HISTORY_PK from stg_orders o
JOIN stg_order_status_history sh ON sh.order_id = o.id
  );
[0m15:19:43.238396 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.244808 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:19:43.245907 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */
alter table "postgres"."dbt"."stg_order_order_status_history__dbt_tmp" rename to "stg_order_order_status_history"
[0m15:19:43.247442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.250208 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: COMMIT
[0m15:19:43.251217 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:19:43.252111 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: COMMIT
[0m15:19:43.255480 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.260229 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_order_status_history"
[0m15:19:43.261244 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_order_order_status_history__dbt_backup" cascade
[0m15:19:43.262565 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.264903 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_order_status_history (execute): 2024-09-01 15:19:43.206555 => 2024-09-01 15:19:43.264838
[0m15:19:43.265727 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_order_status_history: Close
[0m15:19:43.267061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6d84f0>]}
[0m15:19:43.268308 [info ] [Thread-1  ]: 26 of 46 OK created sql view model dbt.stg_order_order_status_history .......... [[32mCREATE VIEW[0m in 0.08s]
[0m15:19:43.269665 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_order_status_history
[0m15:19:43.271039 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:19:43.272415 [info ] [Thread-1  ]: 27 of 46 START sql view model dbt.stg_order_with_delay_order ................... [RUN]
[0m15:19:43.274029 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_order_with_delay_order'
[0m15:19:43.275281 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:19:43.282659 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:19:43.289411 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay_order (compile): 2024-09-01 15:19:43.276210 => 2024-09-01 15:19:43.289267
[0m15:19:43.290294 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:19:43.298913 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:19:43.305132 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:19:43.306017 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: BEGIN
[0m15:19:43.306714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.314110 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.315674 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:19:43.316648 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */

  create view "postgres"."dbt"."stg_order_with_delay_order__dbt_tmp" as (
    with stg_order as (
    select id, ORDER_KEY, ORDER_PK from "postgres"."dbt"."stg_orders"
),

stg_order_with_delay as (
    select ORDER_WITH_DELAY_KEY, ORDER_WITH_DELAY_PK, order_id from "postgres"."dbt"."stg_order_with_delay"
)

select  ORDER_KEY, ORDER_WITH_DELAY_KEY, ORDER_PK, ORDER_WITH_DELAY_PK from stg_order o
JOIN stg_order_with_delay od ON o.id = od.order_id
  );
[0m15:19:43.319553 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.324753 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:19:43.325830 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */
alter table "postgres"."dbt"."stg_order_with_delay_order__dbt_tmp" rename to "stg_order_with_delay_order"
[0m15:19:43.327168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.329818 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: COMMIT
[0m15:19:43.330752 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:19:43.331712 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: COMMIT
[0m15:19:43.334332 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.338853 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_order_with_delay_order"
[0m15:19:43.340094 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_order_with_delay_order"} */
drop view if exists "postgres"."dbt"."stg_order_with_delay_order__dbt_backup" cascade
[0m15:19:43.341537 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.343756 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_order_with_delay_order (execute): 2024-09-01 15:19:43.290983 => 2024-09-01 15:19:43.343696
[0m15:19:43.344681 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_order_with_delay_order: Close
[0m15:19:43.346038 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58521940>]}
[0m15:19:43.347557 [info ] [Thread-1  ]: 27 of 46 OK created sql view model dbt.stg_order_with_delay_order .............. [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:43.349182 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_order_with_delay_order
[0m15:19:43.350450 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:19:43.351983 [info ] [Thread-1  ]: 28 of 46 START sql view model dbt.stg_warehouse_order_status_history ........... [RUN]
[0m15:19:43.353851 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_order_status_history'
[0m15:19:43.355253 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:19:43.362354 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:19:43.369735 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_order_status_history (compile): 2024-09-01 15:19:43.356460 => 2024-09-01 15:19:43.369614
[0m15:19:43.370655 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:19:43.380898 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:19:43.387385 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:19:43.388209 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: BEGIN
[0m15:19:43.388934 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.396543 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.397914 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:19:43.398889 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */

  create view "postgres"."dbt"."stg_warehouse_order_status_history__dbt_tmp" as (
    with stg_warehouse as (
    select WAREHOUSE_KEY, WAREHOUSE_PK, id from "postgres"."dbt"."stg_warehouse"
),

stg_order_status_history as (
    select ORDER_STATUS_HISTORY_KEY, ORDER_STATUS_HISTORY_PK, warehouse_id from "postgres"."dbt"."stg_order_status_history"
)

select  WAREHOUSE_KEY, ORDER_STATUS_HISTORY_KEY, WAREHOUSE_PK, ORDER_STATUS_HISTORY_PK from stg_warehouse w
JOIN stg_order_status_history sh ON sh.warehouse_id = w.id
  );
[0m15:19:43.401468 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.406632 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:19:43.407935 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */
alter table "postgres"."dbt"."stg_warehouse_order_status_history__dbt_tmp" rename to "stg_warehouse_order_status_history"
[0m15:19:43.409433 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.411905 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: COMMIT
[0m15:19:43.412837 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:19:43.413596 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: COMMIT
[0m15:19:43.416265 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.420681 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_order_status_history"
[0m15:19:43.421743 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_warehouse_order_status_history__dbt_backup" cascade
[0m15:19:43.423032 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.425143 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_order_status_history (execute): 2024-09-01 15:19:43.371427 => 2024-09-01 15:19:43.425078
[0m15:19:43.426297 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_order_status_history: Close
[0m15:19:43.427956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58518250>]}
[0m15:19:43.429217 [info ] [Thread-1  ]: 28 of 46 OK created sql view model dbt.stg_warehouse_order_status_history ...... [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:43.430434 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_order_status_history
[0m15:19:43.431852 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:19:43.433300 [info ] [Thread-1  ]: 29 of 46 START sql view model dbt.stg_warehouse_address_city ................... [RUN]
[0m15:19:43.434909 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address_city'
[0m15:19:43.436179 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:19:43.442341 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:19:43.449732 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_city (compile): 2024-09-01 15:19:43.437277 => 2024-09-01 15:19:43.449627
[0m15:19:43.450577 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:19:43.459067 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:19:43.467458 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:19:43.468170 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: BEGIN
[0m15:19:43.468779 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.475802 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.477405 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:19:43.478546 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */

  create view "postgres"."dbt"."stg_warehouse_address_city__dbt_tmp" as (
    with stg_city as (
    select CITY_KEY, CITY_PK, id from "postgres"."dbt"."stg_city"
),

stg_warehouse_address as (
    select WAREHOUSE_ADDRESS_KEY, WAREHOUSE_ADDRESS_PK, city_id from "postgres"."dbt"."stg_warehouse_address"
)

select  WAREHOUSE_ADDRESS_KEY, CITY_KEY, WAREHOUSE_ADDRESS_PK, CITY_PK from stg_city sc
JOIN stg_warehouse_address swa ON sc.id = swa.city_id
  );
[0m15:19:43.481434 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.487785 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:19:43.488907 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */
alter table "postgres"."dbt"."stg_warehouse_address_city__dbt_tmp" rename to "stg_warehouse_address_city"
[0m15:19:43.490195 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.492651 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: COMMIT
[0m15:19:43.493541 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:19:43.494425 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: COMMIT
[0m15:19:43.497020 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.501485 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_city"
[0m15:19:43.502557 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_city"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address_city__dbt_backup" cascade
[0m15:19:43.503840 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.505895 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_city (execute): 2024-09-01 15:19:43.451258 => 2024-09-01 15:19:43.505837
[0m15:19:43.506856 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_city: Close
[0m15:19:43.508224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6b35b0>]}
[0m15:19:43.509433 [info ] [Thread-1  ]: 29 of 46 OK created sql view model dbt.stg_warehouse_address_city .............. [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:43.510939 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address_city
[0m15:19:43.512308 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:19:43.513637 [info ] [Thread-1  ]: 30 of 46 START sql view model dbt.stg_warehouse_address_warehouse_params ....... [RUN]
[0m15:19:43.515252 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_address_warehouse_params'
[0m15:19:43.516430 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:19:43.522264 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:19:43.529204 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_warehouse_params (compile): 2024-09-01 15:19:43.517517 => 2024-09-01 15:19:43.529114
[0m15:19:43.529978 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:19:43.538385 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:19:43.546361 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:19:43.547090 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: BEGIN
[0m15:19:43.547763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.555296 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.556991 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:19:43.558304 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_tmp" as (
    with stg_warehouse_address as (
    select WAREHOUSE_ADDRESS_KEY, WAREHOUSE_ADDRESS_PK, id from "postgres"."dbt"."stg_warehouse_address"
),

stg_warehouse_params as (
    select WAREHOUSE_PARAMS_KEY, WAREHOUSE_PARAMS_PK, address_id from "postgres"."dbt"."stg_warehouse_params"
)

select  WAREHOUSE_ADDRESS_KEY, WAREHOUSE_PARAMS_KEY, WAREHOUSE_ADDRESS_PK, WAREHOUSE_PARAMS_PK from stg_warehouse_address wa
JOIN stg_warehouse_params wp ON wp.address_id = wa.id
  );
[0m15:19:43.561462 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.567266 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:19:43.568354 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_tmp" rename to "stg_warehouse_address_warehouse_params"
[0m15:19:43.569645 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.572216 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: COMMIT
[0m15:19:43.573201 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:19:43.574113 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: COMMIT
[0m15:19:43.576704 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.582517 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"
[0m15:19:43.583612 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_address_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_address_warehouse_params__dbt_backup" cascade
[0m15:19:43.584903 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.587009 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_address_warehouse_params (execute): 2024-09-01 15:19:43.530588 => 2024-09-01 15:19:43.586949
[0m15:19:43.587848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_address_warehouse_params: Close
[0m15:19:43.589080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58518250>]}
[0m15:19:43.590178 [info ] [Thread-1  ]: 30 of 46 OK created sql view model dbt.stg_warehouse_address_warehouse_params .. [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:43.591317 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_address_warehouse_params
[0m15:19:43.592380 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:19:43.593442 [info ] [Thread-1  ]: 31 of 46 START sql view model dbt.stg_warehouse_warehouse_params ............... [RUN]
[0m15:19:43.594705 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_warehouse_warehouse_params'
[0m15:19:43.595590 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:19:43.600826 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:19:43.608840 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_warehouse_params (compile): 2024-09-01 15:19:43.596256 => 2024-09-01 15:19:43.608748
[0m15:19:43.609656 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:19:43.617720 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:19:43.625791 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:19:43.626588 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: BEGIN
[0m15:19:43.627358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.634736 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.636246 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:19:43.637373 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */

  create view "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_tmp" as (
    with stg_warehouse as (
    select WAREHOUSE_KEY, WAREHOUSE_PK, id from "postgres"."dbt"."stg_warehouse"
),

stg_warehouse_params as (
    select WAREHOUSE_PARAMS_KEY, WAREHOUSE_PARAMS_PK, warehouse_id from "postgres"."dbt"."stg_warehouse_params"
)

select  WAREHOUSE_KEY, WAREHOUSE_PARAMS_KEY, WAREHOUSE_PK, WAREHOUSE_PARAMS_PK from stg_warehouse w
JOIN stg_warehouse_params wp ON wp.warehouse_id = w.id
  );
[0m15:19:43.640839 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.646865 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:19:43.647951 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */
alter table "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_tmp" rename to "stg_warehouse_warehouse_params"
[0m15:19:43.649304 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.652290 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: COMMIT
[0m15:19:43.653130 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:19:43.653986 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: COMMIT
[0m15:19:43.656456 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.661002 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_warehouse_warehouse_params"
[0m15:19:43.662034 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_warehouse_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_warehouse_warehouse_params__dbt_backup" cascade
[0m15:19:43.663452 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.665457 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_warehouse_warehouse_params (execute): 2024-09-01 15:19:43.610280 => 2024-09-01 15:19:43.665395
[0m15:19:43.666174 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_warehouse_warehouse_params: Close
[0m15:19:43.667345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a5caf40>]}
[0m15:19:43.668580 [info ] [Thread-1  ]: 31 of 46 OK created sql view model dbt.stg_warehouse_warehouse_params .......... [[32mCREATE VIEW[0m in 0.07s]
[0m15:19:43.669799 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_warehouse_warehouse_params
[0m15:19:43.671034 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:19:43.672008 [info ] [Thread-1  ]: 32 of 46 START sql view model dbt.stg_link_client_address_city ................. [RUN]
[0m15:19:43.673407 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_address_city'
[0m15:19:43.674221 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:19:43.688450 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.689828 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: BEGIN
[0m15:19:43.691022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.699272 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.700707 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.702087 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:43.711039 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:43.721998 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.723437 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:43.727233 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:43.738128 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.746352 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_city (compile): 2024-09-01 15:19:43.674889 => 2024-09-01 15:19:43.746191
[0m15:19:43.747656 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:19:43.757959 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.767123 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.768340 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */

  create view "postgres"."dbt"."stg_link_client_address_city__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk

    FROM "postgres"."dbt"."stg_client_address_city"
),

derived_columns AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    'CSV_CLIENT_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_ADDRESS_CITY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_address_key,
    city_key,
    client_address_pk,
    city_pk,
    RECORD_SOURCE,
    LINK_CLIENT_ADDRESS_CITY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:43.771902 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.779972 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.781046 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */
alter table "postgres"."dbt"."stg_link_client_address_city__dbt_tmp" rename to "stg_link_client_address_city"
[0m15:19:43.782687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.787238 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: COMMIT
[0m15:19:43.788417 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.789462 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: COMMIT
[0m15:19:43.793019 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.798715 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_city"
[0m15:19:43.799797 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_city"} */
drop view if exists "postgres"."dbt"."stg_link_client_address_city__dbt_backup" cascade
[0m15:19:43.800948 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.802915 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_city (execute): 2024-09-01 15:19:43.748630 => 2024-09-01 15:19:43.802857
[0m15:19:43.803823 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_city: Close
[0m15:19:43.805176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58518250>]}
[0m15:19:43.806168 [info ] [Thread-1  ]: 32 of 46 OK created sql view model dbt.stg_link_client_address_city ............ [[32mCREATE VIEW[0m in 0.13s]
[0m15:19:43.807592 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_address_city
[0m15:19:43.809089 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:19:43.810274 [info ] [Thread-1  ]: 33 of 46 START sql view model dbt.stg_link_client_address_client ............... [RUN]
[0m15:19:43.811826 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_address_client'
[0m15:19:43.812812 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:19:43.825876 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.826964 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: BEGIN
[0m15:19:43.827896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.835347 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.836667 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.837763 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:43.844691 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:43.854747 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.855886 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_address_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:43.859475 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:43.868686 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.876664 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_client (compile): 2024-09-01 15:19:43.813721 => 2024-09-01 15:19:43.876566
[0m15:19:43.877546 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:19:43.887252 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.896303 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.897431 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */

  create view "postgres"."dbt"."stg_link_client_address_client__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk

    FROM "postgres"."dbt"."stg_client_address_client"
),

derived_columns AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_ADDRESS_CLIENT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_address_key,
    client_key,
    client_address_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_CLIENT_ADDRESS_CLIENT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:43.899928 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:43.905197 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.906189 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */
alter table "postgres"."dbt"."stg_link_client_address_client__dbt_tmp" rename to "stg_link_client_address_client"
[0m15:19:43.907773 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:43.910937 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: COMMIT
[0m15:19:43.912216 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.913255 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: COMMIT
[0m15:19:43.915947 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:43.920504 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_address_client"
[0m15:19:43.921740 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_address_client"} */
drop view if exists "postgres"."dbt"."stg_link_client_address_client__dbt_backup" cascade
[0m15:19:43.923164 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:43.925663 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_address_client (execute): 2024-09-01 15:19:43.878138 => 2024-09-01 15:19:43.925533
[0m15:19:43.926892 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_address_client: Close
[0m15:19:43.928654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6d8b20>]}
[0m15:19:43.930030 [info ] [Thread-1  ]: 33 of 46 OK created sql view model dbt.stg_link_client_address_client .......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:43.931619 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_address_client
[0m15:19:43.933210 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:19:43.934347 [info ] [Thread-1  ]: 34 of 46 START sql view model dbt.stg_link_client_client_type .................. [RUN]
[0m15:19:43.935892 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_client_client_type'
[0m15:19:43.937050 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:19:43.950144 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:43.951370 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: BEGIN
[0m15:19:43.952416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:43.960210 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:43.961615 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:43.962549 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:43.969051 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:43.980101 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:43.981120 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_client_client_type'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:43.984553 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:43.993844 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:44.001145 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_client_type (compile): 2024-09-01 15:19:43.938153 => 2024-09-01 15:19:44.001049
[0m15:19:44.001986 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:19:44.010176 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:44.017646 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:44.018324 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */

  create view "postgres"."dbt"."stg_link_client_client_type__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk

    FROM "postgres"."dbt"."stg_client_client_type"
),

derived_columns AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_TYPE_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CLIENT_CLIENT_TYPE_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    client_type_key,
    client_key,
    client_type_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_CLIENT_CLIENT_TYPE_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.020627 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.026169 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:44.027424 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */
alter table "postgres"."dbt"."stg_link_client_client_type__dbt_tmp" rename to "stg_link_client_client_type"
[0m15:19:44.028998 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.031668 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: COMMIT
[0m15:19:44.032790 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:44.033758 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: COMMIT
[0m15:19:44.037128 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.041766 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_client_client_type"
[0m15:19:44.042867 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_client_client_type"} */
drop view if exists "postgres"."dbt"."stg_link_client_client_type__dbt_backup" cascade
[0m15:19:44.044188 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.046319 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_client_client_type (execute): 2024-09-01 15:19:44.002608 => 2024-09-01 15:19:44.046260
[0m15:19:44.047442 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_client_client_type: Close
[0m15:19:44.048931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f58523df0>]}
[0m15:19:44.050334 [info ] [Thread-1  ]: 34 of 46 OK created sql view model dbt.stg_link_client_client_type ............. [[32mCREATE VIEW[0m in 0.11s]
[0m15:19:44.051902 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_client_client_type
[0m15:19:44.053107 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_city_country
[0m15:19:44.054368 [info ] [Thread-1  ]: 35 of 46 START sql view model dbt.stg_link_city_country ........................ [RUN]
[0m15:19:44.055968 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_city_country'
[0m15:19:44.057125 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_city_country
[0m15:19:44.108168 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.109457 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: BEGIN
[0m15:19:44.110664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:44.118767 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:44.120299 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.121608 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_city_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.129363 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.139469 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.140679 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_city_country'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.144523 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.153616 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.162190 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_city_country (compile): 2024-09-01 15:19:44.057972 => 2024-09-01 15:19:44.162060
[0m15:19:44.163163 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_city_country
[0m15:19:44.171929 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.181239 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.182016 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */

  create view "postgres"."dbt"."stg_link_city_country__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk

    FROM "postgres"."dbt"."stg_city_country"
),

derived_columns AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    'CSV_CITY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(COUNTRY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CITY_COUNTRY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    city_key,
    country_key,
    city_pk,
    country_pk,
    RECORD_SOURCE,
    LINK_CITY_COUNTRY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.184342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.189889 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.191233 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */
alter table "postgres"."dbt"."stg_link_city_country__dbt_tmp" rename to "stg_link_city_country"
[0m15:19:44.192883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.195605 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: COMMIT
[0m15:19:44.196639 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.197698 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: COMMIT
[0m15:19:44.200703 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.205931 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_city_country"
[0m15:19:44.206937 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_city_country"} */
drop view if exists "postgres"."dbt"."stg_link_city_country__dbt_backup" cascade
[0m15:19:44.208500 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.211008 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_city_country (execute): 2024-09-01 15:19:44.163996 => 2024-09-01 15:19:44.210946
[0m15:19:44.212013 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_city_country: Close
[0m15:19:44.213426 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5845de80>]}
[0m15:19:44.214523 [info ] [Thread-1  ]: 35 of 46 OK created sql view model dbt.stg_link_city_country ................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:19:44.215759 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_city_country
[0m15:19:44.217019 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:19:44.218460 [info ] [Thread-1  ]: 36 of 46 START sql view model dbt.stg_link_currency_currency_rate .............. [RUN]
[0m15:19:44.220234 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_currency_currency_rate'
[0m15:19:44.221566 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:19:44.235383 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.236445 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: BEGIN
[0m15:19:44.237477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:44.245146 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:44.246432 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.247486 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_currency_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.255724 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.265762 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.266870 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_currency_currency_rate'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.270467 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.279701 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.288202 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_currency_currency_rate (compile): 2024-09-01 15:19:44.222666 => 2024-09-01 15:19:44.288102
[0m15:19:44.289006 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:19:44.297328 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.305354 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.306218 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */

  create view "postgres"."dbt"."stg_link_currency_currency_rate__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk

    FROM "postgres"."dbt"."stg_currency_currency_rate"
),

derived_columns AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    'CSV_CURRENCY_RATE'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_RATE_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_CURRENCY_CURRENCY_RATE_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    currency_key,
    currency_rate_key,
    currency_pk,
    currency_rate_pk,
    RECORD_SOURCE,
    LINK_CURRENCY_CURRENCY_RATE_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.308539 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.314946 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.316083 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */
alter table "postgres"."dbt"."stg_link_currency_currency_rate__dbt_tmp" rename to "stg_link_currency_currency_rate"
[0m15:19:44.317571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.320376 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: COMMIT
[0m15:19:44.321374 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.322399 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: COMMIT
[0m15:19:44.325614 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.329958 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_currency_currency_rate"
[0m15:19:44.330807 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_currency_currency_rate"} */
drop view if exists "postgres"."dbt"."stg_link_currency_currency_rate__dbt_backup" cascade
[0m15:19:44.332019 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.334209 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_currency_currency_rate (execute): 2024-09-01 15:19:44.289618 => 2024-09-01 15:19:44.334134
[0m15:19:44.335316 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_currency_currency_rate: Close
[0m15:19:44.336750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a625e50>]}
[0m15:19:44.337976 [info ] [Thread-1  ]: 36 of 46 OK created sql view model dbt.stg_link_currency_currency_rate ......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:44.339466 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_currency_currency_rate
[0m15:19:44.340704 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:19:44.341885 [info ] [Thread-1  ]: 37 of 46 START sql view model dbt.stg_link_order_status_order_status_history ... [RUN]
[0m15:19:44.343713 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_status_order_status_history'
[0m15:19:44.344889 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:19:44.357565 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.358658 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: BEGIN
[0m15:19:44.359605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:44.367627 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:44.368868 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.369818 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_status_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.377020 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.388144 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.389188 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_status_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.392670 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.402203 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.411060 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_status_order_status_history (compile): 2024-09-01 15:19:44.345637 => 2024-09-01 15:19:44.410950
[0m15:19:44.412108 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:19:44.421296 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.429511 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.430460 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */

  create view "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_order_status_order_status_history"
),

derived_columns AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_status_key,
    order_status_history_key,
    order_status_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.432937 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.438291 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.439403 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */
alter table "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_tmp" rename to "stg_link_order_status_order_status_history"
[0m15:19:44.440705 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.443446 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: COMMIT
[0m15:19:44.444389 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.445316 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: COMMIT
[0m15:19:44.448439 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.452844 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_status_order_status_history"
[0m15:19:44.453849 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_status_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_order_status_order_status_history__dbt_backup" cascade
[0m15:19:44.455059 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.457123 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_status_order_status_history (execute): 2024-09-01 15:19:44.412903 => 2024-09-01 15:19:44.457065
[0m15:19:44.458215 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_status_order_status_history: Close
[0m15:19:44.459921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a625be0>]}
[0m15:19:44.461280 [info ] [Thread-1  ]: 37 of 46 OK created sql view model dbt.stg_link_order_status_order_status_history  [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:44.462784 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_status_order_status_history
[0m15:19:44.464011 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_client
[0m15:19:44.465332 [info ] [Thread-1  ]: 38 of 46 START sql view model dbt.stg_link_order_client ........................ [RUN]
[0m15:19:44.466895 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_client'
[0m15:19:44.467986 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_client
[0m15:19:44.481779 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.482981 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: BEGIN
[0m15:19:44.483974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:44.491723 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:44.493170 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.494112 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.501349 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.512555 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.513790 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_client'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.517296 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.527440 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.535436 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_client (compile): 2024-09-01 15:19:44.468881 => 2024-09-01 15:19:44.535336
[0m15:19:44.536223 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_client
[0m15:19:44.544519 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.552623 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.553657 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */

  create view "postgres"."dbt"."stg_link_order_client__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk

    FROM "postgres"."dbt"."stg_order_client"
),

derived_columns AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    'CSV_CLIENT'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CLIENT_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_CLIENT_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    client_key,
    order_pk,
    client_pk,
    RECORD_SOURCE,
    LINK_ORDER_CLIENT_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.555887 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.561430 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.562696 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */
alter table "postgres"."dbt"."stg_link_order_client__dbt_tmp" rename to "stg_link_order_client"
[0m15:19:44.564288 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.566805 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: COMMIT
[0m15:19:44.567882 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.569003 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: COMMIT
[0m15:19:44.571638 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.577079 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_client"
[0m15:19:44.578423 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_client"} */
drop view if exists "postgres"."dbt"."stg_link_order_client__dbt_backup" cascade
[0m15:19:44.579836 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.581942 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_client (execute): 2024-09-01 15:19:44.536811 => 2024-09-01 15:19:44.581884
[0m15:19:44.582982 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_client: Close
[0m15:19:44.584487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a625c70>]}
[0m15:19:44.585836 [info ] [Thread-1  ]: 38 of 46 OK created sql view model dbt.stg_link_order_client ................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:44.587296 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_client
[0m15:19:44.588799 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_currency
[0m15:19:44.589970 [info ] [Thread-1  ]: 39 of 46 START sql view model dbt.stg_link_order_currency ...................... [RUN]
[0m15:19:44.591528 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_currency'
[0m15:19:44.592447 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_currency
[0m15:19:44.605194 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.606445 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: BEGIN
[0m15:19:44.607499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:44.615393 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:44.616899 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.618062 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.624777 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.634951 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.636202 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_currency'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.639850 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.649011 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.656583 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_currency (compile): 2024-09-01 15:19:44.593257 => 2024-09-01 15:19:44.656481
[0m15:19:44.657371 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_currency
[0m15:19:44.666449 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.675905 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.676707 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */

  create view "postgres"."dbt"."stg_link_order_currency__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk

    FROM "postgres"."dbt"."stg_order_currency"
),

derived_columns AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    'CSV_ORDERS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(CURRENCY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_CURRENCY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    currency_key,
    order_pk,
    currency_pk,
    RECORD_SOURCE,
    LINK_ORDER_CURRENCY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.678895 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.685256 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.686701 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */
alter table "postgres"."dbt"."stg_link_order_currency__dbt_tmp" rename to "stg_link_order_currency"
[0m15:19:44.688362 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.691182 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: COMMIT
[0m15:19:44.692456 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.693587 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: COMMIT
[0m15:19:44.697119 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.701771 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_currency"
[0m15:19:44.702970 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_currency"} */
drop view if exists "postgres"."dbt"."stg_link_order_currency__dbt_backup" cascade
[0m15:19:44.704260 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.706253 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_currency (execute): 2024-09-01 15:19:44.657957 => 2024-09-01 15:19:44.706193
[0m15:19:44.707247 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_currency: Close
[0m15:19:44.709353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a750ee0>]}
[0m15:19:44.711180 [info ] [Thread-1  ]: 39 of 46 OK created sql view model dbt.stg_link_order_currency ................. [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:44.712687 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_currency
[0m15:19:44.714034 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_goods
[0m15:19:44.715201 [info ] [Thread-1  ]: 40 of 46 START sql view model dbt.stg_link_order_goods ......................... [RUN]
[0m15:19:44.716662 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_goods'
[0m15:19:44.717873 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_goods
[0m15:19:44.731230 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.732534 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: BEGIN
[0m15:19:44.733593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:44.741419 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:44.742926 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.743932 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.751667 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.762947 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.764206 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_goods'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.767780 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.777176 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.785818 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_goods (compile): 2024-09-01 15:19:44.718601 => 2024-09-01 15:19:44.785716
[0m15:19:44.786609 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_goods
[0m15:19:44.795038 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.804189 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.804919 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */

  create view "postgres"."dbt"."stg_link_order_goods__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk

    FROM "postgres"."dbt"."stg_order_goods"
),

derived_columns AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    'CSV_GOODS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(GOOD_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_GOOD_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    good_key,
    order_pk,
    good_pk,
    RECORD_SOURCE,
    LINK_ORDER_GOOD_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.807013 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.812427 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.813803 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */
alter table "postgres"."dbt"."stg_link_order_goods__dbt_tmp" rename to "stg_link_order_goods"
[0m15:19:44.815697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.818866 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: COMMIT
[0m15:19:44.820260 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.821180 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: COMMIT
[0m15:19:44.824302 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.828723 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_goods"
[0m15:19:44.829835 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_goods"} */
drop view if exists "postgres"."dbt"."stg_link_order_goods__dbt_backup" cascade
[0m15:19:44.831127 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.833502 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_goods (execute): 2024-09-01 15:19:44.787210 => 2024-09-01 15:19:44.833423
[0m15:19:44.834642 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_goods: Close
[0m15:19:44.836174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5abe55e0>]}
[0m15:19:44.837278 [info ] [Thread-1  ]: 40 of 46 OK created sql view model dbt.stg_link_order_goods .................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:44.838636 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_goods
[0m15:19:44.839654 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:19:44.840580 [info ] [Thread-1  ]: 41 of 46 START sql view model dbt.stg_link_order_order_status_history .......... [RUN]
[0m15:19:44.842175 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_order_status_history'
[0m15:19:44.843164 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:19:44.856731 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.857623 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: BEGIN
[0m15:19:44.858409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:44.865912 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:44.867140 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.868142 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.875273 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.886655 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.887724 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:44.891607 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:44.901941 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.908542 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_order_status_history (compile): 2024-09-01 15:19:44.843907 => 2024-09-01 15:19:44.908424
[0m15:19:44.909620 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:19:44.923718 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.933706 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.934641 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */

  create view "postgres"."dbt"."stg_link_order_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_order_order_status_history"
),

derived_columns AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    order_status_history_key,
    order_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_ORDER_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:44.937197 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:44.944019 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.946410 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */
alter table "postgres"."dbt"."stg_link_order_order_status_history__dbt_tmp" rename to "stg_link_order_order_status_history"
[0m15:19:44.948982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:44.953889 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: COMMIT
[0m15:19:44.955938 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.957450 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: COMMIT
[0m15:19:44.963100 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:44.972219 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_order_status_history"
[0m15:19:44.973358 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_order_order_status_history__dbt_backup" cascade
[0m15:19:44.974630 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:44.977587 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_order_status_history (execute): 2024-09-01 15:19:44.910429 => 2024-09-01 15:19:44.977498
[0m15:19:44.978692 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_order_status_history: Close
[0m15:19:44.981001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5845de80>]}
[0m15:19:44.984830 [info ] [Thread-1  ]: 41 of 46 OK created sql view model dbt.stg_link_order_order_status_history ..... [[32mCREATE VIEW[0m in 0.14s]
[0m15:19:44.989644 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_order_status_history
[0m15:19:44.991296 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:19:44.992556 [info ] [Thread-1  ]: 42 of 46 START sql view model dbt.stg_link_order_with_delay_order .............. [RUN]
[0m15:19:44.994682 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_order_with_delay_order'
[0m15:19:44.995856 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:19:45.011974 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.012870 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: BEGIN
[0m15:19:45.013688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:45.024302 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:45.025463 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.026327 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_with_delay_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.035171 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.047181 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.048642 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_with_delay_order'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.053417 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.066734 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.081537 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_with_delay_order (compile): 2024-09-01 15:19:44.996785 => 2024-09-01 15:19:45.081312
[0m15:19:45.083596 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:19:45.099401 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.110468 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.111786 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */

  create view "postgres"."dbt"."stg_link_order_with_delay_order__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk

    FROM "postgres"."dbt"."stg_order_with_delay_order"
),

derived_columns AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    'CSV_ORDER_WITH_DELAY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_WITH_DELAY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_ORDER_WITH_DELAY_ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    order_key,
    order_with_delay_key,
    order_pk,
    order_with_delay_pk,
    RECORD_SOURCE,
    LINK_ORDER_WITH_DELAY_ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:45.114123 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:45.120448 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.121379 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */
alter table "postgres"."dbt"."stg_link_order_with_delay_order__dbt_tmp" rename to "stg_link_order_with_delay_order"
[0m15:19:45.122553 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:45.124981 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: COMMIT
[0m15:19:45.126076 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.127258 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: COMMIT
[0m15:19:45.132179 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:45.136824 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_order_with_delay_order"
[0m15:19:45.137734 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_order_with_delay_order"} */
drop view if exists "postgres"."dbt"."stg_link_order_with_delay_order__dbt_backup" cascade
[0m15:19:45.138698 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:45.140614 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_order_with_delay_order (execute): 2024-09-01 15:19:45.085186 => 2024-09-01 15:19:45.140549
[0m15:19:45.141625 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_order_with_delay_order: Close
[0m15:19:45.142931 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6d8bb0>]}
[0m15:19:45.143908 [info ] [Thread-1  ]: 42 of 46 OK created sql view model dbt.stg_link_order_with_delay_order ......... [[32mCREATE VIEW[0m in 0.15s]
[0m15:19:45.144937 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_order_with_delay_order
[0m15:19:45.145842 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:19:45.146657 [info ] [Thread-1  ]: 43 of 46 START sql view model dbt.stg_link_warehouse_order_status_history ...... [RUN]
[0m15:19:45.147865 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_order_status_history'
[0m15:19:45.148646 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:19:45.161630 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.162464 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: BEGIN
[0m15:19:45.163132 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:45.170137 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:45.171381 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.172246 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.178706 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.190683 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.191844 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_order_status_history'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.195458 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.250828 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.257806 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_order_status_history (compile): 2024-09-01 15:19:45.149305 => 2024-09-01 15:19:45.257693
[0m15:19:45.258843 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:19:45.267994 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.275504 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.276267 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */

  create view "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk

    FROM "postgres"."dbt"."stg_warehouse_order_status_history"
),

derived_columns AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    'CSV_ORDER_STATUS_HISTORY'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(ORDER_STATUS_HISTORY_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_key,
    order_status_history_key,
    warehouse_pk,
    order_status_history_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:45.278529 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:45.283689 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.284854 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */
alter table "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_tmp" rename to "stg_link_warehouse_order_status_history"
[0m15:19:45.286223 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:45.288870 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: COMMIT
[0m15:19:45.289930 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.290850 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: COMMIT
[0m15:19:45.294136 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:45.298785 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"
[0m15:19:45.299985 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_order_status_history"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_order_status_history__dbt_backup" cascade
[0m15:19:45.301223 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:45.304212 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_order_status_history (execute): 2024-09-01 15:19:45.259892 => 2024-09-01 15:19:45.304117
[0m15:19:45.305703 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_order_status_history: Close
[0m15:19:45.307515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6d3940>]}
[0m15:19:45.308813 [info ] [Thread-1  ]: 43 of 46 OK created sql view model dbt.stg_link_warehouse_order_status_history . [[32mCREATE VIEW[0m in 0.16s]
[0m15:19:45.310647 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_order_status_history
[0m15:19:45.312074 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:19:45.313592 [info ] [Thread-1  ]: 44 of 46 START sql view model dbt.stg_link_warehouse_address_city .............. [RUN]
[0m15:19:45.315802 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_address_city'
[0m15:19:45.317041 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:19:45.331200 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.332366 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: BEGIN
[0m15:19:45.333365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:45.342867 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:45.344100 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.345201 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.353705 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.366387 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.367454 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_city'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.371407 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.381670 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.388283 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_city (compile): 2024-09-01 15:19:45.318248 => 2024-09-01 15:19:45.388142
[0m15:19:45.389256 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:19:45.398865 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.406014 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.406862 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */

  create view "postgres"."dbt"."stg_link_warehouse_address_city__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk

    FROM "postgres"."dbt"."stg_warehouse_address_city"
),

derived_columns AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    'CSV_WAREHOUSE_ADDRESS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(CITY_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_ADDRESS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ADDRESS_CITY_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_address_key,
    city_key,
    warehouse_address_pk,
    city_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ADDRESS_CITY_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:45.409191 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:45.414685 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.415936 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */
alter table "postgres"."dbt"."stg_link_warehouse_address_city__dbt_tmp" rename to "stg_link_warehouse_address_city"
[0m15:19:45.417393 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:45.420363 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: COMMIT
[0m15:19:45.421341 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.422274 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: COMMIT
[0m15:19:45.424560 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:45.429265 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_city"
[0m15:19:45.430355 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_city"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_address_city__dbt_backup" cascade
[0m15:19:45.431611 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:45.433733 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_city (execute): 2024-09-01 15:19:45.390053 => 2024-09-01 15:19:45.433673
[0m15:19:45.434732 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_city: Close
[0m15:19:45.436249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5abdfa00>]}
[0m15:19:45.437306 [info ] [Thread-1  ]: 44 of 46 OK created sql view model dbt.stg_link_warehouse_address_city ......... [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:45.438667 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_address_city
[0m15:19:45.439957 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:19:45.441029 [info ] [Thread-1  ]: 45 of 46 START sql view model dbt.stg_link_warehouse_address_warehouse_params .. [RUN]
[0m15:19:45.442566 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params'
[0m15:19:45.443442 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:19:45.458129 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.459591 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: BEGIN
[0m15:19:45.460709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:45.468327 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:45.469742 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.470894 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.478207 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.488585 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.489784 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_address_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.493235 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.502505 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.509426 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params (compile): 2024-09-01 15:19:45.444266 => 2024-09-01 15:19:45.509311
[0m15:19:45.510225 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:19:45.518893 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.526063 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.526823 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */

  create view "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk

    FROM "postgres"."dbt"."stg_warehouse_address_warehouse_params"
),

derived_columns AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_ADDRESS_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_PARAMS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_address_key,
    warehouse_params_key,
    warehouse_address_pk,
    warehouse_params_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:45.529106 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:45.535244 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.536283 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */
alter table "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_tmp" rename to "stg_link_warehouse_address_warehouse_params"
[0m15:19:45.538100 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:45.541063 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: COMMIT
[0m15:19:45.542219 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.543201 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: COMMIT
[0m15:19:45.546527 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:45.551033 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"
[0m15:19:45.552198 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_address_warehouse_params__dbt_backup" cascade
[0m15:19:45.553775 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:45.556231 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params (execute): 2024-09-01 15:19:45.510831 => 2024-09-01 15:19:45.556171
[0m15:19:45.557398 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params: Close
[0m15:19:45.558943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6ec5b0>]}
[0m15:19:45.560169 [info ] [Thread-1  ]: 45 of 46 OK created sql view model dbt.stg_link_warehouse_address_warehouse_params  [[32mCREATE VIEW[0m in 0.12s]
[0m15:19:45.561475 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_address_warehouse_params
[0m15:19:45.562762 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:19:45.563983 [info ] [Thread-1  ]: 46 of 46 START sql view model dbt.stg_link_warehouse_warehouse_params .......... [RUN]
[0m15:19:45.565503 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.stg_link_warehouse_warehouse_params'
[0m15:19:45.566502 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:19:45.579561 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.580670 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: BEGIN
[0m15:19:45.581662 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:45.590902 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:19:45.592223 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.593264 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.600417 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.610538 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.611652 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "postgres".INFORMATION_SCHEMA.columns
      where table_name = 'stg_warehouse_warehouse_params'
        
        and table_schema = 'dbt'
        
      order by ordinal_position

  
[0m15:19:45.614914 [debug] [Thread-1  ]: SQL status: SELECT 4 in 0 seconds
[0m15:19:45.625442 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.633995 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_warehouse_params (compile): 2024-09-01 15:19:45.567401 => 2024-09-01 15:19:45.633882
[0m15:19:45.634804 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:19:45.643550 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.650589 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.651382 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */

  create view "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_tmp" as (
    





with staging as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk

    FROM "postgres"."dbt"."stg_warehouse_warehouse_params"
),

derived_columns AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    'CSV_WAREHOUSE_PARAMS'::TEXT AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    RECORD_SOURCE,

    DECODE(MD5(NULLIF(CONCAT(
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_KEY AS VARCHAR))), ''), '^^'), '||',
        COALESCE(NULLIF(UPPER(TRIM(CAST(WAREHOUSE_PARAMS_KEY AS VARCHAR))), ''), '^^')
    ), '^^||^^')), 'hex') AS LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    warehouse_key,
    warehouse_params_key,
    warehouse_pk,
    warehouse_params_pk,
    RECORD_SOURCE,
    LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

select *, current_timestamp as LOAD_DATE,
    current_timestamp AS EFFECTIVE_FROM from staging
  );
[0m15:19:45.653535 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:19:45.658407 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.659356 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */
alter table "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_tmp" rename to "stg_link_warehouse_warehouse_params"
[0m15:19:45.660586 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:19:45.663306 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: COMMIT
[0m15:19:45.664487 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.665585 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: COMMIT
[0m15:19:45.668286 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:19:45.672612 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"
[0m15:19:45.673797 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.stg_link_warehouse_warehouse_params"} */
drop view if exists "postgres"."dbt"."stg_link_warehouse_warehouse_params__dbt_backup" cascade
[0m15:19:45.675010 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:19:45.677130 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.stg_link_warehouse_warehouse_params (execute): 2024-09-01 15:19:45.635436 => 2024-09-01 15:19:45.677069
[0m15:19:45.678012 [debug] [Thread-1  ]: On model.otus_project_dbtvault.stg_link_warehouse_warehouse_params: Close
[0m15:19:45.679491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7fb9a26-7d9d-40c9-89ec-8ff40a935a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5abdfa00>]}
[0m15:19:45.680876 [info ] [Thread-1  ]: 46 of 46 OK created sql view model dbt.stg_link_warehouse_warehouse_params ..... [[32mCREATE VIEW[0m in 0.11s]
[0m15:19:45.682188 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.stg_link_warehouse_warehouse_params
[0m15:19:45.685942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:45.687385 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:45.688569 [debug] [MainThread]: On master: BEGIN
[0m15:19:45.689784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:45.697754 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:19:45.699336 [debug] [MainThread]: On master: COMMIT
[0m15:19:45.700601 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:45.701874 [debug] [MainThread]: On master: COMMIT
[0m15:19:45.703332 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:19:45.704517 [debug] [MainThread]: On master: Close
[0m15:19:45.705912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:45.707632 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.stg_link_warehouse_warehouse_params' was properly closed.
[0m15:19:45.708984 [info ] [MainThread]: 
[0m15:19:45.710102 [info ] [MainThread]: Finished running 46 view models in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m15:19:45.714635 [debug] [MainThread]: Command end result
[0m15:19:45.748509 [info ] [MainThread]: 
[0m15:19:45.749771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:45.751217 [info ] [MainThread]: 
[0m15:19:45.752681 [info ] [MainThread]: Done. PASS=46 WARN=0 ERROR=0 SKIP=0 TOTAL=46
[0m15:19:45.754093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5ab77d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a5c0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f5a6d8370>]}
[0m15:19:45.755321 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:21:55.768903 | a60cf242-6b67-4c14-b7db-bd2238d6c403 ==============================
[0m15:21:55.768903 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:21:55.772163 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:raw_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:21:55.773550 [debug] [MainThread]: Tracking: tracking
[0m15:21:55.779279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95826d5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95826d5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95826d5a30>]}
[0m15:21:58.956720 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:21:58.958012 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/stage/stg_order_status_history1.sql
[0m15:21:59.001465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95826040d0>]}
[0m15:21:59.049543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958229f130>]}
[0m15:21:59.050611 [info ] [MainThread]: Found 96 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:21:59.051626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95826bb0a0>]}
[0m15:21:59.061287 [info ] [MainThread]: 
[0m15:21:59.064596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:21:59.070002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:21:59.086184 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:21:59.087453 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:21:59.088569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:59.097401 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:21:59.100082 [debug] [ThreadPool]: On list_postgres: Close
[0m15:21:59.110249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:21:59.119594 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:21:59.120860 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:21:59.122018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:59.130016 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:21:59.131658 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:21:59.132819 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:21:59.136054 [debug] [ThreadPool]: SQL status: SELECT 61 in 0 seconds
[0m15:21:59.139959 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:21:59.141330 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:21:59.164217 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:59.165526 [debug] [MainThread]: On master: BEGIN
[0m15:21:59.166686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:59.174500 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:21:59.176215 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:59.177231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:21:59.203455 [debug] [MainThread]: SQL status: SELECT 61 in 0 seconds
[0m15:21:59.214424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95826c5550>]}
[0m15:21:59.215788 [debug] [MainThread]: On master: ROLLBACK
[0m15:21:59.217107 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:59.218179 [debug] [MainThread]: On master: BEGIN
[0m15:21:59.219297 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:21:59.220370 [debug] [MainThread]: On master: COMMIT
[0m15:21:59.221378 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:59.222155 [debug] [MainThread]: On master: COMMIT
[0m15:21:59.222977 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:21:59.223796 [debug] [MainThread]: On master: Close
[0m15:21:59.224988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:21:59.225962 [info ] [MainThread]: 
[0m15:21:59.231578 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_city
[0m15:21:59.232962 [info ] [Thread-1  ]: 1 of 45 START sql incremental model dbt.hub_city ............................... [RUN]
[0m15:21:59.234709 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_city'
[0m15:21:59.235711 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_city
[0m15:21:59.273997 [info ] [Thread-1  ]: 15:21:59 + Loading postgres.dbt.hub_city from 1 source(s)
[0m15:21:59.371156 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_city"
[0m15:21:59.386340 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_city (compile): 2024-09-01 15:21:59.236604 => 2024-09-01 15:21:59.386214
[0m15:21:59.387190 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_city
[0m15:21:59.471487 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_city"
[0m15:21:59.486450 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:21:59.487227 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: BEGIN
[0m15:21:59.487882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:21:59.494912 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:21:59.496272 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:21:59.497249 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_city"} */

      
  
    

  create  table "postgres"."dbt"."hub_city"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CITY_PK) rr.CITY_PK, rr.CITY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_city" AS rr
    WHERE rr.CITY_PK IS NOT NULL
    ORDER BY rr.CITY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CITY_PK, a.CITY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:21:59.517142 [debug] [Thread-1  ]: SQL status: SELECT 2351 in 0 seconds
[0m15:21:59.545089 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: COMMIT
[0m15:21:59.546243 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_city"
[0m15:21:59.547252 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: COMMIT
[0m15:21:59.551491 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:21:59.553163 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_city (execute): 2024-09-01 15:21:59.387846 => 2024-09-01 15:21:59.553103
[0m15:21:59.554192 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_city: Close
[0m15:21:59.555703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177f70>]}
[0m15:21:59.557060 [info ] [Thread-1  ]: 1 of 45 OK created sql incremental model dbt.hub_city .......................... [[32mSELECT 2351[0m in 0.32s]
[0m15:21:59.560400 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_city
[0m15:21:59.561723 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_client
[0m15:21:59.562928 [info ] [Thread-1  ]: 2 of 45 START sql incremental model dbt.hub_client ............................. [RUN]
[0m15:21:59.564828 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_client'
[0m15:21:59.565852 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_client
[0m15:21:59.574763 [info ] [Thread-1  ]: 15:21:59 + Loading postgres.dbt.hub_client from 1 source(s)
[0m15:21:59.585070 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_client"
[0m15:21:59.593379 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client (compile): 2024-09-01 15:21:59.566744 => 2024-09-01 15:21:59.593266
[0m15:21:59.594508 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_client
[0m15:21:59.604770 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_client"
[0m15:21:59.614979 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client"
[0m15:21:59.615916 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client: BEGIN
[0m15:21:59.616839 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:21:59.624287 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:21:59.625743 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client"
[0m15:21:59.626950 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_client"} */

      
  
    

  create  table "postgres"."dbt"."hub_client"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CLIENT_PK) rr.CLIENT_PK, rr.CLIENT_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client" AS rr
    WHERE rr.CLIENT_PK IS NOT NULL
    ORDER BY rr.CLIENT_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CLIENT_PK, a.CLIENT_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:00.827110 [debug] [Thread-1  ]: SQL status: SELECT 180000 in 1 seconds
[0m15:22:00.830349 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client: COMMIT
[0m15:22:00.831757 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client"
[0m15:22:00.832913 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client: COMMIT
[0m15:22:00.883854 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:00.885828 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client (execute): 2024-09-01 15:21:59.595332 => 2024-09-01 15:22:00.885737
[0m15:22:00.887148 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client: Close
[0m15:22:00.888892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177e50>]}
[0m15:22:00.890187 [info ] [Thread-1  ]: 2 of 45 OK created sql incremental model dbt.hub_client ........................ [[32mSELECT 180000[0m in 1.32s]
[0m15:22:00.891397 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_client
[0m15:22:00.893006 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_client_address
[0m15:22:00.894169 [info ] [Thread-1  ]: 3 of 45 START sql incremental model dbt.hub_client_address ..................... [RUN]
[0m15:22:00.896079 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_client_address'
[0m15:22:00.897474 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_client_address
[0m15:22:00.906336 [info ] [Thread-1  ]: 15:22:00 + Loading postgres.dbt.hub_client_address from 1 source(s)
[0m15:22:00.915958 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_client_address"
[0m15:22:00.924591 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client_address (compile): 2024-09-01 15:22:00.898439 => 2024-09-01 15:22:00.924479
[0m15:22:00.925425 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_client_address
[0m15:22:00.936364 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_client_address"
[0m15:22:00.945764 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_address"
[0m15:22:00.946526 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_address: BEGIN
[0m15:22:00.947217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:00.954704 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:00.956370 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_address"
[0m15:22:00.957397 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_client_address"} */

      
  
    

  create  table "postgres"."dbt"."hub_client_address"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CLIENT_ADDRESS_PK) rr.CLIENT_ADDRESS_PK, rr.CLIENT_ADDRESS_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client_address" AS rr
    WHERE rr.CLIENT_ADDRESS_PK IS NOT NULL
    ORDER BY rr.CLIENT_ADDRESS_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CLIENT_ADDRESS_PK, a.CLIENT_ADDRESS_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:01.591204 [debug] [Thread-1  ]: SQL status: SELECT 120000 in 1 seconds
[0m15:22:01.594704 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_address: COMMIT
[0m15:22:01.595907 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_address"
[0m15:22:01.596942 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_address: COMMIT
[0m15:22:01.623458 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:01.625330 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client_address (execute): 2024-09-01 15:22:00.926051 => 2024-09-01 15:22:01.625266
[0m15:22:01.626394 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_address: Close
[0m15:22:01.628002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177f10>]}
[0m15:22:01.629271 [info ] [Thread-1  ]: 3 of 45 OK created sql incremental model dbt.hub_client_address ................ [[32mSELECT 120000[0m in 0.73s]
[0m15:22:01.630965 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_client_address
[0m15:22:01.632273 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_client_type
[0m15:22:01.633222 [info ] [Thread-1  ]: 4 of 45 START sql incremental model dbt.hub_client_type ........................ [RUN]
[0m15:22:01.635024 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_client_type'
[0m15:22:01.636448 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_client_type
[0m15:22:01.645608 [info ] [Thread-1  ]: 15:22:01 + Loading postgres.dbt.hub_client_type from 1 source(s)
[0m15:22:01.655660 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_client_type"
[0m15:22:01.663927 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client_type (compile): 2024-09-01 15:22:01.637333 => 2024-09-01 15:22:01.663823
[0m15:22:01.664804 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_client_type
[0m15:22:01.674464 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_client_type"
[0m15:22:01.685259 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:22:01.686018 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: BEGIN
[0m15:22:01.686692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:01.694094 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:01.695624 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:22:01.696974 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_client_type"} */

      
  
    

  create  table "postgres"."dbt"."hub_client_type"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CLIENT_TYPE_PK) rr.CLIENT_TYPE_PK, rr.CLIENT_TYPE_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client_type" AS rr
    WHERE rr.CLIENT_TYPE_PK IS NOT NULL
    ORDER BY rr.CLIENT_TYPE_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CLIENT_TYPE_PK, a.CLIENT_TYPE_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:01.705260 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:22:01.708323 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: COMMIT
[0m15:22:01.709308 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_client_type"
[0m15:22:01.710242 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: COMMIT
[0m15:22:01.713196 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:01.714754 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_client_type (execute): 2024-09-01 15:22:01.665415 => 2024-09-01 15:22:01.714695
[0m15:22:01.715768 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_client_type: Close
[0m15:22:01.717238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177ee0>]}
[0m15:22:01.718483 [info ] [Thread-1  ]: 4 of 45 OK created sql incremental model dbt.hub_client_type ................... [[32mSELECT 2[0m in 0.08s]
[0m15:22:01.719872 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_client_type
[0m15:22:01.721126 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_country
[0m15:22:01.722295 [info ] [Thread-1  ]: 5 of 45 START sql incremental model dbt.hub_country ............................ [RUN]
[0m15:22:01.724071 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_country'
[0m15:22:01.724983 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_country
[0m15:22:01.733889 [info ] [Thread-1  ]: 15:22:01 + Loading postgres.dbt.hub_country from 1 source(s)
[0m15:22:01.743993 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_country"
[0m15:22:01.752496 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_country (compile): 2024-09-01 15:22:01.725701 => 2024-09-01 15:22:01.752390
[0m15:22:01.753304 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_country
[0m15:22:01.799243 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_country"
[0m15:22:01.808020 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:22:01.808811 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: BEGIN
[0m15:22:01.809484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:01.816788 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:01.818416 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:22:01.819731 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_country"} */

      
  
    

  create  table "postgres"."dbt"."hub_country"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.COUNTRY_PK) rr.COUNTRY_PK, rr.COUNTRY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_country" AS rr
    WHERE rr.COUNTRY_PK IS NOT NULL
    ORDER BY rr.COUNTRY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.COUNTRY_PK, a.COUNTRY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:01.827682 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0 seconds
[0m15:22:01.830726 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: COMMIT
[0m15:22:01.831658 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_country"
[0m15:22:01.832556 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: COMMIT
[0m15:22:01.835595 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:01.837155 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_country (execute): 2024-09-01 15:22:01.753907 => 2024-09-01 15:22:01.837095
[0m15:22:01.838041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_country: Close
[0m15:22:01.839482 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177e20>]}
[0m15:22:01.840573 [info ] [Thread-1  ]: 5 of 45 OK created sql incremental model dbt.hub_country ....................... [[32mSELECT 28[0m in 0.12s]
[0m15:22:01.841953 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_country
[0m15:22:01.843181 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_currency
[0m15:22:01.844354 [info ] [Thread-1  ]: 6 of 45 START sql incremental model dbt.hub_currency ........................... [RUN]
[0m15:22:01.845947 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_currency'
[0m15:22:01.846945 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_currency
[0m15:22:01.855862 [info ] [Thread-1  ]: 15:22:01 + Loading postgres.dbt.hub_currency from 1 source(s)
[0m15:22:01.865179 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_currency"
[0m15:22:01.874359 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency (compile): 2024-09-01 15:22:01.847821 => 2024-09-01 15:22:01.874224
[0m15:22:01.875192 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_currency
[0m15:22:01.885494 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_currency"
[0m15:22:01.895226 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:22:01.896033 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: BEGIN
[0m15:22:01.896731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:01.904273 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:01.905815 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:22:01.907041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency"} */

      
  
    

  create  table "postgres"."dbt"."hub_currency"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CURRENCY_PK) rr.CURRENCY_PK, rr.CURRENCY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency" AS rr
    WHERE rr.CURRENCY_PK IS NOT NULL
    ORDER BY rr.CURRENCY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CURRENCY_PK, a.CURRENCY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:01.914712 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0 seconds
[0m15:22:01.917882 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: COMMIT
[0m15:22:01.918886 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency"
[0m15:22:01.919813 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: COMMIT
[0m15:22:01.922337 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:01.923691 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency (execute): 2024-09-01 15:22:01.875903 => 2024-09-01 15:22:01.923632
[0m15:22:01.924545 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency: Close
[0m15:22:01.925826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177ee0>]}
[0m15:22:01.926794 [info ] [Thread-1  ]: 6 of 45 OK created sql incremental model dbt.hub_currency ...................... [[32mSELECT 19[0m in 0.08s]
[0m15:22:01.927906 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_currency
[0m15:22:01.929093 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_currency_rate
[0m15:22:01.930192 [info ] [Thread-1  ]: 7 of 45 START sql incremental model dbt.hub_currency_rate ...................... [RUN]
[0m15:22:01.931782 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_currency_rate'
[0m15:22:01.932802 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_currency_rate
[0m15:22:01.941328 [info ] [Thread-1  ]: 15:22:01 + Loading postgres.dbt.hub_currency_rate from 1 source(s)
[0m15:22:01.950951 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_currency_rate"
[0m15:22:01.959418 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency_rate (compile): 2024-09-01 15:22:01.933519 => 2024-09-01 15:22:01.959311
[0m15:22:01.960305 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_currency_rate
[0m15:22:01.971258 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_currency_rate"
[0m15:22:01.980399 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:22:01.981390 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: BEGIN
[0m15:22:01.982159 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:01.989621 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:01.991134 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:22:01.992190 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_currency_rate"} */

      
  
    

  create  table "postgres"."dbt"."hub_currency_rate"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.CURRENCY_RATE_PK) rr.CURRENCY_RATE_PK, rr.CURRENCY_RATE_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency_rate" AS rr
    WHERE rr.CURRENCY_RATE_PK IS NOT NULL
    ORDER BY rr.CURRENCY_RATE_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.CURRENCY_RATE_PK, a.CURRENCY_RATE_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:02.022169 [debug] [Thread-1  ]: SQL status: SELECT 4982 in 0 seconds
[0m15:22:02.025848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: COMMIT
[0m15:22:02.027390 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_currency_rate"
[0m15:22:02.028791 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: COMMIT
[0m15:22:02.034709 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:02.036255 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_currency_rate (execute): 2024-09-01 15:22:01.960942 => 2024-09-01 15:22:02.036195
[0m15:22:02.037136 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_currency_rate: Close
[0m15:22:02.038565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177fd0>]}
[0m15:22:02.039808 [info ] [Thread-1  ]: 7 of 45 OK created sql incremental model dbt.hub_currency_rate ................. [[32mSELECT 4982[0m in 0.11s]
[0m15:22:02.041403 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_currency_rate
[0m15:22:02.042486 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_good
[0m15:22:02.043487 [info ] [Thread-1  ]: 8 of 45 START sql incremental model dbt.hub_good ............................... [RUN]
[0m15:22:02.045735 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_good'
[0m15:22:02.047113 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_good
[0m15:22:02.056641 [info ] [Thread-1  ]: 15:22:02 + Loading postgres.dbt.hub_good from 1 source(s)
[0m15:22:02.067689 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_good"
[0m15:22:02.077078 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_good (compile): 2024-09-01 15:22:02.048081 => 2024-09-01 15:22:02.076963
[0m15:22:02.078040 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_good
[0m15:22:02.088596 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_good"
[0m15:22:02.096207 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:22:02.097126 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: BEGIN
[0m15:22:02.098017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:02.106022 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:02.107587 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:22:02.108725 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_good"} */

      
  
    

  create  table "postgres"."dbt"."hub_good"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.GOOD_PK) rr.GOOD_PK, rr.GOOD_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_goods" AS rr
    WHERE rr.GOOD_PK IS NOT NULL
    ORDER BY rr.GOOD_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.GOOD_PK, a.GOOD_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:02.619115 [debug] [Thread-1  ]: SQL status: SELECT 105759 in 1 seconds
[0m15:22:02.623629 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: COMMIT
[0m15:22:02.624962 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_good"
[0m15:22:02.625863 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: COMMIT
[0m15:22:02.697280 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:02.699017 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_good (execute): 2024-09-01 15:22:02.078746 => 2024-09-01 15:22:02.698955
[0m15:22:02.700070 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_good: Close
[0m15:22:02.701848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177e50>]}
[0m15:22:02.703166 [info ] [Thread-1  ]: 8 of 45 OK created sql incremental model dbt.hub_good .......................... [[32mSELECT 105759[0m in 0.66s]
[0m15:22:02.704438 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_good
[0m15:22:02.706089 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_order
[0m15:22:02.707455 [info ] [Thread-1  ]: 9 of 45 START sql incremental model dbt.hub_order .............................. [RUN]
[0m15:22:02.709354 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_order'
[0m15:22:02.710474 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_order
[0m15:22:02.719504 [info ] [Thread-1  ]: 15:22:02 + Loading postgres.dbt.hub_order from 1 source(s)
[0m15:22:02.729322 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_order"
[0m15:22:02.740910 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order (compile): 2024-09-01 15:22:02.711416 => 2024-09-01 15:22:02.740763
[0m15:22:02.741779 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_order
[0m15:22:02.753712 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_order"
[0m15:22:02.762923 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order"
[0m15:22:02.763924 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order: BEGIN
[0m15:22:02.764856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:02.773068 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:02.774534 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order"
[0m15:22:02.775656 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order"} */

      
  
    

  create  table "postgres"."dbt"."hub_order"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ORDER_PK) rr.ORDER_PK, rr.ORDER_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_orders" AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    ORDER BY rr.ORDER_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDER_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:03.056876 [debug] [Thread-1  ]: SQL status: SELECT 60000 in 0 seconds
[0m15:22:03.059751 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order: COMMIT
[0m15:22:03.060640 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order"
[0m15:22:03.061494 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order: COMMIT
[0m15:22:03.086494 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:03.088347 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order (execute): 2024-09-01 15:22:02.742452 => 2024-09-01 15:22:03.088284
[0m15:22:03.089420 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order: Close
[0m15:22:03.090827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177eb0>]}
[0m15:22:03.091994 [info ] [Thread-1  ]: 9 of 45 OK created sql incremental model dbt.hub_order ......................... [[32mSELECT 60000[0m in 0.38s]
[0m15:22:03.093377 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_order
[0m15:22:03.094871 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_order_status
[0m15:22:03.095892 [info ] [Thread-1  ]: 10 of 45 START sql incremental model dbt.hub_order_status ...................... [RUN]
[0m15:22:03.097453 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_order_status'
[0m15:22:03.098468 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_order_status
[0m15:22:03.107989 [info ] [Thread-1  ]: 15:22:03 + Loading postgres.dbt.hub_order_status from 1 source(s)
[0m15:22:03.118538 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_order_status"
[0m15:22:03.126625 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status (compile): 2024-09-01 15:22:03.099292 => 2024-09-01 15:22:03.126501
[0m15:22:03.127530 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_order_status
[0m15:22:03.138206 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_order_status"
[0m15:22:03.147639 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:22:03.148659 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: BEGIN
[0m15:22:03.149412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:03.156980 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:03.158599 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:22:03.159776 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_status"} */

      
  
    

  create  table "postgres"."dbt"."hub_order_status"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ORDER_STATUS_PK) rr.ORDER_STATUS_PK, rr.ORDER_STATUS_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status" AS rr
    WHERE rr.ORDER_STATUS_PK IS NOT NULL
    ORDER BY rr.ORDER_STATUS_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.ORDER_STATUS_PK, a.ORDER_STATUS_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:03.167388 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:22:03.170522 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: COMMIT
[0m15:22:03.171402 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status"
[0m15:22:03.172220 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: COMMIT
[0m15:22:03.174616 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:03.176143 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status (execute): 2024-09-01 15:22:03.128211 => 2024-09-01 15:22:03.176067
[0m15:22:03.177106 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status: Close
[0m15:22:03.178321 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177e50>]}
[0m15:22:03.179243 [info ] [Thread-1  ]: 10 of 45 OK created sql incremental model dbt.hub_order_status ................. [[32mSELECT 7[0m in 0.08s]
[0m15:22:03.180241 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_order_status
[0m15:22:03.181198 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_order_status_history
[0m15:22:03.182031 [info ] [Thread-1  ]: 11 of 45 START sql incremental model dbt.hub_order_status_history .............. [RUN]
[0m15:22:03.183301 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_order_status_history'
[0m15:22:03.184054 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_order_status_history
[0m15:22:03.193228 [info ] [Thread-1  ]: 15:22:03 + Loading postgres.dbt.hub_order_status_history from 1 source(s)
[0m15:22:03.203550 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_order_status_history"
[0m15:22:03.212557 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status_history (compile): 2024-09-01 15:22:03.184843 => 2024-09-01 15:22:03.212448
[0m15:22:03.213389 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_order_status_history
[0m15:22:03.224751 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_order_status_history"
[0m15:22:03.233900 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status_history"
[0m15:22:03.235038 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: BEGIN
[0m15:22:03.235710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:03.243080 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:03.244735 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status_history"
[0m15:22:03.246097 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_status_history"} */

      
  
    

  create  table "postgres"."dbt"."hub_order_status_history"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ORDER_STATUS_HISTORY_PK) rr.ORDER_STATUS_HISTORY_PK, rr.ORDER_STATUS_HISTORY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status_history" AS rr
    WHERE rr.ORDER_STATUS_HISTORY_PK IS NOT NULL
    ORDER BY rr.ORDER_STATUS_HISTORY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:04.499161 [debug] [Thread-1  ]: SQL status: SELECT 249912 in 1 seconds
[0m15:22:04.502480 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: COMMIT
[0m15:22:04.503615 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_status_history"
[0m15:22:04.504629 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: COMMIT
[0m15:22:04.582057 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:04.583658 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_status_history (execute): 2024-09-01 15:22:03.214028 => 2024-09-01 15:22:04.583598
[0m15:22:04.584438 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_status_history: Close
[0m15:22:04.585795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177fd0>]}
[0m15:22:04.586930 [info ] [Thread-1  ]: 11 of 45 OK created sql incremental model dbt.hub_order_status_history ......... [[32mSELECT 249912[0m in 1.40s]
[0m15:22:04.588029 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_order_status_history
[0m15:22:04.589127 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_order_with_delay
[0m15:22:04.590107 [info ] [Thread-1  ]: 12 of 45 START sql incremental model dbt.hub_order_with_delay .................. [RUN]
[0m15:22:04.591794 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_order_with_delay'
[0m15:22:04.592846 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_order_with_delay
[0m15:22:04.604209 [info ] [Thread-1  ]: 15:22:04 + Loading postgres.dbt.hub_order_with_delay from 1 source(s)
[0m15:22:04.615878 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_order_with_delay"
[0m15:22:04.623507 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_with_delay (compile): 2024-09-01 15:22:04.593769 => 2024-09-01 15:22:04.623393
[0m15:22:04.624375 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_order_with_delay
[0m15:22:04.635149 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_order_with_delay"
[0m15:22:04.644405 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_with_delay"
[0m15:22:04.645225 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_with_delay: BEGIN
[0m15:22:04.646082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:04.653469 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:04.654892 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_with_delay"
[0m15:22:04.656280 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_order_with_delay"} */

      
  
    

  create  table "postgres"."dbt"."hub_order_with_delay"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.ORDER_WITH_DELAY_PK) rr.ORDER_WITH_DELAY_PK, rr.ORDER_WITH_DELAY_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_with_delay" AS rr
    WHERE rr.ORDER_WITH_DELAY_PK IS NOT NULL
    ORDER BY rr.ORDER_WITH_DELAY_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.ORDER_WITH_DELAY_PK, a.ORDER_WITH_DELAY_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:04.677994 [debug] [Thread-1  ]: SQL status: SELECT 3088 in 0 seconds
[0m15:22:04.681122 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_with_delay: COMMIT
[0m15:22:04.682244 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_order_with_delay"
[0m15:22:04.683317 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_with_delay: COMMIT
[0m15:22:04.687778 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:04.689444 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_order_with_delay (execute): 2024-09-01 15:22:04.625010 => 2024-09-01 15:22:04.689383
[0m15:22:04.690399 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_order_with_delay: Close
[0m15:22:04.691847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177e50>]}
[0m15:22:04.693029 [info ] [Thread-1  ]: 12 of 45 OK created sql incremental model dbt.hub_order_with_delay ............. [[32mSELECT 3088[0m in 0.10s]
[0m15:22:04.694508 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_order_with_delay
[0m15:22:04.695788 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_warehouse
[0m15:22:04.696769 [info ] [Thread-1  ]: 13 of 45 START sql incremental model dbt.hub_warehouse ......................... [RUN]
[0m15:22:04.698247 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_warehouse'
[0m15:22:04.699125 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_warehouse
[0m15:22:04.708437 [info ] [Thread-1  ]: 15:22:04 + Loading postgres.dbt.hub_warehouse from 1 source(s)
[0m15:22:04.718799 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_warehouse"
[0m15:22:04.728512 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_warehouse (compile): 2024-09-01 15:22:04.699843 => 2024-09-01 15:22:04.728400
[0m15:22:04.729357 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_warehouse
[0m15:22:04.741301 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_warehouse"
[0m15:22:04.750048 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse"
[0m15:22:04.750860 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse: BEGIN
[0m15:22:04.751611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:04.758897 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:04.760349 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse"
[0m15:22:04.761371 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_warehouse"} */

      
  
    

  create  table "postgres"."dbt"."hub_warehouse"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.WAREHOUSE_PK) rr.WAREHOUSE_PK, rr.WAREHOUSE_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse" AS rr
    WHERE rr.WAREHOUSE_PK IS NOT NULL
    ORDER BY rr.WAREHOUSE_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.WAREHOUSE_PK, a.WAREHOUSE_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:04.793264 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:04.796568 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse: COMMIT
[0m15:22:04.797806 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse"
[0m15:22:04.799022 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse: COMMIT
[0m15:22:04.805215 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:04.806716 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_warehouse (execute): 2024-09-01 15:22:04.730091 => 2024-09-01 15:22:04.806657
[0m15:22:04.807735 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse: Close
[0m15:22:04.809103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177fa0>]}
[0m15:22:04.810273 [info ] [Thread-1  ]: 13 of 45 OK created sql incremental model dbt.hub_warehouse .................... [[32mSELECT 5668[0m in 0.11s]
[0m15:22:04.811942 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_warehouse
[0m15:22:04.813828 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_warehouse_address
[0m15:22:04.814980 [info ] [Thread-1  ]: 14 of 45 START sql incremental model dbt.hub_warehouse_address ................. [RUN]
[0m15:22:04.816797 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_warehouse_address'
[0m15:22:04.818035 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_warehouse_address
[0m15:22:04.826802 [info ] [Thread-1  ]: 15:22:04 + Loading postgres.dbt.hub_warehouse_address from 1 source(s)
[0m15:22:04.837136 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_warehouse_address"
[0m15:22:04.845573 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_warehouse_address (compile): 2024-09-01 15:22:04.819090 => 2024-09-01 15:22:04.845462
[0m15:22:04.846414 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_warehouse_address
[0m15:22:04.856669 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_warehouse_address"
[0m15:22:04.865784 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse_address"
[0m15:22:04.866522 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_address: BEGIN
[0m15:22:04.867196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:04.874523 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:04.875959 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse_address"
[0m15:22:04.877074 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_warehouse_address"} */

      
  
    

  create  table "postgres"."dbt"."hub_warehouse_address"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.WAREHOUSE_ADDRESS_PK) rr.WAREHOUSE_ADDRESS_PK, rr.WAREHOUSE_ADDRESS_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse_address" AS rr
    WHERE rr.WAREHOUSE_ADDRESS_PK IS NOT NULL
    ORDER BY rr.WAREHOUSE_ADDRESS_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.WAREHOUSE_ADDRESS_PK, a.WAREHOUSE_ADDRESS_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:04.909988 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:04.913136 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_address: COMMIT
[0m15:22:04.914139 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse_address"
[0m15:22:04.915026 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_address: COMMIT
[0m15:22:04.921055 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:04.922663 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_warehouse_address (execute): 2024-09-01 15:22:04.847020 => 2024-09-01 15:22:04.922597
[0m15:22:04.923909 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_address: Close
[0m15:22:04.925640 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582177e50>]}
[0m15:22:04.927052 [info ] [Thread-1  ]: 14 of 45 OK created sql incremental model dbt.hub_warehouse_address ............ [[32mSELECT 5668[0m in 0.11s]
[0m15:22:04.928971 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_warehouse_address
[0m15:22:04.930277 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.hub_warehouse_params
[0m15:22:04.931425 [info ] [Thread-1  ]: 15 of 45 START sql incremental model dbt.hub_warehouse_params .................. [RUN]
[0m15:22:04.933119 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.hub_warehouse_params'
[0m15:22:04.934247 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.hub_warehouse_params
[0m15:22:04.943462 [info ] [Thread-1  ]: 15:22:04 + Loading postgres.dbt.hub_warehouse_params from 1 source(s)
[0m15:22:04.954486 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.hub_warehouse_params"
[0m15:22:04.962961 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_warehouse_params (compile): 2024-09-01 15:22:04.935067 => 2024-09-01 15:22:04.962857
[0m15:22:04.963793 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.hub_warehouse_params
[0m15:22:04.975477 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.hub_warehouse_params"
[0m15:22:04.984438 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse_params"
[0m15:22:04.985210 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_params: BEGIN
[0m15:22:04.985900 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:04.993213 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:04.994761 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse_params"
[0m15:22:04.995996 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.hub_warehouse_params"} */

      
  
    

  create  table "postgres"."dbt"."hub_warehouse_params"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT DISTINCT ON (rr.WAREHOUSE_PARAMS_PK) rr.WAREHOUSE_PARAMS_PK, rr.WAREHOUSE_PARAMS_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse_params" AS rr
    WHERE rr.WAREHOUSE_PARAMS_PK IS NOT NULL
    ORDER BY rr.WAREHOUSE_PARAMS_PK, rr.LOAD_DATE
),

records_to_insert AS (
    SELECT a.WAREHOUSE_PARAMS_PK, a.WAREHOUSE_PARAMS_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:05.030323 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:05.034717 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_params: COMMIT
[0m15:22:05.036044 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.hub_warehouse_params"
[0m15:22:05.037903 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_params: COMMIT
[0m15:22:05.044657 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:05.047189 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.hub_warehouse_params (execute): 2024-09-01 15:22:04.964418 => 2024-09-01 15:22:05.047118
[0m15:22:05.048435 [debug] [Thread-1  ]: On model.otus_project_dbtvault.hub_warehouse_params: Close
[0m15:22:05.050974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9581fe4610>]}
[0m15:22:05.052496 [info ] [Thread-1  ]: 15 of 45 OK created sql incremental model dbt.hub_warehouse_params ............. [[32mSELECT 5668[0m in 0.12s]
[0m15:22:05.054026 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.hub_warehouse_params
[0m15:22:05.055395 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_city_country
[0m15:22:05.056625 [info ] [Thread-1  ]: 16 of 45 START sql incremental model dbt.link_city_country ..................... [RUN]
[0m15:22:05.058496 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_city_country'
[0m15:22:05.059560 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_city_country
[0m15:22:05.080964 [info ] [Thread-1  ]: 15:22:05 + Loading postgres.dbt.link_city_country from 1 source(s)
[0m15:22:05.128207 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_city_country"
[0m15:22:05.140632 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_city_country (compile): 2024-09-01 15:22:05.060807 => 2024-09-01 15:22:05.140492
[0m15:22:05.141643 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_city_country
[0m15:22:05.153883 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_city_country"
[0m15:22:05.169213 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_city_country"
[0m15:22:05.170670 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_city_country: BEGIN
[0m15:22:05.171882 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:05.182001 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:05.183261 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_city_country"
[0m15:22:05.185501 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_city_country"} */

      
  
    

  create  table "postgres"."dbt"."link_city_country"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_CITY_COUNTRY_PK, rr.CITY_PK, rr.COUNTRY_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CITY_COUNTRY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_city_country" AS rr
    WHERE rr.LINK_CITY_COUNTRY_PK IS NOT NULL
    AND rr.CITY_PK IS NOT NULL
    AND rr.COUNTRY_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CITY_COUNTRY_PK, a.CITY_PK, a.COUNTRY_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:05.230450 [debug] [Thread-1  ]: SQL status: SELECT 2350 in 0 seconds
[0m15:22:05.234186 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_city_country: COMMIT
[0m15:22:05.235244 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_city_country"
[0m15:22:05.236035 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_city_country: COMMIT
[0m15:22:05.239722 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:05.240976 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_city_country (execute): 2024-09-01 15:22:05.142344 => 2024-09-01 15:22:05.240915
[0m15:22:05.241685 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_city_country: Close
[0m15:22:05.242863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582168b50>]}
[0m15:22:05.243836 [info ] [Thread-1  ]: 16 of 45 OK created sql incremental model dbt.link_city_country ................ [[32mSELECT 2350[0m in 0.18s]
[0m15:22:05.244778 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_city_country
[0m15:22:05.245672 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_client_address_city
[0m15:22:05.246658 [info ] [Thread-1  ]: 17 of 45 START sql incremental model dbt.link_client_address_city .............. [RUN]
[0m15:22:05.248910 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_client_address_city'
[0m15:22:05.250237 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_client_address_city
[0m15:22:05.260839 [info ] [Thread-1  ]: 15:22:05 + Loading postgres.dbt.link_client_address_city from 1 source(s)
[0m15:22:05.271886 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_client_address_city"
[0m15:22:05.280247 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_client_address_city (compile): 2024-09-01 15:22:05.251498 => 2024-09-01 15:22:05.280130
[0m15:22:05.281165 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_client_address_city
[0m15:22:05.291850 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_client_address_city"
[0m15:22:05.300156 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_address_city"
[0m15:22:05.300950 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_city: BEGIN
[0m15:22:05.301648 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:05.309693 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:05.311041 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_address_city"
[0m15:22:05.312135 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_client_address_city"} */

      
  
    

  create  table "postgres"."dbt"."link_client_address_city"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_CLIENT_ADDRESS_CITY_PK, rr.CITY_PK, rr.CLIENT_ADDRESS_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CLIENT_ADDRESS_CITY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_client_address_city" AS rr
    WHERE rr.LINK_CLIENT_ADDRESS_CITY_PK IS NOT NULL
    AND rr.CITY_PK IS NOT NULL
    AND rr.CLIENT_ADDRESS_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CLIENT_ADDRESS_CITY_PK, a.CITY_PK, a.CLIENT_ADDRESS_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:06.836807 [debug] [Thread-1  ]: SQL status: SELECT 120000 in 2 seconds
[0m15:22:06.840197 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_city: COMMIT
[0m15:22:06.841587 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_address_city"
[0m15:22:06.842727 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_city: COMMIT
[0m15:22:06.866873 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:06.868678 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_client_address_city (execute): 2024-09-01 15:22:05.281828 => 2024-09-01 15:22:06.868618
[0m15:22:06.869735 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_city: Close
[0m15:22:06.871122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958262b160>]}
[0m15:22:06.872238 [info ] [Thread-1  ]: 17 of 45 OK created sql incremental model dbt.link_client_address_city ......... [[32mSELECT 120000[0m in 1.62s]
[0m15:22:06.873529 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_client_address_city
[0m15:22:06.874999 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_client_address_client
[0m15:22:06.876283 [info ] [Thread-1  ]: 18 of 45 START sql incremental model dbt.link_client_address_client ............ [RUN]
[0m15:22:06.877930 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_client_address_client'
[0m15:22:06.879035 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_client_address_client
[0m15:22:06.887579 [info ] [Thread-1  ]: 15:22:06 + Loading postgres.dbt.link_client_address_client from 1 source(s)
[0m15:22:06.898514 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_client_address_client"
[0m15:22:06.906204 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_client_address_client (compile): 2024-09-01 15:22:06.879949 => 2024-09-01 15:22:06.906095
[0m15:22:06.906984 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_client_address_client
[0m15:22:06.917694 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_client_address_client"
[0m15:22:06.925832 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_address_client"
[0m15:22:06.926522 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_client: BEGIN
[0m15:22:06.927196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:06.934647 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:06.936081 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_address_client"
[0m15:22:06.937203 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_client_address_client"} */

      
  
    

  create  table "postgres"."dbt"."link_client_address_client"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_CLIENT_ADDRESS_CLIENT_PK, rr.CLIENT_PK, rr.CLIENT_ADDRESS_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CLIENT_ADDRESS_CLIENT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_client_address_client" AS rr
    WHERE rr.LINK_CLIENT_ADDRESS_CLIENT_PK IS NOT NULL
    AND rr.CLIENT_PK IS NOT NULL
    AND rr.CLIENT_ADDRESS_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CLIENT_ADDRESS_CLIENT_PK, a.CLIENT_PK, a.CLIENT_ADDRESS_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:09.424066 [debug] [Thread-1  ]: SQL status: SELECT 119986 in 2 seconds
[0m15:22:09.427218 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_client: COMMIT
[0m15:22:09.428340 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_address_client"
[0m15:22:09.429349 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_client: COMMIT
[0m15:22:09.453464 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:09.455334 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_client_address_client (execute): 2024-09-01 15:22:06.907586 => 2024-09-01 15:22:09.455274
[0m15:22:09.456439 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_address_client: Close
[0m15:22:09.458001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820dad60>]}
[0m15:22:09.459254 [info ] [Thread-1  ]: 18 of 45 OK created sql incremental model dbt.link_client_address_client ....... [[32mSELECT 119986[0m in 2.58s]
[0m15:22:09.460701 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_client_address_client
[0m15:22:09.462304 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_client_client_type
[0m15:22:09.463471 [info ] [Thread-1  ]: 19 of 45 START sql incremental model dbt.link_client_client_type ............... [RUN]
[0m15:22:09.465135 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_client_client_type'
[0m15:22:09.466361 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_client_client_type
[0m15:22:09.476384 [info ] [Thread-1  ]: 15:22:09 + Loading postgres.dbt.link_client_client_type from 1 source(s)
[0m15:22:09.488565 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_client_client_type"
[0m15:22:09.497362 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_client_client_type (compile): 2024-09-01 15:22:09.467360 => 2024-09-01 15:22:09.497194
[0m15:22:09.498258 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_client_client_type
[0m15:22:09.509204 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_client_client_type"
[0m15:22:09.517999 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_client_type"
[0m15:22:09.518782 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_client_type: BEGIN
[0m15:22:09.519453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:09.526765 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:09.528564 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_client_type"
[0m15:22:09.529801 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_client_client_type"} */

      
  
    

  create  table "postgres"."dbt"."link_client_client_type"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_CLIENT_CLIENT_TYPE_PK, rr.CLIENT_PK, rr.CLIENT_TYPE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CLIENT_CLIENT_TYPE_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_client_client_type" AS rr
    WHERE rr.LINK_CLIENT_CLIENT_TYPE_PK IS NOT NULL
    AND rr.CLIENT_PK IS NOT NULL
    AND rr.CLIENT_TYPE_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CLIENT_CLIENT_TYPE_PK, a.CLIENT_PK, a.CLIENT_TYPE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:10.912504 [debug] [Thread-1  ]: SQL status: SELECT 180000 in 1 seconds
[0m15:22:10.915699 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_client_type: COMMIT
[0m15:22:10.916808 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_client_client_type"
[0m15:22:10.917851 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_client_type: COMMIT
[0m15:22:10.977494 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:10.979487 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_client_client_type (execute): 2024-09-01 15:22:09.498918 => 2024-09-01 15:22:10.979371
[0m15:22:10.980914 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_client_client_type: Close
[0m15:22:10.982790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820b65e0>]}
[0m15:22:10.984281 [info ] [Thread-1  ]: 19 of 45 OK created sql incremental model dbt.link_client_client_type .......... [[32mSELECT 180000[0m in 1.52s]
[0m15:22:10.986070 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_client_client_type
[0m15:22:10.987724 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_currency_currency_rate
[0m15:22:10.988948 [info ] [Thread-1  ]: 20 of 45 START sql incremental model dbt.link_currency_currency_rate ........... [RUN]
[0m15:22:10.990741 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_currency_currency_rate'
[0m15:22:10.992142 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_currency_currency_rate
[0m15:22:11.001268 [info ] [Thread-1  ]: 15:22:11 + Loading postgres.dbt.link_currency_currency_rate from 1 source(s)
[0m15:22:11.012421 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_currency_currency_rate"
[0m15:22:11.020203 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_currency_currency_rate (compile): 2024-09-01 15:22:10.993089 => 2024-09-01 15:22:11.020098
[0m15:22:11.021028 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_currency_currency_rate
[0m15:22:11.032094 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_currency_currency_rate"
[0m15:22:11.041999 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_currency_currency_rate"
[0m15:22:11.042929 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_currency_currency_rate: BEGIN
[0m15:22:11.043617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:11.051087 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:11.052739 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_currency_currency_rate"
[0m15:22:11.054005 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_currency_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_currency_currency_rate"} */

      
  
    

  create  table "postgres"."dbt"."link_currency_currency_rate"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_CURRENCY_CURRENCY_RATE_PK, rr.CURRENCY_PK, rr.CURRENCY_RATE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CURRENCY_CURRENCY_RATE_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_currency_currency_rate" AS rr
    WHERE rr.LINK_CURRENCY_CURRENCY_RATE_PK IS NOT NULL
    AND rr.CURRENCY_PK IS NOT NULL
    AND rr.CURRENCY_RATE_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CURRENCY_CURRENCY_RATE_PK, a.CURRENCY_PK, a.CURRENCY_RATE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:11.118462 [debug] [Thread-1  ]: SQL status: SELECT 4982 in 0 seconds
[0m15:22:11.121903 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_currency_currency_rate: COMMIT
[0m15:22:11.123207 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_currency_currency_rate"
[0m15:22:11.124367 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_currency_currency_rate: COMMIT
[0m15:22:11.130759 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:11.132571 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_currency_currency_rate (execute): 2024-09-01 15:22:11.021674 => 2024-09-01 15:22:11.132512
[0m15:22:11.133631 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_currency_currency_rate: Close
[0m15:22:11.135405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582170df0>]}
[0m15:22:11.137042 [info ] [Thread-1  ]: 20 of 45 OK created sql incremental model dbt.link_currency_currency_rate ...... [[32mSELECT 4982[0m in 0.15s]
[0m15:22:11.138561 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_currency_currency_rate
[0m15:22:11.139913 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_order_client
[0m15:22:11.141230 [info ] [Thread-1  ]: 21 of 45 START sql incremental model dbt.link_order_client ..................... [RUN]
[0m15:22:11.142937 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_order_client'
[0m15:22:11.144199 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_order_client
[0m15:22:11.154378 [info ] [Thread-1  ]: 15:22:11 + Loading postgres.dbt.link_order_client from 1 source(s)
[0m15:22:11.166603 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_order_client"
[0m15:22:11.175264 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_client (compile): 2024-09-01 15:22:11.145174 => 2024-09-01 15:22:11.175159
[0m15:22:11.176095 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_order_client
[0m15:22:11.186607 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_order_client"
[0m15:22:11.197039 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_client"
[0m15:22:11.197835 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_client: BEGIN
[0m15:22:11.198518 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:11.205934 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:11.207421 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_client"
[0m15:22:11.208614 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_order_client"} */

      
  
    

  create  table "postgres"."dbt"."link_order_client"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_ORDER_CLIENT_PK, rr.ORDER_PK, rr.CLIENT_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_ORDER_CLIENT_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_order_client" AS rr
    WHERE rr.LINK_ORDER_CLIENT_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.CLIENT_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_ORDER_CLIENT_PK, a.ORDER_PK, a.CLIENT_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:12.917087 [debug] [Thread-1  ]: SQL status: SELECT 180000 in 2 seconds
[0m15:22:12.920910 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_client: COMMIT
[0m15:22:12.922312 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_client"
[0m15:22:12.923594 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_client: COMMIT
[0m15:22:12.944709 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:12.946534 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_client (execute): 2024-09-01 15:22:11.176721 => 2024-09-01 15:22:12.946473
[0m15:22:12.947768 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_client: Close
[0m15:22:12.949369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820165b0>]}
[0m15:22:12.950745 [info ] [Thread-1  ]: 21 of 45 OK created sql incremental model dbt.link_order_client ................ [[32mSELECT 180000[0m in 1.81s]
[0m15:22:12.952066 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_order_client
[0m15:22:12.953443 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_order_currency
[0m15:22:12.954929 [info ] [Thread-1  ]: 22 of 45 START sql incremental model dbt.link_order_currency ................... [RUN]
[0m15:22:12.956758 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_order_currency'
[0m15:22:12.957995 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_order_currency
[0m15:22:12.967572 [info ] [Thread-1  ]: 15:22:12 + Loading postgres.dbt.link_order_currency from 1 source(s)
[0m15:22:12.980426 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_order_currency"
[0m15:22:12.990008 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_currency (compile): 2024-09-01 15:22:12.958973 => 2024-09-01 15:22:12.989888
[0m15:22:12.991155 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_order_currency
[0m15:22:13.004181 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_order_currency"
[0m15:22:13.013628 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_currency"
[0m15:22:13.014757 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_currency: BEGIN
[0m15:22:13.015644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:13.023195 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:13.024855 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_currency"
[0m15:22:13.026072 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_order_currency"} */

      
  
    

  create  table "postgres"."dbt"."link_order_currency"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_ORDER_CURRENCY_PK, rr.ORDER_PK, rr.CURRENCY_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_ORDER_CURRENCY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_order_currency" AS rr
    WHERE rr.LINK_ORDER_CURRENCY_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.CURRENCY_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_ORDER_CURRENCY_PK, a.ORDER_PK, a.CURRENCY_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:13.264216 [debug] [Thread-1  ]: SQL status: SELECT 2199 in 0 seconds
[0m15:22:13.267541 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_currency: COMMIT
[0m15:22:13.268619 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_currency"
[0m15:22:13.269532 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_currency: COMMIT
[0m15:22:13.274068 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:13.275583 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_currency (execute): 2024-09-01 15:22:12.992095 => 2024-09-01 15:22:13.275523
[0m15:22:13.276564 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_currency: Close
[0m15:22:13.278023 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582109370>]}
[0m15:22:13.279266 [info ] [Thread-1  ]: 22 of 45 OK created sql incremental model dbt.link_order_currency .............. [[32mSELECT 2199[0m in 0.32s]
[0m15:22:13.280769 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_order_currency
[0m15:22:13.282045 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_order_goods
[0m15:22:13.283271 [info ] [Thread-1  ]: 23 of 45 START sql incremental model dbt.link_order_goods ...................... [RUN]
[0m15:22:13.284952 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_order_goods'
[0m15:22:13.286361 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_order_goods
[0m15:22:13.296247 [info ] [Thread-1  ]: 15:22:13 + Loading postgres.dbt.link_order_goods from 1 source(s)
[0m15:22:13.309028 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_order_goods"
[0m15:22:13.317444 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_goods (compile): 2024-09-01 15:22:13.287266 => 2024-09-01 15:22:13.317246
[0m15:22:13.318494 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_order_goods
[0m15:22:13.329889 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_order_goods"
[0m15:22:13.339150 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_goods"
[0m15:22:13.340061 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_goods: BEGIN
[0m15:22:13.340960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:13.348737 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:13.350445 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_goods"
[0m15:22:13.351714 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_order_goods"} */

      
  
    

  create  table "postgres"."dbt"."link_order_goods"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_ORDER_GOOD_PK, rr.ORDER_PK, rr.GOOD_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_ORDER_GOOD_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_order_goods" AS rr
    WHERE rr.LINK_ORDER_GOOD_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.GOOD_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_ORDER_GOOD_PK, a.ORDER_PK, a.GOOD_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:14.372696 [debug] [Thread-1  ]: SQL status: SELECT 105759 in 1 seconds
[0m15:22:14.375856 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_goods: COMMIT
[0m15:22:14.376937 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_goods"
[0m15:22:14.378055 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_goods: COMMIT
[0m15:22:14.422708 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:14.424538 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_goods (execute): 2024-09-01 15:22:13.319268 => 2024-09-01 15:22:14.424478
[0m15:22:14.425800 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_goods: Close
[0m15:22:14.427631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95826a1be0>]}
[0m15:22:14.431431 [info ] [Thread-1  ]: 23 of 45 OK created sql incremental model dbt.link_order_goods ................. [[32mSELECT 105759[0m in 1.14s]
[0m15:22:14.433185 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_order_goods
[0m15:22:14.434581 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_order_order_status_history
[0m15:22:14.435812 [info ] [Thread-1  ]: 24 of 45 START sql incremental model dbt.link_order_order_status_history ....... [RUN]
[0m15:22:14.437506 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_order_order_status_history'
[0m15:22:14.438812 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_order_order_status_history
[0m15:22:14.448715 [info ] [Thread-1  ]: 15:22:14 + Loading postgres.dbt.link_order_order_status_history from 1 source(s)
[0m15:22:14.461473 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_order_order_status_history"
[0m15:22:14.469537 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_order_status_history (compile): 2024-09-01 15:22:14.439897 => 2024-09-01 15:22:14.469434
[0m15:22:14.470367 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_order_order_status_history
[0m15:22:14.481595 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_order_order_status_history"
[0m15:22:14.490446 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_order_status_history"
[0m15:22:14.491273 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_order_status_history: BEGIN
[0m15:22:14.491911 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:14.499032 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:14.500695 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_order_status_history"
[0m15:22:14.502165 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_order_order_status_history"} */

      
  
    

  create  table "postgres"."dbt"."link_order_order_status_history"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_ORDER_ORDER_STATUS_HISTORY_PK, rr.ORDER_PK, rr.ORDER_STATUS_HISTORY_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_ORDER_ORDER_STATUS_HISTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_order_order_status_history" AS rr
    WHERE rr.LINK_ORDER_ORDER_STATUS_HISTORY_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.ORDER_STATUS_HISTORY_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_ORDER_ORDER_STATUS_HISTORY_PK, a.ORDER_PK, a.ORDER_STATUS_HISTORY_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:16.697519 [debug] [Thread-1  ]: SQL status: SELECT 249912 in 2 seconds
[0m15:22:16.700941 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_order_status_history: COMMIT
[0m15:22:16.702248 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_order_status_history"
[0m15:22:16.703446 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_order_status_history: COMMIT
[0m15:22:16.710327 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:16.711943 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_order_status_history (execute): 2024-09-01 15:22:14.471102 => 2024-09-01 15:22:16.711868
[0m15:22:16.713286 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_order_status_history: Close
[0m15:22:16.714902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958211cb80>]}
[0m15:22:16.716189 [info ] [Thread-1  ]: 24 of 45 OK created sql incremental model dbt.link_order_order_status_history .. [[32mSELECT 249912[0m in 2.28s]
[0m15:22:16.717582 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_order_order_status_history
[0m15:22:16.718805 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_order_status_order_status_history
[0m15:22:16.720050 [info ] [Thread-1  ]: 25 of 45 START sql incremental model dbt.link_order_status_order_status_history  [RUN]
[0m15:22:16.721591 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_order_status_order_status_history'
[0m15:22:16.722603 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_order_status_order_status_history
[0m15:22:16.732788 [info ] [Thread-1  ]: 15:22:16 + Loading postgres.dbt.link_order_status_order_status_history from 1 source(s)
[0m15:22:16.745360 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_order_status_order_status_history"
[0m15:22:16.753835 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_status_order_status_history (compile): 2024-09-01 15:22:16.723579 => 2024-09-01 15:22:16.753725
[0m15:22:16.754889 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_order_status_order_status_history
[0m15:22:16.766040 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_order_status_order_status_history"
[0m15:22:16.775649 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_status_order_status_history"
[0m15:22:16.776461 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_status_order_status_history: BEGIN
[0m15:22:16.777198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:16.784567 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:16.786293 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_status_order_status_history"
[0m15:22:16.787625 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_status_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_order_status_order_status_history"} */

      
  
    

  create  table "postgres"."dbt"."link_order_status_order_status_history"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK, rr.ORDER_STATUS_PK, rr.ORDER_STATUS_HISTORY_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_order_status_order_status_history" AS rr
    WHERE rr.LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK IS NOT NULL
    AND rr.ORDER_STATUS_PK IS NOT NULL
    AND rr.ORDER_STATUS_HISTORY_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_ORDER_STATUS_ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_PK, a.ORDER_STATUS_HISTORY_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:18.721457 [debug] [Thread-1  ]: SQL status: SELECT 249912 in 2 seconds
[0m15:22:18.725031 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_status_order_status_history: COMMIT
[0m15:22:18.726120 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_status_order_status_history"
[0m15:22:18.727205 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_status_order_status_history: COMMIT
[0m15:22:18.748858 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:18.750795 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_status_order_status_history (execute): 2024-09-01 15:22:16.755669 => 2024-09-01 15:22:18.750735
[0m15:22:18.751968 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_status_order_status_history: Close
[0m15:22:18.753469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958262b160>]}
[0m15:22:19.757409 [info ] [Thread-1  ]: 25 of 45 OK created sql incremental model dbt.link_order_status_order_status_history  [[32mSELECT 249912[0m in 2.03s]
[0m15:22:19.759327 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_order_status_order_status_history
[0m15:22:19.760660 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_order_with_delay_order
[0m15:22:19.762038 [info ] [Thread-1  ]: 26 of 45 START sql incremental model dbt.link_order_with_delay_order ........... [RUN]
[0m15:22:19.763750 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_order_with_delay_order'
[0m15:22:19.764809 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_order_with_delay_order
[0m15:22:19.773989 [info ] [Thread-1  ]: 15:22:19 + Loading postgres.dbt.link_order_with_delay_order from 1 source(s)
[0m15:22:19.785610 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_order_with_delay_order"
[0m15:22:19.795099 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_with_delay_order (compile): 2024-09-01 15:22:19.765733 => 2024-09-01 15:22:19.794985
[0m15:22:19.795969 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_order_with_delay_order
[0m15:22:19.808846 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_order_with_delay_order"
[0m15:22:19.818434 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_with_delay_order"
[0m15:22:19.819236 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_with_delay_order: BEGIN
[0m15:22:19.819952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:19.827867 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:19.829190 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_with_delay_order"
[0m15:22:19.829990 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_with_delay_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_order_with_delay_order"} */

      
  
    

  create  table "postgres"."dbt"."link_order_with_delay_order"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_ORDER_WITH_DELAY_ORDER_PK, rr.ORDER_WITH_DELAY_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_ORDER_WITH_DELAY_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_order_with_delay_order" AS rr
    WHERE rr.LINK_ORDER_WITH_DELAY_ORDER_PK IS NOT NULL
    AND rr.ORDER_WITH_DELAY_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_ORDER_WITH_DELAY_ORDER_PK, a.ORDER_WITH_DELAY_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:20.085117 [debug] [Thread-1  ]: SQL status: SELECT 3082 in 0 seconds
[0m15:22:20.088716 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_with_delay_order: COMMIT
[0m15:22:20.089808 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_order_with_delay_order"
[0m15:22:20.090872 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_with_delay_order: COMMIT
[0m15:22:20.093716 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:20.095305 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_order_with_delay_order (execute): 2024-09-01 15:22:19.796599 => 2024-09-01 15:22:20.095245
[0m15:22:20.096229 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_order_with_delay_order: Close
[0m15:22:20.097767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958211cb80>]}
[0m15:22:20.098888 [info ] [Thread-1  ]: 26 of 45 OK created sql incremental model dbt.link_order_with_delay_order ...... [[32mSELECT 3082[0m in 0.33s]
[0m15:22:20.100278 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_order_with_delay_order
[0m15:22:20.101537 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_warehouse_address_city
[0m15:22:20.102726 [info ] [Thread-1  ]: 27 of 45 START sql incremental model dbt.link_warehouse_address_city ........... [RUN]
[0m15:22:20.104760 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_warehouse_address_city'
[0m15:22:20.106043 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_warehouse_address_city
[0m15:22:20.115440 [info ] [Thread-1  ]: 15:22:20 + Loading postgres.dbt.link_warehouse_address_city from 1 source(s)
[0m15:22:20.127995 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_warehouse_address_city"
[0m15:22:20.137487 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_address_city (compile): 2024-09-01 15:22:20.107122 => 2024-09-01 15:22:20.137379
[0m15:22:20.138345 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_warehouse_address_city
[0m15:22:20.149387 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_warehouse_address_city"
[0m15:22:20.158050 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_address_city"
[0m15:22:20.158804 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_city: BEGIN
[0m15:22:20.159714 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:20.167073 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:20.168626 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_address_city"
[0m15:22:20.169749 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_warehouse_address_city"} */

      
  
    

  create  table "postgres"."dbt"."link_warehouse_address_city"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_WAREHOUSE_ADDRESS_CITY_PK, rr.WAREHOUSE_ADDRESS_PK, rr.CITY_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_WAREHOUSE_ADDRESS_CITY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_warehouse_address_city" AS rr
    WHERE rr.LINK_WAREHOUSE_ADDRESS_CITY_PK IS NOT NULL
    AND rr.WAREHOUSE_ADDRESS_PK IS NOT NULL
    AND rr.CITY_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_WAREHOUSE_ADDRESS_CITY_PK, a.WAREHOUSE_ADDRESS_PK, a.CITY_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:20.249211 [debug] [Thread-1  ]: SQL status: SELECT 5667 in 0 seconds
[0m15:22:20.252590 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_city: COMMIT
[0m15:22:20.253706 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_address_city"
[0m15:22:20.254737 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_city: COMMIT
[0m15:22:20.267436 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:20.269089 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_address_city (execute): 2024-09-01 15:22:20.139019 => 2024-09-01 15:22:20.269016
[0m15:22:20.270021 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_city: Close
[0m15:22:20.271508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820b65e0>]}
[0m15:22:20.272961 [info ] [Thread-1  ]: 27 of 45 OK created sql incremental model dbt.link_warehouse_address_city ...... [[32mSELECT 5667[0m in 0.17s]
[0m15:22:20.274367 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_warehouse_address_city
[0m15:22:20.275871 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_warehouse_address_warehouse_params
[0m15:22:20.276874 [info ] [Thread-1  ]: 28 of 45 START sql incremental model dbt.link_warehouse_address_warehouse_params  [RUN]
[0m15:22:20.278322 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_warehouse_address_warehouse_params'
[0m15:22:20.279382 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_warehouse_address_warehouse_params
[0m15:22:20.288335 [info ] [Thread-1  ]: 15:22:20 + Loading postgres.dbt.link_warehouse_address_warehouse_params from 1 source(s)
[0m15:22:20.300409 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_warehouse_address_warehouse_params"
[0m15:22:20.308973 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_address_warehouse_params (compile): 2024-09-01 15:22:20.280385 => 2024-09-01 15:22:20.308868
[0m15:22:20.309798 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_warehouse_address_warehouse_params
[0m15:22:20.322015 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_warehouse_address_warehouse_params"
[0m15:22:20.331210 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_address_warehouse_params"
[0m15:22:20.331988 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_warehouse_params: BEGIN
[0m15:22:20.332650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:20.339719 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:20.341174 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_address_warehouse_params"
[0m15:22:20.342356 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_warehouse_address_warehouse_params"} */

      
  
    

  create  table "postgres"."dbt"."link_warehouse_address_warehouse_params"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK, rr.WAREHOUSE_ADDRESS_PK, rr.WAREHOUSE_PARAMS_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_warehouse_address_warehouse_params" AS rr
    WHERE rr.LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK IS NOT NULL
    AND rr.WAREHOUSE_ADDRESS_PK IS NOT NULL
    AND rr.WAREHOUSE_PARAMS_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_WAREHOUSE_ADDRESS_WAREHOUSE_PARAMS_PK, a.WAREHOUSE_ADDRESS_PK, a.WAREHOUSE_PARAMS_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:20.437846 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:20.441108 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_warehouse_params: COMMIT
[0m15:22:20.442257 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_address_warehouse_params"
[0m15:22:20.443325 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_warehouse_params: COMMIT
[0m15:22:20.450756 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:20.452607 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_address_warehouse_params (execute): 2024-09-01 15:22:20.310422 => 2024-09-01 15:22:20.452544
[0m15:22:20.453631 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_address_warehouse_params: Close
[0m15:22:20.455286 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958211cb80>]}
[0m15:22:20.456601 [info ] [Thread-1  ]: 28 of 45 OK created sql incremental model dbt.link_warehouse_address_warehouse_params  [[32mSELECT 5668[0m in 0.18s]
[0m15:22:20.457956 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_warehouse_address_warehouse_params
[0m15:22:20.459519 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_warehouse_order_status_history
[0m15:22:20.460838 [info ] [Thread-1  ]: 29 of 45 START sql incremental model dbt.link_warehouse_order_status_history ... [RUN]
[0m15:22:20.462699 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_warehouse_order_status_history'
[0m15:22:20.463829 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_warehouse_order_status_history
[0m15:22:20.473205 [info ] [Thread-1  ]: 15:22:20 + Loading postgres.dbt.link_warehouse_order_status_history from 1 source(s)
[0m15:22:20.486303 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_warehouse_order_status_history"
[0m15:22:20.494925 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_order_status_history (compile): 2024-09-01 15:22:20.465013 => 2024-09-01 15:22:20.494816
[0m15:22:20.495726 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_warehouse_order_status_history
[0m15:22:20.506991 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_warehouse_order_status_history"
[0m15:22:20.516393 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_order_status_history"
[0m15:22:20.517144 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_order_status_history: BEGIN
[0m15:22:20.517869 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:20.525713 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:20.526998 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_order_status_history"
[0m15:22:20.528008 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_warehouse_order_status_history"} */

      
  
    

  create  table "postgres"."dbt"."link_warehouse_order_status_history"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK, rr.WAREHOUSE_PK, rr.ORDER_STATUS_HISTORY_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_warehouse_order_status_history" AS rr
    WHERE rr.LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK IS NOT NULL
    AND rr.WAREHOUSE_PK IS NOT NULL
    AND rr.ORDER_STATUS_HISTORY_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_WAREHOUSE_ORDER_STATUS_HISTORY_PK, a.WAREHOUSE_PK, a.ORDER_STATUS_HISTORY_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:22.112836 [debug] [Thread-1  ]: SQL status: SELECT 189146 in 2 seconds
[0m15:22:22.115875 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_order_status_history: COMMIT
[0m15:22:22.116893 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_order_status_history"
[0m15:22:22.117756 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_order_status_history: COMMIT
[0m15:22:22.277846 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:22.279565 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_order_status_history (execute): 2024-09-01 15:22:20.496337 => 2024-09-01 15:22:22.279487
[0m15:22:22.280515 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_order_status_history: Close
[0m15:22:22.281997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95807918e0>]}
[0m15:22:22.283079 [info ] [Thread-1  ]: 29 of 45 OK created sql incremental model dbt.link_warehouse_order_status_history  [[32mSELECT 189146[0m in 1.82s]
[0m15:22:22.284187 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_warehouse_order_status_history
[0m15:22:22.285360 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.link_warehouse_warehouse_params
[0m15:22:22.286601 [info ] [Thread-1  ]: 30 of 45 START sql incremental model dbt.link_warehouse_warehouse_params ....... [RUN]
[0m15:22:22.288885 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.link_warehouse_warehouse_params'
[0m15:22:22.289958 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.link_warehouse_warehouse_params
[0m15:22:22.299615 [info ] [Thread-1  ]: 15:22:22 + Loading postgres.dbt.link_warehouse_warehouse_params from 1 source(s)
[0m15:22:22.313400 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.link_warehouse_warehouse_params"
[0m15:22:22.321750 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_warehouse_params (compile): 2024-09-01 15:22:22.290866 => 2024-09-01 15:22:22.321639
[0m15:22:22.322584 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.link_warehouse_warehouse_params
[0m15:22:22.335473 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.link_warehouse_warehouse_params"
[0m15:22:22.344498 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_warehouse_params"
[0m15:22:22.345256 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_warehouse_params: BEGIN
[0m15:22:22.345994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:22.353203 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:22.354725 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_warehouse_params"
[0m15:22:22.355872 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.link_warehouse_warehouse_params"} */

      
  
    

  create  table "postgres"."dbt"."link_warehouse_warehouse_params"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
  SELECT * FROM (
    SELECT rr.LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK, rr.WAREHOUSE_PK, rr.WAREHOUSE_PARAMS_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM "postgres"."dbt"."stg_link_warehouse_warehouse_params" AS rr
    WHERE rr.LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK IS NOT NULL
    AND rr.WAREHOUSE_PK IS NOT NULL
    AND rr.WAREHOUSE_PARAMS_PK IS NOT NULL
  ) as l
  WHERE row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_WAREHOUSE_WAREHOUSE_PARAMS_PK, a.WAREHOUSE_PK, a.WAREHOUSE_PARAMS_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:22.446539 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:22.449718 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_warehouse_params: COMMIT
[0m15:22:22.450723 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.link_warehouse_warehouse_params"
[0m15:22:22.451628 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_warehouse_params: COMMIT
[0m15:22:22.459118 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:22.460716 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.link_warehouse_warehouse_params (execute): 2024-09-01 15:22:22.323211 => 2024-09-01 15:22:22.460658
[0m15:22:22.461625 [debug] [Thread-1  ]: On model.otus_project_dbtvault.link_warehouse_warehouse_params: Close
[0m15:22:22.463033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958216eb80>]}
[0m15:22:22.464399 [info ] [Thread-1  ]: 30 of 45 OK created sql incremental model dbt.link_warehouse_warehouse_params .. [[32mSELECT 5668[0m in 0.17s]
[0m15:22:22.465807 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.link_warehouse_warehouse_params
[0m15:22:22.467053 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_city
[0m15:22:22.468232 [info ] [Thread-1  ]: 31 of 45 START sql incremental model dbt.sat_city .............................. [RUN]
[0m15:22:22.469806 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_city'
[0m15:22:22.470803 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_city
[0m15:22:22.554086 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_city"
[0m15:22:22.566437 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_city (compile): 2024-09-01 15:22:22.471697 => 2024-09-01 15:22:22.566328
[0m15:22:22.567382 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_city
[0m15:22:22.578465 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_city"
[0m15:22:22.592019 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:22:22.592812 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: BEGIN
[0m15:22:22.593474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:22.601514 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:22.603007 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:22:22.604313 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_city"} */

      
  
    

  create  table "postgres"."dbt"."sat_city"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CITY_PK, a.CITY_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_city" AS a
    WHERE a.CITY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CITY_PK, stage.CITY_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:22.633505 [debug] [Thread-1  ]: SQL status: SELECT 2351 in 0 seconds
[0m15:22:22.637014 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: COMMIT
[0m15:22:22.638292 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_city"
[0m15:22:22.639400 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: COMMIT
[0m15:22:22.644485 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:22.646051 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_city (execute): 2024-09-01 15:22:22.568122 => 2024-09-01 15:22:22.645990
[0m15:22:22.647042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_city: Close
[0m15:22:22.648573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820165b0>]}
[0m15:22:22.649717 [info ] [Thread-1  ]: 31 of 45 OK created sql incremental model dbt.sat_city ......................... [[32mSELECT 2351[0m in 0.18s]
[0m15:22:22.651291 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_city
[0m15:22:22.652670 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_client
[0m15:22:22.653804 [info ] [Thread-1  ]: 32 of 45 START sql incremental model dbt.sat_client ............................ [RUN]
[0m15:22:22.655360 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_client'
[0m15:22:22.656363 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_client
[0m15:22:22.686132 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_client"
[0m15:22:22.695895 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client (compile): 2024-09-01 15:22:22.657149 => 2024-09-01 15:22:22.695769
[0m15:22:22.696962 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_client
[0m15:22:22.708425 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_client"
[0m15:22:22.716976 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client"
[0m15:22:22.717748 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client: BEGIN
[0m15:22:22.718417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:22.726070 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:22.727635 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client"
[0m15:22:22.728680 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_client"} */

      
  
    

  create  table "postgres"."dbt"."sat_client"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CLIENT_PK, a.CLIENT_HASHDIFF, a.name, a.client_type_code, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client" AS a
    WHERE a.CLIENT_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CLIENT_PK, stage.CLIENT_HASHDIFF, stage.name, stage.client_type_code, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:24.100992 [debug] [Thread-1  ]: SQL status: SELECT 180000 in 1 seconds
[0m15:22:24.104177 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client: COMMIT
[0m15:22:24.105360 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client"
[0m15:22:24.106334 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client: COMMIT
[0m15:22:24.226883 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:24.228739 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client (execute): 2024-09-01 15:22:22.697693 => 2024-09-01 15:22:24.228676
[0m15:22:24.229858 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client: Close
[0m15:22:24.231535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958262b160>]}
[0m15:22:24.232891 [info ] [Thread-1  ]: 32 of 45 OK created sql incremental model dbt.sat_client ....................... [[32mSELECT 180000[0m in 1.58s]
[0m15:22:24.234320 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_client
[0m15:22:24.235973 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_client_address
[0m15:22:24.237276 [info ] [Thread-1  ]: 33 of 45 START sql incremental model dbt.sat_client_address .................... [RUN]
[0m15:22:24.239143 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_client_address'
[0m15:22:24.240212 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_client_address
[0m15:22:24.270249 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_client_address"
[0m15:22:24.279290 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client_address (compile): 2024-09-01 15:22:24.241193 => 2024-09-01 15:22:24.279182
[0m15:22:24.280249 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_client_address
[0m15:22:24.291658 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_client_address"
[0m15:22:24.300775 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_address"
[0m15:22:24.301521 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_address: BEGIN
[0m15:22:24.302179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:24.309696 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:24.311146 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_address"
[0m15:22:24.312305 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_client_address"} */

      
  
    

  create  table "postgres"."dbt"."sat_client_address"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CLIENT_ADDRESS_PK, a.CLIENT_ADDRESS_HASHDIFF, a.street, a.house, a.is_valid, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client_address" AS a
    WHERE a.CLIENT_ADDRESS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CLIENT_ADDRESS_PK, stage.CLIENT_ADDRESS_HASHDIFF, stage.street, stage.house, stage.is_valid, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:25.372774 [debug] [Thread-1  ]: SQL status: SELECT 120000 in 1 seconds
[0m15:22:25.377278 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_address: COMMIT
[0m15:22:25.378559 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_address"
[0m15:22:25.379448 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_address: COMMIT
[0m15:22:25.526069 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:25.527969 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client_address (execute): 2024-09-01 15:22:24.281027 => 2024-09-01 15:22:25.527895
[0m15:22:25.529096 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_address: Close
[0m15:22:25.530692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95806fb1f0>]}
[0m15:22:25.532081 [info ] [Thread-1  ]: 33 of 45 OK created sql incremental model dbt.sat_client_address ............... [[32mSELECT 120000[0m in 1.29s]
[0m15:22:25.533374 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_client_address
[0m15:22:25.535015 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_client_type
[0m15:22:25.536339 [info ] [Thread-1  ]: 34 of 45 START sql incremental model dbt.sat_client_type ....................... [RUN]
[0m15:22:25.538006 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_client_type'
[0m15:22:25.539352 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_client_type
[0m15:22:25.569699 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_client_type"
[0m15:22:25.578490 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client_type (compile): 2024-09-01 15:22:25.540480 => 2024-09-01 15:22:25.578382
[0m15:22:25.579297 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_client_type
[0m15:22:25.590967 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_client_type"
[0m15:22:25.600375 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:22:25.601211 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: BEGIN
[0m15:22:25.601925 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:25.609877 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:25.611310 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:22:25.612614 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_client_type"} */

      
  
    

  create  table "postgres"."dbt"."sat_client_type"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CLIENT_TYPE_PK, a.CLIENT_TYPE_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_client_type" AS a
    WHERE a.CLIENT_TYPE_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CLIENT_TYPE_PK, stage.CLIENT_TYPE_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:25.621023 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m15:22:25.624344 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: COMMIT
[0m15:22:25.625482 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_client_type"
[0m15:22:25.626336 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: COMMIT
[0m15:22:25.629024 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:25.630520 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_client_type (execute): 2024-09-01 15:22:25.579880 => 2024-09-01 15:22:25.630449
[0m15:22:25.631347 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_client_type: Close
[0m15:22:25.632726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95806f1ee0>]}
[0m15:22:25.633839 [info ] [Thread-1  ]: 34 of 45 OK created sql incremental model dbt.sat_client_type .................. [[32mSELECT 2[0m in 0.10s]
[0m15:22:25.635149 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_client_type
[0m15:22:25.636253 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_country
[0m15:22:25.637285 [info ] [Thread-1  ]: 35 of 45 START sql incremental model dbt.sat_country ........................... [RUN]
[0m15:22:25.638713 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_country'
[0m15:22:25.639708 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_country
[0m15:22:25.669456 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_country"
[0m15:22:25.678911 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_country (compile): 2024-09-01 15:22:25.640514 => 2024-09-01 15:22:25.678798
[0m15:22:25.679766 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_country
[0m15:22:25.692217 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_country"
[0m15:22:25.701608 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:22:25.702444 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: BEGIN
[0m15:22:25.703169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:25.710661 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:25.712271 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:22:25.713515 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_country"} */

      
  
    

  create  table "postgres"."dbt"."sat_country"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.COUNTRY_PK, a.COUNTRY_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_country" AS a
    WHERE a.COUNTRY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.COUNTRY_PK, stage.COUNTRY_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:25.722240 [debug] [Thread-1  ]: SQL status: SELECT 28 in 0 seconds
[0m15:22:25.725227 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: COMMIT
[0m15:22:25.726065 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_country"
[0m15:22:25.727039 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: COMMIT
[0m15:22:25.729336 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:25.730695 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_country (execute): 2024-09-01 15:22:25.680416 => 2024-09-01 15:22:25.730634
[0m15:22:25.731570 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_country: Close
[0m15:22:25.732778 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820b65e0>]}
[0m15:22:25.733720 [info ] [Thread-1  ]: 35 of 45 OK created sql incremental model dbt.sat_country ...................... [[32mSELECT 28[0m in 0.09s]
[0m15:22:25.734823 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_country
[0m15:22:25.736331 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_currency
[0m15:22:25.737379 [info ] [Thread-1  ]: 36 of 45 START sql incremental model dbt.sat_currency .......................... [RUN]
[0m15:22:25.738955 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_currency'
[0m15:22:25.739788 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_currency
[0m15:22:25.771352 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_currency"
[0m15:22:25.779935 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency (compile): 2024-09-01 15:22:25.740443 => 2024-09-01 15:22:25.779811
[0m15:22:25.780883 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_currency
[0m15:22:25.792614 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_currency"
[0m15:22:25.802893 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:22:25.803852 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: BEGIN
[0m15:22:25.804729 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:25.814065 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:25.815516 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:22:25.816788 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency"} */

      
  
    

  create  table "postgres"."dbt"."sat_currency"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CURRENCY_PK, a.CURRENCY_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency" AS a
    WHERE a.CURRENCY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CURRENCY_PK, stage.CURRENCY_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:25.826081 [debug] [Thread-1  ]: SQL status: SELECT 19 in 0 seconds
[0m15:22:25.829261 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: COMMIT
[0m15:22:25.830270 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency"
[0m15:22:25.831090 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: COMMIT
[0m15:22:25.833956 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:25.835767 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency (execute): 2024-09-01 15:22:25.781536 => 2024-09-01 15:22:25.835674
[0m15:22:25.836824 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency: Close
[0m15:22:25.838559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95807918e0>]}
[0m15:22:25.839990 [info ] [Thread-1  ]: 36 of 45 OK created sql incremental model dbt.sat_currency ..................... [[32mSELECT 19[0m in 0.10s]
[0m15:22:25.841556 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_currency
[0m15:22:25.843020 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_currency_rate
[0m15:22:25.844415 [info ] [Thread-1  ]: 37 of 45 START sql incremental model dbt.sat_currency_rate ..................... [RUN]
[0m15:22:25.846233 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_currency_rate'
[0m15:22:25.847393 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_currency_rate
[0m15:22:25.882082 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_currency_rate"
[0m15:22:25.890455 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency_rate (compile): 2024-09-01 15:22:25.848562 => 2024-09-01 15:22:25.890342
[0m15:22:25.891282 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_currency_rate
[0m15:22:25.902562 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_currency_rate"
[0m15:22:25.911318 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:22:25.912115 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: BEGIN
[0m15:22:25.912790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:25.920189 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:25.921501 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:22:25.922565 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_currency_rate"} */

      
  
    

  create  table "postgres"."dbt"."sat_currency_rate"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.CURRENCY_RATE_PK, a.CURRENCY_RATE_HASHDIFF, a.relation_to_rur, a.date_start, a.date_end, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_currency_rate" AS a
    WHERE a.CURRENCY_RATE_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CURRENCY_RATE_PK, stage.CURRENCY_RATE_HASHDIFF, stage.relation_to_rur, stage.date_start, stage.date_end, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:25.973315 [debug] [Thread-1  ]: SQL status: SELECT 4982 in 0 seconds
[0m15:22:25.976872 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: COMMIT
[0m15:22:25.978158 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_currency_rate"
[0m15:22:25.979303 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: COMMIT
[0m15:22:25.985937 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:25.987930 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_currency_rate (execute): 2024-09-01 15:22:25.891892 => 2024-09-01 15:22:25.987868
[0m15:22:25.989048 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_currency_rate: Close
[0m15:22:25.990770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958262b160>]}
[0m15:22:25.991988 [info ] [Thread-1  ]: 37 of 45 OK created sql incremental model dbt.sat_currency_rate ................ [[32mSELECT 4982[0m in 0.15s]
[0m15:22:25.993272 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_currency_rate
[0m15:22:25.994577 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_good
[0m15:22:25.995607 [info ] [Thread-1  ]: 38 of 45 START sql incremental model dbt.sat_good .............................. [RUN]
[0m15:22:25.997155 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_good'
[0m15:22:25.998267 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_good
[0m15:22:26.028725 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_good"
[0m15:22:26.038084 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_good (compile): 2024-09-01 15:22:25.999099 => 2024-09-01 15:22:26.037963
[0m15:22:26.038970 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_good
[0m15:22:26.050367 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_good"
[0m15:22:26.059143 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:22:26.059894 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: BEGIN
[0m15:22:26.060574 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:26.068274 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:26.069712 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:22:26.070859 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_good"} */

      
  
    

  create  table "postgres"."dbt"."sat_good"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.GOOD_PK, a.GOOD_HASHDIFF, a.name, a.cost_per_unit, a.count, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_goods" AS a
    WHERE a.GOOD_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.GOOD_PK, stage.GOOD_HASHDIFF, stage.name, stage.cost_per_unit, stage.count, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:26.799720 [debug] [Thread-1  ]: SQL status: SELECT 105759 in 1 seconds
[0m15:22:26.803273 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: COMMIT
[0m15:22:26.804539 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_good"
[0m15:22:26.805568 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: COMMIT
[0m15:22:26.827248 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:26.829104 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_good (execute): 2024-09-01 15:22:26.039715 => 2024-09-01 15:22:26.829043
[0m15:22:26.830100 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_good: Close
[0m15:22:26.831744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820165b0>]}
[0m15:22:26.833096 [info ] [Thread-1  ]: 38 of 45 OK created sql incremental model dbt.sat_good ......................... [[32mSELECT 105759[0m in 0.83s]
[0m15:22:26.834472 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_good
[0m15:22:26.835818 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order
[0m15:22:26.836995 [info ] [Thread-1  ]: 39 of 45 START sql incremental model dbt.sat_order ............................. [RUN]
[0m15:22:26.838757 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order'
[0m15:22:26.840086 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order
[0m15:22:26.873732 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order"
[0m15:22:26.882273 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order (compile): 2024-09-01 15:22:26.840987 => 2024-09-01 15:22:26.882158
[0m15:22:26.883149 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order
[0m15:22:26.895273 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order"
[0m15:22:26.904463 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m15:22:26.905266 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: BEGIN
[0m15:22:26.905991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:26.913852 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:26.915378 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m15:22:26.916542 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order"} */

      
  
    

  create  table "postgres"."dbt"."sat_order"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.order_date, a.length, a.height, a.width, a.weight, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_orders" AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.order_date, stage.length, stage.height, stage.width, stage.weight, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:27.502446 [debug] [Thread-1  ]: SQL status: SELECT 60000 in 1 seconds
[0m15:22:27.506121 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: COMMIT
[0m15:22:27.507336 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order"
[0m15:22:27.508386 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: COMMIT
[0m15:22:27.552261 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:27.553869 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order (execute): 2024-09-01 15:22:26.883813 => 2024-09-01 15:22:27.553809
[0m15:22:27.554751 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order: Close
[0m15:22:27.556230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9580771400>]}
[0m15:22:27.557317 [info ] [Thread-1  ]: 39 of 45 OK created sql incremental model dbt.sat_order ........................ [[32mSELECT 60000[0m in 0.72s]
[0m15:22:27.558527 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order
[0m15:22:27.559795 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_status
[0m15:22:27.561255 [info ] [Thread-1  ]: 40 of 45 START sql incremental model dbt.sat_order_status ...................... [RUN]
[0m15:22:27.562924 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_status'
[0m15:22:27.563971 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_status
[0m15:22:27.593014 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_status"
[0m15:22:27.601816 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status (compile): 2024-09-01 15:22:27.564946 => 2024-09-01 15:22:27.601711
[0m15:22:27.602616 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_status
[0m15:22:27.614672 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order_status"
[0m15:22:27.624087 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:22:27.624894 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: BEGIN
[0m15:22:27.625627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:27.633464 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:27.635009 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:22:27.636202 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status"} */

      
  
    

  create  table "postgres"."dbt"."sat_order_status"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_STATUS_PK, a.ORDER_STATUS_HASHDIFF, a.name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status" AS a
    WHERE a.ORDER_STATUS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_STATUS_PK, stage.ORDER_STATUS_HASHDIFF, stage.name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:27.644126 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0 seconds
[0m15:22:27.647034 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: COMMIT
[0m15:22:27.648156 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status"
[0m15:22:27.649249 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: COMMIT
[0m15:22:27.651711 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:27.653165 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status (execute): 2024-09-01 15:22:27.603200 => 2024-09-01 15:22:27.653090
[0m15:22:27.653904 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status: Close
[0m15:22:27.655290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958072d160>]}
[0m15:22:27.656277 [info ] [Thread-1  ]: 40 of 45 OK created sql incremental model dbt.sat_order_status ................. [[32mSELECT 7[0m in 0.09s]
[0m15:22:27.657396 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order_status
[0m15:22:27.658516 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_status_history
[0m15:22:27.659799 [info ] [Thread-1  ]: 41 of 45 START sql incremental model dbt.sat_order_status_history .............. [RUN]
[0m15:22:27.661332 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_status_history'
[0m15:22:27.662208 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_status_history
[0m15:22:27.736790 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_status_history"
[0m15:22:27.746825 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status_history (compile): 2024-09-01 15:22:27.662993 => 2024-09-01 15:22:27.746653
[0m15:22:27.747859 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_status_history
[0m15:22:27.761093 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order_status_history"
[0m15:22:27.770277 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status_history"
[0m15:22:27.771096 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: BEGIN
[0m15:22:27.771865 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:27.782595 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:27.783964 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status_history"
[0m15:22:27.785243 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_status_history"} */

      
  
    

  create  table "postgres"."dbt"."sat_order_status_history"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_STATUS_HISTORY_PK, a.ORDER_STATUS_HISTORY_HASHDIFF, a.status_datetime, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_status_history" AS a
    WHERE a.ORDER_STATUS_HISTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_STATUS_HISTORY_PK, stage.ORDER_STATUS_HISTORY_HASHDIFF, stage.status_datetime, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:29.206152 [debug] [Thread-1  ]: SQL status: SELECT 249912 in 1 seconds
[0m15:22:29.209513 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: COMMIT
[0m15:22:29.210744 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_status_history"
[0m15:22:29.211978 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: COMMIT
[0m15:22:29.224504 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:29.226171 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_status_history (execute): 2024-09-01 15:22:27.748834 => 2024-09-01 15:22:29.226111
[0m15:22:29.227299 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_status_history: Close
[0m15:22:29.228927 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958078e3d0>]}
[0m15:22:29.230347 [info ] [Thread-1  ]: 41 of 45 OK created sql incremental model dbt.sat_order_status_history ......... [[32mSELECT 249912[0m in 1.57s]
[0m15:22:29.231531 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order_status_history
[0m15:22:29.232978 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_order_with_delay
[0m15:22:29.234163 [info ] [Thread-1  ]: 42 of 45 START sql incremental model dbt.sat_order_with_delay .................. [RUN]
[0m15:22:29.235972 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_order_with_delay'
[0m15:22:29.237053 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_order_with_delay
[0m15:22:29.266254 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_order_with_delay"
[0m15:22:29.275030 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_with_delay (compile): 2024-09-01 15:22:29.237944 => 2024-09-01 15:22:29.274922
[0m15:22:29.275904 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_order_with_delay
[0m15:22:29.288492 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_order_with_delay"
[0m15:22:29.297452 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m15:22:29.298294 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: BEGIN
[0m15:22:29.298992 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:29.306639 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:29.308327 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m15:22:29.309543 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_order_with_delay"} */

      
  
    

  create  table "postgres"."dbt"."sat_order_with_delay"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.ORDER_WITH_DELAY_PK, a.ORDER_WITH_DELAY_HASHDIFF, a.reason_for_delay, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_order_with_delay" AS a
    WHERE a.ORDER_WITH_DELAY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_WITH_DELAY_PK, stage.ORDER_WITH_DELAY_HASHDIFF, stage.reason_for_delay, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:29.342198 [debug] [Thread-1  ]: SQL status: SELECT 3088 in 0 seconds
[0m15:22:29.345644 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: COMMIT
[0m15:22:29.346705 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_order_with_delay"
[0m15:22:29.347678 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: COMMIT
[0m15:22:29.360500 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:29.362358 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_order_with_delay (execute): 2024-09-01 15:22:29.276564 => 2024-09-01 15:22:29.362298
[0m15:22:29.363475 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_order_with_delay: Close
[0m15:22:29.365296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95821982e0>]}
[0m15:22:29.366662 [info ] [Thread-1  ]: 42 of 45 OK created sql incremental model dbt.sat_order_with_delay ............. [[32mSELECT 3088[0m in 0.13s]
[0m15:22:29.368395 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_order_with_delay
[0m15:22:29.369723 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_warehouse
[0m15:22:29.370923 [info ] [Thread-1  ]: 43 of 45 START sql incremental model dbt.sat_warehouse ......................... [RUN]
[0m15:22:29.372803 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_warehouse'
[0m15:22:29.374010 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_warehouse
[0m15:22:29.405643 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_warehouse"
[0m15:22:29.414418 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse (compile): 2024-09-01 15:22:29.374900 => 2024-09-01 15:22:29.414299
[0m15:22:29.415256 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_warehouse
[0m15:22:29.426921 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_warehouse"
[0m15:22:29.437303 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m15:22:29.438178 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: BEGIN
[0m15:22:29.438907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:29.446506 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:29.448102 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m15:22:29.449337 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse"} */

      
  
    

  create  table "postgres"."dbt"."sat_warehouse"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.WAREHOUSE_PK, a.WAREHOUSE_HASHDIFF, a.name, a.system_name, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse" AS a
    WHERE a.WAREHOUSE_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.WAREHOUSE_PK, stage.WAREHOUSE_HASHDIFF, stage.name, stage.system_name, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:29.503917 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:29.507310 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: COMMIT
[0m15:22:29.508475 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse"
[0m15:22:29.509536 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: COMMIT
[0m15:22:29.523360 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:29.525218 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse (execute): 2024-09-01 15:22:29.415977 => 2024-09-01 15:22:29.525158
[0m15:22:29.526376 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse: Close
[0m15:22:29.527942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9582198760>]}
[0m15:22:29.529374 [info ] [Thread-1  ]: 43 of 45 OK created sql incremental model dbt.sat_warehouse .................... [[32mSELECT 5668[0m in 0.16s]
[0m15:22:29.531090 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_warehouse
[0m15:22:29.532643 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_warehouse_address
[0m15:22:29.534081 [info ] [Thread-1  ]: 44 of 45 START sql incremental model dbt.sat_warehouse_address ................. [RUN]
[0m15:22:29.535716 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_warehouse_address'
[0m15:22:29.536839 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_warehouse_address
[0m15:22:29.568113 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_warehouse_address"
[0m15:22:29.578024 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_address (compile): 2024-09-01 15:22:29.537876 => 2024-09-01 15:22:29.577912
[0m15:22:29.578865 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_warehouse_address
[0m15:22:29.590605 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_warehouse_address"
[0m15:22:29.599050 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m15:22:29.599801 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: BEGIN
[0m15:22:29.600717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:29.608523 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:29.609981 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m15:22:29.611041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_address"} */

      
  
    

  create  table "postgres"."dbt"."sat_warehouse_address"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.WAREHOUSE_ADDRESS_PK, a.WAREHOUSE_ADDRESS_HASHDIFF, a.street, a.house, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse_address" AS a
    WHERE a.WAREHOUSE_ADDRESS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.WAREHOUSE_ADDRESS_PK, stage.WAREHOUSE_ADDRESS_HASHDIFF, stage.street, stage.house, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:29.666088 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:29.669930 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: COMMIT
[0m15:22:29.671279 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_address"
[0m15:22:29.672689 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: COMMIT
[0m15:22:29.700111 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:29.702342 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_address (execute): 2024-09-01 15:22:29.579490 => 2024-09-01 15:22:29.702282
[0m15:22:29.703583 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_address: Close
[0m15:22:29.705058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9581fec9a0>]}
[0m15:22:29.706257 [info ] [Thread-1  ]: 44 of 45 OK created sql incremental model dbt.sat_warehouse_address ............ [[32mSELECT 5668[0m in 0.17s]
[0m15:22:29.707915 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_warehouse_address
[0m15:22:29.709056 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.sat_warehouse_params
[0m15:22:29.710199 [info ] [Thread-1  ]: 45 of 45 START sql incremental model dbt.sat_warehouse_params .................. [RUN]
[0m15:22:29.711942 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.sat_warehouse_params'
[0m15:22:29.713012 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.sat_warehouse_params
[0m15:22:29.744162 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.sat_warehouse_params"
[0m15:22:29.754678 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_params (compile): 2024-09-01 15:22:29.714057 => 2024-09-01 15:22:29.754565
[0m15:22:29.755517 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.sat_warehouse_params
[0m15:22:29.767410 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.sat_warehouse_params"
[0m15:22:29.776714 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m15:22:29.777721 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: BEGIN
[0m15:22:29.778564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:22:29.785848 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:22:29.787332 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m15:22:29.788709 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.sat_warehouse_params"} */

      
  
    

  create  table "postgres"."dbt"."sat_warehouse_params"
  as (
    -- Generated by AutomateDV (formerly known as dbtvault)

    WITH source_data AS (
    SELECT a.WAREHOUSE_PARAMS_PK, a.WAREHOUSE_PARAMS_HASHDIFF, a.max_loading_weight, a.max_loading_volume, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM "postgres"."dbt"."stg_warehouse_params" AS a
    WHERE a.WAREHOUSE_PARAMS_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.WAREHOUSE_PARAMS_PK, stage.WAREHOUSE_PARAMS_HASHDIFF, stage.max_loading_weight, stage.max_loading_volume, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage

)

SELECT * FROM records_to_insert
  );
  
  
[0m15:22:29.839378 [debug] [Thread-1  ]: SQL status: SELECT 5668 in 0 seconds
[0m15:22:29.842915 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: COMMIT
[0m15:22:29.843939 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.sat_warehouse_params"
[0m15:22:29.844946 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: COMMIT
[0m15:22:29.857860 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:22:29.859416 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.sat_warehouse_params (execute): 2024-09-01 15:22:29.756142 => 2024-09-01 15:22:29.859356
[0m15:22:29.860571 [debug] [Thread-1  ]: On model.otus_project_dbtvault.sat_warehouse_params: Close
[0m15:22:29.862188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60cf242-6b67-4c14-b7db-bd2238d6c403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95807116d0>]}
[0m15:22:29.863553 [info ] [Thread-1  ]: 45 of 45 OK created sql incremental model dbt.sat_warehouse_params ............. [[32mSELECT 5668[0m in 0.15s]
[0m15:22:29.865253 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.sat_warehouse_params
[0m15:22:29.868209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:29.869417 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:29.870494 [debug] [MainThread]: On master: BEGIN
[0m15:22:29.871429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:29.878812 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:22:29.880378 [debug] [MainThread]: On master: COMMIT
[0m15:22:29.881458 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:29.882558 [debug] [MainThread]: On master: COMMIT
[0m15:22:29.883572 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:22:29.884384 [debug] [MainThread]: On master: Close
[0m15:22:29.885759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:29.886692 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.sat_warehouse_params' was properly closed.
[0m15:22:29.887813 [info ] [MainThread]: 
[0m15:22:29.888845 [info ] [MainThread]: Finished running 45 incremental models in 0 hours 0 minutes and 30.82 seconds (30.82s).
[0m15:22:29.893145 [debug] [MainThread]: Command end result
[0m15:22:29.925725 [info ] [MainThread]: 
[0m15:22:29.926874 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:29.928246 [info ] [MainThread]: 
[0m15:22:29.929419 [info ] [MainThread]: Done. PASS=45 WARN=0 ERROR=0 SKIP=0 TOTAL=45
[0m15:22:29.930696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f958229f1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820f5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95820f5fa0>]}
[0m15:22:29.931925 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:23:06.546187 | e0dba673-a984-40e5-8c57-0c5e5a099103 ==============================
[0m15:23:06.546187 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:23:06.549109 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:23:06.549962 [debug] [MainThread]: Tracking: tracking
[0m15:23:06.555139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b10399520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b10399130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b10399a30>]}
[0m15:23:09.707398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:09.708199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:09.726181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fe870d0>]}
[0m15:23:09.774817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1006b910>]}
[0m15:23:09.775906 [info ] [MainThread]: Found 96 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:23:09.777123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1038e0a0>]}
[0m15:23:09.783526 [info ] [MainThread]: 
[0m15:23:09.786744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:09.789155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:23:09.808793 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:23:09.809889 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:23:09.810848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:09.821327 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:23:09.824006 [debug] [ThreadPool]: On list_postgres: Close
[0m15:23:09.835045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:23:09.844387 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:23:09.845736 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:23:09.846919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:09.854935 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:23:09.856442 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:23:09.857535 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:23:09.860720 [debug] [ThreadPool]: SQL status: SELECT 106 in 0 seconds
[0m15:23:09.865927 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:23:09.867337 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:23:09.894789 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.896144 [debug] [MainThread]: On master: BEGIN
[0m15:23:09.897210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:09.905176 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:09.906771 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.907900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:09.960072 [debug] [MainThread]: SQL status: SELECT 61 in 0 seconds
[0m15:23:09.970700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b1037ea60>]}
[0m15:23:09.972153 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:09.973557 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.974665 [debug] [MainThread]: On master: BEGIN
[0m15:23:09.976194 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:09.977416 [debug] [MainThread]: On master: COMMIT
[0m15:23:09.978415 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.979354 [debug] [MainThread]: On master: COMMIT
[0m15:23:09.980441 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:23:09.981373 [debug] [MainThread]: On master: Close
[0m15:23:09.982777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:09.983661 [info ] [MainThread]: 
[0m15:23:09.988587 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.as_of_date
[0m15:23:09.989930 [info ] [Thread-1  ]: 1 of 5 START sql table model dbt.as_of_date .................................... [RUN]
[0m15:23:09.991559 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.as_of_date'
[0m15:23:09.992612 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.as_of_date
[0m15:23:10.028689 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.030242 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: BEGIN
[0m15:23:10.031294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:10.039035 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:23:10.040558 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.041716 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */


        select 
        ((TO_DATE('2024-10-01', 'yyyy-mm-dd'))::date - (TO_DATE('2023-12-01', 'yyyy-mm-dd'))::date)
    
[0m15:23:10.043357 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m15:23:10.060753 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.072646 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (compile): 2024-09-01 15:23:09.993822 => 2024-09-01 15:23:10.072516
[0m15:23:10.073509 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.as_of_date
[0m15:23:10.131190 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.142153 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.142989 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */

  
    

  create  table "postgres"."dbt"."as_of_date__dbt_tmp"
  as (
    WITH as_of_date AS (
 





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 305
    order by generated_number



),

all_periods as (

    select (
        

    TO_DATE('2023-12-01', 'yyyy-mm-dd') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= TO_DATE('2024-10-01', 'yyyy-mm-dd')

)

select * from filtered


)
SELECT DATE_day as AS_OF_DATE FROM as_of_date
  );
  
[0m15:23:10.150764 [debug] [Thread-1  ]: SQL status: SELECT 305 in 0 seconds
[0m15:23:10.161014 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.162280 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date__dbt_tmp" rename to "as_of_date"
[0m15:23:10.163729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:23:10.191576 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:23:10.192774 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.193834 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:23:10.197812 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:23:10.206628 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:23:10.207858 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
drop table if exists "postgres"."dbt"."as_of_date__dbt_backup" cascade
[0m15:23:10.209020 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:23:10.211139 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (execute): 2024-09-01 15:23:10.074132 => 2024-09-01 15:23:10.211081
[0m15:23:10.212047 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: Close
[0m15:23:10.213442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fcadaf0>]}
[0m15:23:10.214596 [info ] [Thread-1  ]: 1 of 5 OK created sql table model dbt.as_of_date ............................... [[32mSELECT 305[0m in 0.22s]
[0m15:23:10.217816 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.as_of_date
[0m15:23:10.218963 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_city_country
[0m15:23:10.220151 [info ] [Thread-1  ]: 2 of 5 START sql view model dbt.cv_city_country ................................ [RUN]
[0m15:23:10.221655 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_city_country'
[0m15:23:10.222800 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_city_country
[0m15:23:10.229719 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_city_country"
[0m15:23:10.236276 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (compile): 2024-09-01 15:23:10.223728 => 2024-09-01 15:23:10.236145
[0m15:23:10.237147 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_city_country
[0m15:23:10.267100 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_city_country"
[0m15:23:10.275605 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:23:10.276448 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: BEGIN
[0m15:23:10.277252 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:10.284793 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:23:10.286141 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:23:10.287137 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */

  create view "postgres"."dbt"."cv_city_country__dbt_tmp" as (
    select
    sci.CITY_PK,
    sci.name AS city_name,
    sco.name AS country_name
FROM "postgres"."dbt"."sat_city" AS sci
LEFT JOIN "postgres"."dbt"."link_city_country" AS ccl on ccl.CITY_PK = sci.CITY_PK
LEFT JOIN "postgres"."dbt"."sat_country" AS sco ON sco.COUNTRY_PK = ccl.COUNTRY_PK
  );
[0m15:23:10.289913 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:23:10.295466 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:23:10.296585 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country__dbt_tmp" rename to "cv_city_country"
[0m15:23:10.298075 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:23:10.300712 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m15:23:10.301884 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:23:10.302853 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m15:23:10.306028 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:23:10.310563 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:23:10.311676 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
drop view if exists "postgres"."dbt"."cv_city_country__dbt_backup" cascade
[0m15:23:10.313082 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:23:10.315251 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (execute): 2024-09-01 15:23:10.237846 => 2024-09-01 15:23:10.315194
[0m15:23:10.316272 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: Close
[0m15:23:10.317856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fdfa7f0>]}
[0m15:23:10.319487 [info ] [Thread-1  ]: 2 of 5 OK created sql view model dbt.cv_city_country ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m15:23:10.321203 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_city_country
[0m15:23:10.323009 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_date
[0m15:23:10.324291 [info ] [Thread-1  ]: 3 of 5 START sql view model dbt.cv_date ........................................ [RUN]
[0m15:23:10.326140 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_date'
[0m15:23:10.327328 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_date
[0m15:23:10.332924 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_date"
[0m15:23:10.340410 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (compile): 2024-09-01 15:23:10.328438 => 2024-09-01 15:23:10.340298
[0m15:23:10.341437 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_date
[0m15:23:10.352205 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_date"
[0m15:23:10.360731 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:23:10.361571 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: BEGIN
[0m15:23:10.362368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:10.370033 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:23:10.371341 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:23:10.372511 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */

  create view "postgres"."dbt"."cv_date__dbt_tmp" as (
    WITH
RECURSIVE dates AS (
    SELECT
        '2023-12-01'::TIMESTAMP AS date_value
    UNION
    SELECT
        date_value + INTERVAL '1' DAY AS date_value
    FROM dates
    WHERE date_value <= '2024-10-01'
)
select date_value from dates
  );
[0m15:23:10.375331 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:23:10.381272 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:23:10.382291 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date__dbt_tmp" rename to "cv_date"
[0m15:23:10.383516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:23:10.385881 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:23:10.386652 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:23:10.387556 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:23:10.390208 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:23:10.394694 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:23:10.395828 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
drop view if exists "postgres"."dbt"."cv_date__dbt_backup" cascade
[0m15:23:10.397195 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:23:10.399248 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (execute): 2024-09-01 15:23:10.342226 => 2024-09-01 15:23:10.399191
[0m15:23:10.400188 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: Close
[0m15:23:10.401685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fdd0f70>]}
[0m15:23:10.402977 [info ] [Thread-1  ]: 3 of 5 OK created sql view model dbt.cv_date ................................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:23:10.404386 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_date
[0m15:23:10.405675 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status
[0m15:23:10.406897 [info ] [Thread-1  ]: 4 of 5 START sql view model dbt.cv_last_order_status ........................... [RUN]
[0m15:23:10.408541 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status'
[0m15:23:10.409536 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status
[0m15:23:10.415593 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status"
[0m15:23:10.423137 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (compile): 2024-09-01 15:23:10.410270 => 2024-09-01 15:23:10.423014
[0m15:23:10.424157 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status
[0m15:23:10.436231 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status"
[0m15:23:10.444991 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:23:10.445758 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: BEGIN
[0m15:23:10.446457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:10.453924 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:23:10.455467 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:23:10.456588 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */

  create view "postgres"."dbt"."cv_last_order_status__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd hh24:mi') as status_datetime,
        row_number() over (partition by lo.ORDER_PK order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    os.ORDER_PK,
	os.status_datetime,
    loo.ORDER_STATUS_PK,
lw.WAREHOUSE_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_order_status_order_status_history" AS loo on loo.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m15:23:10.459386 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:23:10.464450 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:23:10.465588 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status__dbt_tmp" rename to "cv_last_order_status"
[0m15:23:10.467159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:23:10.469621 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m15:23:10.470554 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:23:10.471499 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m15:23:10.474047 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:23:10.478471 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:23:10.479561 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
drop view if exists "postgres"."dbt"."cv_last_order_status__dbt_backup" cascade
[0m15:23:10.480873 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:23:10.483105 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (execute): 2024-09-01 15:23:10.425178 => 2024-09-01 15:23:10.483048
[0m15:23:10.484178 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: Close
[0m15:23:10.485665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fd8cd00>]}
[0m15:23:10.486786 [info ] [Thread-1  ]: 4 of 5 OK created sql view model dbt.cv_last_order_status ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:23:10.488306 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status
[0m15:23:10.489732 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:23:10.491092 [info ] [Thread-1  ]: 5 of 5 START sql view model dbt.cv_currency_rate_by_date ....................... [RUN]
[0m15:23:10.492658 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_currency_rate_by_date'
[0m15:23:10.493691 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:23:10.499790 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:23:10.507588 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (compile): 2024-09-01 15:23:10.494516 => 2024-09-01 15:23:10.507477
[0m15:23:10.508431 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:23:10.519123 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:23:10.526906 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:23:10.527697 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: BEGIN
[0m15:23:10.528373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:10.535920 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:23:10.537578 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:23:10.538791 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */

  create view "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" as (
    SELECT
    q.CURRENCY_PK,
    q.relation_to_rur,
    d.as_of_date AS date_value
FROM (
    SELECT
        ccr.CURRENCY_PK, cr.relation_to_rur, cr.date_start,
        LAG(cr.date_start) OVER (PARTITION BY ccr.CURRENCY_PK ORDER BY cr.date_start DESC) AS date_end
    FROM "postgres"."dbt"."sat_currency_rate" cr
	LEFT JOIN "postgres"."dbt"."link_currency_currency_rate" ccr ON ccr.CURRENCY_RATE_PK = cr.CURRENCY_RATE_PK
	)q, "postgres"."dbt"."as_of_date" d
    WHERE d.as_of_date >= COALESCE(q.date_start, '2023-12-01') AND d.as_of_date < COALESCE(q.date_end, '2024-10-01')
  );
[0m15:23:10.541805 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:23:10.547360 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:23:10.548418 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
alter table "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" rename to "cv_currency_rate_by_date"
[0m15:23:10.549706 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:23:10.552316 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m15:23:10.553316 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:23:10.554154 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m15:23:10.557293 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:23:10.597700 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:23:10.598938 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
drop view if exists "postgres"."dbt"."cv_currency_rate_by_date__dbt_backup" cascade
[0m15:23:10.600426 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:23:10.602640 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (execute): 2024-09-01 15:23:10.509059 => 2024-09-01 15:23:10.602580
[0m15:23:10.603700 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: Close
[0m15:23:10.605249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0dba673-a984-40e5-8c57-0c5e5a099103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fdce760>]}
[0m15:23:10.606675 [info ] [Thread-1  ]: 5 of 5 OK created sql view model dbt.cv_currency_rate_by_date .................. [[32mCREATE VIEW[0m in 0.11s]
[0m15:23:10.608006 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:23:10.610981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:10.612194 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:10.613279 [debug] [MainThread]: On master: BEGIN
[0m15:23:10.614229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:10.622221 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:10.623825 [debug] [MainThread]: On master: COMMIT
[0m15:23:10.624811 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:10.625745 [debug] [MainThread]: On master: COMMIT
[0m15:23:10.626843 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:23:10.627746 [debug] [MainThread]: On master: Close
[0m15:23:10.629141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:10.630097 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_currency_rate_by_date' was properly closed.
[0m15:23:10.630962 [info ] [MainThread]: 
[0m15:23:10.631994 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m15:23:10.633623 [debug] [MainThread]: Command end result
[0m15:23:10.667630 [info ] [MainThread]: 
[0m15:23:10.668745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:10.669918 [info ] [MainThread]: 
[0m15:23:10.671280 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:23:10.672795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fd36430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b103958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b0fda3820>]}
[0m15:23:10.674317 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:23:22.353100 | 2b4bb9a9-0df5-4738-92a6-f0a1dc109e18 ==============================
[0m15:23:22.353100 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:23:22.356170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:23:22.357184 [debug] [MainThread]: Tracking: tracking
[0m15:23:22.362238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a712490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a7121c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a712a30>]}
[0m15:23:25.605665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:25.606693 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:25.627203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b4bb9a9-0df5-4738-92a6-f0a1dc109e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a2020d0>]}
[0m15:23:25.675162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b4bb9a9-0df5-4738-92a6-f0a1dc109e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a3e7910>]}
[0m15:23:25.676249 [info ] [MainThread]: Found 96 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:23:25.677322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b4bb9a9-0df5-4738-92a6-f0a1dc109e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a6f94f0>]}
[0m15:23:25.684104 [info ] [MainThread]: 
[0m15:23:25.687887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:25.689960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:23:25.707266 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:23:25.708444 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:23:25.709488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:25.718147 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:23:25.720635 [debug] [ThreadPool]: On list_postgres: Close
[0m15:23:25.731238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:23:25.740550 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:23:25.741532 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:23:25.742360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:25.750368 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:23:25.751737 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:23:25.752945 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:23:25.756499 [debug] [ThreadPool]: SQL status: SELECT 111 in 0 seconds
[0m15:23:25.762067 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:23:25.763607 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:23:25.794958 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:25.796385 [debug] [MainThread]: On master: BEGIN
[0m15:23:25.797631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:25.805754 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:25.807202 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:25.808393 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:25.867770 [debug] [MainThread]: SQL status: SELECT 71 in 0 seconds
[0m15:23:25.880046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b4bb9a9-0df5-4738-92a6-f0a1dc109e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a6f8a60>]}
[0m15:23:25.881503 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:25.882885 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:25.883883 [debug] [MainThread]: On master: BEGIN
[0m15:23:25.885279 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:25.886555 [debug] [MainThread]: On master: COMMIT
[0m15:23:25.887625 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:25.888469 [debug] [MainThread]: On master: COMMIT
[0m15:23:25.889551 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:23:25.890487 [debug] [MainThread]: On master: Close
[0m15:23:25.891997 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:25.893222 [info ] [MainThread]: 
[0m15:23:25.898013 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_sender
[0m15:23:25.899146 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.cv_order_sender ................................ [RUN]
[0m15:23:25.900714 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_sender'
[0m15:23:25.901824 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_sender
[0m15:23:25.909724 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_sender"
[0m15:23:25.920488 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (compile): 2024-09-01 15:23:25.902711 => 2024-09-01 15:23:25.920342
[0m15:23:25.921351 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_sender
[0m15:23:25.977774 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_sender"
[0m15:23:25.990667 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:23:25.991446 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: BEGIN
[0m15:23:25.992143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:23:25.999648 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:23:26.001197 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:23:26.002424 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */

  create view "postgres"."dbt"."cv_order_sender__dbt_tmp" as (
    SELECT
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'sender'
  );
[0m15:23:26.005656 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:23:26.016048 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:23:26.017316 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender__dbt_tmp" rename to "cv_order_sender"
[0m15:23:26.018903 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:23:26.041309 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m15:23:26.042602 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:23:26.043789 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m15:23:26.047001 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:23:26.054910 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:23:26.056095 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
drop view if exists "postgres"."dbt"."cv_order_sender__dbt_backup" cascade
[0m15:23:26.057590 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:23:26.059962 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (execute): 2024-09-01 15:23:25.921970 => 2024-09-01 15:23:26.059901
[0m15:23:26.061054 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: Close
[0m15:23:26.062487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b4bb9a9-0df5-4738-92a6-f0a1dc109e18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a707d90>]}
[0m15:23:26.063918 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.cv_order_sender ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:23:26.066944 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_sender
[0m15:23:26.070207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:26.071415 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:26.072526 [debug] [MainThread]: On master: BEGIN
[0m15:23:26.073689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:26.081580 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:23:26.083333 [debug] [MainThread]: On master: COMMIT
[0m15:23:26.084456 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:26.085518 [debug] [MainThread]: On master: COMMIT
[0m15:23:26.086640 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:23:26.087561 [debug] [MainThread]: On master: Close
[0m15:23:26.088946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:26.089978 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_order_sender' was properly closed.
[0m15:23:26.090793 [info ] [MainThread]: 
[0m15:23:26.091923 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:23:26.093191 [debug] [MainThread]: Command end result
[0m15:23:26.126249 [info ] [MainThread]: 
[0m15:23:26.127409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:26.128666 [info ] [MainThread]: 
[0m15:23:26.129936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:23:26.131261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a013e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521a6f94f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f521befeee0>]}
[0m15:23:26.132580 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:25:20.266477 | 258aa9c9-85b3-4044-9973-4b26f80304a7 ==============================
[0m15:25:20.266477 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:25:20.269656 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:25:20.270559 [debug] [MainThread]: Tracking: tracking
[0m15:25:20.274985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a6389bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a608bbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a608bb640>]}
[0m15:25:23.115568 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m15:25:23.117050 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_order_receiver.sql
[0m15:25:23.118102 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_order_sender.sql
[0m15:25:23.119062 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_order_payer.sql
[0m15:25:23.119912 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_order_sender.sql
[0m15:25:23.146689 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_receiver.sql
[0m15:25:23.165149 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_sender.sql
[0m15:25:23.171747 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_payer.sql
[0m15:25:23.206305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.otus_project_dbtvault.cdm
[0m15:25:23.221636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a607810d0>]}
[0m15:25:23.270819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a608d6bb0>]}
[0m15:25:23.272193 [info ] [MainThread]: Found 98 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:25:23.273385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a608bb820>]}
[0m15:25:23.281102 [info ] [MainThread]: 
[0m15:25:23.284319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:25:23.286826 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:25:23.303422 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:25:23.304753 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:25:23.305905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:23.316682 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:25:23.319447 [debug] [ThreadPool]: On list_postgres: Close
[0m15:25:23.331486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:25:23.341986 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:25:23.343494 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:25:23.344689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:23.353504 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:25:23.355148 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:25:23.356467 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:25:23.360467 [debug] [ThreadPool]: SQL status: SELECT 112 in 0 seconds
[0m15:25:23.366194 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:25:23.367665 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:25:23.397409 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:23.398891 [debug] [MainThread]: On master: BEGIN
[0m15:25:23.400098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:23.408569 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:25:23.410327 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:23.411491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:25:23.470757 [debug] [MainThread]: SQL status: SELECT 77 in 0 seconds
[0m15:25:23.483922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a620c5490>]}
[0m15:25:23.485339 [debug] [MainThread]: On master: ROLLBACK
[0m15:25:23.486699 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:23.487911 [debug] [MainThread]: On master: BEGIN
[0m15:25:23.489914 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:25:23.491474 [debug] [MainThread]: On master: COMMIT
[0m15:25:23.492787 [debug] [MainThread]: Using postgres connection "master"
[0m15:25:23.493803 [debug] [MainThread]: On master: COMMIT
[0m15:25:23.495122 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:25:23.496174 [debug] [MainThread]: On master: Close
[0m15:25:23.497591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:23.499132 [info ] [MainThread]: 
[0m15:25:23.503952 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.as_of_date
[0m15:25:23.505161 [info ] [Thread-1  ]: 1 of 8 START sql table model dbt.as_of_date .................................... [RUN]
[0m15:25:23.506652 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.as_of_date'
[0m15:25:23.507745 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.as_of_date
[0m15:25:23.542868 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.544033 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: BEGIN
[0m15:25:23.544983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:23.552838 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:25:23.554373 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.555407 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */


        select 
        ((TO_DATE('2024-10-01', 'yyyy-mm-dd'))::date - (TO_DATE('2023-12-01', 'yyyy-mm-dd'))::date)
    
[0m15:25:23.557042 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m15:25:23.575726 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.584382 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (compile): 2024-09-01 15:25:23.508946 => 2024-09-01 15:25:23.584251
[0m15:25:23.585256 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.as_of_date
[0m15:25:23.645458 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.654308 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.655085 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */

  
    

  create  table "postgres"."dbt"."as_of_date__dbt_tmp"
  as (
    WITH as_of_date AS (
 





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 305
    order by generated_number



),

all_periods as (

    select (
        

    TO_DATE('2023-12-01', 'yyyy-mm-dd') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= TO_DATE('2024-10-01', 'yyyy-mm-dd')

)

select * from filtered


)
SELECT DATE_day as AS_OF_DATE FROM as_of_date
  );
  
[0m15:25:23.662867 [debug] [Thread-1  ]: SQL status: SELECT 305 in 0 seconds
[0m15:25:23.673015 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.674270 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date" rename to "as_of_date__dbt_backup"
[0m15:25:23.675788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:23.681351 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.682595 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date__dbt_tmp" rename to "as_of_date"
[0m15:25:23.684026 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:23.714232 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:25:23.715542 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.716626 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:25:23.719858 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:25:23.729006 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:25:23.730159 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
drop table if exists "postgres"."dbt"."as_of_date__dbt_backup" cascade
[0m15:25:23.733885 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:25:23.736480 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (execute): 2024-09-01 15:25:23.585872 => 2024-09-01 15:25:23.736417
[0m15:25:23.737555 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: Close
[0m15:25:23.739226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f149a60>]}
[0m15:25:23.740542 [info ] [Thread-1  ]: 1 of 8 OK created sql table model dbt.as_of_date ............................... [[32mSELECT 305[0m in 0.23s]
[0m15:25:23.743956 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.as_of_date
[0m15:25:23.745508 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_city_country
[0m15:25:23.746968 [info ] [Thread-1  ]: 2 of 8 START sql view model dbt.cv_city_country ................................ [RUN]
[0m15:25:23.748825 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_city_country'
[0m15:25:23.750122 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_city_country
[0m15:25:23.756085 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.762897 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (compile): 2024-09-01 15:25:23.751066 => 2024-09-01 15:25:23.762782
[0m15:25:23.763738 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_city_country
[0m15:25:23.797489 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.804741 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.805604 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: BEGIN
[0m15:25:23.806311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:23.813795 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:25:23.815201 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.816156 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */

  create view "postgres"."dbt"."cv_city_country__dbt_tmp" as (
    select
    sci.CITY_PK,
    sci.name AS city_name,
    sco.name AS country_name
FROM "postgres"."dbt"."sat_city" AS sci
LEFT JOIN "postgres"."dbt"."link_city_country" AS ccl on ccl.CITY_PK = sci.CITY_PK
LEFT JOIN "postgres"."dbt"."sat_country" AS sco ON sco.COUNTRY_PK = ccl.COUNTRY_PK
  );
[0m15:25:23.818770 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:25:23.824718 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.825855 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country" rename to "cv_city_country__dbt_backup"
[0m15:25:23.827330 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:23.832746 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.833824 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country__dbt_tmp" rename to "cv_city_country"
[0m15:25:23.835092 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:23.838006 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m15:25:23.839290 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.840133 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m15:25:23.843458 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:25:23.887353 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:25:23.888791 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
drop view if exists "postgres"."dbt"."cv_city_country__dbt_backup" cascade
[0m15:25:23.892298 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:25:23.894742 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (execute): 2024-09-01 15:25:23.764422 => 2024-09-01 15:25:23.894682
[0m15:25:23.895862 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: Close
[0m15:25:23.897492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f285b80>]}
[0m15:25:23.899099 [info ] [Thread-1  ]: 2 of 8 OK created sql view model dbt.cv_city_country ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m15:25:23.900844 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_city_country
[0m15:25:23.902246 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_date
[0m15:25:23.903474 [info ] [Thread-1  ]: 3 of 8 START sql view model dbt.cv_date ........................................ [RUN]
[0m15:25:23.905213 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_date'
[0m15:25:23.906342 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_date
[0m15:25:23.910762 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_date"
[0m15:25:23.918177 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (compile): 2024-09-01 15:25:23.907290 => 2024-09-01 15:25:23.918062
[0m15:25:23.919016 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_date
[0m15:25:23.930237 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_date"
[0m15:25:23.940441 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:25:23.941231 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: BEGIN
[0m15:25:23.942292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:23.950073 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:25:23.951270 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:25:23.952469 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */

  create view "postgres"."dbt"."cv_date__dbt_tmp" as (
    WITH
RECURSIVE dates AS (
    SELECT
        '2023-12-01'::TIMESTAMP AS date_value
    UNION
    SELECT
        date_value + INTERVAL '1' DAY AS date_value
    FROM dates
    WHERE date_value <= '2024-10-01'
)
select date_value from dates
  );
[0m15:25:23.955056 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:25:23.960833 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:25:23.961691 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date" rename to "cv_date__dbt_backup"
[0m15:25:23.962792 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:23.968100 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:25:23.969265 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date__dbt_tmp" rename to "cv_date"
[0m15:25:23.970634 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:23.973433 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:25:23.974374 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:25:23.975258 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:25:23.977898 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:25:23.983792 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:25:23.985075 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
drop view if exists "postgres"."dbt"."cv_date__dbt_backup" cascade
[0m15:25:23.988108 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:25:23.990321 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (execute): 2024-09-01 15:25:23.919618 => 2024-09-01 15:25:23.990227
[0m15:25:23.991242 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: Close
[0m15:25:23.992772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f33d9d0>]}
[0m15:25:23.993948 [info ] [Thread-1  ]: 3 of 8 OK created sql view model dbt.cv_date ................................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:25:23.995575 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_date
[0m15:25:23.996838 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status
[0m15:25:23.998040 [info ] [Thread-1  ]: 4 of 8 START sql view model dbt.cv_last_order_status ........................... [RUN]
[0m15:25:23.999666 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status'
[0m15:25:24.000953 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status
[0m15:25:24.007901 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.014434 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (compile): 2024-09-01 15:25:24.001850 => 2024-09-01 15:25:24.014278
[0m15:25:24.015420 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status
[0m15:25:24.026177 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.035120 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.036011 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: BEGIN
[0m15:25:24.036808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:24.044100 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:25:24.045652 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.046677 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */

  create view "postgres"."dbt"."cv_last_order_status__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd hh24:mi') as status_datetime,
        row_number() over (partition by lo.ORDER_PK order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    os.ORDER_PK,
	os.status_datetime,
    loo.ORDER_STATUS_PK,
lw.WAREHOUSE_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_order_status_order_status_history" AS loo on loo.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m15:25:24.050111 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:25:24.056428 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.057527 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status" rename to "cv_last_order_status__dbt_backup"
[0m15:25:24.059077 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:24.064086 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.065242 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status__dbt_tmp" rename to "cv_last_order_status"
[0m15:25:24.066644 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:24.069564 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m15:25:24.070526 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.071411 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m15:25:24.073762 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:25:24.078614 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:25:24.079558 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
drop view if exists "postgres"."dbt"."cv_last_order_status__dbt_backup" cascade
[0m15:25:24.082592 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:25:24.084614 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (execute): 2024-09-01 15:25:24.016077 => 2024-09-01 15:25:24.084555
[0m15:25:24.085573 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: Close
[0m15:25:24.087040 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a607cfee0>]}
[0m15:25:24.088445 [info ] [Thread-1  ]: 4 of 8 OK created sql view model dbt.cv_last_order_status ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:25:24.090056 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status
[0m15:25:24.091332 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_payer
[0m15:25:24.092688 [info ] [Thread-1  ]: 5 of 8 START sql view model dbt.cv_order_payer ................................. [RUN]
[0m15:25:24.094536 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_payer'
[0m15:25:24.095602 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_payer
[0m15:25:24.104451 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_payer"
[0m15:25:24.111558 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (compile): 2024-09-01 15:25:24.096605 => 2024-09-01 15:25:24.111441
[0m15:25:24.112404 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_payer
[0m15:25:24.123372 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_payer"
[0m15:25:24.131636 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:25:24.132434 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: BEGIN
[0m15:25:24.133109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:24.140727 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:25:24.142157 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:25:24.143325 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */

  create view "postgres"."dbt"."cv_order_payer__dbt_tmp" as (
    SELECT
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'payer'
  );
[0m15:25:24.146549 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:25:24.152891 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:25:24.153836 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
alter table "postgres"."dbt"."cv_order_payer__dbt_tmp" rename to "cv_order_payer"
[0m15:25:24.155057 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:24.157907 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m15:25:24.159112 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:25:24.160034 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m15:25:24.163461 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:25:24.167897 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:25:24.169080 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
drop view if exists "postgres"."dbt"."cv_order_payer__dbt_backup" cascade
[0m15:25:24.170301 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:25:24.172605 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (execute): 2024-09-01 15:25:24.113054 => 2024-09-01 15:25:24.172546
[0m15:25:24.173808 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: Close
[0m15:25:24.175334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f346a60>]}
[0m15:25:24.176646 [info ] [Thread-1  ]: 5 of 8 OK created sql view model dbt.cv_order_payer ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:25:24.178458 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_payer
[0m15:25:24.179806 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_receiver
[0m15:25:24.180951 [info ] [Thread-1  ]: 6 of 8 START sql view model dbt.cv_order_receiver .............................. [RUN]
[0m15:25:24.182570 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_receiver'
[0m15:25:24.183579 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_receiver
[0m15:25:24.190968 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_receiver"
[0m15:25:24.198759 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (compile): 2024-09-01 15:25:24.184349 => 2024-09-01 15:25:24.198644
[0m15:25:24.199643 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_receiver
[0m15:25:24.212190 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_receiver"
[0m15:25:24.221166 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:25:24.222324 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: BEGIN
[0m15:25:24.223030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:24.230625 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:25:24.232150 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:25:24.233475 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */

  create view "postgres"."dbt"."cv_order_receiver__dbt_tmp" as (
    SELECT
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'receiver'
  );
[0m15:25:24.237658 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:25:24.243544 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:25:24.244687 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
alter table "postgres"."dbt"."cv_order_receiver__dbt_tmp" rename to "cv_order_receiver"
[0m15:25:24.246202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:25:24.249307 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m15:25:24.250781 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:25:24.252092 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m15:25:24.255021 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:25:24.260050 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:25:24.261211 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
drop view if exists "postgres"."dbt"."cv_order_receiver__dbt_backup" cascade
[0m15:25:24.262628 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:25:24.265043 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (execute): 2024-09-01 15:25:24.200341 => 2024-09-01 15:25:24.264929
[0m15:25:24.266174 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: Close
[0m15:25:24.267714 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a607cfee0>]}
[0m15:25:24.269365 [info ] [Thread-1  ]: 6 of 8 OK created sql view model dbt.cv_order_receiver ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:25:24.271034 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_receiver
[0m15:25:24.272318 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_sender
[0m15:25:24.273535 [info ] [Thread-1  ]: 7 of 8 START sql view model dbt.cv_order_sender ................................ [RUN]
[0m15:25:24.275311 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_sender'
[0m15:25:24.276392 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_sender
[0m15:25:24.284007 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_sender"
[0m15:25:24.291898 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (compile): 2024-09-01 15:25:24.277249 => 2024-09-01 15:25:24.291775
[0m15:25:24.292745 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_sender
[0m15:25:24.303385 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_sender"
[0m15:25:24.312845 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:25:24.313641 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: BEGIN
[0m15:25:24.314338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:25:24.321689 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:25:24.323232 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:25:24.324364 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */

  create view "postgres"."dbt"."cv_order_sender__dbt_tmp" as (
    SELECT
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'sender'
  );
[0m15:25:24.327885 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:25:24.335377 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:25:24.336647 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender" rename to "cv_order_sender__dbt_backup"
[0m15:35:04.695675 [debug] [Thread-1  ]: Postgres adapter: Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m15:35:04.697042 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: ROLLBACK
[0m15:35:04.698796 [debug] [Thread-1  ]: Failed to rollback 'model.otus_project_dbtvault.cv_order_sender'
[0m15:35:04.700513 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m15:35:04.701868 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:35:04.703049 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (execute): 2024-09-01 15:25:24.293377 => 2024-09-01 15:35:04.702972
[0m15:35:04.704489 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: Close
[0m15:35:04.707736 [debug] [Thread-1  ]: Database Error in model cv_order_sender (models/business_vault/cv_order_sender.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_order_sender.sql
[0m15:35:04.708901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f2dcf70>]}
[0m15:35:04.710000 [error] [Thread-1  ]: 7 of 8 ERROR creating sql view model dbt.cv_order_sender ....................... [[31mERROR[0m in 580.43s]
[0m15:35:04.711115 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_sender
[0m15:35:04.712224 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:35:04.713187 [info ] [Thread-1  ]: 8 of 8 START sql view model dbt.cv_currency_rate_by_date ....................... [RUN]
[0m15:35:04.714727 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_currency_rate_by_date'
[0m15:35:04.715651 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:35:04.722541 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:35:04.730074 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (compile): 2024-09-01 15:35:04.716412 => 2024-09-01 15:35:04.729955
[0m15:35:04.730893 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:35:04.746946 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:35:04.758906 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:35:04.760101 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: BEGIN
[0m15:35:04.760861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:35:04.762386 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.3), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:35:04.764100 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m15:35:04.765523 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m15:35:04.768260 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (execute): 2024-09-01 15:35:04.731538 => 2024-09-01 15:35:04.768170
[0m15:35:04.771717 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: No close available on handle
[0m15:35:04.774493 [debug] [Thread-1  ]: Database Error in model cv_currency_rate_by_date (models/business_vault/cv_currency_rate_by_date.sql)
  connection to server at "postgres" (172.19.0.3), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
  compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_currency_rate_by_date.sql
[0m15:35:04.775814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '258aa9c9-85b3-4044-9973-4b26f80304a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a607cfee0>]}
[0m15:35:04.777088 [error] [Thread-1  ]: 8 of 8 ERROR creating sql view model dbt.cv_currency_rate_by_date .............. [[31mERROR[0m in 0.06s]
[0m15:35:04.778352 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:35:04.781944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:35:04.783472 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:04.784490 [debug] [MainThread]: On master: BEGIN
[0m15:35:04.785686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:35:05.873886 [debug] [MainThread]: SQL status: BEGIN in 1 seconds
[0m15:35:05.876286 [debug] [MainThread]: On master: COMMIT
[0m15:35:05.878902 [debug] [MainThread]: Using postgres connection "master"
[0m15:35:05.880214 [debug] [MainThread]: On master: COMMIT
[0m15:35:05.881710 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:35:05.882774 [debug] [MainThread]: On master: Close
[0m15:35:05.884626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:05.885930 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_currency_rate_by_date' was properly closed.
[0m15:35:05.887146 [info ] [MainThread]: 
[0m15:35:05.888778 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 9 minutes and 42.60 seconds (582.60s).
[0m15:35:05.891650 [debug] [MainThread]: Command end result
[0m15:35:05.938895 [info ] [MainThread]: 
[0m15:35:05.940541 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:35:05.941946 [info ] [MainThread]: 
[0m15:35:05.943394 [error] [MainThread]: [33mDatabase Error in model cv_order_sender (models/business_vault/cv_order_sender.sql)[0m
[0m15:35:05.944932 [error] [MainThread]:   terminating connection due to administrator command
[0m15:35:05.946256 [error] [MainThread]:   server closed the connection unexpectedly
[0m15:35:05.947711 [error] [MainThread]:   	This probably means the server terminated abnormally
[0m15:35:05.948862 [error] [MainThread]:   	before or while processing the request.
[0m15:35:05.950203 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_order_sender.sql
[0m15:35:05.951341 [info ] [MainThread]: 
[0m15:35:05.952798 [error] [MainThread]: [33mDatabase Error in model cv_currency_rate_by_date (models/business_vault/cv_currency_rate_by_date.sql)[0m
[0m15:35:05.954036 [error] [MainThread]:   connection to server at "postgres" (172.19.0.3), port 5432 failed: Connection refused
[0m15:35:05.955146 [error] [MainThread]:   	Is the server running on that host and accepting TCP/IP connections?
[0m15:35:05.956264 [error] [MainThread]:   
[0m15:35:05.957419 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_currency_rate_by_date.sql
[0m15:35:05.958561 [info ] [MainThread]: 
[0m15:35:05.959726 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=0 TOTAL=8
[0m15:35:05.961091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a5f235670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a607bc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a608de430>]}
[0m15:35:05.962240 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:35:52.338158 | b5be0e37-6b4f-453c-898b-b2e2de7f7a5c ==============================
[0m15:35:52.338158 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:35:52.340511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:35:52.341739 [debug] [MainThread]: Tracking: tracking
[0m15:35:52.346553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47007fb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47007fbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47007fb430>]}
[0m15:35:52.350018 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2e2zfb03'
[0m15:35:52.352214 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:35:53.416172 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:53.417697 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m15:35:53.419109 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:35:53.420143 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:35:53.424678 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:35:53.426103 [debug] [MainThread]: STDERR: "b''"
[0m15:35:53.427135 [debug] [MainThread]:   Checking out revision master.
[0m15:35:53.428170 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:35:53.433625 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:53.434902 [debug] [MainThread]: STDERR: "b''"
[0m15:35:53.435865 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:35:54.915023 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:54.916007 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m15:35:54.916731 [debug] [MainThread]: Executing "git tag --list"
[0m15:35:54.920930 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:35:54.922655 [debug] [MainThread]: STDERR: "b''"
[0m15:35:54.924085 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:35:54.935425 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:35:54.936909 [debug] [MainThread]: STDERR: "b''"
[0m15:35:54.938124 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:35:54.943544 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:35:54.945106 [debug] [MainThread]: STDERR: "b''"
[0m15:35:54.946187 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m15:35:54.947737 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:35:54.960562 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:35:55.428113 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:35:55.429833 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:35:55.633784 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:35:55.814966 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:35:55.820586 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:55.821909 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:35:55.823210 [debug] [MainThread]: command return code=128
[0m15:35:55.826351 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:35:55.827657 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:35:55.834842 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:35:55.836424 [debug] [MainThread]: STDERR: "b''"
[0m15:35:55.837488 [debug] [MainThread]:   Checking out revision master.
[0m15:35:55.838520 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:35:55.847000 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:55.848554 [debug] [MainThread]: STDERR: "b''"
[0m15:35:55.849477 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:35:56.664603 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:56.666221 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:35:56.667336 [debug] [MainThread]: Executing "git tag --list"
[0m15:35:56.672223 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:35:56.674534 [debug] [MainThread]: STDERR: "b''"
[0m15:35:56.675740 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:35:56.682842 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:35:56.684854 [debug] [MainThread]: STDERR: "b''"
[0m15:35:56.685947 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:35:56.690477 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:35:56.691862 [debug] [MainThread]: STDERR: "b''"
[0m15:35:56.693170 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:35:56.695632 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:35:56.709840 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m15:35:56.918944 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:35:56.923341 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:56.924762 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:35:56.925882 [debug] [MainThread]: command return code=128
[0m15:35:56.927350 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:35:56.928404 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:35:56.933767 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:35:56.935592 [debug] [MainThread]: STDERR: "b''"
[0m15:35:56.936710 [debug] [MainThread]:   Checking out revision master.
[0m15:35:56.937638 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:35:56.944707 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:56.946188 [debug] [MainThread]: STDERR: "b''"
[0m15:35:56.947217 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:35:57.809871 [debug] [MainThread]: STDOUT: "b''"
[0m15:35:57.811281 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:35:57.812849 [debug] [MainThread]: Executing "git tag --list"
[0m15:35:57.819911 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:35:57.821507 [debug] [MainThread]: STDERR: "b''"
[0m15:35:57.822824 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:35:57.832443 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:35:57.833923 [debug] [MainThread]: STDERR: "b''"
[0m15:35:57.835333 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:35:57.841738 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:35:57.843736 [debug] [MainThread]: STDERR: "b''"
[0m15:35:57.844892 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:36:00.397881 [info ] [MainThread]:   Installed from revision master
[0m15:36:00.399522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5be0e37-6b4f-453c-898b-b2e2de7f7a5c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470086f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4700f86790>]}
[0m15:36:00.400966 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:36:03.922315 [info ] [MainThread]:   Installed from version 1.3.0
[0m15:36:03.923117 [info ] [MainThread]:   Up to date!
[0m15:36:03.924240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b5be0e37-6b4f-453c-898b-b2e2de7f7a5c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4701591b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4700f86790>]}
[0m15:36:03.925343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4700915700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4701896d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470085c610>]}
[0m15:36:03.926046 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:36:34.817908 | 798aa7c3-dbd6-4788-8371-5e802f8f0d19 ==============================
[0m15:36:34.817908 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:36:34.821117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:36:34.822245 [debug] [MainThread]: Tracking: tracking
[0m15:36:34.828677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802d386bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a3a6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a3a6e50>]}
[0m15:36:37.776875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m15:36:37.778792 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/order_clients_info.sql
[0m15:36:37.780150 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/business_vault/cv_order_sender.sql
[0m15:36:37.781372 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/business_vault/cv_order_payer.sql
[0m15:36:37.782558 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/business_vault/cv_order_receiver.sql
[0m15:36:37.812180 [debug] [MainThread]: 1699: static parser successfully parsed cdm/order_clients_info.sql
[0m15:36:37.833970 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_sender.sql
[0m15:36:37.839627 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_payer.sql
[0m15:36:37.845473 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_receiver.sql
[0m15:36:37.901818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a2620d0>]}
[0m15:36:37.953808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8029e7bfd0>]}
[0m15:36:37.955184 [info ] [MainThread]: Found 99 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:36:37.956526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a3a67f0>]}
[0m15:36:37.964012 [info ] [MainThread]: 
[0m15:36:37.967483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:37.970418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:36:37.988630 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:36:37.989650 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:36:37.990671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:37.999887 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:36:38.002313 [debug] [ThreadPool]: On list_postgres: Close
[0m15:36:38.012601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:36:38.022740 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:36:38.023906 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:36:38.024793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:38.032853 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:36:38.034379 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:36:38.035682 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:36:38.039143 [debug] [ThreadPool]: SQL status: SELECT 107 in 0 seconds
[0m15:36:38.044826 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:36:38.046495 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:36:38.076232 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:38.077510 [debug] [MainThread]: On master: BEGIN
[0m15:36:38.078415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:38.086867 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:36:38.088456 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:38.089706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:36:38.144496 [debug] [MainThread]: SQL status: SELECT 61 in 0 seconds
[0m15:36:38.155825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a3bb190>]}
[0m15:36:38.157023 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:38.158182 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:38.159109 [debug] [MainThread]: On master: BEGIN
[0m15:36:38.160348 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:36:38.161897 [debug] [MainThread]: On master: COMMIT
[0m15:36:38.162999 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:38.163796 [debug] [MainThread]: On master: COMMIT
[0m15:36:38.164954 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:36:38.165887 [debug] [MainThread]: On master: Close
[0m15:36:38.167291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:38.168460 [info ] [MainThread]: 
[0m15:36:38.173071 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.as_of_date
[0m15:36:38.174306 [info ] [Thread-1  ]: 1 of 8 START sql table model dbt.as_of_date .................................... [RUN]
[0m15:36:38.175786 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.as_of_date'
[0m15:36:38.176978 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.as_of_date
[0m15:36:38.215045 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.216409 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: BEGIN
[0m15:36:38.217418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:38.225262 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:38.226719 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.227780 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */


        select 
        ((TO_DATE('2024-10-01', 'yyyy-mm-dd'))::date - (TO_DATE('2023-12-01', 'yyyy-mm-dd'))::date)
    
[0m15:36:38.229271 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m15:36:38.249449 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.258479 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (compile): 2024-09-01 15:36:38.177841 => 2024-09-01 15:36:38.258335
[0m15:36:38.259645 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.as_of_date
[0m15:36:38.326159 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.332432 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.333432 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */

  
    

  create  table "postgres"."dbt"."as_of_date__dbt_tmp"
  as (
    WITH as_of_date AS (
 





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 305
    order by generated_number



),

all_periods as (

    select (
        

    TO_DATE('2023-12-01', 'yyyy-mm-dd') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= TO_DATE('2024-10-01', 'yyyy-mm-dd')

)

select * from filtered


)
SELECT DATE_day as AS_OF_DATE FROM as_of_date
  );
  
[0m15:36:38.340594 [debug] [Thread-1  ]: SQL status: SELECT 305 in 0 seconds
[0m15:36:38.350648 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.351926 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date" rename to "as_of_date__dbt_backup"
[0m15:36:38.353444 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.358728 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.359781 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date__dbt_tmp" rename to "as_of_date"
[0m15:36:38.361004 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.394068 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:36:38.395428 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.396922 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m15:36:38.401895 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:38.413829 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m15:36:38.415253 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
drop table if exists "postgres"."dbt"."as_of_date__dbt_backup" cascade
[0m15:36:38.420026 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m15:36:38.423584 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (execute): 2024-09-01 15:36:38.260607 => 2024-09-01 15:36:38.423470
[0m15:36:38.424961 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: Close
[0m15:36:38.427369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a2c6b50>]}
[0m15:36:38.429164 [info ] [Thread-1  ]: 1 of 8 OK created sql table model dbt.as_of_date ............................... [[32mSELECT 305[0m in 0.25s]
[0m15:36:38.433610 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.as_of_date
[0m15:36:38.435516 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_city_country
[0m15:36:38.436901 [info ] [Thread-1  ]: 2 of 8 START sql view model dbt.cv_city_country ................................ [RUN]
[0m15:36:38.438391 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_city_country'
[0m15:36:38.439248 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_city_country
[0m15:36:38.446158 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_city_country"
[0m15:36:38.452751 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (compile): 2024-09-01 15:36:38.439907 => 2024-09-01 15:36:38.452586
[0m15:36:38.453794 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_city_country
[0m15:36:38.488643 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_city_country"
[0m15:36:38.495671 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:36:38.496712 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: BEGIN
[0m15:36:38.497568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:38.505484 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:38.506878 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:36:38.507897 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */

  create view "postgres"."dbt"."cv_city_country__dbt_tmp" as (
    select
    sci.CITY_PK,
    sci.name AS city_name,
    sco.name AS country_name
FROM "postgres"."dbt"."sat_city" AS sci
LEFT JOIN "postgres"."dbt"."link_city_country" AS ccl on ccl.CITY_PK = sci.CITY_PK
LEFT JOIN "postgres"."dbt"."sat_country" AS sco ON sco.COUNTRY_PK = ccl.COUNTRY_PK
  );
[0m15:36:38.510419 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:36:38.516808 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:36:38.517995 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country__dbt_tmp" rename to "cv_city_country"
[0m15:36:38.519624 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.522212 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m15:36:38.523071 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:36:38.523987 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m15:36:38.526766 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:38.531729 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m15:36:38.532656 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
drop view if exists "postgres"."dbt"."cv_city_country__dbt_backup" cascade
[0m15:36:38.533621 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:36:38.535852 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (execute): 2024-09-01 15:36:38.454468 => 2024-09-01 15:36:38.535785
[0m15:36:38.537091 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: Close
[0m15:36:38.538668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a2c67c0>]}
[0m15:36:38.539884 [info ] [Thread-1  ]: 2 of 8 OK created sql view model dbt.cv_city_country ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m15:36:38.541263 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_city_country
[0m15:36:38.542354 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_date
[0m15:36:38.543314 [info ] [Thread-1  ]: 3 of 8 START sql view model dbt.cv_date ........................................ [RUN]
[0m15:36:38.544887 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_date'
[0m15:36:38.545959 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_date
[0m15:36:38.599046 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_date"
[0m15:36:38.605555 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (compile): 2024-09-01 15:36:38.546917 => 2024-09-01 15:36:38.605342
[0m15:36:38.606942 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_date
[0m15:36:38.622166 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_date"
[0m15:36:38.628734 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:36:38.629602 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: BEGIN
[0m15:36:38.630418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:38.637991 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:38.639487 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:36:38.640349 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */

  create view "postgres"."dbt"."cv_date__dbt_tmp" as (
    WITH
RECURSIVE dates AS (
    SELECT
        '2023-12-01'::TIMESTAMP AS date_value
    UNION
    SELECT
        date_value + INTERVAL '1' DAY AS date_value
    FROM dates
    WHERE date_value <= '2024-10-01'
)
select date_value from dates
  );
[0m15:36:38.642494 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:36:38.648345 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:36:38.649260 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date__dbt_tmp" rename to "cv_date"
[0m15:36:38.650405 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.653059 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:36:38.653909 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:36:38.654611 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m15:36:38.656916 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:38.661469 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m15:36:38.662392 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
drop view if exists "postgres"."dbt"."cv_date__dbt_backup" cascade
[0m15:36:38.663318 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:36:38.665315 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (execute): 2024-09-01 15:36:38.607822 => 2024-09-01 15:36:38.665252
[0m15:36:38.666287 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: Close
[0m15:36:38.667645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8028d75940>]}
[0m15:36:38.668763 [info ] [Thread-1  ]: 3 of 8 OK created sql view model dbt.cv_date ................................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:36:38.670083 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_date
[0m15:36:38.671282 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status
[0m15:36:38.672276 [info ] [Thread-1  ]: 4 of 8 START sql view model dbt.cv_last_order_status ........................... [RUN]
[0m15:36:38.673758 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status'
[0m15:36:38.674696 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status
[0m15:36:38.681137 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status"
[0m15:36:38.687578 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (compile): 2024-09-01 15:36:38.675331 => 2024-09-01 15:36:38.687451
[0m15:36:38.688553 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status
[0m15:36:38.701808 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status"
[0m15:36:38.708374 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:36:38.709452 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: BEGIN
[0m15:36:38.710490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:38.717911 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:38.719136 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:36:38.719952 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */

  create view "postgres"."dbt"."cv_last_order_status__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd hh24:mi') as status_datetime,
        row_number() over (partition by lo.ORDER_PK order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    os.ORDER_PK,
	os.status_datetime,
    loo.ORDER_STATUS_PK,
lw.WAREHOUSE_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_order_status_order_status_history" AS loo on loo.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m15:36:38.722784 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:36:38.728609 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:36:38.729473 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status__dbt_tmp" rename to "cv_last_order_status"
[0m15:36:38.730639 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.733155 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m15:36:38.733909 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:36:38.734562 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m15:36:38.737290 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:38.742226 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m15:36:38.743173 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
drop view if exists "postgres"."dbt"."cv_last_order_status__dbt_backup" cascade
[0m15:36:38.744159 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:36:38.746075 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (execute): 2024-09-01 15:36:38.689333 => 2024-09-01 15:36:38.746016
[0m15:36:38.746755 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: Close
[0m15:36:38.747990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8028c5f1c0>]}
[0m15:36:38.749746 [info ] [Thread-1  ]: 4 of 8 OK created sql view model dbt.cv_last_order_status ...................... [[32mCREATE VIEW[0m in 0.07s]
[0m15:36:38.750776 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status
[0m15:36:38.751830 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_payer
[0m15:36:38.752927 [info ] [Thread-1  ]: 5 of 8 START sql view model dbt.cv_order_payer ................................. [RUN]
[0m15:36:38.754648 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_payer'
[0m15:36:38.755810 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_payer
[0m15:36:38.763232 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_payer"
[0m15:36:38.769912 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (compile): 2024-09-01 15:36:38.756784 => 2024-09-01 15:36:38.769787
[0m15:36:38.770955 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_payer
[0m15:36:38.783229 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_payer"
[0m15:36:38.791168 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:36:38.791984 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: BEGIN
[0m15:36:38.792782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:38.800952 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:38.802457 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:36:38.803462 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */

  create view "postgres"."dbt"."cv_order_payer__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'payer'
  );
[0m15:36:38.806641 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:36:38.813984 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:36:38.815035 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
alter table "postgres"."dbt"."cv_order_payer__dbt_tmp" rename to "cv_order_payer"
[0m15:36:38.817088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.819759 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m15:36:38.820655 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:36:38.821421 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m15:36:38.824181 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:38.828693 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m15:36:38.829617 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
drop view if exists "postgres"."dbt"."cv_order_payer__dbt_backup" cascade
[0m15:36:38.830985 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:36:38.833194 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (execute): 2024-09-01 15:36:38.771931 => 2024-09-01 15:36:38.833092
[0m15:36:38.834150 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: Close
[0m15:36:38.835622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8028df0be0>]}
[0m15:36:38.836909 [info ] [Thread-1  ]: 5 of 8 OK created sql view model dbt.cv_order_payer ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m15:36:38.838310 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_payer
[0m15:36:38.839653 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_receiver
[0m15:36:38.840603 [info ] [Thread-1  ]: 6 of 8 START sql view model dbt.cv_order_receiver .............................. [RUN]
[0m15:36:38.841960 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_receiver'
[0m15:36:38.842903 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_receiver
[0m15:36:38.849890 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_receiver"
[0m15:36:38.857736 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (compile): 2024-09-01 15:36:38.843693 => 2024-09-01 15:36:38.857631
[0m15:36:38.858686 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_receiver
[0m15:36:38.869651 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_receiver"
[0m15:36:38.878572 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:36:38.879367 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: BEGIN
[0m15:36:38.880044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:38.887499 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:38.889166 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:36:38.890461 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */

  create view "postgres"."dbt"."cv_order_receiver__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'receiver'
  );
[0m15:36:38.893813 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:36:38.899294 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:36:38.900418 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
alter table "postgres"."dbt"."cv_order_receiver__dbt_tmp" rename to "cv_order_receiver"
[0m15:36:38.901992 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.904563 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m15:36:38.905574 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:36:38.906671 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m15:36:38.909137 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:38.913575 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m15:36:38.914681 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
drop view if exists "postgres"."dbt"."cv_order_receiver__dbt_backup" cascade
[0m15:36:38.915997 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:36:38.918138 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (execute): 2024-09-01 15:36:38.859442 => 2024-09-01 15:36:38.918080
[0m15:36:38.919187 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: Close
[0m15:36:38.920671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a246eb0>]}
[0m15:36:38.921959 [info ] [Thread-1  ]: 6 of 8 OK created sql view model dbt.cv_order_receiver ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:36:38.923448 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_receiver
[0m15:36:38.924870 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_sender
[0m15:36:38.926269 [info ] [Thread-1  ]: 7 of 8 START sql view model dbt.cv_order_sender ................................ [RUN]
[0m15:36:38.928265 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_sender'
[0m15:36:38.929628 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_sender
[0m15:36:38.938566 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_sender"
[0m15:36:38.947078 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (compile): 2024-09-01 15:36:38.930421 => 2024-09-01 15:36:38.946948
[0m15:36:38.947984 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_sender
[0m15:36:38.960217 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_sender"
[0m15:36:38.968679 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:36:38.969410 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: BEGIN
[0m15:36:38.970208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:38.977619 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:38.979127 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:36:38.980433 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */

  create view "postgres"."dbt"."cv_order_sender__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'sender'
  );
[0m15:36:38.983696 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:36:38.989275 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:36:38.990404 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender__dbt_tmp" rename to "cv_order_sender"
[0m15:36:38.991816 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:38.994384 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m15:36:38.995279 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:36:38.996109 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m15:36:38.999129 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:39.003655 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m15:36:39.004758 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
drop view if exists "postgres"."dbt"."cv_order_sender__dbt_backup" cascade
[0m15:36:39.006069 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:36:39.008140 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (execute): 2024-09-01 15:36:38.948760 => 2024-09-01 15:36:39.008083
[0m15:36:39.009132 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: Close
[0m15:36:39.010560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8028da2be0>]}
[0m15:36:39.011905 [info ] [Thread-1  ]: 7 of 8 OK created sql view model dbt.cv_order_sender ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m15:36:39.013356 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_sender
[0m15:36:39.014826 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:36:39.015933 [info ] [Thread-1  ]: 8 of 8 START sql view model dbt.cv_currency_rate_by_date ....................... [RUN]
[0m15:36:39.017446 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_currency_rate_by_date'
[0m15:36:39.018434 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:36:39.024097 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:36:39.031347 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (compile): 2024-09-01 15:36:39.019165 => 2024-09-01 15:36:39.031251
[0m15:36:39.032367 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:36:39.044325 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:36:39.052556 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:36:39.053301 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: BEGIN
[0m15:36:39.053994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:39.061498 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:39.063498 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:36:39.064889 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */

  create view "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" as (
    SELECT
    q.CURRENCY_PK,
    q.relation_to_rur,
    d.as_of_date AS date_value
FROM (
    SELECT
        ccr.CURRENCY_PK, cr.relation_to_rur, cr.date_start,
        LAG(cr.date_start) OVER (PARTITION BY ccr.CURRENCY_PK ORDER BY cr.date_start DESC) AS date_end
    FROM "postgres"."dbt"."sat_currency_rate" cr
	LEFT JOIN "postgres"."dbt"."link_currency_currency_rate" ccr ON ccr.CURRENCY_RATE_PK = cr.CURRENCY_RATE_PK
	)q, "postgres"."dbt"."as_of_date" d
    WHERE d.as_of_date >= COALESCE(q.date_start, '2023-12-01') AND d.as_of_date < COALESCE(q.date_end, '2024-10-01')
  );
[0m15:36:39.068251 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:36:39.074211 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:36:39.075258 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
alter table "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" rename to "cv_currency_rate_by_date"
[0m15:36:39.076962 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:36:39.080086 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m15:36:39.081178 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:36:39.082319 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m15:36:39.084974 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:36:39.089640 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m15:36:39.090753 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
drop view if exists "postgres"."dbt"."cv_currency_rate_by_date__dbt_backup" cascade
[0m15:36:39.092271 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:36:39.094567 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (execute): 2024-09-01 15:36:39.033041 => 2024-09-01 15:36:39.094509
[0m15:36:39.095686 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: Close
[0m15:36:39.097401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '798aa7c3-dbd6-4788-8371-5e802f8f0d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a2c6550>]}
[0m15:36:39.098778 [info ] [Thread-1  ]: 8 of 8 OK created sql view model dbt.cv_currency_rate_by_date .................. [[32mCREATE VIEW[0m in 0.08s]
[0m15:36:39.100445 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m15:36:39.103349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:39.104431 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:39.105504 [debug] [MainThread]: On master: BEGIN
[0m15:36:39.106524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:39.114323 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:36:39.115778 [debug] [MainThread]: On master: COMMIT
[0m15:36:39.117015 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:39.118044 [debug] [MainThread]: On master: COMMIT
[0m15:36:39.119260 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:36:39.120304 [debug] [MainThread]: On master: Close
[0m15:36:39.121671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:39.123655 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_currency_rate_by_date' was properly closed.
[0m15:36:39.124727 [info ] [MainThread]: 
[0m15:36:39.125702 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m15:36:39.127280 [debug] [MainThread]: Command end result
[0m15:36:39.160747 [info ] [MainThread]: 
[0m15:36:39.162030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:36:39.163208 [info ] [MainThread]: 
[0m15:36:39.164477 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:36:39.165865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f802a247850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8028e55340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8028e55790>]}
[0m15:36:39.167064 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:36:50.987051 | e0c8cb41-9c03-4e95-8acc-bd3871c8b02f ==============================
[0m15:36:50.987051 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:36:50.989995 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:36:50.991013 [debug] [MainThread]: Tracking: tracking
[0m15:36:50.995902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebcd7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebcd7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebcd7a30>]}
[0m15:36:54.177424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:54.178290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:54.198887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0c8cb41-9c03-4e95-8acc-bd3871c8b02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebc1efd0>]}
[0m15:36:54.249761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0c8cb41-9c03-4e95-8acc-bd3871c8b02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebafa430>]}
[0m15:36:54.250789 [info ] [MainThread]: Found 99 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:36:54.251929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c8cb41-9c03-4e95-8acc-bd3871c8b02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebcbdf70>]}
[0m15:36:54.258363 [info ] [MainThread]: 
[0m15:36:54.261706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:54.264420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:36:54.282648 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:36:54.283859 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:36:54.284919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:54.294454 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:36:54.297422 [debug] [ThreadPool]: On list_postgres: Close
[0m15:36:54.308122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:36:54.317485 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:36:54.318727 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:36:54.319903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:54.328489 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:36:54.330013 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:36:54.331077 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:36:54.334968 [debug] [ThreadPool]: SQL status: SELECT 114 in 0 seconds
[0m15:36:54.340951 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:36:54.342358 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:36:54.370781 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:54.372256 [debug] [MainThread]: On master: BEGIN
[0m15:36:54.373428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:54.381150 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:36:54.382727 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:54.384004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:36:54.445347 [debug] [MainThread]: SQL status: SELECT 89 in 0 seconds
[0m15:36:54.460256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c8cb41-9c03-4e95-8acc-bd3871c8b02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aed510e80>]}
[0m15:36:54.461591 [debug] [MainThread]: On master: ROLLBACK
[0m15:36:54.462876 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:54.463931 [debug] [MainThread]: On master: BEGIN
[0m15:36:54.465544 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:36:54.466740 [debug] [MainThread]: On master: COMMIT
[0m15:36:54.467867 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:54.468945 [debug] [MainThread]: On master: COMMIT
[0m15:36:54.470101 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:36:54.470982 [debug] [MainThread]: On master: Close
[0m15:36:54.472332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:54.473442 [info ] [MainThread]: 
[0m15:36:54.478385 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.order_clients_info
[0m15:36:54.479504 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.order_clients_info ............................. [RUN]
[0m15:36:54.481013 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.order_clients_info'
[0m15:36:54.482184 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.order_clients_info
[0m15:36:54.489318 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.order_clients_info"
[0m15:36:54.497978 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (compile): 2024-09-01 15:36:54.482900 => 2024-09-01 15:36:54.497854
[0m15:36:54.498825 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.order_clients_info
[0m15:36:54.553724 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.order_clients_info"
[0m15:36:54.562173 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:36:54.562938 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: BEGIN
[0m15:36:54.563617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:36:54.570848 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:36:54.572347 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:36:54.573612 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.order_clients_info"} */

  create view "postgres"."dbt"."order_clients_info__dbt_tmp" as (
    select
    so.ORDER_PK,
    cop.CLIENT_PK as payer_client_pk,
    ctp.CLIENT_TYPE_PK as payer_client_type_pk,
    ctp.client_type_code as payer_client_type_code,
    cos.CLIENT_PK as sender_client_pk,
    cts.CLIENT_TYPE_PK as sender_client_type_pk,
    cts.client_type_code as sender_client_type_code,
    cor.CLIENT_PK as sender_client_pk,
    ctr.CLIENT_TYPE_PK as sender_client_type_pk,
    ctr.client_type_code as sender_client_type_code
from "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = sc.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctp on ctp.CLIENT_TYPE_PK = cop.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_sender" AS cos on cos.ORDER_PK = sc.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS cts on cts.CLIENT_TYPE_PK = cos.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_receiver" AS cor on cor.ORDER_PK = sc.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctr on ctr.CLIENT_TYPE_PK = cor.CLIENT_TYPE_PK
  );
[0m15:36:54.575540 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "sc"
LINE 16: ..."."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = sc.ORDER_P...
                                                              ^

[0m15:36:54.577016 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: ROLLBACK
[0m15:36:54.578652 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (execute): 2024-09-01 15:36:54.499475 => 2024-09-01 15:36:54.578572
[0m15:36:54.579749 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: Close
[0m15:36:54.582798 [debug] [Thread-1  ]: Database Error in model order_clients_info (models/cdm/order_clients_info.sql)
  missing FROM-clause entry for table "sc"
  LINE 16: ..."."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = sc.ORDER_P...
                                                                ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/order_clients_info.sql
[0m15:36:54.584216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c8cb41-9c03-4e95-8acc-bd3871c8b02f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aeb799d00>]}
[0m15:36:54.585450 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.order_clients_info .................... [[31mERROR[0m in 0.10s]
[0m15:36:54.588406 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.order_clients_info
[0m15:36:54.591224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:36:54.592372 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:54.593314 [debug] [MainThread]: On master: BEGIN
[0m15:36:54.594220 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:54.601971 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:36:54.603465 [debug] [MainThread]: On master: COMMIT
[0m15:36:54.604671 [debug] [MainThread]: Using postgres connection "master"
[0m15:36:54.606081 [debug] [MainThread]: On master: COMMIT
[0m15:36:54.607336 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:36:54.608458 [debug] [MainThread]: On master: Close
[0m15:36:54.610187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:54.611253 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.order_clients_info' was properly closed.
[0m15:36:54.612356 [info ] [MainThread]: 
[0m15:36:54.613439 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:36:54.614608 [debug] [MainThread]: Command end result
[0m15:36:54.648082 [info ] [MainThread]: 
[0m15:36:54.649406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:36:54.650896 [info ] [MainThread]: 
[0m15:36:54.652098 [error] [MainThread]: [33mDatabase Error in model order_clients_info (models/cdm/order_clients_info.sql)[0m
[0m15:36:54.653328 [error] [MainThread]:   missing FROM-clause entry for table "sc"
[0m15:36:54.654453 [error] [MainThread]:   LINE 16: ..."."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = sc.ORDER_P...
[0m15:36:54.655648 [error] [MainThread]:                                                                 ^
[0m15:36:54.656895 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/order_clients_info.sql
[0m15:36:54.658206 [info ] [MainThread]: 
[0m15:36:54.659678 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:54.661541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebcbdf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebcb70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4aebcb7610>]}
[0m15:36:54.662807 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:37:29.985583 | 60ab2d98-534f-49ab-ba9d-d029223ffb84 ==============================
[0m15:37:29.985583 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:37:29.988547 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:37:29.989932 [debug] [MainThread]: Tracking: tracking
[0m15:37:29.995042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458596d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458596df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458596d7f0>]}
[0m15:37:32.914409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:32.916046 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/order_clients_info.sql
[0m15:37:32.943361 [debug] [MainThread]: 1699: static parser successfully parsed cdm/order_clients_info.sql
[0m15:37:33.002481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ab2d98-534f-49ab-ba9d-d029223ffb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45858160d0>]}
[0m15:37:33.051383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ab2d98-534f-49ab-ba9d-d029223ffb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45855430a0>]}
[0m15:37:33.052913 [info ] [MainThread]: Found 99 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:37:33.054331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ab2d98-534f-49ab-ba9d-d029223ffb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4585965ca0>]}
[0m15:37:33.061604 [info ] [MainThread]: 
[0m15:37:33.064624 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:33.067360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:37:33.084356 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:37:33.085736 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:37:33.087030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:33.095683 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:37:33.098365 [debug] [ThreadPool]: On list_postgres: Close
[0m15:37:33.108532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:37:33.117834 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:37:33.119112 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:37:33.120222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:33.127890 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:37:33.129441 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:37:33.130797 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:37:33.134378 [debug] [ThreadPool]: SQL status: SELECT 114 in 0 seconds
[0m15:37:33.140019 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:37:33.141286 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:37:33.169710 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:33.170933 [debug] [MainThread]: On master: BEGIN
[0m15:37:33.172072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:33.180096 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:37:33.181510 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:33.182767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:33.243808 [debug] [MainThread]: SQL status: SELECT 89 in 0 seconds
[0m15:37:33.258315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ab2d98-534f-49ab-ba9d-d029223ffb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45871b17c0>]}
[0m15:37:33.259513 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:33.260634 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:33.261633 [debug] [MainThread]: On master: BEGIN
[0m15:37:33.262826 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:37:33.263933 [debug] [MainThread]: On master: COMMIT
[0m15:37:33.264906 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:33.265731 [debug] [MainThread]: On master: COMMIT
[0m15:37:33.266630 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:37:33.267373 [debug] [MainThread]: On master: Close
[0m15:37:33.268445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:33.269422 [info ] [MainThread]: 
[0m15:37:33.274012 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.order_clients_info
[0m15:37:33.275216 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.order_clients_info ............................. [RUN]
[0m15:37:33.276587 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.order_clients_info'
[0m15:37:33.277485 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.order_clients_info
[0m15:37:33.285322 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.order_clients_info"
[0m15:37:33.293845 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (compile): 2024-09-01 15:37:33.278301 => 2024-09-01 15:37:33.293724
[0m15:37:33.294851 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.order_clients_info
[0m15:37:33.351683 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.order_clients_info"
[0m15:37:33.359145 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:37:33.359928 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: BEGIN
[0m15:37:33.360596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:37:33.368098 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:37:33.369737 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:37:33.371013 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.order_clients_info"} */

  create view "postgres"."dbt"."order_clients_info__dbt_tmp" as (
    select
    so.ORDER_PK,
    cop.CLIENT_PK as payer_client_pk,
    ctp.CLIENT_TYPE_PK as payer_client_type_pk,
    ctp.client_type_code as payer_client_type_code,
    cos.CLIENT_PK as sender_client_pk,
    cts.CLIENT_TYPE_PK as sender_client_type_pk,
    cts.client_type_code as sender_client_type_code,
    cor.CLIENT_PK as sender_client_pk,
    ctr.CLIENT_TYPE_PK as sender_client_type_pk,
    ctr.client_type_code as sender_client_type_code
from "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctp on ctp.CLIENT_TYPE_PK = cop.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_sender" AS cos on cos.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS cts on cts.CLIENT_TYPE_PK = cos.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_receiver" AS cor on cor.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctr on ctr.CLIENT_TYPE_PK = cor.CLIENT_TYPE_PK
  );
[0m15:37:33.374044 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column ctp.client_type_code does not exist
LINE 8:     ctp.client_type_code as payer_client_type_code,
            ^

[0m15:37:33.376006 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: ROLLBACK
[0m15:37:33.377714 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (execute): 2024-09-01 15:37:33.295573 => 2024-09-01 15:37:33.377505
[0m15:37:33.378865 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: Close
[0m15:37:33.382000 [debug] [Thread-1  ]: Database Error in model order_clients_info (models/cdm/order_clients_info.sql)
  column ctp.client_type_code does not exist
  LINE 8:     ctp.client_type_code as payer_client_type_code,
              ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/order_clients_info.sql
[0m15:37:33.383323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60ab2d98-534f-49ab-ba9d-d029223ffb84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45843d7730>]}
[0m15:37:33.384683 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.order_clients_info .................... [[31mERROR[0m in 0.11s]
[0m15:37:33.387864 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.order_clients_info
[0m15:37:33.391005 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:33.392103 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:33.392941 [debug] [MainThread]: On master: BEGIN
[0m15:37:33.393773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:33.401411 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:37:33.403022 [debug] [MainThread]: On master: COMMIT
[0m15:37:33.404149 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:33.405073 [debug] [MainThread]: On master: COMMIT
[0m15:37:33.406318 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:37:33.407220 [debug] [MainThread]: On master: Close
[0m15:37:33.408668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:33.409496 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.order_clients_info' was properly closed.
[0m15:37:33.410385 [info ] [MainThread]: 
[0m15:37:33.411276 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:37:33.412455 [debug] [MainThread]: Command end result
[0m15:37:33.444595 [info ] [MainThread]: 
[0m15:37:33.445823 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:33.447302 [info ] [MainThread]: 
[0m15:37:33.448723 [error] [MainThread]: [33mDatabase Error in model order_clients_info (models/cdm/order_clients_info.sql)[0m
[0m15:37:33.449883 [error] [MainThread]:   column ctp.client_type_code does not exist
[0m15:37:33.451315 [error] [MainThread]:   LINE 8:     ctp.client_type_code as payer_client_type_code,
[0m15:37:33.452569 [error] [MainThread]:               ^
[0m15:37:33.453734 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/order_clients_info.sql
[0m15:37:33.455225 [info ] [MainThread]: 
[0m15:37:33.456883 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:37:33.458381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45855430d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458596b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458596bd60>]}
[0m15:37:33.459668 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:39:06.201595 | a7ebad77-b77b-44e9-97b1-b70cf3c737fb ==============================
[0m15:39:06.201595 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:39:06.204453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:06.205377 [debug] [MainThread]: Tracking: tracking
[0m15:39:06.210326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0ff13490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0ff131c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0ff13a30>]}
[0m15:39:09.448357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:09.450048 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/order_clients_info.sql
[0m15:39:09.476276 [debug] [MainThread]: 1699: static parser successfully parsed cdm/order_clients_info.sql
[0m15:39:09.534162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7ebad77-b77b-44e9-97b1-b70cf3c737fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0fdb00d0>]}
[0m15:39:09.584142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7ebad77-b77b-44e9-97b1-b70cf3c737fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0fadb610>]}
[0m15:39:09.585293 [info ] [MainThread]: Found 99 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:39:09.586583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ebad77-b77b-44e9-97b1-b70cf3c737fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0fef7b20>]}
[0m15:39:09.593702 [info ] [MainThread]: 
[0m15:39:09.597090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:09.599164 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:39:09.615680 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:39:09.617089 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:39:09.618251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:09.626520 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:39:09.629368 [debug] [ThreadPool]: On list_postgres: Close
[0m15:39:09.640238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:39:09.650094 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:39:09.651454 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:39:09.652630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:09.660716 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:39:09.662623 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:39:09.663792 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:39:09.667301 [debug] [ThreadPool]: SQL status: SELECT 114 in 0 seconds
[0m15:39:09.672893 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:39:09.674249 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:39:09.702671 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.704034 [debug] [MainThread]: On master: BEGIN
[0m15:39:09.705164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:09.713238 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:39:09.714926 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.716141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:09.778407 [debug] [MainThread]: SQL status: SELECT 89 in 0 seconds
[0m15:39:09.792810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ebad77-b77b-44e9-97b1-b70cf3c737fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0ff01790>]}
[0m15:39:09.794108 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:09.795359 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.796295 [debug] [MainThread]: On master: BEGIN
[0m15:39:09.797426 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:39:09.798591 [debug] [MainThread]: On master: COMMIT
[0m15:39:09.799536 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.800395 [debug] [MainThread]: On master: COMMIT
[0m15:39:09.801509 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:39:09.802258 [debug] [MainThread]: On master: Close
[0m15:39:09.803424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:09.804380 [info ] [MainThread]: 
[0m15:39:09.808251 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.order_clients_info
[0m15:39:09.809226 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.order_clients_info ............................. [RUN]
[0m15:39:09.810535 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.order_clients_info'
[0m15:39:09.811591 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.order_clients_info
[0m15:39:09.820038 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.order_clients_info"
[0m15:39:09.828152 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (compile): 2024-09-01 15:39:09.812543 => 2024-09-01 15:39:09.828034
[0m15:39:09.828987 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.order_clients_info
[0m15:39:09.884547 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.order_clients_info"
[0m15:39:09.892760 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:39:09.893536 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: BEGIN
[0m15:39:09.894223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:09.901652 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:39:09.902984 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:39:09.904066 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.order_clients_info"} */

  create view "postgres"."dbt"."order_clients_info__dbt_tmp" as (
    select
    so.ORDER_PK,
    cop.CLIENT_PK as payer_client_pk,
    ctp.CLIENT_TYPE_PK as payer_client_type_pk,
    ctp.name as payer_client_type_name,
    cos.CLIENT_PK as sender_client_pk,
    cts.CLIENT_TYPE_PK as sender_client_type_pk,
    cts.name as sender_client_type_name,
    cor.CLIENT_PK as sender_client_pk,
    ctr.CLIENT_TYPE_PK as sender_client_type_pk,
    ctr.name as sender_client_type_name
from "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctp on ctp.CLIENT_TYPE_PK = cop.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_sender" AS cos on cos.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS cts on cts.CLIENT_TYPE_PK = cos.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_receiver" AS cor on cor.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctr on ctr.CLIENT_TYPE_PK = cor.CLIENT_TYPE_PK
  );
[0m15:39:09.907063 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "sender_client_pk" specified more than once

[0m15:39:09.908494 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: ROLLBACK
[0m15:39:09.910005 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (execute): 2024-09-01 15:39:09.829663 => 2024-09-01 15:39:09.909909
[0m15:39:09.911013 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: Close
[0m15:39:09.913971 [debug] [Thread-1  ]: Database Error in model order_clients_info (models/cdm/order_clients_info.sql)
  column "sender_client_pk" specified more than once
  compiled Code at target/run/otus_project_dbtvault/models/cdm/order_clients_info.sql
[0m15:39:09.915248 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ebad77-b77b-44e9-97b1-b70cf3c737fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0e96f730>]}
[0m15:39:09.916461 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.order_clients_info .................... [[31mERROR[0m in 0.11s]
[0m15:39:09.919199 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.order_clients_info
[0m15:39:09.922187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:09.923292 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.924182 [debug] [MainThread]: On master: BEGIN
[0m15:39:09.924970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:09.932606 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:39:09.934128 [debug] [MainThread]: On master: COMMIT
[0m15:39:09.935217 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:09.936538 [debug] [MainThread]: On master: COMMIT
[0m15:39:09.937725 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:39:09.938775 [debug] [MainThread]: On master: Close
[0m15:39:09.940062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:09.941610 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.order_clients_info' was properly closed.
[0m15:39:09.942507 [info ] [MainThread]: 
[0m15:39:09.943478 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:39:09.944725 [debug] [MainThread]: Command end result
[0m15:39:09.977372 [info ] [MainThread]: 
[0m15:39:09.978730 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:09.980009 [info ] [MainThread]: 
[0m15:39:09.981325 [error] [MainThread]: [33mDatabase Error in model order_clients_info (models/cdm/order_clients_info.sql)[0m
[0m15:39:09.982782 [error] [MainThread]:   column "sender_client_pk" specified more than once
[0m15:39:09.984115 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/order_clients_info.sql
[0m15:39:09.985420 [info ] [MainThread]: 
[0m15:39:09.986872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:39:09.988565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0fef7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0ff1a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf0f9f79d0>]}
[0m15:39:09.990078 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 15:39:39.238485 | 0165b8c4-ddd6-4c71-bd8f-f8ad58b2e73c ==============================
[0m15:39:39.238485 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:39:39.241658 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:39.242824 [debug] [MainThread]: Tracking: tracking
[0m15:39:39.248609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17ad352bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aa371d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aa3711c0>]}
[0m15:39:42.464091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:42.465640 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/order_clients_info.sql
[0m15:39:42.492582 [debug] [MainThread]: 1699: static parser successfully parsed cdm/order_clients_info.sql
[0m15:39:42.549943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0165b8c4-ddd6-4c71-bd8f-f8ad58b2e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aa223f10>]}
[0m15:39:42.598449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0165b8c4-ddd6-4c71-bd8f-f8ad58b2e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a9f565e0>]}
[0m15:39:42.599453 [info ] [MainThread]: Found 99 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m15:39:42.600682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0165b8c4-ddd6-4c71-bd8f-f8ad58b2e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aa371820>]}
[0m15:39:42.608062 [info ] [MainThread]: 
[0m15:39:42.611564 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:42.613938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m15:39:42.630508 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m15:39:42.632037 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m15:39:42.633228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:42.642204 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m15:39:42.644875 [debug] [ThreadPool]: On list_postgres: Close
[0m15:39:42.655138 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m15:39:42.664561 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:39:42.665820 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m15:39:42.666896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:42.674898 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:39:42.676618 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m15:39:42.677817 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m15:39:42.681606 [debug] [ThreadPool]: SQL status: SELECT 114 in 0 seconds
[0m15:39:42.687250 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m15:39:42.688524 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m15:39:42.716592 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.717980 [debug] [MainThread]: On master: BEGIN
[0m15:39:42.719230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:42.727435 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:39:42.729225 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.730791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:42.793110 [debug] [MainThread]: SQL status: SELECT 89 in 0 seconds
[0m15:39:42.807677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0165b8c4-ddd6-4c71-bd8f-f8ad58b2e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aa0db790>]}
[0m15:39:42.809111 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:42.810484 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.811595 [debug] [MainThread]: On master: BEGIN
[0m15:39:42.812925 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:39:42.814037 [debug] [MainThread]: On master: COMMIT
[0m15:39:42.814985 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.815891 [debug] [MainThread]: On master: COMMIT
[0m15:39:42.816956 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:39:42.817954 [debug] [MainThread]: On master: Close
[0m15:39:42.819343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:42.820337 [info ] [MainThread]: 
[0m15:39:42.825204 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.order_clients_info
[0m15:39:42.826417 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.order_clients_info ............................. [RUN]
[0m15:39:42.827789 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.order_clients_info'
[0m15:39:42.828667 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.order_clients_info
[0m15:39:42.836367 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.order_clients_info"
[0m15:39:42.844203 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (compile): 2024-09-01 15:39:42.829368 => 2024-09-01 15:39:42.844070
[0m15:39:42.845404 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.order_clients_info
[0m15:39:42.900356 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.order_clients_info"
[0m15:39:42.908836 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:39:42.909605 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: BEGIN
[0m15:39:42.910310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:39:42.917711 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:39:42.919278 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:39:42.920392 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.order_clients_info"} */

  create view "postgres"."dbt"."order_clients_info__dbt_tmp" as (
    select
    so.ORDER_PK,
    cop.CLIENT_PK as payer_client_pk,
    ctp.CLIENT_TYPE_PK as payer_client_type_pk,
    ctp.name as payer_client_type_name,
    cos.CLIENT_PK as sender_client_pk,
    cts.CLIENT_TYPE_PK as sender_client_type_pk,
    cts.name as sender_client_type_name,
    cor.CLIENT_PK as receiver_client_pk,
    ctr.CLIENT_TYPE_PK as receiver_client_type_pk,
    ctr.name as receiver_client_type_name
from "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctp on ctp.CLIENT_TYPE_PK = cop.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_sender" AS cos on cos.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS cts on cts.CLIENT_TYPE_PK = cos.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_receiver" AS cor on cor.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctr on ctr.CLIENT_TYPE_PK = cor.CLIENT_TYPE_PK
  );
[0m15:39:42.924594 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m15:39:42.934460 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:39:42.935817 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.order_clients_info"} */
alter table "postgres"."dbt"."order_clients_info__dbt_tmp" rename to "order_clients_info"
[0m15:39:42.937498 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:39:42.959416 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: COMMIT
[0m15:39:42.960757 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:39:42.961906 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: COMMIT
[0m15:39:42.964855 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:39:42.973037 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.order_clients_info"
[0m15:39:42.974198 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.order_clients_info"} */
drop view if exists "postgres"."dbt"."order_clients_info__dbt_backup" cascade
[0m15:39:42.975642 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:39:42.978248 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.order_clients_info (execute): 2024-09-01 15:39:42.846396 => 2024-09-01 15:39:42.978185
[0m15:39:42.979614 [debug] [Thread-1  ]: On model.otus_project_dbtvault.order_clients_info: Close
[0m15:39:42.981380 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0165b8c4-ddd6-4c71-bd8f-f8ad58b2e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8c00790>]}
[0m15:39:42.982771 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.order_clients_info ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m15:39:42.985862 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.order_clients_info
[0m15:39:42.988351 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:42.989382 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.990308 [debug] [MainThread]: On master: BEGIN
[0m15:39:42.991412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:42.999078 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:39:43.000840 [debug] [MainThread]: On master: COMMIT
[0m15:39:43.001986 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:43.003000 [debug] [MainThread]: On master: COMMIT
[0m15:39:43.004363 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:39:43.005498 [debug] [MainThread]: On master: Close
[0m15:39:43.006983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:43.008022 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.order_clients_info' was properly closed.
[0m15:39:43.009152 [info ] [MainThread]: 
[0m15:39:43.010484 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:39:43.012183 [debug] [MainThread]: Command end result
[0m15:39:43.045531 [info ] [MainThread]: 
[0m15:39:43.046725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:43.048032 [info ] [MainThread]: 
[0m15:39:43.049173 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:43.050730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17aa371820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8e1aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17a8e1a100>]}
[0m15:39:43.052020 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:02:44.590208 | 23dc88ed-9583-4a15-8646-3ddb9370b4b7 ==============================
[0m16:02:44.590208 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:02:44.593287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:02:44.594257 [debug] [MainThread]: Tracking: tracking
[0m16:02:44.599286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c90d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c90d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c90da30>]}
[0m16:02:47.760306 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m16:02:47.761731 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:02:47.762557 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_order_clients_info.sql
[0m16:02:47.763275 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/order_clients_info.sql
[0m16:02:47.764084 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/business_vault/cv_last_order_status.sql
[0m16:02:47.790173 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_goods.sql
[0m16:02:47.815182 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_clients_info.sql
[0m16:02:47.830170 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_last_order_status.sql
[0m16:02:47.884221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23dc88ed-9583-4a15-8646-3ddb9370b4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c7b00d0>]}
[0m16:02:47.932568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23dc88ed-9583-4a15-8646-3ddb9370b4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4e0bc2b0>]}
[0m16:02:47.933616 [info ] [MainThread]: Found 100 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:02:47.934661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23dc88ed-9583-4a15-8646-3ddb9370b4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c8eeb20>]}
[0m16:02:47.940851 [info ] [MainThread]: 
[0m16:02:47.943788 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:47.945941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:02:47.962255 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:02:47.963464 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:02:47.964644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:47.973235 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:02:47.975822 [debug] [ThreadPool]: On list_postgres: Close
[0m16:02:47.986132 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:02:47.996203 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:02:47.997577 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:02:47.998814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:48.006765 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:02:48.008255 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:02:48.009698 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:02:48.013492 [debug] [ThreadPool]: SQL status: SELECT 115 in 0 seconds
[0m16:02:48.019128 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:02:48.020477 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:02:48.049575 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:48.051079 [debug] [MainThread]: On master: BEGIN
[0m16:02:48.052349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:48.060378 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:02:48.061956 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:48.063205 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:48.128198 [debug] [MainThread]: SQL status: SELECT 94 in 0 seconds
[0m16:02:48.144080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23dc88ed-9583-4a15-8646-3ddb9370b4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4e0f9e80>]}
[0m16:02:48.145913 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:48.148635 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:48.150031 [debug] [MainThread]: On master: BEGIN
[0m16:02:48.151764 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:02:48.153155 [debug] [MainThread]: On master: COMMIT
[0m16:02:48.154319 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:48.155425 [debug] [MainThread]: On master: COMMIT
[0m16:02:48.156657 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:02:48.157539 [debug] [MainThread]: On master: Close
[0m16:02:48.158854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:48.159944 [info ] [MainThread]: 
[0m16:02:48.164294 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_goods
[0m16:02:48.165561 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.cv_goods ....................................... [RUN]
[0m16:02:48.167189 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_goods'
[0m16:02:48.168230 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_goods
[0m16:02:48.176377 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_goods"
[0m16:02:48.184375 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (compile): 2024-09-01 16:02:48.168951 => 2024-09-01 16:02:48.184248
[0m16:02:48.185349 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_goods
[0m16:02:48.246014 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_goods"
[0m16:02:48.254450 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:02:48.255450 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: BEGIN
[0m16:02:48.256208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:02:48.264178 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:02:48.265881 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:02:48.266985 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */

  create view "postgres"."dbt"."cv_goods__dbt_tmp" as (
    with ords as (
SELECT
    so.ORDER_PK,
    so.order_date,
    case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.status_datetime
        else null
    end as delivery_date,
        case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.WAREHOUSE_PK
        else null
    end as delivery_warehouse_pk,
    oc.CURRENCY_PK,
    ls.
FROM "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order_status" AS os on os.ORDER_STATUS_PK = ls.ORDER_STATUS_PK
LEFT JOIN "postgres"."dbt"."link_order_currency" AS oc on oc.ORDER_PK = so.ORDER_PK
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    sg.GOOD_PK,
    sg.count,
    sg.cost_per_unit,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) as cost_per_unit_rur,
    sg.cost_per_unit * sg.count as full_good_cost,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) * sg.count as full_good_cost_rur
from ords
LEFT JOIN "postgres"."dbt"."link_order_goods" AS og on og.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_good" AS sg on sg.GOOD_PK = og.GOOD_PK
LEFT JOIN "postgres"."dbt"."cv_currency_rate_by_date" AS crr on crr.CURRENCY_PK = ords.CURRENCY_PK
    and crr.date_value = COALESCE(ords.delivery_date, ords.order_date)
;
  );
[0m16:02:48.268488 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "."
LINE 18: FROM "postgres"."dbt"."sat_order" AS so
                        ^

[0m16:02:48.270416 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: ROLLBACK
[0m16:02:48.271982 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (execute): 2024-09-01 16:02:48.186096 => 2024-09-01 16:02:48.271874
[0m16:02:48.273131 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: Close
[0m16:02:48.276393 [debug] [Thread-1  ]: Database Error in model cv_goods (models/cdm/cv_goods.sql)
  syntax error at or near "."
  LINE 18: FROM "postgres"."dbt"."sat_order" AS so
                          ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_goods.sql
[0m16:02:48.277906 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23dc88ed-9583-4a15-8646-3ddb9370b4b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4b18f0a0>]}
[0m16:02:48.279210 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.cv_goods .............................. [[31mERROR[0m in 0.11s]
[0m16:02:48.282264 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_goods
[0m16:02:48.285357 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:48.286391 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:48.287358 [debug] [MainThread]: On master: BEGIN
[0m16:02:48.288169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:48.298347 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:02:48.299958 [debug] [MainThread]: On master: COMMIT
[0m16:02:48.301157 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:48.302267 [debug] [MainThread]: On master: COMMIT
[0m16:02:48.303537 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:02:48.304681 [debug] [MainThread]: On master: Close
[0m16:02:48.306268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:48.307734 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_goods' was properly closed.
[0m16:02:48.308902 [info ] [MainThread]: 
[0m16:02:48.310253 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m16:02:48.311598 [debug] [MainThread]: Command end result
[0m16:02:48.346695 [info ] [MainThread]: 
[0m16:02:48.347965 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:02:48.349201 [info ] [MainThread]: 
[0m16:02:48.350505 [error] [MainThread]: [33mDatabase Error in model cv_goods (models/cdm/cv_goods.sql)[0m
[0m16:02:48.351751 [error] [MainThread]:   syntax error at or near "."
[0m16:02:48.353112 [error] [MainThread]:   LINE 18: FROM "postgres"."dbt"."sat_order" AS so
[0m16:02:48.354359 [error] [MainThread]:                           ^
[0m16:02:48.355573 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_goods.sql
[0m16:02:48.356866 [info ] [MainThread]: 
[0m16:02:48.358305 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:02:48.359786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c90d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c901d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e4c7c1f40>]}
[0m16:02:48.360853 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:03:41.961767 | 4dad77bd-4c82-46c0-91fe-793e65ce72bb ==============================
[0m16:03:41.961767 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:03:41.964716 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:03:41.965781 [debug] [MainThread]: Tracking: tracking
[0m16:03:41.970919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587cfdcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5879ffad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5879ffa1c0>]}
[0m16:03:45.158802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:45.160513 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:03:45.188102 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_goods.sql
[0m16:03:45.246460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dad77bd-4c82-46c0-91fe-793e65ce72bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5879eb80d0>]}
[0m16:03:45.296413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dad77bd-4c82-46c0-91fe-793e65ce72bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5879be13a0>]}
[0m16:03:45.297530 [info ] [MainThread]: Found 100 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:03:45.298884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dad77bd-4c82-46c0-91fe-793e65ce72bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5879ffa820>]}
[0m16:03:45.308140 [info ] [MainThread]: 
[0m16:03:45.312188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:45.314271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:03:45.331017 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:03:45.332577 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:03:45.334014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:45.343642 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:03:45.346170 [debug] [ThreadPool]: On list_postgres: Close
[0m16:03:45.356685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:03:45.366475 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:03:45.367767 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:03:45.368843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:45.376522 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:03:45.378297 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:03:45.379712 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:03:45.383020 [debug] [ThreadPool]: SQL status: SELECT 115 in 0 seconds
[0m16:03:45.388729 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:03:45.389864 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:03:45.418532 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:45.419860 [debug] [MainThread]: On master: BEGIN
[0m16:03:45.421003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:45.428997 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:03:45.430809 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:45.431999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:45.495599 [debug] [MainThread]: SQL status: SELECT 94 in 0 seconds
[0m16:03:45.511759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dad77bd-4c82-46c0-91fe-793e65ce72bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587a0093d0>]}
[0m16:03:45.513294 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:45.514785 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:45.515929 [debug] [MainThread]: On master: BEGIN
[0m16:03:45.517344 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:03:45.518586 [debug] [MainThread]: On master: COMMIT
[0m16:03:45.519704 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:45.520611 [debug] [MainThread]: On master: COMMIT
[0m16:03:45.521656 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:03:45.522469 [debug] [MainThread]: On master: Close
[0m16:03:45.523659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:45.524620 [info ] [MainThread]: 
[0m16:03:45.528957 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_goods
[0m16:03:45.530167 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.cv_goods ....................................... [RUN]
[0m16:03:45.531672 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_goods'
[0m16:03:45.532433 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_goods
[0m16:03:45.540235 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_goods"
[0m16:03:45.547882 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (compile): 2024-09-01 16:03:45.533085 => 2024-09-01 16:03:45.547768
[0m16:03:45.548808 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_goods
[0m16:03:45.616944 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_goods"
[0m16:03:45.625721 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:03:45.626948 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: BEGIN
[0m16:03:45.627860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:03:45.639093 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:03:45.640930 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:03:45.642077 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */

  create view "postgres"."dbt"."cv_goods__dbt_tmp" as (
    with ords as (
SELECT
    so.ORDER_PK,
    so.order_date,
    case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.status_datetime
        else null
    end as delivery_date,
        case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.WAREHOUSE_PK
        else null
    end as delivery_warehouse_pk,
    oc.CURRENCY_PK
FROM "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order_status" AS os on os.ORDER_STATUS_PK = ls.ORDER_STATUS_PK
LEFT JOIN "postgres"."dbt"."link_order_currency" AS oc on oc.ORDER_PK = so.ORDER_PK
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    sg.GOOD_PK,
    sg.count,
    sg.cost_per_unit,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) as cost_per_unit_rur,
    sg.cost_per_unit * sg.count as full_good_cost,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) * sg.count as full_good_cost_rur,
    ords.delivery_warehouse_pk
from ords
LEFT JOIN "postgres"."dbt"."link_order_goods" AS og on og.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_good" AS sg on sg.GOOD_PK = og.GOOD_PK
LEFT JOIN "postgres"."dbt"."cv_currency_rate_by_date" AS crr on crr.CURRENCY_PK = ords.CURRENCY_PK
    and crr.date_value = COALESCE(ords.delivery_date, ords.order_date)
;
  );
[0m16:03:45.643618 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 39: ;
         ^

[0m16:03:45.645652 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: ROLLBACK
[0m16:03:45.647361 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (execute): 2024-09-01 16:03:45.549420 => 2024-09-01 16:03:45.647255
[0m16:03:45.648487 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: Close
[0m16:03:45.651505 [debug] [Thread-1  ]: Database Error in model cv_goods (models/cdm/cv_goods.sql)
  syntax error at or near ";"
  LINE 39: ;
           ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_goods.sql
[0m16:03:45.652863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dad77bd-4c82-46c0-91fe-793e65ce72bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5878a74c10>]}
[0m16:03:45.654377 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.cv_goods .............................. [[31mERROR[0m in 0.12s]
[0m16:03:45.657612 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_goods
[0m16:03:45.660555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:45.661764 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:45.662859 [debug] [MainThread]: On master: BEGIN
[0m16:03:45.663847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:45.672818 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:03:45.674615 [debug] [MainThread]: On master: COMMIT
[0m16:03:45.675674 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:45.676633 [debug] [MainThread]: On master: COMMIT
[0m16:03:45.677738 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:03:45.678762 [debug] [MainThread]: On master: Close
[0m16:03:45.680337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:45.681298 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_goods' was properly closed.
[0m16:03:45.682340 [info ] [MainThread]: 
[0m16:03:45.683503 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m16:03:45.684719 [debug] [MainThread]: Command end result
[0m16:03:45.720006 [info ] [MainThread]: 
[0m16:03:45.721279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:45.722693 [info ] [MainThread]: 
[0m16:03:45.724198 [error] [MainThread]: [33mDatabase Error in model cv_goods (models/cdm/cv_goods.sql)[0m
[0m16:03:45.725524 [error] [MainThread]:   syntax error at or near ";"
[0m16:03:45.727027 [error] [MainThread]:   LINE 39: ;
[0m16:03:45.728322 [error] [MainThread]:            ^
[0m16:03:45.729510 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_goods.sql
[0m16:03:45.730628 [info ] [MainThread]: 
[0m16:03:45.731880 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:45.733026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5879ffa820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f587a01e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5879ed0940>]}
[0m16:03:45.733843 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:03:58.324065 | 8d2db669-316a-4128-8c5c-f57082d5ea07 ==============================
[0m16:03:58.324065 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:03:58.327193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:03:58.328158 [debug] [MainThread]: Tracking: tracking
[0m16:03:58.332745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7efadb2bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef7dd0d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef7dd01c0>]}
[0m16:04:01.569964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:01.571542 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:04:01.598142 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_goods.sql
[0m16:04:01.654583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d2db669-316a-4128-8c5c-f57082d5ea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef7c8b0d0>]}
[0m16:04:01.702850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d2db669-316a-4128-8c5c-f57082d5ea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef79b6760>]}
[0m16:04:01.703825 [info ] [MainThread]: Found 100 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:04:01.704981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d2db669-316a-4128-8c5c-f57082d5ea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef7dd0820>]}
[0m16:04:01.711652 [info ] [MainThread]: 
[0m16:04:01.714842 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:01.717053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:04:01.733483 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:04:01.734901 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:04:01.736199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:01.745168 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:04:01.747762 [debug] [ThreadPool]: On list_postgres: Close
[0m16:04:01.758393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:04:01.767676 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:04:01.768997 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:04:01.770213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:01.777896 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:04:01.779429 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:04:01.780704 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:04:01.784087 [debug] [ThreadPool]: SQL status: SELECT 115 in 0 seconds
[0m16:04:01.789785 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:04:01.791092 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:04:01.820525 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:01.821829 [debug] [MainThread]: On master: BEGIN
[0m16:04:01.823012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:01.831560 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:04:01.832986 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:01.834243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:04:01.897337 [debug] [MainThread]: SQL status: SELECT 94 in 0 seconds
[0m16:04:01.913340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d2db669-316a-4128-8c5c-f57082d5ea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef7de0fd0>]}
[0m16:04:01.914831 [debug] [MainThread]: On master: ROLLBACK
[0m16:04:01.916268 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:01.917329 [debug] [MainThread]: On master: BEGIN
[0m16:04:01.918653 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:04:01.919894 [debug] [MainThread]: On master: COMMIT
[0m16:04:01.920946 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:01.921971 [debug] [MainThread]: On master: COMMIT
[0m16:04:01.923119 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:04:01.924187 [debug] [MainThread]: On master: Close
[0m16:04:01.925707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:01.926993 [info ] [MainThread]: 
[0m16:04:01.931943 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_goods
[0m16:04:01.933322 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.cv_goods ....................................... [RUN]
[0m16:04:01.934968 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_goods'
[0m16:04:01.935831 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_goods
[0m16:04:01.943541 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_goods"
[0m16:04:01.951457 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (compile): 2024-09-01 16:04:01.936547 => 2024-09-01 16:04:01.951290
[0m16:04:01.952319 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_goods
[0m16:04:02.012568 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_goods"
[0m16:04:02.020181 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:04:02.020948 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: BEGIN
[0m16:04:02.021684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:04:02.029038 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:04:02.030600 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:04:02.031765 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */

  create view "postgres"."dbt"."cv_goods__dbt_tmp" as (
    with ords as (
SELECT
    so.ORDER_PK,
    so.order_date,
    case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.status_datetime
        else null
    end as delivery_date,
        case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.WAREHOUSE_PK
        else null
    end as delivery_warehouse_pk,
    oc.CURRENCY_PK
FROM "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order_status" AS os on os.ORDER_STATUS_PK = ls.ORDER_STATUS_PK
LEFT JOIN "postgres"."dbt"."link_order_currency" AS oc on oc.ORDER_PK = so.ORDER_PK
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    sg.GOOD_PK,
    sg.count,
    sg.cost_per_unit,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) as cost_per_unit_rur,
    sg.cost_per_unit * sg.count as full_good_cost,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) * sg.count as full_good_cost_rur,
    ords.delivery_warehouse_pk
from ords
LEFT JOIN "postgres"."dbt"."link_order_goods" AS og on og.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_good" AS sg on sg.GOOD_PK = og.GOOD_PK
LEFT JOIN "postgres"."dbt"."cv_currency_rate_by_date" AS crr on crr.CURRENCY_PK = ords.CURRENCY_PK
    and crr.date_value = COALESCE(ords.delivery_date, ords.order_date)
  );
[0m16:04:02.036208 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:04:02.046397 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:04:02.047736 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
alter table "postgres"."dbt"."cv_goods__dbt_tmp" rename to "cv_goods"
[0m16:04:02.049458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:04:02.072278 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:04:02.073597 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:04:02.074713 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:04:02.079455 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:04:02.088321 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:04:02.089513 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
drop view if exists "postgres"."dbt"."cv_goods__dbt_backup" cascade
[0m16:04:02.090825 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:04:02.093158 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (execute): 2024-09-01 16:04:01.953272 => 2024-09-01 16:04:02.093097
[0m16:04:02.094218 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: Close
[0m16:04:02.095886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d2db669-316a-4128-8c5c-f57082d5ea07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef6660c10>]}
[0m16:04:02.097549 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.cv_goods .................................. [[32mCREATE VIEW[0m in 0.16s]
[0m16:04:02.101491 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_goods
[0m16:04:02.104335 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:02.105285 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:02.106275 [debug] [MainThread]: On master: BEGIN
[0m16:04:02.107281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:02.115202 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:04:02.116969 [debug] [MainThread]: On master: COMMIT
[0m16:04:02.118146 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:02.119640 [debug] [MainThread]: On master: COMMIT
[0m16:04:02.120997 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:04:02.122009 [debug] [MainThread]: On master: Close
[0m16:04:02.123442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:02.124599 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_goods' was properly closed.
[0m16:04:02.125904 [info ] [MainThread]: 
[0m16:04:02.127377 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m16:04:02.128977 [debug] [MainThread]: Command end result
[0m16:04:02.163008 [info ] [MainThread]: 
[0m16:04:02.164151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:02.165399 [info ] [MainThread]: 
[0m16:04:02.166555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:04:02.168095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef79b67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef7df4430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ef68801c0>]}
[0m16:04:02.169365 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:26:24.057966 | 58158d15-bd10-441b-a244-cdb3fdb4f3fc ==============================
[0m16:26:24.057966 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:26:24.061884 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:26:24.064551 [debug] [MainThread]: Tracking: tracking
[0m16:26:24.073742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b1cfdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aed1b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aed1be50>]}
[0m16:26:27.288692 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m16:26:27.290160 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:26:27.290991 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:26:27.292121 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_goods.sql
[0m16:26:27.293451 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:26:27.324336 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:26:27.342077 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m16:26:27.348859 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_goods.sql
[0m16:26:27.353335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06ae811220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aea18370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06aea182e0>]}
[0m16:26:27.354829 [debug] [MainThread]: Flushing usage events
[0m16:26:28.210384 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.otus_project_dbtvault.cv_order_attributes' (models/cdm/cv_order_attributes.sql) depends on a node named 'cv_order_client_info' which was not found


============================== 2024-09-01 16:26:39.381892 | a4d406ee-a348-4095-8b0a-059c9193ea7e ==============================
[0m16:26:39.381892 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:26:39.384881 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:26:39.385968 [debug] [MainThread]: Tracking: tracking
[0m16:26:39.391861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dcb062520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dcb062130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dcb062a30>]}
[0m16:26:42.673386 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m16:26:42.674899 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:26:42.675892 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:26:42.677002 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_goods.sql
[0m16:26:42.677942 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:26:42.705124 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:26:42.722491 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m16:26:42.728768 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_goods.sql
[0m16:26:42.734145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dcab3e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dcae923a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2dcae92310>]}
[0m16:26:42.735580 [debug] [MainThread]: Flushing usage events
[0m16:26:43.431071 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.otus_project_dbtvault.cv_order_attributes' (models/cdm/cv_order_attributes.sql) depends on a node named 'cv_order_client_info' which was not found


============================== 2024-09-01 16:26:56.535724 | f7cc0137-097a-40de-ba81-0b6137eefbf5 ==============================
[0m16:26:56.535724 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:26:56.538776 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:26:56.539986 [debug] [MainThread]: Tracking: tracking
[0m16:26:56.545115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0a678040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0a678340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0a678640>]}
[0m16:26:59.955842 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m16:26:59.957300 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:26:59.958336 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_goods.sql
[0m16:26:59.959405 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:26:59.960412 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:26:59.986008 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m16:27:00.004475 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_goods.sql
[0m16:27:00.010526 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:27:00.014881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0a149310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0a32b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d0a32b3d0>]}
[0m16:27:00.016202 [debug] [MainThread]: Flushing usage events
[0m16:27:00.718454 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.otus_project_dbtvault.cv_order_attributes' (models/cdm/cv_order_attributes.sql) depends on a node named 'cv_order_client_info' which was not found


============================== 2024-09-01 16:27:16.764006 | 17eb40bf-2dd1-4aa1-af98-e4e048e5d8f8 ==============================
[0m16:27:16.764006 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:27:16.766986 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:27:16.768349 [debug] [MainThread]: Tracking: tracking
[0m16:27:16.774091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eb26cb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eb26cb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eb26cba30>]}
[0m16:27:20.033353 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m16:27:20.035047 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:27:20.035948 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_goods.sql
[0m16:27:20.036765 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:27:20.037611 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:27:20.064869 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:27:20.083741 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_goods.sql
[0m16:27:20.088717 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m16:27:20.092639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eb21a6250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eb23a63a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eb23a6310>]}
[0m16:27:20.093882 [debug] [MainThread]: Flushing usage events
[0m16:27:20.911983 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.otus_project_dbtvault.cv_order_attributes' (models/cdm/cv_order_attributes.sql) depends on a node named 'cv_order_client_info' which was not found


============================== 2024-09-01 16:28:33.411791 | ba6a64cd-1ae2-411c-ae63-830e19736cba ==============================
[0m16:28:33.411791 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:28:33.414609 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:28:33.415864 [debug] [MainThread]: Tracking: tracking
[0m16:28:33.420780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2a332bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d27352310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d27352e50>]}
[0m16:28:36.674213 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 0 files changed.
[0m16:28:36.675812 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:28:36.676711 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_goods.sql
[0m16:28:36.677836 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:28:36.678571 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:28:36.705012 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:28:36.723215 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_goods.sql
[0m16:28:36.728081 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m16:28:36.731901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d26e46220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2704c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d2704c2e0>]}
[0m16:28:36.732998 [debug] [MainThread]: Flushing usage events
[0m16:28:37.546733 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.otus_project_dbtvault.cv_order_attributes' (models/cdm/cv_order_attributes.sql) depends on a node named 'cv_order_client_info' which was not found


============================== 2024-09-01 16:29:24.303804 | 480f59e5-4d7a-4bc2-954e-c510b4a7aac7 ==============================
[0m16:29:24.303804 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:29:24.307287 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:29:24.308545 [debug] [MainThread]: Tracking: tracking
[0m16:29:24.315581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcfa0d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcfa0d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcfa0da30>]}
[0m16:29:27.545724 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m16:29:27.547051 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:29:27.547970 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_goods.sql
[0m16:29:27.548788 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_goods.sql
[0m16:29:27.576559 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m16:29:27.596437 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_goods.sql
[0m16:29:27.645036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcf9080d0>]}
[0m16:29:27.695650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcf5d87f0>]}
[0m16:29:27.696799 [info ] [MainThread]: Found 101 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:29:27.697891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcf9fa5e0>]}
[0m16:29:27.705607 [info ] [MainThread]: 
[0m16:29:27.709309 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:27.712015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:29:27.728019 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:29:27.729244 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:29:27.730323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:27.740151 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:29:27.742943 [debug] [ThreadPool]: On list_postgres: Close
[0m16:29:27.754374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:29:27.763789 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:29:27.765032 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:29:27.766210 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:27.774066 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:29:27.775438 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:29:27.776503 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:29:27.780060 [debug] [ThreadPool]: SQL status: SELECT 107 in 0 seconds
[0m16:29:27.785440 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:29:27.786812 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:29:27.814842 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:27.816084 [debug] [MainThread]: On master: BEGIN
[0m16:29:27.817116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:27.825017 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:29:27.826410 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:27.827614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:27.879658 [debug] [MainThread]: SQL status: SELECT 61 in 0 seconds
[0m16:29:27.890210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fd11f7640>]}
[0m16:29:27.891500 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:27.892691 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:27.893644 [debug] [MainThread]: On master: BEGIN
[0m16:29:27.894857 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:29:27.896160 [debug] [MainThread]: On master: COMMIT
[0m16:29:27.897200 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:27.898129 [debug] [MainThread]: On master: COMMIT
[0m16:29:27.899185 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:29:27.900046 [debug] [MainThread]: On master: Close
[0m16:29:27.901355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:27.902404 [info ] [MainThread]: 
[0m16:29:27.906975 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.as_of_date
[0m16:29:27.908047 [info ] [Thread-1  ]: 1 of 10 START sql table model dbt.as_of_date ................................... [RUN]
[0m16:29:27.909426 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.as_of_date'
[0m16:29:27.910315 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.as_of_date
[0m16:29:27.946733 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:29:27.947822 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: BEGIN
[0m16:29:27.948489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:27.956084 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:27.957495 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:29:27.958194 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */


        select 
        ((TO_DATE('2024-10-01', 'yyyy-mm-dd'))::date - (TO_DATE('2023-12-01', 'yyyy-mm-dd'))::date)
    
[0m16:29:27.959638 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m16:29:27.978920 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.as_of_date"
[0m16:29:27.985782 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (compile): 2024-09-01 16:29:27.910998 => 2024-09-01 16:29:27.985634
[0m16:29:27.986703 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.as_of_date
[0m16:29:28.050934 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.as_of_date"
[0m16:29:28.057834 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:29:28.058693 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */

  
    

  create  table "postgres"."dbt"."as_of_date__dbt_tmp"
  as (
    WITH as_of_date AS (
 





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 305
    order by generated_number



),

all_periods as (

    select (
        

    TO_DATE('2023-12-01', 'yyyy-mm-dd') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= TO_DATE('2024-10-01', 'yyyy-mm-dd')

)

select * from filtered


)
SELECT DATE_day as AS_OF_DATE FROM as_of_date
  );
  
[0m16:29:28.065693 [debug] [Thread-1  ]: SQL status: SELECT 305 in 0 seconds
[0m16:29:28.075991 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:29:28.077311 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date" rename to "as_of_date__dbt_backup"
[0m16:29:28.078617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.084476 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:29:28.085493 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date__dbt_tmp" rename to "as_of_date"
[0m16:29:28.086661 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.118510 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m16:29:28.119755 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:29:28.120866 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m16:29:28.124739 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.134441 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:29:28.135573 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
drop table if exists "postgres"."dbt"."as_of_date__dbt_backup" cascade
[0m16:29:28.138603 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:29:28.141177 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (execute): 2024-09-01 16:29:27.987573 => 2024-09-01 16:29:28.141067
[0m16:29:28.142377 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: Close
[0m16:29:28.143857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce281ca0>]}
[0m16:29:28.145088 [info ] [Thread-1  ]: 1 of 10 OK created sql table model dbt.as_of_date .............................. [[32mSELECT 305[0m in 0.23s]
[0m16:29:28.148039 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.as_of_date
[0m16:29:28.149343 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_city_country
[0m16:29:28.150620 [info ] [Thread-1  ]: 2 of 10 START sql view model dbt.cv_city_country ............................... [RUN]
[0m16:29:28.152468 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_city_country'
[0m16:29:28.153865 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_city_country
[0m16:29:28.160045 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_city_country"
[0m16:29:28.167434 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (compile): 2024-09-01 16:29:28.154874 => 2024-09-01 16:29:28.167315
[0m16:29:28.168539 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_city_country
[0m16:29:28.200917 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_city_country"
[0m16:29:28.209067 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:29:28.209999 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: BEGIN
[0m16:29:28.210821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.218162 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.219742 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:29:28.220893 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */

  create view "postgres"."dbt"."cv_city_country__dbt_tmp" as (
    select
    sci.CITY_PK,
    sci.name AS city_name,
    sco.name AS country_name
FROM "postgres"."dbt"."sat_city" AS sci
LEFT JOIN "postgres"."dbt"."link_city_country" AS ccl on ccl.CITY_PK = sci.CITY_PK
LEFT JOIN "postgres"."dbt"."sat_country" AS sco ON sco.COUNTRY_PK = ccl.COUNTRY_PK
  );
[0m16:29:28.223678 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.229213 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:29:28.230147 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country__dbt_tmp" rename to "cv_city_country"
[0m16:29:28.231208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.233488 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m16:29:28.234264 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:29:28.234978 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m16:29:28.237711 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.242694 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:29:28.243965 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
drop view if exists "postgres"."dbt"."cv_city_country__dbt_backup" cascade
[0m16:29:28.245466 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.247639 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (execute): 2024-09-01 16:29:28.169395 => 2024-09-01 16:29:28.247579
[0m16:29:28.248625 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: Close
[0m16:29:28.250139 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce281910>]}
[0m16:29:28.251655 [info ] [Thread-1  ]: 2 of 10 OK created sql view model dbt.cv_city_country .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:29:28.253319 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_city_country
[0m16:29:28.254589 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_date
[0m16:29:28.255647 [info ] [Thread-1  ]: 3 of 10 START sql view model dbt.cv_date ....................................... [RUN]
[0m16:29:28.257213 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_date'
[0m16:29:28.258267 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_date
[0m16:29:28.311665 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_date"
[0m16:29:28.319819 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (compile): 2024-09-01 16:29:28.259043 => 2024-09-01 16:29:28.319656
[0m16:29:28.320821 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_date
[0m16:29:28.333276 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_date"
[0m16:29:28.341438 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:29:28.342342 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: BEGIN
[0m16:29:28.343175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.351921 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.353487 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:29:28.354451 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */

  create view "postgres"."dbt"."cv_date__dbt_tmp" as (
    WITH
RECURSIVE dates AS (
    SELECT
        '2023-12-01'::TIMESTAMP AS date_value
    UNION
    SELECT
        date_value + INTERVAL '1' DAY AS date_value
    FROM dates
    WHERE date_value <= '2024-10-01'
)
select date_value from dates
  );
[0m16:29:28.356772 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.364406 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:29:28.365761 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date__dbt_tmp" rename to "cv_date"
[0m16:29:28.367207 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.370305 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m16:29:28.371199 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:29:28.371956 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m16:29:28.374496 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.380408 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:29:28.381482 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
drop view if exists "postgres"."dbt"."cv_date__dbt_backup" cascade
[0m16:29:28.382543 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.385111 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (execute): 2024-09-01 16:29:28.321754 => 2024-09-01 16:29:28.385044
[0m16:29:28.386029 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: Close
[0m16:29:28.387277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce3caa90>]}
[0m16:29:28.388443 [info ] [Thread-1  ]: 3 of 10 OK created sql view model dbt.cv_date .................................. [[32mCREATE VIEW[0m in 0.13s]
[0m16:29:28.389787 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_date
[0m16:29:28.391090 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status
[0m16:29:28.392435 [info ] [Thread-1  ]: 4 of 10 START sql view model dbt.cv_last_order_status .......................... [RUN]
[0m16:29:28.394058 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status'
[0m16:29:28.395032 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status
[0m16:29:28.402832 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status"
[0m16:29:28.412805 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (compile): 2024-09-01 16:29:28.396005 => 2024-09-01 16:29:28.412631
[0m16:29:28.413903 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status
[0m16:29:28.436988 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status"
[0m16:29:28.444747 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:29:28.445542 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: BEGIN
[0m16:29:28.446235 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.454033 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.455483 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:29:28.456689 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */

  create view "postgres"."dbt"."cv_last_order_status__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd hh24:mi') as status_datetime,
        row_number() over (partition by lo.ORDER_PK order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    os.ORDER_PK,
	os.status_datetime,
    loo.ORDER_STATUS_PK,
    lw.WAREHOUSE_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_order_status_order_status_history" AS loo on loo.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m16:29:28.459406 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.464691 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:29:28.465460 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status__dbt_tmp" rename to "cv_last_order_status"
[0m16:29:28.466516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.469106 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m16:29:28.469993 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:29:28.471144 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m16:29:28.474071 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.478540 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:29:28.479248 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
drop view if exists "postgres"."dbt"."cv_last_order_status__dbt_backup" cascade
[0m16:29:28.480134 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.482043 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (execute): 2024-09-01 16:29:28.414828 => 2024-09-01 16:29:28.481981
[0m16:29:28.482759 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: Close
[0m16:29:28.484074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcf9ff850>]}
[0m16:29:28.485422 [info ] [Thread-1  ]: 4 of 10 OK created sql view model dbt.cv_last_order_status ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:29:28.487176 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status
[0m16:29:28.488132 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_payer
[0m16:29:28.488975 [info ] [Thread-1  ]: 5 of 10 START sql view model dbt.cv_order_payer ................................ [RUN]
[0m16:29:28.490267 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_payer'
[0m16:29:28.491026 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_payer
[0m16:29:28.498063 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_payer"
[0m16:29:28.505990 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (compile): 2024-09-01 16:29:28.491713 => 2024-09-01 16:29:28.505858
[0m16:29:28.506930 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_payer
[0m16:29:28.522209 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_payer"
[0m16:29:28.530818 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:29:28.531849 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: BEGIN
[0m16:29:28.532788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.541236 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.542473 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:29:28.543548 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */

  create view "postgres"."dbt"."cv_order_payer__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'payer'
  );
[0m16:29:28.546741 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.553373 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:29:28.554402 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
alter table "postgres"."dbt"."cv_order_payer__dbt_tmp" rename to "cv_order_payer"
[0m16:29:28.555751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.558242 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m16:29:28.559057 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:29:28.559837 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m16:29:28.562668 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.567318 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:29:28.568291 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
drop view if exists "postgres"."dbt"."cv_order_payer__dbt_backup" cascade
[0m16:29:28.569433 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.571673 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (execute): 2024-09-01 16:29:28.507610 => 2024-09-01 16:29:28.571612
[0m16:29:28.572605 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: Close
[0m16:29:28.574103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fcf6b65b0>]}
[0m16:29:28.575345 [info ] [Thread-1  ]: 5 of 10 OK created sql view model dbt.cv_order_payer ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:29:28.576672 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_payer
[0m16:29:28.578009 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_receiver
[0m16:29:28.579229 [info ] [Thread-1  ]: 6 of 10 START sql view model dbt.cv_order_receiver ............................. [RUN]
[0m16:29:28.580762 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_receiver'
[0m16:29:28.581856 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_receiver
[0m16:29:28.589263 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_receiver"
[0m16:29:28.596617 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (compile): 2024-09-01 16:29:28.582737 => 2024-09-01 16:29:28.596500
[0m16:29:28.597701 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_receiver
[0m16:29:28.608999 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_receiver"
[0m16:29:28.617034 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:29:28.617820 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: BEGIN
[0m16:29:28.618490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.626039 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.627492 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:29:28.628636 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */

  create view "postgres"."dbt"."cv_order_receiver__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'receiver'
  );
[0m16:29:28.632166 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.638105 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:29:28.639353 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
alter table "postgres"."dbt"."cv_order_receiver__dbt_tmp" rename to "cv_order_receiver"
[0m16:29:28.641412 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.644767 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m16:29:28.645707 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:29:28.646484 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m16:29:28.648837 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.653571 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:29:28.655026 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
drop view if exists "postgres"."dbt"."cv_order_receiver__dbt_backup" cascade
[0m16:29:28.656484 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.658636 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (execute): 2024-09-01 16:29:28.598508 => 2024-09-01 16:29:28.658573
[0m16:29:28.659737 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: Close
[0m16:29:28.661475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce3c6be0>]}
[0m16:29:28.662711 [info ] [Thread-1  ]: 6 of 10 OK created sql view model dbt.cv_order_receiver ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m16:29:28.664081 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_receiver
[0m16:29:28.665239 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_sender
[0m16:29:28.666313 [info ] [Thread-1  ]: 7 of 10 START sql view model dbt.cv_order_sender ............................... [RUN]
[0m16:29:28.667935 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_sender'
[0m16:29:28.669020 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_sender
[0m16:29:28.678016 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_sender"
[0m16:29:28.686918 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (compile): 2024-09-01 16:29:28.670124 => 2024-09-01 16:29:28.686783
[0m16:29:28.687782 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_sender
[0m16:29:28.698896 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_sender"
[0m16:29:28.707091 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:29:28.707860 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: BEGIN
[0m16:29:28.708544 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.715963 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.717243 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:29:28.718260 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */

  create view "postgres"."dbt"."cv_order_sender__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'sender'
  );
[0m16:29:28.721534 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.727716 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:29:28.728835 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender__dbt_tmp" rename to "cv_order_sender"
[0m16:29:28.730423 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.733098 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m16:29:28.734113 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:29:28.735037 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m16:29:28.738306 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.743376 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:29:28.744501 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
drop view if exists "postgres"."dbt"."cv_order_sender__dbt_backup" cascade
[0m16:29:28.745812 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.748128 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (execute): 2024-09-01 16:29:28.688450 => 2024-09-01 16:29:28.748065
[0m16:29:28.749317 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: Close
[0m16:29:28.751027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce3a89d0>]}
[0m16:29:28.752535 [info ] [Thread-1  ]: 7 of 10 OK created sql view model dbt.cv_order_sender .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:29:28.754288 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_sender
[0m16:29:28.755681 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:29:28.756956 [info ] [Thread-1  ]: 8 of 10 START sql view model dbt.cv_currency_rate_by_date ...................... [RUN]
[0m16:29:28.758705 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_currency_rate_by_date'
[0m16:29:28.759962 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:29:28.768648 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:29:28.778571 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (compile): 2024-09-01 16:29:28.760954 => 2024-09-01 16:29:28.778402
[0m16:29:28.780027 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:29:28.792552 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:29:28.800594 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:29:28.801385 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: BEGIN
[0m16:29:28.802046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.809093 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.810577 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:29:28.811631 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */

  create view "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" as (
    SELECT
    q.CURRENCY_PK,
    q.relation_to_rur,
    d.as_of_date AS date_value
FROM (
    SELECT
        ccr.CURRENCY_PK, cr.relation_to_rur, cr.date_start,
        LAG(cr.date_start) OVER (PARTITION BY ccr.CURRENCY_PK ORDER BY cr.date_start DESC) AS date_end
    FROM "postgres"."dbt"."sat_currency_rate" cr
	LEFT JOIN "postgres"."dbt"."link_currency_currency_rate" ccr ON ccr.CURRENCY_RATE_PK = cr.CURRENCY_RATE_PK
	)q, "postgres"."dbt"."as_of_date" d
    WHERE d.as_of_date >= COALESCE(q.date_start, '2023-12-01') AND d.as_of_date < COALESCE(q.date_end, '2024-10-01')
  );
[0m16:29:28.814767 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.820766 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:29:28.821852 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
alter table "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" rename to "cv_currency_rate_by_date"
[0m16:29:28.823153 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.825693 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m16:29:28.826745 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:29:28.827693 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m16:29:28.830067 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.834625 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:29:28.835577 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
drop view if exists "postgres"."dbt"."cv_currency_rate_by_date__dbt_backup" cascade
[0m16:29:28.836773 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.838938 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (execute): 2024-09-01 16:29:28.781091 => 2024-09-01 16:29:28.838878
[0m16:29:28.839850 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: Close
[0m16:29:28.841385 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce3c6be0>]}
[0m16:29:28.842798 [info ] [Thread-1  ]: 8 of 10 OK created sql view model dbt.cv_currency_rate_by_date ................. [[32mCREATE VIEW[0m in 0.08s]
[0m16:29:28.844270 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:29:28.845394 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_clients_info
[0m16:29:28.846453 [info ] [Thread-1  ]: 9 of 10 START sql view model dbt.cv_order_clients_info ......................... [RUN]
[0m16:29:28.847938 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_clients_info'
[0m16:29:28.849137 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_clients_info
[0m16:29:28.857995 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:29:28.865874 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_clients_info (compile): 2024-09-01 16:29:28.850180 => 2024-09-01 16:29:28.865758
[0m16:29:28.866785 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_clients_info
[0m16:29:28.880076 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:29:28.889129 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:29:28.890020 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: BEGIN
[0m16:29:28.890840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.898563 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.899993 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:29:28.901044 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_clients_info"} */

  create view "postgres"."dbt"."cv_order_clients_info__dbt_tmp" as (
    select
    so.ORDER_PK,
    cop.CLIENT_PK as payer_client_pk,
    cop.CITY_PK as payer_city_pk,
    cop.is_valid as is_payer_address_valid,
    ctp.CLIENT_TYPE_PK as payer_client_type_pk,
    ctp.name as payer_client_type_name,
    cos.CLIENT_PK as sender_client_pk,
    cos.CITY_PK as sender_city_pk,
    cos.is_valid as is_sender_address_valid,
    cts.CLIENT_TYPE_PK as sender_client_type_pk,
    cts.name as sender_client_type_name,
    cor.CLIENT_PK as receiver_client_pk,
    cor.CITY_PK as receiver_city_pk,
    cor.is_valid as is_receiver_address_valid,
    ctr.CLIENT_TYPE_PK as receiver_client_type_pk,
    ctr.name as receiver_client_type_name
from "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctp on ctp.CLIENT_TYPE_PK = cop.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_sender" AS cos on cos.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS cts on cts.CLIENT_TYPE_PK = cos.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_receiver" AS cor on cor.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctr on ctr.CLIENT_TYPE_PK = cor.CLIENT_TYPE_PK
  );
[0m16:29:28.905465 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:28.912253 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:29:28.913505 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_clients_info"} */
alter table "postgres"."dbt"."cv_order_clients_info__dbt_tmp" rename to "cv_order_clients_info"
[0m16:29:28.914964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:28.917621 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: COMMIT
[0m16:29:28.918594 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:29:28.919530 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: COMMIT
[0m16:29:28.922233 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:28.926978 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:29:28.928159 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_clients_info"} */
drop view if exists "postgres"."dbt"."cv_order_clients_info__dbt_backup" cascade
[0m16:29:28.929570 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:28.931965 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_clients_info (execute): 2024-09-01 16:29:28.867449 => 2024-09-01 16:29:28.931898
[0m16:29:28.932987 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: Close
[0m16:29:28.934698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce3a89d0>]}
[0m16:29:28.936195 [info ] [Thread-1  ]: 9 of 10 OK created sql view model dbt.cv_order_clients_info .................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:29:28.937665 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_clients_info
[0m16:29:28.938931 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_goods
[0m16:29:28.940205 [info ] [Thread-1  ]: 10 of 10 START sql view model dbt.cv_goods ..................................... [RUN]
[0m16:29:28.941882 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_goods'
[0m16:29:28.943115 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_goods
[0m16:29:28.951674 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_goods"
[0m16:29:28.959769 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (compile): 2024-09-01 16:29:28.944236 => 2024-09-01 16:29:28.959652
[0m16:29:28.960646 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_goods
[0m16:29:28.971555 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_goods"
[0m16:29:28.979088 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:29:28.979814 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: BEGIN
[0m16:29:28.980479 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:28.987931 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:28.989316 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:29:28.990439 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */

  create view "postgres"."dbt"."cv_goods__dbt_tmp" as (
    with ords as (
SELECT
    so.ORDER_PK,
    so.order_date,
    case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.status_datetime
        else null
    end as delivery_date,
        case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.WAREHOUSE_PK
        else null
    end as delivery_warehouse_pk,
    oc.CURRENCY_PK
FROM "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order_status" AS os on os.ORDER_STATUS_PK = ls.ORDER_STATUS_PK
LEFT JOIN "postgres"."dbt"."link_order_currency" AS oc on oc.ORDER_PK = so.ORDER_PK
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    sg.GOOD_PK,
    sg.count,
    sg.cost_per_unit,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) as cost_per_unit_rur,
    sg.cost_per_unit * sg.count as full_good_cost,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) * sg.count as full_good_cost_rur,
    ords.delivery_warehouse_pk
from ords
LEFT JOIN "postgres"."dbt"."link_order_goods" AS og on og.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_good" AS sg on sg.GOOD_PK = og.GOOD_PK
LEFT JOIN "postgres"."dbt"."cv_currency_rate_by_date" AS crr on crr.CURRENCY_PK = ords.CURRENCY_PK
    and crr.date_value = COALESCE(ords.delivery_date, ords.order_date)
  );
[0m16:29:28.994940 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:29.001349 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:29:29.002403 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
alter table "postgres"."dbt"."cv_goods__dbt_tmp" rename to "cv_goods"
[0m16:29:29.003902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:29.006545 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:29:29.007713 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:29:29.008757 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:29:29.011577 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:29.017135 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:29:29.018398 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
drop view if exists "postgres"."dbt"."cv_goods__dbt_backup" cascade
[0m16:29:29.019734 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:29.022067 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (execute): 2024-09-01 16:29:28.961304 => 2024-09-01 16:29:29.022007
[0m16:29:29.023190 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: Close
[0m16:29:29.024761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '480f59e5-4d7a-4bc2-954e-c510b4a7aac7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce387790>]}
[0m16:29:29.026201 [info ] [Thread-1  ]: 10 of 10 OK created sql view model dbt.cv_goods ................................ [[32mCREATE VIEW[0m in 0.08s]
[0m16:29:29.027494 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_goods
[0m16:29:29.030681 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:29.031999 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:29.033303 [debug] [MainThread]: On master: BEGIN
[0m16:29:29.034484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:29.042838 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:29:29.044684 [debug] [MainThread]: On master: COMMIT
[0m16:29:29.045872 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:29.046889 [debug] [MainThread]: On master: COMMIT
[0m16:29:29.048165 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:29:29.049193 [debug] [MainThread]: On master: Close
[0m16:29:29.050575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:29.051316 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_goods' was properly closed.
[0m16:29:29.052376 [info ] [MainThread]: 
[0m16:29:29.053576 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m16:29:29.055370 [debug] [MainThread]: Command end result
[0m16:29:29.089308 [info ] [MainThread]: 
[0m16:29:29.090527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:29.091994 [info ] [MainThread]: 
[0m16:29:29.093271 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:29:29.094863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce3caa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce38bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fce369100>]}
[0m16:29:29.096133 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:30:11.119726 | 5c15b675-f27e-400e-8b90-6f5b5011c07f ==============================
[0m16:30:11.119726 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:30:11.123202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:30:11.124345 [debug] [MainThread]: Tracking: tracking
[0m16:30:11.130254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa2c5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa2c5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa2c5eb0>]}
[0m16:30:14.423663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:30:14.425513 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:30:14.452855 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:30:14.469104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdf9daf160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa1062b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efdfa106220>]}
[0m16:30:14.470464 [debug] [MainThread]: Flushing usage events
[0m16:30:15.305901 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.otus_project_dbtvault.cv_order_attributes' (models/cdm/cv_order_attributes.sql) depends on a node named 'cv_order_client_info' which was not found


============================== 2024-09-01 16:30:38.502455 | b86a38be-4abb-4c62-b4ac-cd5298eec3e3 ==============================
[0m16:30:38.502455 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:30:38.506025 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:30:38.507621 [debug] [MainThread]: Tracking: tracking
[0m16:30:38.513642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25b7bbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2587da310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2587da8e0>]}
[0m16:30:41.489381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:30:41.490825 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:30:41.517595 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:30:41.576151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b86a38be-4abb-4c62-b4ac-cd5298eec3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2586990d0>]}
[0m16:30:41.629521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b86a38be-4abb-4c62-b4ac-cd5298eec3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2582b9a30>]}
[0m16:30:41.630698 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:30:41.631932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b86a38be-4abb-4c62-b4ac-cd5298eec3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2587dae80>]}
[0m16:30:41.641566 [info ] [MainThread]: 
[0m16:30:41.645123 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:41.647933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:30:41.665298 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:30:41.666451 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:30:41.667302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:41.679190 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:30:41.682214 [debug] [ThreadPool]: On list_postgres: Close
[0m16:30:41.693168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:30:41.702859 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:30:41.704064 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:30:41.705102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:41.713193 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:30:41.714853 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:30:41.715987 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:30:41.719621 [debug] [ThreadPool]: SQL status: SELECT 116 in 0 seconds
[0m16:30:41.725462 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:30:41.726716 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:30:41.756763 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:41.758176 [debug] [MainThread]: On master: BEGIN
[0m16:30:41.759469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:30:41.767457 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:30:41.769068 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:41.770237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:30:41.834096 [debug] [MainThread]: SQL status: SELECT 101 in 0 seconds
[0m16:30:41.850062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b86a38be-4abb-4c62-b4ac-cd5298eec3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2587e9dc0>]}
[0m16:30:41.851332 [debug] [MainThread]: On master: ROLLBACK
[0m16:30:41.852833 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:41.854006 [debug] [MainThread]: On master: BEGIN
[0m16:30:41.855555 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:30:41.856798 [debug] [MainThread]: On master: COMMIT
[0m16:30:41.857992 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:41.859025 [debug] [MainThread]: On master: COMMIT
[0m16:30:41.860457 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:30:41.861532 [debug] [MainThread]: On master: Close
[0m16:30:41.862928 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:30:41.864020 [info ] [MainThread]: 
[0m16:30:41.868845 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_business_area
[0m16:30:41.870116 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_business_area ............................... [RUN]
[0m16:30:41.871779 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_business_area'
[0m16:30:41.873268 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_business_area
[0m16:30:41.878364 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_business_area"
[0m16:30:41.886523 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (compile): 2024-09-01 16:30:41.874447 => 2024-09-01 16:30:41.886391
[0m16:30:41.887416 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_business_area
[0m16:30:41.942014 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_business_area"
[0m16:30:41.950660 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:30:41.951487 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: BEGIN
[0m16:30:41.952217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:30:41.959642 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:30:41.961102 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:30:41.962185 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */

  create view "postgres"."dbt"."cv_business_area__dbt_tmp" as (
    select
    1 as id,
    'ФЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'C2C' as business_area_name
UNION
    2 as id,
    'ФЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'C2B' as business_area_name
UNION
    3 as id,
    'ЮЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'B2B' as business_area_name
UNION
    4 as id,
    'ЮЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'B2C' as business_area_name
  );
[0m16:30:41.963647 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "2"
LINE 10:     2 as id,
             ^

[0m16:30:41.964943 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: ROLLBACK
[0m16:30:41.966433 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (execute): 2024-09-01 16:30:41.888061 => 2024-09-01 16:30:41.966324
[0m16:30:41.967564 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: Close
[0m16:30:41.970402 [debug] [Thread-1  ]: Database Error in model cv_business_area (models/cdm/cv_business_area.sql)
  syntax error at or near "2"
  LINE 10:     2 as id,
               ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_business_area.sql
[0m16:30:41.971769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86a38be-4abb-4c62-b4ac-cd5298eec3e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa257252be0>]}
[0m16:30:41.972955 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model dbt.cv_business_area ...................... [[31mERROR[0m in 0.10s]
[0m16:30:41.975845 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_business_area
[0m16:30:41.977547 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_attributes
[0m16:30:41.978615 [info ] [Thread-1  ]: 2 of 2 SKIP relation dbt.cv_order_attributes ................................... [[33mSKIP[0m]
[0m16:30:41.979961 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_attributes
[0m16:30:41.982525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:30:41.983656 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:41.984544 [debug] [MainThread]: On master: BEGIN
[0m16:30:41.985404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:41.992814 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:30:41.994251 [debug] [MainThread]: On master: COMMIT
[0m16:30:41.995636 [debug] [MainThread]: Using postgres connection "master"
[0m16:30:41.996851 [debug] [MainThread]: On master: COMMIT
[0m16:30:41.998220 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:30:41.999227 [debug] [MainThread]: On master: Close
[0m16:30:42.000935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:42.001880 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_business_area' was properly closed.
[0m16:30:42.002874 [info ] [MainThread]: 
[0m16:30:42.003967 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:30:42.005379 [debug] [MainThread]: Command end result
[0m16:30:42.038183 [info ] [MainThread]: 
[0m16:30:42.039315 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:30:42.040562 [info ] [MainThread]: 
[0m16:30:42.041800 [error] [MainThread]: [33mDatabase Error in model cv_business_area (models/cdm/cv_business_area.sql)[0m
[0m16:30:42.043274 [error] [MainThread]:   syntax error at or near "2"
[0m16:30:42.044618 [error] [MainThread]:   LINE 10:     2 as id,
[0m16:30:42.045751 [error] [MainThread]:                ^
[0m16:30:42.047135 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_business_area.sql
[0m16:30:42.048454 [info ] [MainThread]: 
[0m16:30:42.049766 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:30:42.051234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa259fe0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2587c1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa25873af10>]}
[0m16:30:42.052385 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:31:10.112620 | dc35c431-d14f-4ef3-9bc5-37e957ab89cf ==============================
[0m16:31:10.112620 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:31:10.115542 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:31:10.116658 [debug] [MainThread]: Tracking: tracking
[0m16:31:10.121782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe801520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe801130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe801a30>]}
[0m16:31:13.202108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:13.203898 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:31:13.230456 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m16:31:13.288259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc35c431-d14f-4ef3-9bc5-37e957ab89cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe73b0d0>]}
[0m16:31:13.336680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc35c431-d14f-4ef3-9bc5-37e957ab89cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe3cf850>]}
[0m16:31:13.337948 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:31:13.339210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc35c431-d14f-4ef3-9bc5-37e957ab89cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe7edb20>]}
[0m16:31:13.346409 [info ] [MainThread]: 
[0m16:31:13.349631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:13.352165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:31:13.369042 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:31:13.370395 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:31:13.371627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:13.380535 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:31:13.383388 [debug] [ThreadPool]: On list_postgres: Close
[0m16:31:13.394002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:31:13.403196 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:31:13.404302 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:31:13.405409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:13.413285 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:31:13.414650 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:31:13.415828 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:31:13.419642 [debug] [ThreadPool]: SQL status: SELECT 116 in 0 seconds
[0m16:31:13.425392 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:31:13.426600 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:31:13.455103 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:13.456409 [debug] [MainThread]: On master: BEGIN
[0m16:31:13.457514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:13.465392 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:31:13.466959 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:13.468122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:13.531713 [debug] [MainThread]: SQL status: SELECT 101 in 0 seconds
[0m16:31:13.547959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc35c431-d14f-4ef3-9bc5-37e957ab89cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe2c7a60>]}
[0m16:31:13.549220 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:13.550418 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:13.551442 [debug] [MainThread]: On master: BEGIN
[0m16:31:13.552845 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:31:13.554231 [debug] [MainThread]: On master: COMMIT
[0m16:31:13.555240 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:13.556238 [debug] [MainThread]: On master: COMMIT
[0m16:31:13.557313 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:31:13.558189 [debug] [MainThread]: On master: Close
[0m16:31:13.559595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:13.560719 [info ] [MainThread]: 
[0m16:31:13.565141 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_business_area
[0m16:31:13.566432 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_business_area ............................... [RUN]
[0m16:31:13.568018 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_business_area'
[0m16:31:13.568941 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_business_area
[0m16:31:13.573448 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_business_area"
[0m16:31:13.580941 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (compile): 2024-09-01 16:31:13.569637 => 2024-09-01 16:31:13.580831
[0m16:31:13.581739 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_business_area
[0m16:31:13.637882 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_business_area"
[0m16:31:13.646001 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:13.646748 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: BEGIN
[0m16:31:13.647405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:13.655107 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:31:13.656471 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:13.657747 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */

  create view "postgres"."dbt"."cv_business_area__dbt_tmp" as (
    select
    1 as id,
    'ФЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'C2C' as business_area_name
UNION
select
    2 as id,
    'ФЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'C2B' as business_area_name
UNION
select
    3 as id,
    'ЮЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'B2B' as business_area_name
UNION
select
    4 as id,
    'ЮЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'B2C' as business_area_name
  );
[0m16:31:13.660850 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:31:13.671190 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:13.672523 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area__dbt_tmp" rename to "cv_business_area"
[0m16:31:13.673947 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:31:13.696140 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:31:13.697344 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:13.698548 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:31:13.701535 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:31:13.709290 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:13.710445 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
drop view if exists "postgres"."dbt"."cv_business_area__dbt_backup" cascade
[0m16:31:13.712025 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:31:13.714576 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (execute): 2024-09-01 16:31:13.582329 => 2024-09-01 16:31:13.714515
[0m16:31:13.715731 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: Close
[0m16:31:13.717306 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc35c431-d14f-4ef3-9bc5-37e957ab89cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fd0873d0>]}
[0m16:31:13.718700 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.cv_business_area .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:31:13.721700 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_business_area
[0m16:31:13.723726 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:13.724686 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.cv_order_attributes ............................ [RUN]
[0m16:31:13.726260 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_attributes'
[0m16:31:13.727241 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:13.735890 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:13.742669 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (compile): 2024-09-01 16:31:13.728010 => 2024-09-01 16:31:13.742456
[0m16:31:13.743755 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:13.757636 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:13.764858 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:13.765568 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: BEGIN
[0m16:31:13.766191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:13.773643 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:31:13.774901 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:13.776169 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_attributes"} */

  create view "postgres"."dbt"."cv_order_attributes__dbt_tmp" as (
    with ords as
(
SELECT
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    SUM(cg.count) as good_count,
    SUM(cg.full_good_cost) as full_good_cost,
    SUM(cg.full_good_cost_rur) as full_good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
group by
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    cg.delivery_warehouse_pk
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    ords.good_count,
    ords.full_good_cost,
    ords.full_good_cost_rur,
    ords.delivery_warehouse_pk,
    ls.WAREHOUSE_PK as current_warehouse_pk,
    ls.ORDER_STATUS_PK as current_status_pk,
    so.weight as order_weight,
    so.length * so.height * so.width as order_volume,
    oc.payer_city_pk,
    cop.is_valid as is_payer_address_valid,
    oc.payer_client_type_pk,
    oc.sender_city_pk,
    oc.receiver_city_pk,
    case
        when oc.is_sender_address_valid is false or oc.is_receiver_address_valid is false then TRUE
        else FALSE
    end as has_problem_address,
    ba.id as business_area_id
from ords
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order" AS so on ords.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_order_clients_info" AS oc on oc.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_business_area" AS ba on ba.receiver_type_name = oc.sender_client_type_name
    and ba.receiver_type_name = oc.receiver_client_type_name
  );
[0m16:31:13.779225 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "cop"
LINE 37:     cop.is_valid as is_payer_address_valid,
             ^

[0m16:31:13.780688 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: ROLLBACK
[0m16:31:13.782139 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (execute): 2024-09-01 16:31:13.744725 => 2024-09-01 16:31:13.782051
[0m16:31:13.783430 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: Close
[0m16:31:13.786804 [debug] [Thread-1  ]: Database Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)
  missing FROM-clause entry for table "cop"
  LINE 37:     cop.is_valid as is_payer_address_valid,
               ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:31:13.787996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc35c431-d14f-4ef3-9bc5-37e957ab89cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fd0870d0>]}
[0m16:31:13.789161 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbt.cv_order_attributes ................... [[31mERROR[0m in 0.06s]
[0m16:31:13.790433 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:13.793422 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:13.794625 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:13.795616 [debug] [MainThread]: On master: BEGIN
[0m16:31:13.796419 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:13.803963 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:31:13.805586 [debug] [MainThread]: On master: COMMIT
[0m16:31:13.806832 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:13.808098 [debug] [MainThread]: On master: COMMIT
[0m16:31:13.809524 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:31:13.810629 [debug] [MainThread]: On master: Close
[0m16:31:13.812220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:13.813255 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_order_attributes' was properly closed.
[0m16:31:13.814335 [info ] [MainThread]: 
[0m16:31:13.815549 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m16:31:13.817020 [debug] [MainThread]: Command end result
[0m16:31:13.886015 [info ] [MainThread]: 
[0m16:31:13.887209 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:31:13.888335 [info ] [MainThread]: 
[0m16:31:13.889575 [error] [MainThread]: [33mDatabase Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)[0m
[0m16:31:13.890913 [error] [MainThread]:   missing FROM-clause entry for table "cop"
[0m16:31:13.892222 [error] [MainThread]:   LINE 37:     cop.is_valid as is_payer_address_valid,
[0m16:31:13.893575 [error] [MainThread]:                ^
[0m16:31:13.894588 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:31:13.895965 [info ] [MainThread]: 
[0m16:31:13.897290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:31:13.898537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4401014c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fe846a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44017360a0>]}
[0m16:31:13.899735 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:31:47.521339 | 73a32a39-7215-4a30-9f0b-d943a27bde80 ==============================
[0m16:31:47.521339 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:31:47.524456 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:31:47.525680 [debug] [MainThread]: Tracking: tracking
[0m16:31:47.530897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4575f0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4575f0130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4575f0a30>]}
[0m16:31:50.870717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:31:50.872575 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:31:50.902028 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:31:50.963020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73a32a39-7215-4a30-9f0b-d943a27bde80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4575240d0>]}
[0m16:31:51.013864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73a32a39-7215-4a30-9f0b-d943a27bde80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4571bba30>]}
[0m16:31:51.015070 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:31:51.016351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a32a39-7215-4a30-9f0b-d943a27bde80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4575d75e0>]}
[0m16:31:51.023822 [info ] [MainThread]: 
[0m16:31:51.027793 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:51.029973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:31:51.048174 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:31:51.049093 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:31:51.049869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:51.060711 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:31:51.063255 [debug] [ThreadPool]: On list_postgres: Close
[0m16:31:51.075766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:31:51.088581 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:31:51.089804 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:31:51.090776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:51.098932 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:31:51.100551 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:31:51.101849 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:31:51.105587 [debug] [ThreadPool]: SQL status: SELECT 117 in 0 seconds
[0m16:31:51.112106 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:31:51.113763 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:31:51.147919 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:51.149193 [debug] [MainThread]: On master: BEGIN
[0m16:31:51.150220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:51.161518 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:31:51.163090 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:51.164373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:51.232659 [debug] [MainThread]: SQL status: SELECT 101 in 0 seconds
[0m16:31:51.248650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a32a39-7215-4a30-9f0b-d943a27bde80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4570b4c40>]}
[0m16:31:51.249677 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:51.250583 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:51.251463 [debug] [MainThread]: On master: BEGIN
[0m16:31:51.252438 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:31:51.253528 [debug] [MainThread]: On master: COMMIT
[0m16:31:51.254526 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:51.255464 [debug] [MainThread]: On master: COMMIT
[0m16:31:51.256608 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:31:51.257681 [debug] [MainThread]: On master: Close
[0m16:31:51.259102 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:51.260072 [info ] [MainThread]: 
[0m16:31:51.264144 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_business_area
[0m16:31:51.265276 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_business_area ............................... [RUN]
[0m16:31:51.266793 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_business_area'
[0m16:31:51.267694 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_business_area
[0m16:31:51.272693 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.280161 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (compile): 2024-09-01 16:31:51.268505 => 2024-09-01 16:31:51.280045
[0m16:31:51.281003 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_business_area
[0m16:31:51.335807 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.344296 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.345015 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: BEGIN
[0m16:31:51.345635 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:51.352750 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:31:51.354151 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.355278 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */

  create view "postgres"."dbt"."cv_business_area__dbt_tmp" as (
    select
    1 as id,
    'ФЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'C2C' as business_area_name
UNION
select
    2 as id,
    'ФЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'C2B' as business_area_name
UNION
select
    3 as id,
    'ЮЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'B2B' as business_area_name
UNION
select
    4 as id,
    'ЮЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'B2C' as business_area_name
  );
[0m16:31:51.358198 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:31:51.367968 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.369141 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area" rename to "cv_business_area__dbt_backup"
[0m16:31:51.370698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:31:51.375800 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.376928 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area__dbt_tmp" rename to "cv_business_area"
[0m16:31:51.378430 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:31:51.404894 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:31:51.406171 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.407174 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:31:51.410966 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:31:51.420965 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:31:51.422191 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
drop view if exists "postgres"."dbt"."cv_business_area__dbt_backup" cascade
[0m16:31:51.425676 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:31:51.428017 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (execute): 2024-09-01 16:31:51.281681 => 2024-09-01 16:31:51.427953
[0m16:31:51.429152 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: Close
[0m16:31:51.430659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a32a39-7215-4a30-9f0b-d943a27bde80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc455e74580>]}
[0m16:31:51.431965 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.cv_business_area .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:31:51.435477 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_business_area
[0m16:31:51.437336 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:51.438629 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.cv_order_attributes ............................ [RUN]
[0m16:31:51.440100 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_attributes'
[0m16:31:51.440959 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:51.447981 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:51.455882 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (compile): 2024-09-01 16:31:51.441737 => 2024-09-01 16:31:51.455779
[0m16:31:51.456852 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:51.468227 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:51.476859 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:51.477607 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: BEGIN
[0m16:31:51.478276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:31:51.485566 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:31:51.487288 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:31:51.488480 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_attributes"} */

  create view "postgres"."dbt"."cv_order_attributes__dbt_tmp" as (
    with ords as
(
SELECT
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    SUM(cg.count) as good_count,
    SUM(cg.full_good_cost) as full_good_cost,
    SUM(cg.full_good_cost_rur) as full_good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
group by
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    cg.delivery_warehouse_pk
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    ords.good_count,
    ords.full_good_cost,
    ords.full_good_cost_rur,
    ords.delivery_warehouse_pk,
    ls.WAREHOUSE_PK as current_warehouse_pk,
    ls.ORDER_STATUS_PK as current_status_pk,
    so.weight as order_weight,
    so.length * so.height * so.width as order_volume,
    oc.payer_city_pk,
    oc.payer_client_type_pk,
    oc.sender_city_pk,
    oc.receiver_city_pk,
    case
        when oc.is_sender_address_valid is false or oc.is_receiver_address_valid is false then TRUE
        else FALSE
    end as has_problem_address,
    ba.id as business_area_id
from ords
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order" AS so on ords.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_order_clients_info" AS oc on oc.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_business_area" AS ba on ba.receiver_type_name = oc.sender_client_type_name
    and ba.receiver_type_name = oc.receiver_client_type_name
  );
[0m16:31:51.491703 [debug] [Thread-1  ]: Postgres adapter: Postgres error: argument of IS FALSE must be type boolean, not type text
LINE 41:         when oc.is_sender_address_valid is false or oc.is_re...
                      ^

[0m16:31:51.496403 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: ROLLBACK
[0m16:31:51.498203 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (execute): 2024-09-01 16:31:51.457624 => 2024-09-01 16:31:51.498117
[0m16:31:51.499294 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: Close
[0m16:31:51.502276 [debug] [Thread-1  ]: Database Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)
  argument of IS FALSE must be type boolean, not type text
  LINE 41:         when oc.is_sender_address_valid is false or oc.is_re...
                        ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:31:51.503569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a32a39-7215-4a30-9f0b-d943a27bde80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45604e220>]}
[0m16:31:51.504808 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbt.cv_order_attributes ................... [[31mERROR[0m in 0.06s]
[0m16:31:51.506436 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_attributes
[0m16:31:51.508956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:51.510057 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:51.510982 [debug] [MainThread]: On master: BEGIN
[0m16:31:51.512047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:51.519526 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:31:51.521121 [debug] [MainThread]: On master: COMMIT
[0m16:31:51.522365 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:51.523529 [debug] [MainThread]: On master: COMMIT
[0m16:31:51.524834 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:31:51.525853 [debug] [MainThread]: On master: Close
[0m16:31:51.527540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:51.528294 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_order_attributes' was properly closed.
[0m16:31:51.529040 [info ] [MainThread]: 
[0m16:31:51.529964 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m16:31:51.531234 [debug] [MainThread]: Command end result
[0m16:31:51.599519 [info ] [MainThread]: 
[0m16:31:51.600621 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:31:51.602062 [info ] [MainThread]: 
[0m16:31:51.603498 [error] [MainThread]: [33mDatabase Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)[0m
[0m16:31:51.604717 [error] [MainThread]:   argument of IS FALSE must be type boolean, not type text
[0m16:31:51.605923 [error] [MainThread]:   LINE 41:         when oc.is_sender_address_valid is false or oc.is_re...
[0m16:31:51.606983 [error] [MainThread]:                         ^
[0m16:31:51.608074 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:31:51.609285 [info ] [MainThread]: 
[0m16:31:51.610828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:31:51.612247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45944eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4575bb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4575bb8b0>]}
[0m16:31:51.613449 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:34:36.821585 | 51881ff9-38a0-487c-a662-b8353928d969 ==============================
[0m16:34:36.821585 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:34:36.824730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:34:36.826068 [debug] [MainThread]: Tracking: tracking
[0m16:34:36.831089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f1996d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f199f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f1997f0>]}
[0m16:34:40.222809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:40.224280 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/business_vault/cv_order_clients_info.sql
[0m16:34:40.252798 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_clients_info.sql
[0m16:34:40.312478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f0460d0>]}
[0m16:34:40.362854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535ed714c0>]}
[0m16:34:40.363981 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:34:40.365078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f191e20>]}
[0m16:34:40.372393 [info ] [MainThread]: 
[0m16:34:40.376178 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:40.379414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:34:40.396232 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:34:40.397770 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:34:40.399240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:40.408456 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:34:40.411420 [debug] [ThreadPool]: On list_postgres: Close
[0m16:34:40.422528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:34:40.432251 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:34:40.433535 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:34:40.434639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:40.443224 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:34:40.444760 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:34:40.445889 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:34:40.449553 [debug] [ThreadPool]: SQL status: SELECT 111 in 0 seconds
[0m16:34:40.455526 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:34:40.456917 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:34:40.485247 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:40.486469 [debug] [MainThread]: On master: BEGIN
[0m16:34:40.487414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:40.495615 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:34:40.496994 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:40.498308 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:40.559751 [debug] [MainThread]: SQL status: SELECT 84 in 0 seconds
[0m16:34:40.573679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f1975b0>]}
[0m16:34:40.574800 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:40.575888 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:40.576896 [debug] [MainThread]: On master: BEGIN
[0m16:34:40.578227 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:34:40.579300 [debug] [MainThread]: On master: COMMIT
[0m16:34:40.580381 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:40.581282 [debug] [MainThread]: On master: COMMIT
[0m16:34:40.582509 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:34:40.583353 [debug] [MainThread]: On master: Close
[0m16:34:40.584711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:40.585778 [info ] [MainThread]: 
[0m16:34:40.590804 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.as_of_date
[0m16:34:40.592318 [info ] [Thread-1  ]: 1 of 10 START sql table model dbt.as_of_date ................................... [RUN]
[0m16:34:40.594144 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.as_of_date'
[0m16:34:40.595334 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.as_of_date
[0m16:34:40.632523 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.633876 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: BEGIN
[0m16:34:40.635014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:34:40.642863 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:34:40.644448 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.645539 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */


        select 
        ((TO_DATE('2024-10-01', 'yyyy-mm-dd'))::date - (TO_DATE('2023-12-01', 'yyyy-mm-dd'))::date)
    
[0m16:34:40.647324 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m16:34:40.665737 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.677533 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (compile): 2024-09-01 16:34:40.596282 => 2024-09-01 16:34:40.677398
[0m16:34:40.678702 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.as_of_date
[0m16:34:40.737417 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.746449 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.747289 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */

  
    

  create  table "postgres"."dbt"."as_of_date__dbt_tmp"
  as (
    WITH as_of_date AS (
 





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 305
    order by generated_number



),

all_periods as (

    select (
        

    TO_DATE('2023-12-01', 'yyyy-mm-dd') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= TO_DATE('2024-10-01', 'yyyy-mm-dd')

)

select * from filtered


)
SELECT DATE_day as AS_OF_DATE FROM as_of_date
  );
  
[0m16:34:40.754465 [debug] [Thread-1  ]: SQL status: SELECT 305 in 0 seconds
[0m16:34:40.764297 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.765382 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date" rename to "as_of_date__dbt_backup"
[0m16:34:40.766723 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:34:40.772479 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.773564 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date__dbt_tmp" rename to "as_of_date"
[0m16:34:40.774794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:34:40.806481 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m16:34:40.807758 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.808981 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m16:34:40.813150 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:34:40.822249 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:34:40.823109 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
drop table if exists "postgres"."dbt"."as_of_date__dbt_backup" cascade
[0m16:34:40.826115 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:34:40.828309 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (execute): 2024-09-01 16:34:40.679390 => 2024-09-01 16:34:40.828243
[0m16:34:40.829189 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: Close
[0m16:34:40.830646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f197370>]}
[0m16:34:40.832065 [info ] [Thread-1  ]: 1 of 10 OK created sql table model dbt.as_of_date .............................. [[32mSELECT 305[0m in 0.24s]
[0m16:34:40.835050 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.as_of_date
[0m16:34:40.836370 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_city_country
[0m16:34:40.837686 [info ] [Thread-1  ]: 2 of 10 START sql view model dbt.cv_city_country ............................... [RUN]
[0m16:34:40.839575 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_city_country'
[0m16:34:40.840748 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_city_country
[0m16:34:40.847700 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_city_country"
[0m16:34:40.854525 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (compile): 2024-09-01 16:34:40.841783 => 2024-09-01 16:34:40.854407
[0m16:34:40.855611 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_city_country
[0m16:34:40.889442 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_city_country"
[0m16:34:40.896991 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:34:40.897905 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: BEGIN
[0m16:34:40.898770 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:34:40.906178 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:34:40.907602 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:34:40.908788 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */

  create view "postgres"."dbt"."cv_city_country__dbt_tmp" as (
    select
    sci.CITY_PK,
    sci.name AS city_name,
    sco.name AS country_name
FROM "postgres"."dbt"."sat_city" AS sci
LEFT JOIN "postgres"."dbt"."link_city_country" AS ccl on ccl.CITY_PK = sci.CITY_PK
LEFT JOIN "postgres"."dbt"."sat_country" AS sco ON sco.COUNTRY_PK = ccl.COUNTRY_PK
  );
[0m16:34:40.912037 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:34:40.918523 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:34:40.919571 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country__dbt_tmp" rename to "cv_city_country"
[0m16:34:40.920914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:34:40.923757 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m16:34:40.925014 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:34:40.926099 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m16:34:40.930722 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:34:40.976684 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:34:40.977919 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
drop view if exists "postgres"."dbt"."cv_city_country__dbt_backup" cascade
[0m16:34:40.979327 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:34:40.981592 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (execute): 2024-09-01 16:34:40.856272 => 2024-09-01 16:34:40.981527
[0m16:34:40.982698 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: Close
[0m16:34:40.984485 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535dd58550>]}
[0m16:34:40.986162 [info ] [Thread-1  ]: 2 of 10 OK created sql view model dbt.cv_city_country .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:34:40.987826 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_city_country
[0m16:34:40.989456 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_date
[0m16:34:40.990715 [info ] [Thread-1  ]: 3 of 10 START sql view model dbt.cv_date ....................................... [RUN]
[0m16:34:40.992707 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_date'
[0m16:34:40.994305 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_date
[0m16:34:40.999307 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_date"
[0m16:34:41.007264 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (compile): 2024-09-01 16:34:40.995423 => 2024-09-01 16:34:41.007146
[0m16:34:41.008185 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_date
[0m16:34:41.019230 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_date"
[0m16:34:41.026814 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:34:41.027719 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: BEGIN
[0m16:34:41.028559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:34:41.036031 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:34:41.037573 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:34:41.038744 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */

  create view "postgres"."dbt"."cv_date__dbt_tmp" as (
    WITH
RECURSIVE dates AS (
    SELECT
        '2023-12-01'::TIMESTAMP AS date_value
    UNION
    SELECT
        date_value + INTERVAL '1' DAY AS date_value
    FROM dates
    WHERE date_value <= '2024-10-01'
)
select date_value from dates
  );
[0m16:34:41.041843 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:34:41.048038 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:34:41.049339 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date__dbt_tmp" rename to "cv_date"
[0m16:34:41.050784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:34:41.053671 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m16:34:41.055007 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:34:41.055991 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m16:34:41.073471 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:34:41.078328 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:34:41.079787 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
drop view if exists "postgres"."dbt"."cv_date__dbt_backup" cascade
[0m16:34:41.081261 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:34:41.083537 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (execute): 2024-09-01 16:34:41.008864 => 2024-09-01 16:34:41.083478
[0m16:34:41.084631 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: Close
[0m16:34:41.086218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535dd58880>]}
[0m16:34:41.087648 [info ] [Thread-1  ]: 3 of 10 OK created sql view model dbt.cv_date .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m16:34:41.089078 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_date
[0m16:34:41.090388 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status
[0m16:34:41.091647 [info ] [Thread-1  ]: 4 of 10 START sql view model dbt.cv_last_order_status .......................... [RUN]
[0m16:34:41.093410 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status'
[0m16:34:41.094687 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status
[0m16:34:41.102783 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status"
[0m16:34:41.111507 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (compile): 2024-09-01 16:34:41.095773 => 2024-09-01 16:34:41.111362
[0m16:34:41.112583 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status
[0m16:34:41.123692 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status"
[0m16:34:41.132729 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:34:41.133510 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: BEGIN
[0m16:34:41.134166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:34:41.141646 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:34:41.143244 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:34:41.144555 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */

  create view "postgres"."dbt"."cv_last_order_status__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd hh24:mi') as status_datetime,
        row_number() over (partition by lo.ORDER_PK order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    os.ORDER_PK,
	os.status_datetime,
    loo.ORDER_STATUS_PK,
    lw.WAREHOUSE_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_order_status_order_status_history" AS loo on loo.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m16:34:41.147652 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:34:41.154152 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:34:41.155411 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status__dbt_tmp" rename to "cv_last_order_status"
[0m16:34:41.156919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:34:41.159742 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m16:34:41.160892 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:34:41.161888 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m16:34:41.164528 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:34:41.169359 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:34:41.170520 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
drop view if exists "postgres"."dbt"."cv_last_order_status__dbt_backup" cascade
[0m16:34:41.171869 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:34:41.174058 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (execute): 2024-09-01 16:34:41.113298 => 2024-09-01 16:34:41.173997
[0m16:34:41.175041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: Close
[0m16:34:41.176727 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535ee413d0>]}
[0m16:34:41.178240 [info ] [Thread-1  ]: 4 of 10 OK created sql view model dbt.cv_last_order_status ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:34:41.179940 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status
[0m16:34:41.181283 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_payer
[0m16:34:41.182690 [info ] [Thread-1  ]: 5 of 10 START sql view model dbt.cv_order_payer ................................ [RUN]
[0m16:34:41.184752 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_payer'
[0m16:34:41.186307 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_payer
[0m16:34:41.195238 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_payer"
[0m16:34:41.205388 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (compile): 2024-09-01 16:34:41.187775 => 2024-09-01 16:34:41.205151
[0m16:34:41.206752 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_payer
[0m16:34:41.224306 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_payer"
[0m16:34:41.233107 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:34:41.234023 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: BEGIN
[0m16:34:41.234792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:34:41.242684 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:34:41.244168 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:34:41.245393 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */

  create view "postgres"."dbt"."cv_order_payer__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'payer'
  );
[0m16:34:41.249123 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:34:41.256036 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:34:41.257399 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
alter table "postgres"."dbt"."cv_order_payer" rename to "cv_order_payer__dbt_backup"
[0m16:35:14.712740 [debug] [Thread-1  ]: Postgres adapter: Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m16:35:14.713957 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: ROLLBACK
[0m16:35:14.715601 [debug] [Thread-1  ]: Failed to rollback 'model.otus_project_dbtvault.cv_order_payer'
[0m16:35:14.716746 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m16:35:14.717987 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m16:35:14.718911 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (execute): 2024-09-01 16:34:41.207917 => 2024-09-01 16:35:14.718803
[0m16:35:14.719745 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: Close
[0m16:35:14.722555 [debug] [Thread-1  ]: Database Error in model cv_order_payer (models/business_vault/cv_order_payer.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_order_payer.sql
[0m16:35:14.723963 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535dc20880>]}
[0m16:35:14.725317 [error] [Thread-1  ]: 5 of 10 ERROR creating sql view model dbt.cv_order_payer ....................... [[31mERROR[0m in 33.54s]
[0m16:35:14.726713 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_payer
[0m16:35:14.728065 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_receiver
[0m16:35:14.729011 [info ] [Thread-1  ]: 6 of 10 START sql view model dbt.cv_order_receiver ............................. [RUN]
[0m16:35:14.730490 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_receiver'
[0m16:35:14.731696 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_receiver
[0m16:35:14.740027 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_receiver"
[0m16:35:14.746898 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (compile): 2024-09-01 16:35:14.732648 => 2024-09-01 16:35:14.746780
[0m16:35:14.748025 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_receiver
[0m16:35:14.759961 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_receiver"
[0m16:35:14.767905 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:35:14.770826 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: BEGIN
[0m16:35:14.772020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:35:14.784775 [debug] [Thread-1  ]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.3), port 5432 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m16:35:14.787107 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: BEGIN
[0m16:35:14.788380 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m16:35:14.790029 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (execute): 2024-09-01 16:35:14.748919 => 2024-09-01 16:35:14.789856
[0m16:35:14.791372 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: No close available on handle
[0m16:35:14.794849 [debug] [Thread-1  ]: Database Error in model cv_order_receiver (models/business_vault/cv_order_receiver.sql)
  connection to server at "postgres" (172.19.0.3), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
  compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_order_receiver.sql
[0m16:35:14.796539 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f08b1f0>]}
[0m16:35:14.798193 [error] [Thread-1  ]: 6 of 10 ERROR creating sql view model dbt.cv_order_receiver .................... [[31mERROR[0m in 0.07s]
[0m16:35:14.800241 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_receiver
[0m16:35:14.801796 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_sender
[0m16:35:14.803195 [info ] [Thread-1  ]: 7 of 10 START sql view model dbt.cv_order_sender ............................... [RUN]
[0m16:35:14.805025 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_sender'
[0m16:35:14.806336 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_sender
[0m16:35:14.817931 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:14.828723 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (compile): 2024-09-01 16:35:14.807613 => 2024-09-01 16:35:14.828602
[0m16:35:14.829598 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_sender
[0m16:35:14.843199 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:14.850502 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:14.851424 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: BEGIN
[0m16:35:14.852191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:35:15.932524 [debug] [Thread-1  ]: SQL status: BEGIN in 1 seconds
[0m16:35:15.933731 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:15.934589 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */

  create view "postgres"."dbt"."cv_order_sender__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'sender'
  );
[0m16:35:15.938225 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:35:15.945641 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:15.946686 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender" rename to "cv_order_sender__dbt_backup"
[0m16:35:15.948172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:35:15.953342 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:15.954216 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender__dbt_tmp" rename to "cv_order_sender"
[0m16:35:15.955466 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:35:15.958561 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m16:35:15.959553 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:15.960331 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m16:35:15.964134 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:35:15.969240 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:35:15.970300 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
drop view if exists "postgres"."dbt"."cv_order_sender__dbt_backup" cascade
[0m16:35:15.974067 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:35:15.976187 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (execute): 2024-09-01 16:35:14.830251 => 2024-09-01 16:35:15.976125
[0m16:35:15.976947 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: Close
[0m16:35:15.978349 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535dd09c70>]}
[0m16:35:15.979538 [info ] [Thread-1  ]: 7 of 10 OK created sql view model dbt.cv_order_sender .......................... [[32mCREATE VIEW[0m in 1.17s]
[0m16:35:15.980961 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_sender
[0m16:35:15.982215 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:35:15.983587 [info ] [Thread-1  ]: 8 of 10 START sql view model dbt.cv_currency_rate_by_date ...................... [RUN]
[0m16:35:15.985293 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_currency_rate_by_date'
[0m16:35:15.986258 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:35:15.992804 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:35:15.998977 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (compile): 2024-09-01 16:35:15.986992 => 2024-09-01 16:35:15.998856
[0m16:35:15.999942 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:35:16.012814 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:35:16.021330 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:35:16.022436 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: BEGIN
[0m16:35:16.023406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:35:16.037434 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:35:16.038620 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:35:16.039620 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */

  create view "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" as (
    SELECT
    q.CURRENCY_PK,
    q.relation_to_rur,
    d.as_of_date AS date_value
FROM (
    SELECT
        ccr.CURRENCY_PK, cr.relation_to_rur, cr.date_start,
        LAG(cr.date_start) OVER (PARTITION BY ccr.CURRENCY_PK ORDER BY cr.date_start DESC) AS date_end
    FROM "postgres"."dbt"."sat_currency_rate" cr
	LEFT JOIN "postgres"."dbt"."link_currency_currency_rate" ccr ON ccr.CURRENCY_RATE_PK = cr.CURRENCY_RATE_PK
	)q, "postgres"."dbt"."as_of_date" d
    WHERE d.as_of_date >= COALESCE(q.date_start, '2023-12-01') AND d.as_of_date < COALESCE(q.date_end, '2024-10-01')
  );
[0m16:35:16.043026 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:35:16.053090 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:35:16.054294 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
alter table "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" rename to "cv_currency_rate_by_date"
[0m16:35:16.055986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:35:16.059813 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m16:35:16.060975 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:35:16.061838 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m16:35:16.064159 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:35:16.068692 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:35:16.069614 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
drop view if exists "postgres"."dbt"."cv_currency_rate_by_date__dbt_backup" cascade
[0m16:35:16.070842 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:35:16.073171 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (execute): 2024-09-01 16:35:16.000941 => 2024-09-01 16:35:16.073103
[0m16:35:16.074388 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: Close
[0m16:35:16.076241 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f08b1f0>]}
[0m16:35:16.077556 [info ] [Thread-1  ]: 8 of 10 OK created sql view model dbt.cv_currency_rate_by_date ................. [[32mCREATE VIEW[0m in 0.09s]
[0m16:35:16.078915 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:35:16.080138 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_clients_info
[0m16:35:16.081662 [info ] [Thread-1  ]: 9 of 10 SKIP relation dbt.cv_order_clients_info ................................ [[33mSKIP[0m]
[0m16:35:16.083155 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_clients_info
[0m16:35:16.084319 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_goods
[0m16:35:16.085421 [info ] [Thread-1  ]: 10 of 10 START sql view model dbt.cv_goods ..................................... [RUN]
[0m16:35:16.087239 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_goods'
[0m16:35:16.088334 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_goods
[0m16:35:16.096354 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_goods"
[0m16:35:16.103078 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (compile): 2024-09-01 16:35:16.089193 => 2024-09-01 16:35:16.102883
[0m16:35:16.104209 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_goods
[0m16:35:16.120111 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_goods"
[0m16:35:16.127851 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:35:16.128726 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: BEGIN
[0m16:35:16.129462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:35:16.137465 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:35:16.138636 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:35:16.139455 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */

  create view "postgres"."dbt"."cv_goods__dbt_tmp" as (
    with ords as (
SELECT
    so.ORDER_PK,
    so.order_date,
    case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.status_datetime
        else null
    end as delivery_date,
        case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.WAREHOUSE_PK
        else null
    end as delivery_warehouse_pk,
    oc.CURRENCY_PK
FROM "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order_status" AS os on os.ORDER_STATUS_PK = ls.ORDER_STATUS_PK
LEFT JOIN "postgres"."dbt"."link_order_currency" AS oc on oc.ORDER_PK = so.ORDER_PK
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    sg.GOOD_PK,
    sg.count,
    sg.cost_per_unit,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) as cost_per_unit_rur,
    sg.cost_per_unit * sg.count as full_good_cost,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) * sg.count as full_good_cost_rur,
    ords.delivery_warehouse_pk
from ords
LEFT JOIN "postgres"."dbt"."link_order_goods" AS og on og.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_good" AS sg on sg.GOOD_PK = og.GOOD_PK
LEFT JOIN "postgres"."dbt"."cv_currency_rate_by_date" AS crr on crr.CURRENCY_PK = ords.CURRENCY_PK
    and crr.date_value = COALESCE(ords.delivery_date, ords.order_date)
  );
[0m16:35:16.145256 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:35:16.154948 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:35:16.155858 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
alter table "postgres"."dbt"."cv_goods__dbt_tmp" rename to "cv_goods"
[0m16:35:16.157055 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:35:16.159604 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:35:16.160326 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:35:16.160924 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:35:16.163515 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:35:16.169536 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:35:16.170404 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
drop view if exists "postgres"."dbt"."cv_goods__dbt_backup" cascade
[0m16:35:16.171365 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:35:16.173142 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (execute): 2024-09-01 16:35:16.105092 => 2024-09-01 16:35:16.173084
[0m16:35:16.173799 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: Close
[0m16:35:16.174942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51881ff9-38a0-487c-a662-b8353928d969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535ddb3670>]}
[0m16:35:16.175959 [info ] [Thread-1  ]: 10 of 10 OK created sql view model dbt.cv_goods ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m16:35:16.176920 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_goods
[0m16:35:16.179517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:35:16.180541 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:16.181266 [debug] [MainThread]: On master: BEGIN
[0m16:35:16.181905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:16.189150 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:35:16.190136 [debug] [MainThread]: On master: COMMIT
[0m16:35:16.190866 [debug] [MainThread]: Using postgres connection "master"
[0m16:35:16.191593 [debug] [MainThread]: On master: COMMIT
[0m16:35:16.192392 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:35:16.193062 [debug] [MainThread]: On master: Close
[0m16:35:16.194194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:16.195047 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_goods' was properly closed.
[0m16:35:16.195977 [info ] [MainThread]: 
[0m16:35:16.196821 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 35.82 seconds (35.82s).
[0m16:35:16.198293 [debug] [MainThread]: Command end result
[0m16:35:16.230106 [info ] [MainThread]: 
[0m16:35:16.231339 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:35:16.232449 [info ] [MainThread]: 
[0m16:35:16.233724 [error] [MainThread]: [33mDatabase Error in model cv_order_payer (models/business_vault/cv_order_payer.sql)[0m
[0m16:35:16.234770 [error] [MainThread]:   terminating connection due to administrator command
[0m16:35:16.235878 [error] [MainThread]:   server closed the connection unexpectedly
[0m16:35:16.236913 [error] [MainThread]:   	This probably means the server terminated abnormally
[0m16:35:16.238171 [error] [MainThread]:   	before or while processing the request.
[0m16:35:16.239328 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_order_payer.sql
[0m16:35:16.240701 [info ] [MainThread]: 
[0m16:35:16.241925 [error] [MainThread]: [33mDatabase Error in model cv_order_receiver (models/business_vault/cv_order_receiver.sql)[0m
[0m16:35:16.243115 [error] [MainThread]:   connection to server at "postgres" (172.19.0.3), port 5432 failed: Connection refused
[0m16:35:16.244283 [error] [MainThread]:   	Is the server running on that host and accepting TCP/IP connections?
[0m16:35:16.245304 [error] [MainThread]:   
[0m16:35:16.246276 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/business_vault/cv_order_receiver.sql
[0m16:35:16.247349 [info ] [MainThread]: 
[0m16:35:16.248450 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=1 TOTAL=10
[0m16:35:16.249502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f191e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535dd58700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f535f0aadc0>]}
[0m16:35:16.250704 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:35:45.648681 | a7b720f6-e0a5-4848-8ba2-02ae3be11301 ==============================
[0m16:35:45.648681 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:35:45.651196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:35:45.652139 [debug] [MainThread]: Tracking: tracking
[0m16:35:45.657093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1abb9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1abb9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1abb9400>]}
[0m16:35:45.660131 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x489wole'
[0m16:35:45.661664 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:35:46.735187 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:46.736810 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m16:35:46.738360 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:35:46.739602 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:35:46.744067 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:35:46.745506 [debug] [MainThread]: STDERR: "b''"
[0m16:35:46.746541 [debug] [MainThread]:   Checking out revision master.
[0m16:35:46.747511 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:35:46.752731 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:46.754037 [debug] [MainThread]: STDERR: "b''"
[0m16:35:46.755032 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:35:48.220701 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:48.221891 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m16:35:48.222799 [debug] [MainThread]: Executing "git tag --list"
[0m16:35:48.227229 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:35:48.228569 [debug] [MainThread]: STDERR: "b''"
[0m16:35:48.229700 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:35:48.239746 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:35:48.241171 [debug] [MainThread]: STDERR: "b''"
[0m16:35:48.242400 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:35:48.247098 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:35:48.248488 [debug] [MainThread]: STDERR: "b''"
[0m16:35:48.249500 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m16:35:48.251192 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:35:48.264591 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:35:48.732832 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:35:48.734613 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:35:48.952050 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:35:49.097753 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:35:49.102612 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:49.103898 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:35:49.104751 [debug] [MainThread]: command return code=128
[0m16:35:49.106650 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:35:49.107537 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:35:49.112291 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:35:49.113593 [debug] [MainThread]: STDERR: "b''"
[0m16:35:49.114619 [debug] [MainThread]:   Checking out revision master.
[0m16:35:49.115550 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:35:49.121167 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:49.122572 [debug] [MainThread]: STDERR: "b''"
[0m16:35:49.123553 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:35:49.914578 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:49.916091 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:35:49.917113 [debug] [MainThread]: Executing "git tag --list"
[0m16:35:49.922291 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:35:49.923958 [debug] [MainThread]: STDERR: "b''"
[0m16:35:49.925004 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:35:49.932375 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:35:49.933815 [debug] [MainThread]: STDERR: "b''"
[0m16:35:49.934893 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:35:49.939932 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:35:49.941297 [debug] [MainThread]: STDERR: "b''"
[0m16:35:49.942257 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:35:49.943701 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:35:49.958278 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m16:35:50.142564 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:35:50.146672 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:50.148056 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:35:50.148917 [debug] [MainThread]: command return code=128
[0m16:35:50.150243 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:35:50.151107 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:35:50.155739 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:35:50.157295 [debug] [MainThread]: STDERR: "b''"
[0m16:35:50.158482 [debug] [MainThread]:   Checking out revision master.
[0m16:35:50.159543 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:35:50.164699 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:50.165787 [debug] [MainThread]: STDERR: "b''"
[0m16:35:50.166550 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:35:50.943906 [debug] [MainThread]: STDOUT: "b''"
[0m16:35:50.945021 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:35:50.945834 [debug] [MainThread]: Executing "git tag --list"
[0m16:35:50.951433 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:35:50.952745 [debug] [MainThread]: STDERR: "b''"
[0m16:35:50.953728 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:35:50.961269 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:35:50.962815 [debug] [MainThread]: STDERR: "b''"
[0m16:35:50.963874 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:35:50.969113 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:35:50.970456 [debug] [MainThread]: STDERR: "b''"
[0m16:35:50.971286 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:35:53.376726 [info ] [MainThread]:   Installed from revision master
[0m16:35:53.378460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a7b720f6-e0a5-4848-8ba2-02ae3be11301', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1abb51c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1b2dc760>]}
[0m16:35:53.379850 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:35:57.742207 [info ] [MainThread]:   Installed from version 1.3.0
[0m16:35:57.743701 [info ] [MainThread]:   Up to date!
[0m16:35:57.744943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a7b720f6-e0a5-4848-8ba2-02ae3be11301', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1b94ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1b2dc760>]}
[0m16:35:57.746333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1acd27f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1bc56850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a1ac487c0>]}
[0m16:35:57.747296 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:36:03.474998 | d1534ac7-abc5-44a7-aa90-1f5a3aea614c ==============================
[0m16:36:03.474998 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:36:03.478245 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:business_vault'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:36:03.479205 [debug] [MainThread]: Tracking: tracking
[0m16:36:03.485229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ec87f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ec878b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ec87e50>]}
[0m16:36:06.765059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:06.765963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:06.784742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ebf8d90>]}
[0m16:36:06.834596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e96c0d0>]}
[0m16:36:06.835642 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:36:06.836752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e96c1c0>]}
[0m16:36:06.844231 [info ] [MainThread]: 
[0m16:36:06.847933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:06.851053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:36:06.867692 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:36:06.868925 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:36:06.870100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:06.879101 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:36:06.882064 [debug] [ThreadPool]: On list_postgres: Close
[0m16:36:06.892679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:36:06.902989 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:36:06.904184 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:36:06.905091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:06.912803 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:36:06.914322 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:36:06.915589 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:36:06.919500 [debug] [ThreadPool]: SQL status: SELECT 115 in 0 seconds
[0m16:36:06.925348 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:36:06.926733 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:36:06.955344 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:06.956743 [debug] [MainThread]: On master: BEGIN
[0m16:36:06.957918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:06.966673 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:06.968121 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:06.969152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:07.032222 [debug] [MainThread]: SQL status: SELECT 96 in 0 seconds
[0m16:36:07.049011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e768cd0>]}
[0m16:36:07.050530 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:07.052396 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:07.053658 [debug] [MainThread]: On master: BEGIN
[0m16:36:07.055250 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:07.056845 [debug] [MainThread]: On master: COMMIT
[0m16:36:07.057935 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:07.058967 [debug] [MainThread]: On master: COMMIT
[0m16:36:07.060052 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:07.060873 [debug] [MainThread]: On master: Close
[0m16:36:07.062221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:07.063107 [info ] [MainThread]: 
[0m16:36:07.067378 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.as_of_date
[0m16:36:07.068466 [info ] [Thread-1  ]: 1 of 10 START sql table model dbt.as_of_date ................................... [RUN]
[0m16:36:07.069763 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.as_of_date'
[0m16:36:07.070539 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.as_of_date
[0m16:36:07.104857 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.106065 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: BEGIN
[0m16:36:07.107167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.115325 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.116865 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.118180 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */


        select 
        ((TO_DATE('2024-10-01', 'yyyy-mm-dd'))::date - (TO_DATE('2023-12-01', 'yyyy-mm-dd'))::date)
    
[0m16:36:07.120227 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0 seconds
[0m16:36:07.142556 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.150380 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (compile): 2024-09-01 16:36:07.071168 => 2024-09-01 16:36:07.150236
[0m16:36:07.151491 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.as_of_date
[0m16:36:07.215341 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.222676 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.223596 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */

  
    

  create  table "postgres"."dbt"."as_of_date__dbt_tmp"
  as (
    WITH as_of_date AS (
 





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 305
    order by generated_number



),

all_periods as (

    select (
        

    TO_DATE('2023-12-01', 'yyyy-mm-dd') + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= TO_DATE('2024-10-01', 'yyyy-mm-dd')

)

select * from filtered


)
SELECT DATE_day as AS_OF_DATE FROM as_of_date
  );
  
[0m16:36:07.230927 [debug] [Thread-1  ]: SQL status: SELECT 305 in 0 seconds
[0m16:36:07.241123 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.242242 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date" rename to "as_of_date__dbt_backup"
[0m16:36:07.243653 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.249983 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.250956 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
alter table "postgres"."dbt"."as_of_date__dbt_tmp" rename to "as_of_date"
[0m16:36:07.252401 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.283648 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m16:36:07.285094 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.286267 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: COMMIT
[0m16:36:07.289500 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:07.297690 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.as_of_date"
[0m16:36:07.298886 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.as_of_date"} */
drop table if exists "postgres"."dbt"."as_of_date__dbt_backup" cascade
[0m16:36:07.303177 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:36:07.305598 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.as_of_date (execute): 2024-09-01 16:36:07.152479 => 2024-09-01 16:36:07.305536
[0m16:36:07.306733 [debug] [Thread-1  ]: On model.otus_project_dbtvault.as_of_date: Close
[0m16:36:07.308166 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e6e3e80>]}
[0m16:36:07.309228 [info ] [Thread-1  ]: 1 of 10 OK created sql table model dbt.as_of_date .............................. [[32mSELECT 305[0m in 0.24s]
[0m16:36:07.312196 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.as_of_date
[0m16:36:07.313375 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_city_country
[0m16:36:07.314539 [info ] [Thread-1  ]: 2 of 10 START sql view model dbt.cv_city_country ............................... [RUN]
[0m16:36:07.316035 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_city_country'
[0m16:36:07.317026 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_city_country
[0m16:36:07.323408 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.329678 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (compile): 2024-09-01 16:36:07.317837 => 2024-09-01 16:36:07.329584
[0m16:36:07.330424 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_city_country
[0m16:36:07.360645 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.368434 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.369222 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: BEGIN
[0m16:36:07.369943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.377139 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.378438 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.379538 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */

  create view "postgres"."dbt"."cv_city_country__dbt_tmp" as (
    select
    sci.CITY_PK,
    sci.name AS city_name,
    sco.name AS country_name
FROM "postgres"."dbt"."sat_city" AS sci
LEFT JOIN "postgres"."dbt"."link_city_country" AS ccl on ccl.CITY_PK = sci.CITY_PK
LEFT JOIN "postgres"."dbt"."sat_country" AS sco ON sco.COUNTRY_PK = ccl.COUNTRY_PK
  );
[0m16:36:07.382645 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:07.389718 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.390836 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country" rename to "cv_city_country__dbt_backup"
[0m16:36:07.392224 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.397111 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.398181 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
alter table "postgres"."dbt"."cv_city_country__dbt_tmp" rename to "cv_city_country"
[0m16:36:07.399484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.402345 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m16:36:07.403471 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.404516 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: COMMIT
[0m16:36:07.407321 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:07.411772 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_city_country"
[0m16:36:07.413070 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_city_country"} */
drop view if exists "postgres"."dbt"."cv_city_country__dbt_backup" cascade
[0m16:36:07.416144 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:07.418252 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_city_country (execute): 2024-09-01 16:36:07.331041 => 2024-09-01 16:36:07.418196
[0m16:36:07.419279 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_city_country: Close
[0m16:36:07.420769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e6e3070>]}
[0m16:36:07.422051 [info ] [Thread-1  ]: 2 of 10 OK created sql view model dbt.cv_city_country .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m16:36:07.423415 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_city_country
[0m16:36:07.424796 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_date
[0m16:36:07.426022 [info ] [Thread-1  ]: 3 of 10 START sql view model dbt.cv_date ....................................... [RUN]
[0m16:36:07.427638 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_date'
[0m16:36:07.429159 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_date
[0m16:36:07.433684 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_date"
[0m16:36:07.441407 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (compile): 2024-09-01 16:36:07.430219 => 2024-09-01 16:36:07.441296
[0m16:36:07.442254 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_date
[0m16:36:07.452948 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_date"
[0m16:36:07.460739 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:36:07.461698 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: BEGIN
[0m16:36:07.462391 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.469873 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.471419 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:36:07.472801 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */

  create view "postgres"."dbt"."cv_date__dbt_tmp" as (
    WITH
RECURSIVE dates AS (
    SELECT
        '2023-12-01'::TIMESTAMP AS date_value
    UNION
    SELECT
        date_value + INTERVAL '1' DAY AS date_value
    FROM dates
    WHERE date_value <= '2024-10-01'
)
select date_value from dates
  );
[0m16:36:07.475526 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:07.482656 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:36:07.483881 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date" rename to "cv_date__dbt_backup"
[0m16:36:07.485355 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.490470 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:36:07.491645 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
alter table "postgres"."dbt"."cv_date__dbt_tmp" rename to "cv_date"
[0m16:36:07.493043 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.496023 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m16:36:07.497096 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:36:07.498151 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: COMMIT
[0m16:36:07.500936 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:07.505508 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_date"
[0m16:36:07.506776 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_date"} */
drop view if exists "postgres"."dbt"."cv_date__dbt_backup" cascade
[0m16:36:07.509898 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:07.512289 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_date (execute): 2024-09-01 16:36:07.442902 => 2024-09-01 16:36:07.512230
[0m16:36:07.513307 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_date: Close
[0m16:36:07.514756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e6e3700>]}
[0m16:36:07.515735 [info ] [Thread-1  ]: 3 of 10 OK created sql view model dbt.cv_date .................................. [[32mCREATE VIEW[0m in 0.09s]
[0m16:36:07.516813 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_date
[0m16:36:07.517803 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status
[0m16:36:07.518802 [info ] [Thread-1  ]: 4 of 10 START sql view model dbt.cv_last_order_status .......................... [RUN]
[0m16:36:07.520155 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status'
[0m16:36:07.521161 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status
[0m16:36:07.527328 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.534816 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (compile): 2024-09-01 16:36:07.521897 => 2024-09-01 16:36:07.534721
[0m16:36:07.535736 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status
[0m16:36:07.546641 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.554593 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.555570 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: BEGIN
[0m16:36:07.556375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.563738 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.565232 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.566483 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */

  create view "postgres"."dbt"."cv_last_order_status__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd hh24:mi') as status_datetime,
        row_number() over (partition by lo.ORDER_PK order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    os.ORDER_PK,
	os.status_datetime,
    loo.ORDER_STATUS_PK,
    lw.WAREHOUSE_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_order_status_order_status_history" AS loo on loo.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m16:36:07.569611 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:07.576341 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.577523 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status" rename to "cv_last_order_status__dbt_backup"
[0m16:36:07.579097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.621048 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.622436 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
alter table "postgres"."dbt"."cv_last_order_status__dbt_tmp" rename to "cv_last_order_status"
[0m16:36:07.624077 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.626992 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m16:36:07.628038 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.628945 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: COMMIT
[0m16:36:07.632047 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:07.636697 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status"
[0m16:36:07.637889 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status"} */
drop view if exists "postgres"."dbt"."cv_last_order_status__dbt_backup" cascade
[0m16:36:07.641281 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:07.643540 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status (execute): 2024-09-01 16:36:07.536453 => 2024-09-01 16:36:07.643481
[0m16:36:07.644611 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status: Close
[0m16:36:07.646211 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e6e3700>]}
[0m16:36:07.647566 [info ] [Thread-1  ]: 4 of 10 OK created sql view model dbt.cv_last_order_status ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m16:36:07.648892 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status
[0m16:36:07.650297 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_payer
[0m16:36:07.651525 [info ] [Thread-1  ]: 5 of 10 START sql view model dbt.cv_order_payer ................................ [RUN]
[0m16:36:07.653364 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_payer'
[0m16:36:07.654661 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_payer
[0m16:36:07.662215 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.669149 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (compile): 2024-09-01 16:36:07.655742 => 2024-09-01 16:36:07.669052
[0m16:36:07.669952 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_payer
[0m16:36:07.680469 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.688260 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.689175 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: BEGIN
[0m16:36:07.689953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.697568 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.699201 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.700598 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */

  create view "postgres"."dbt"."cv_order_payer__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'payer'
  );
[0m16:36:07.703777 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:07.710194 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.711487 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
alter table "postgres"."dbt"."cv_order_payer" rename to "cv_order_payer__dbt_backup"
[0m16:36:07.713001 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.719468 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.720722 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
alter table "postgres"."dbt"."cv_order_payer__dbt_tmp" rename to "cv_order_payer"
[0m16:36:07.722268 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.725324 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m16:36:07.726348 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.727437 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: COMMIT
[0m16:36:07.730475 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:07.734913 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_payer"
[0m16:36:07.735996 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_payer"} */
drop view if exists "postgres"."dbt"."cv_order_payer__dbt_backup" cascade
[0m16:36:07.739516 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:07.742376 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_payer (execute): 2024-09-01 16:36:07.670578 => 2024-09-01 16:36:07.742289
[0m16:36:07.743531 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_payer: Close
[0m16:36:07.745189 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ebfd7c0>]}
[0m16:36:07.746452 [info ] [Thread-1  ]: 5 of 10 OK created sql view model dbt.cv_order_payer ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m16:36:07.747763 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_payer
[0m16:36:07.748992 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_receiver
[0m16:36:07.750133 [info ] [Thread-1  ]: 6 of 10 START sql view model dbt.cv_order_receiver ............................. [RUN]
[0m16:36:07.751782 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_receiver'
[0m16:36:07.752739 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_receiver
[0m16:36:07.759543 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.766122 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (compile): 2024-09-01 16:36:07.753547 => 2024-09-01 16:36:07.766025
[0m16:36:07.766933 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_receiver
[0m16:36:07.777535 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.785795 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.786592 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: BEGIN
[0m16:36:07.787242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.794422 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.796079 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.797262 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */

  create view "postgres"."dbt"."cv_order_receiver__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'receiver'
  );
[0m16:36:07.800575 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:07.806670 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.807881 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
alter table "postgres"."dbt"."cv_order_receiver" rename to "cv_order_receiver__dbt_backup"
[0m16:36:07.809431 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.815392 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.816628 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
alter table "postgres"."dbt"."cv_order_receiver__dbt_tmp" rename to "cv_order_receiver"
[0m16:36:07.818272 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.821399 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m16:36:07.822504 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.823608 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: COMMIT
[0m16:36:07.826732 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:07.831252 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_receiver"
[0m16:36:07.832444 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_receiver"} */
drop view if exists "postgres"."dbt"."cv_order_receiver__dbt_backup" cascade
[0m16:36:07.835888 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:07.838121 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_receiver (execute): 2024-09-01 16:36:07.767596 => 2024-09-01 16:36:07.838061
[0m16:36:07.839184 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_receiver: Close
[0m16:36:07.840684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e64ed30>]}
[0m16:36:07.841965 [info ] [Thread-1  ]: 6 of 10 OK created sql view model dbt.cv_order_receiver ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m16:36:07.843403 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_receiver
[0m16:36:07.844719 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_sender
[0m16:36:07.845888 [info ] [Thread-1  ]: 7 of 10 START sql view model dbt.cv_order_sender ............................... [RUN]
[0m16:36:07.847479 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_sender'
[0m16:36:07.848807 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_sender
[0m16:36:07.856015 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.864370 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (compile): 2024-09-01 16:36:07.849934 => 2024-09-01 16:36:07.864212
[0m16:36:07.865683 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_sender
[0m16:36:07.878413 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.886959 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.887757 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: BEGIN
[0m16:36:07.888432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.895679 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.897085 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.898269 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */

  create view "postgres"."dbt"."cv_order_sender__dbt_tmp" as (
    SELECT
    loc.ORDER_PK,
    sc.CLIENT_PK,
    lacc.CITY_PK,
    lcc.CLIENT_TYPE_PK,
    sac.is_valid
FROM "postgres"."dbt"."sat_client" AS sc
LEFT JOIN "postgres"."dbt"."link_order_client" AS loc on loc.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_client" AS lac on lac.CLIENT_PK = sc.CLIENT_PK
LEFT JOIN "postgres"."dbt"."link_client_address_city" AS lacc on lacc.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."sat_client_address" AS sac on sac.CLIENT_ADDRESS_PK = lac.CLIENT_ADDRESS_PK
LEFT JOIN "postgres"."dbt"."link_client_client_type" AS lcc on lcc.CLIENT_PK = sc.CLIENT_PK
WHERE sc.client_type_code = 'sender'
  );
[0m16:36:07.901659 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:07.907840 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.909019 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender" rename to "cv_order_sender__dbt_backup"
[0m16:36:07.910691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.916116 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.917290 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
alter table "postgres"."dbt"."cv_order_sender__dbt_tmp" rename to "cv_order_sender"
[0m16:36:07.918821 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:07.923000 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m16:36:07.924210 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.925232 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: COMMIT
[0m16:36:07.928207 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:07.932834 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_sender"
[0m16:36:07.933944 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_sender"} */
drop view if exists "postgres"."dbt"."cv_order_sender__dbt_backup" cascade
[0m16:36:07.937374 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:07.939523 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_sender (execute): 2024-09-01 16:36:07.866804 => 2024-09-01 16:36:07.939462
[0m16:36:07.940643 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_sender: Close
[0m16:36:07.942427 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e658610>]}
[0m16:36:07.943754 [info ] [Thread-1  ]: 7 of 10 OK created sql view model dbt.cv_order_sender .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m16:36:07.945167 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_sender
[0m16:36:07.946643 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:36:07.947923 [info ] [Thread-1  ]: 8 of 10 START sql view model dbt.cv_currency_rate_by_date ...................... [RUN]
[0m16:36:07.949650 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_currency_rate_by_date'
[0m16:36:07.950844 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:36:07.956884 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:36:07.964316 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (compile): 2024-09-01 16:36:07.952002 => 2024-09-01 16:36:07.964215
[0m16:36:07.965355 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:36:07.976532 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:36:07.985716 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:36:07.986482 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: BEGIN
[0m16:36:07.987216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:07.994631 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:07.996200 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:36:07.997489 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */

  create view "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" as (
    SELECT
    q.CURRENCY_PK,
    q.relation_to_rur,
    d.as_of_date AS date_value
FROM (
    SELECT
        ccr.CURRENCY_PK, cr.relation_to_rur, cr.date_start,
        LAG(cr.date_start) OVER (PARTITION BY ccr.CURRENCY_PK ORDER BY cr.date_start DESC) AS date_end
    FROM "postgres"."dbt"."sat_currency_rate" cr
	LEFT JOIN "postgres"."dbt"."link_currency_currency_rate" ccr ON ccr.CURRENCY_RATE_PK = cr.CURRENCY_RATE_PK
	)q, "postgres"."dbt"."as_of_date" d
    WHERE d.as_of_date >= COALESCE(q.date_start, '2023-12-01') AND d.as_of_date < COALESCE(q.date_end, '2024-10-01')
  );
[0m16:36:08.000676 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:08.006200 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:36:08.007332 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
alter table "postgres"."dbt"."cv_currency_rate_by_date__dbt_tmp" rename to "cv_currency_rate_by_date"
[0m16:36:08.008781 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:08.011532 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m16:36:08.012494 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:36:08.013491 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: COMMIT
[0m16:36:08.016013 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:08.020404 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_currency_rate_by_date"
[0m16:36:08.021487 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_currency_rate_by_date"} */
drop view if exists "postgres"."dbt"."cv_currency_rate_by_date__dbt_backup" cascade
[0m16:36:08.022879 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:08.025026 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_currency_rate_by_date (execute): 2024-09-01 16:36:07.966058 => 2024-09-01 16:36:08.024966
[0m16:36:08.026039 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_currency_rate_by_date: Close
[0m16:36:08.027519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ebfd7c0>]}
[0m16:36:08.028711 [info ] [Thread-1  ]: 8 of 10 OK created sql view model dbt.cv_currency_rate_by_date ................. [[32mCREATE VIEW[0m in 0.08s]
[0m16:36:08.030164 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_currency_rate_by_date
[0m16:36:08.031445 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_clients_info
[0m16:36:08.032700 [info ] [Thread-1  ]: 9 of 10 START sql view model dbt.cv_order_clients_info ......................... [RUN]
[0m16:36:08.034378 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_clients_info'
[0m16:36:08.035465 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_clients_info
[0m16:36:08.044398 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:36:08.052804 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_clients_info (compile): 2024-09-01 16:36:08.036489 => 2024-09-01 16:36:08.052692
[0m16:36:08.053655 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_clients_info
[0m16:36:08.065475 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:36:08.074260 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:36:08.075059 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: BEGIN
[0m16:36:08.075762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:08.083409 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:08.084801 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:36:08.086049 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_clients_info"} */

  create view "postgres"."dbt"."cv_order_clients_info__dbt_tmp" as (
    select
    so.ORDER_PK,
    cop.CLIENT_PK as payer_client_pk,
    ctp.CLIENT_TYPE_PK as payer_client_type_pk,
    ctp.name as payer_client_type_name,
    cos.CLIENT_PK as sender_client_pk,
    cos.CITY_PK as sender_city_pk,
    cos.is_valid as is_sender_address_valid,
    cts.CLIENT_TYPE_PK as sender_client_type_pk,
    cts.name as sender_client_type_name,
    cor.CLIENT_PK as receiver_client_pk,
    cor.CITY_PK as receiver_city_pk,
    cor.is_valid as is_receiver_address_valid,
    ctr.CLIENT_TYPE_PK as receiver_client_type_pk,
    ctr.name as receiver_client_type_name
from "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_order_payer" AS cop on cop.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctp on ctp.CLIENT_TYPE_PK = cop.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_sender" AS cos on cos.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS cts on cts.CLIENT_TYPE_PK = cos.CLIENT_TYPE_PK
LEFT JOIN "postgres"."dbt"."cv_order_receiver" AS cor on cor.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_client_type" AS ctr on ctr.CLIENT_TYPE_PK = cor.CLIENT_TYPE_PK
  );
[0m16:36:08.090078 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:08.096246 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:36:08.097470 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_clients_info"} */
alter table "postgres"."dbt"."cv_order_clients_info__dbt_tmp" rename to "cv_order_clients_info"
[0m16:36:08.098691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:08.100997 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: COMMIT
[0m16:36:08.101883 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:36:08.102718 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: COMMIT
[0m16:36:08.105049 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:08.109512 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_clients_info"
[0m16:36:08.110447 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_clients_info"} */
drop view if exists "postgres"."dbt"."cv_order_clients_info__dbt_backup" cascade
[0m16:36:08.111511 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:08.113495 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_clients_info (execute): 2024-09-01 16:36:08.054385 => 2024-09-01 16:36:08.113434
[0m16:36:08.114351 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_clients_info: Close
[0m16:36:08.115656 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ebfd820>]}
[0m16:36:08.116887 [info ] [Thread-1  ]: 9 of 10 OK created sql view model dbt.cv_order_clients_info .................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:36:08.118324 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_clients_info
[0m16:36:08.119636 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_goods
[0m16:36:08.120698 [info ] [Thread-1  ]: 10 of 10 START sql view model dbt.cv_goods ..................................... [RUN]
[0m16:36:08.122351 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_goods'
[0m16:36:08.123453 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_goods
[0m16:36:08.131666 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_goods"
[0m16:36:08.139538 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (compile): 2024-09-01 16:36:08.124197 => 2024-09-01 16:36:08.139427
[0m16:36:08.140457 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_goods
[0m16:36:08.152877 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_goods"
[0m16:36:08.161520 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:36:08.162662 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: BEGIN
[0m16:36:08.163876 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:08.171748 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:08.173479 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:36:08.174806 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */

  create view "postgres"."dbt"."cv_goods__dbt_tmp" as (
    with ords as (
SELECT
    so.ORDER_PK,
    so.order_date,
    case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.status_datetime
        else null
    end as delivery_date,
        case
        when os.name in ('Частично вручено', 'Не вручено', 'Вручено') then ls.WAREHOUSE_PK
        else null
    end as delivery_warehouse_pk,
    oc.CURRENCY_PK
FROM "postgres"."dbt"."sat_order" AS so
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order_status" AS os on os.ORDER_STATUS_PK = ls.ORDER_STATUS_PK
LEFT JOIN "postgres"."dbt"."link_order_currency" AS oc on oc.ORDER_PK = so.ORDER_PK
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    sg.GOOD_PK,
    sg.count,
    sg.cost_per_unit,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) as cost_per_unit_rur,
    sg.cost_per_unit * sg.count as full_good_cost,
    sg.cost_per_unit * COALESCE(relation_to_rur, 1) * sg.count as full_good_cost_rur,
    ords.delivery_warehouse_pk
from ords
LEFT JOIN "postgres"."dbt"."link_order_goods" AS og on og.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_good" AS sg on sg.GOOD_PK = og.GOOD_PK
LEFT JOIN "postgres"."dbt"."cv_currency_rate_by_date" AS crr on crr.CURRENCY_PK = ords.CURRENCY_PK
    and crr.date_value = COALESCE(ords.delivery_date, ords.order_date)
  );
[0m16:36:08.179558 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:08.185377 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:36:08.186417 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
alter table "postgres"."dbt"."cv_goods__dbt_tmp" rename to "cv_goods"
[0m16:36:08.187967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:08.190561 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:36:08.191544 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:36:08.192540 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: COMMIT
[0m16:36:08.195557 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:08.200324 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_goods"
[0m16:36:08.201485 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_goods"} */
drop view if exists "postgres"."dbt"."cv_goods__dbt_backup" cascade
[0m16:36:08.202761 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:08.204871 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_goods (execute): 2024-09-01 16:36:08.141172 => 2024-09-01 16:36:08.204812
[0m16:36:08.205859 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_goods: Close
[0m16:36:08.207834 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1534ac7-abc5-44a7-aa90-1f5a3aea614c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e6e3e50>]}
[0m16:36:08.209335 [info ] [Thread-1  ]: 10 of 10 OK created sql view model dbt.cv_goods ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m16:36:08.210993 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_goods
[0m16:36:08.214059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:08.215282 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:08.216443 [debug] [MainThread]: On master: BEGIN
[0m16:36:08.217566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:08.225365 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:08.226709 [debug] [MainThread]: On master: COMMIT
[0m16:36:08.227985 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:08.229048 [debug] [MainThread]: On master: COMMIT
[0m16:36:08.230219 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:08.231148 [debug] [MainThread]: On master: Close
[0m16:36:08.232573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:08.234340 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_goods' was properly closed.
[0m16:36:08.235372 [info ] [MainThread]: 
[0m16:36:08.236537 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m16:36:08.238821 [debug] [MainThread]: Command end result
[0m16:36:08.274806 [info ] [MainThread]: 
[0m16:36:08.275991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:08.277273 [info ] [MainThread]: 
[0m16:36:08.278559 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m16:36:08.280075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24ea40c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e65c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24e5ede50>]}
[0m16:36:08.281343 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:36:20.916896 | c9eac925-57bf-4077-9b54-0ab09d086745 ==============================
[0m16:36:20.916896 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:36:20.919927 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:36:20.921250 [debug] [MainThread]: Tracking: tracking
[0m16:36:20.927088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226a4af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226a4a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226a4aeb0>]}
[0m16:36:23.986730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:23.987694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:24.007201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9eac925-57bf-4077-9b54-0ab09d086745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42269acdc0>]}
[0m16:36:24.058223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9eac925-57bf-4077-9b54-0ab09d086745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226727100>]}
[0m16:36:24.059596 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:36:24.060967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9eac925-57bf-4077-9b54-0ab09d086745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42267271f0>]}
[0m16:36:24.068942 [info ] [MainThread]: 
[0m16:36:24.072295 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:24.074722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:36:24.092102 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:36:24.093412 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:36:24.094545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:24.104554 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:36:24.107155 [debug] [ThreadPool]: On list_postgres: Close
[0m16:36:24.117429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:36:24.126665 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:36:24.127741 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:36:24.128738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:24.136378 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:36:24.137869 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:36:24.139159 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:36:24.142857 [debug] [ThreadPool]: SQL status: SELECT 116 in 0 seconds
[0m16:36:24.148431 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:36:24.149680 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:36:24.178457 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.179775 [debug] [MainThread]: On master: BEGIN
[0m16:36:24.180910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:24.189223 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:24.190863 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.192273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:24.257999 [debug] [MainThread]: SQL status: SELECT 101 in 0 seconds
[0m16:36:24.275551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9eac925-57bf-4077-9b54-0ab09d086745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226a37340>]}
[0m16:36:24.277092 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:24.278704 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.280074 [debug] [MainThread]: On master: BEGIN
[0m16:36:24.281694 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:24.282952 [debug] [MainThread]: On master: COMMIT
[0m16:36:24.284138 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.285465 [debug] [MainThread]: On master: COMMIT
[0m16:36:24.286428 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:24.287138 [debug] [MainThread]: On master: Close
[0m16:36:24.288328 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:24.289322 [info ] [MainThread]: 
[0m16:36:24.293767 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_business_area
[0m16:36:24.294993 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_business_area ............................... [RUN]
[0m16:36:24.296780 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_business_area'
[0m16:36:24.297851 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_business_area
[0m16:36:24.301542 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_business_area"
[0m16:36:24.308189 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (compile): 2024-09-01 16:36:24.298668 => 2024-09-01 16:36:24.308076
[0m16:36:24.308986 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_business_area
[0m16:36:24.365864 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_business_area"
[0m16:36:24.373194 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:24.374004 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: BEGIN
[0m16:36:24.374684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:24.382064 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:24.383660 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:24.385054 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */

  create view "postgres"."dbt"."cv_business_area__dbt_tmp" as (
    select
    1 as id,
    'ФЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'C2C' as business_area_name
UNION
select
    2 as id,
    'ФЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'C2B' as business_area_name
UNION
select
    3 as id,
    'ЮЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'B2B' as business_area_name
UNION
select
    4 as id,
    'ЮЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'B2C' as business_area_name
  );
[0m16:36:24.388497 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:24.400372 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:24.401523 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area__dbt_tmp" rename to "cv_business_area"
[0m16:36:24.403259 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:24.429786 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:36:24.431216 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:24.432260 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:36:24.435950 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:24.447198 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:24.448261 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
drop view if exists "postgres"."dbt"."cv_business_area__dbt_backup" cascade
[0m16:36:24.449281 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:24.451413 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (execute): 2024-09-01 16:36:24.309660 => 2024-09-01 16:36:24.451347
[0m16:36:24.452268 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: Close
[0m16:36:24.453616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9eac925-57bf-4077-9b54-0ab09d086745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226499160>]}
[0m16:36:24.454769 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.cv_business_area .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:36:24.458021 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_business_area
[0m16:36:24.460074 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:24.461446 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.cv_order_attributes ............................ [RUN]
[0m16:36:24.463394 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_attributes'
[0m16:36:24.464730 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:24.472953 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:24.479321 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (compile): 2024-09-01 16:36:24.465531 => 2024-09-01 16:36:24.479200
[0m16:36:24.480223 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:24.493174 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:24.499537 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:24.500395 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: BEGIN
[0m16:36:24.501243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:24.509941 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:24.511370 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:24.512555 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_attributes"} */

  create view "postgres"."dbt"."cv_order_attributes__dbt_tmp" as (
    with ords as
(
SELECT
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    SUM(cg.count) as good_count,
    SUM(cg.full_good_cost) as full_good_cost,
    SUM(cg.full_good_cost_rur) as full_good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
group by
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    cg.delivery_warehouse_pk
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    ords.good_count,
    ords.full_good_cost,
    ords.full_good_cost_rur,
    ords.delivery_warehouse_pk,
    ls.WAREHOUSE_PK as current_warehouse_pk,
    ls.ORDER_STATUS_PK as current_status_pk,
    so.weight as order_weight,
    so.length * so.height * so.width as order_volume,
    oc.payer_city_pk,
    oc.payer_client_type_pk,
    oc.sender_city_pk,
    oc.receiver_city_pk,
    case
        when oc.is_sender_address_valid is false or oc.is_receiver_address_valid is false then TRUE
        else FALSE
    end as has_problem_address,
    ba.id as business_area_id
from ords
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order" AS so on ords.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_order_clients_info" AS oc on oc.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_business_area" AS ba on ba.receiver_type_name = oc.sender_client_type_name
    and ba.receiver_type_name = oc.receiver_client_type_name
  );
[0m16:36:24.515616 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column oc.payer_city_pk does not exist
LINE 36:     oc.payer_city_pk,
             ^

[0m16:36:24.519964 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: ROLLBACK
[0m16:36:24.521606 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (execute): 2024-09-01 16:36:24.480906 => 2024-09-01 16:36:24.521512
[0m16:36:24.522601 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: Close
[0m16:36:24.525568 [debug] [Thread-1  ]: Database Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)
  column oc.payer_city_pk does not exist
  LINE 36:     oc.payer_city_pk,
               ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:36:24.526759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9eac925-57bf-4077-9b54-0ab09d086745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226978100>]}
[0m16:36:24.527758 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbt.cv_order_attributes ................... [[31mERROR[0m in 0.06s]
[0m16:36:24.529193 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:24.531681 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:24.532710 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.533455 [debug] [MainThread]: On master: BEGIN
[0m16:36:24.534236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:24.541753 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:24.543338 [debug] [MainThread]: On master: COMMIT
[0m16:36:24.544523 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:24.545547 [debug] [MainThread]: On master: COMMIT
[0m16:36:24.546792 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:24.547719 [debug] [MainThread]: On master: Close
[0m16:36:24.549101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:24.550090 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_order_attributes' was properly closed.
[0m16:36:24.551013 [info ] [MainThread]: 
[0m16:36:24.552246 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:36:24.553535 [debug] [MainThread]: Command end result
[0m16:36:24.586680 [info ] [MainThread]: 
[0m16:36:24.587908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:24.589296 [info ] [MainThread]: 
[0m16:36:24.590734 [error] [MainThread]: [33mDatabase Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)[0m
[0m16:36:24.592196 [error] [MainThread]:   column oc.payer_city_pk does not exist
[0m16:36:24.593607 [error] [MainThread]:   LINE 36:     oc.payer_city_pk,
[0m16:36:24.595247 [error] [MainThread]:                ^
[0m16:36:24.596762 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:36:24.598200 [info ] [MainThread]: 
[0m16:36:24.599708 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:36:24.601221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226a37340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226a4a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4226912a60>]}
[0m16:36:24.602566 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:36:46.176744 | 78368445-62b2-41e6-a978-ec4c2de11070 ==============================
[0m16:36:46.176744 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:36:46.180889 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:36:46.182236 [debug] [MainThread]: Tracking: tracking
[0m16:36:46.187211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57af591bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ac5af310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ac5afe50>]}
[0m16:36:49.283817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:36:49.285425 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:36:49.313532 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:36:49.382713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78368445-62b2-41e6-a978-ec4c2de11070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ac46b0d0>]}
[0m16:36:49.434758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78368445-62b2-41e6-a978-ec4c2de11070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ac198a00>]}
[0m16:36:49.436038 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:36:49.437506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78368445-62b2-41e6-a978-ec4c2de11070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ac5af7f0>]}
[0m16:36:49.445249 [info ] [MainThread]: 
[0m16:36:49.448701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:49.451322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:36:49.467849 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:36:49.469026 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:36:49.469979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:49.478924 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:36:49.481466 [debug] [ThreadPool]: On list_postgres: Close
[0m16:36:49.493418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:36:49.503111 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:36:49.504676 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:36:49.505743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:49.514273 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:36:49.515885 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:36:49.517098 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:36:49.520949 [debug] [ThreadPool]: SQL status: SELECT 117 in 0 seconds
[0m16:36:49.527123 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:36:49.528336 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:36:49.560450 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.561519 [debug] [MainThread]: On master: BEGIN
[0m16:36:49.562449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:49.570039 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:49.571495 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.572793 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:49.640556 [debug] [MainThread]: SQL status: SELECT 101 in 0 seconds
[0m16:36:49.656949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78368445-62b2-41e6-a978-ec4c2de11070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ac5967f0>]}
[0m16:36:49.658137 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:49.659351 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.660272 [debug] [MainThread]: On master: BEGIN
[0m16:36:49.661615 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:49.663023 [debug] [MainThread]: On master: COMMIT
[0m16:36:49.664146 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.665157 [debug] [MainThread]: On master: COMMIT
[0m16:36:49.666320 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:49.667366 [debug] [MainThread]: On master: Close
[0m16:36:49.668846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:49.670107 [info ] [MainThread]: 
[0m16:36:49.674825 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_business_area
[0m16:36:49.676241 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_business_area ............................... [RUN]
[0m16:36:49.677931 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_business_area'
[0m16:36:49.679011 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_business_area
[0m16:36:49.683897 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.691745 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (compile): 2024-09-01 16:36:49.679856 => 2024-09-01 16:36:49.691611
[0m16:36:49.692620 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_business_area
[0m16:36:49.754100 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.762904 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.763722 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: BEGIN
[0m16:36:49.764445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:49.772323 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:49.773759 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.774809 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */

  create view "postgres"."dbt"."cv_business_area__dbt_tmp" as (
    select
    1 as id,
    'ФЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'C2C' as business_area_name
UNION
select
    2 as id,
    'ФЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'C2B' as business_area_name
UNION
select
    3 as id,
    'ЮЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'B2B' as business_area_name
UNION
select
    4 as id,
    'ЮЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'B2C' as business_area_name
  );
[0m16:36:49.777343 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:36:49.787345 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.788630 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area" rename to "cv_business_area__dbt_backup"
[0m16:36:49.790184 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:49.795565 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.796747 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area__dbt_tmp" rename to "cv_business_area"
[0m16:36:49.798332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:36:49.824481 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:36:49.825887 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.826958 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:36:49.830280 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:36:49.839737 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:36:49.841248 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
drop view if exists "postgres"."dbt"."cv_business_area__dbt_backup" cascade
[0m16:36:49.844538 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:36:49.846803 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (execute): 2024-09-01 16:36:49.693412 => 2024-09-01 16:36:49.846744
[0m16:36:49.847877 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: Close
[0m16:36:49.849446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78368445-62b2-41e6-a978-ec4c2de11070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57aae4d550>]}
[0m16:36:49.850971 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.cv_business_area .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m16:36:49.854374 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_business_area
[0m16:36:49.856622 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:49.858022 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.cv_order_attributes ............................ [RUN]
[0m16:36:49.859639 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_attributes'
[0m16:36:49.860888 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:49.867862 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:49.875468 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (compile): 2024-09-01 16:36:49.861833 => 2024-09-01 16:36:49.875366
[0m16:36:49.876262 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:49.887479 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:49.895499 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:49.896359 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: BEGIN
[0m16:36:49.897349 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:49.904963 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:49.906590 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:36:49.907667 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_attributes"} */

  create view "postgres"."dbt"."cv_order_attributes__dbt_tmp" as (
    with ords as
(
SELECT
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    SUM(cg.count) as good_count,
    SUM(cg.full_good_cost) as full_good_cost,
    SUM(cg.full_good_cost_rur) as full_good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
group by
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    cg.delivery_warehouse_pk
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    ords.good_count,
    ords.full_good_cost,
    ords.full_good_cost_rur,
    ords.delivery_warehouse_pk,
    ls.WAREHOUSE_PK as current_warehouse_pk,
    ls.ORDER_STATUS_PK as current_status_pk,
    so.weight as order_weight,
    so.length * so.height * so.width as order_volume,
    oc.payer_client_type_pk,
    oc.sender_city_pk,
    oc.receiver_city_pk,
    case
        when oc.is_sender_address_valid is false or oc.is_receiver_address_valid is false then TRUE
        else FALSE
    end as has_problem_address,
    ba.id as business_area_id
from ords
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order" AS so on ords.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_order_clients_info" AS oc on oc.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_business_area" AS ba on ba.receiver_type_name = oc.sender_client_type_name
    and ba.receiver_type_name = oc.receiver_client_type_name
  );
[0m16:36:49.910383 [debug] [Thread-1  ]: Postgres adapter: Postgres error: argument of IS FALSE must be type boolean, not type text
LINE 40:         when oc.is_sender_address_valid is false or oc.is_re...
                      ^

[0m16:36:49.912068 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: ROLLBACK
[0m16:36:49.913609 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (execute): 2024-09-01 16:36:49.876981 => 2024-09-01 16:36:49.913520
[0m16:36:49.914634 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: Close
[0m16:36:49.917488 [debug] [Thread-1  ]: Database Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)
  argument of IS FALSE must be type boolean, not type text
  LINE 40:         when oc.is_sender_address_valid is false or oc.is_re...
                        ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:36:49.918646 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78368445-62b2-41e6-a978-ec4c2de11070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57aae4d370>]}
[0m16:36:49.919829 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbt.cv_order_attributes ................... [[31mERROR[0m in 0.06s]
[0m16:36:49.921146 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_attributes
[0m16:36:49.924080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:49.925024 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.925943 [debug] [MainThread]: On master: BEGIN
[0m16:36:49.926776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:49.935012 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:49.936463 [debug] [MainThread]: On master: COMMIT
[0m16:36:49.937651 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.938727 [debug] [MainThread]: On master: COMMIT
[0m16:36:49.939909 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:49.940911 [debug] [MainThread]: On master: Close
[0m16:36:49.942566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:49.943502 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_order_attributes' was properly closed.
[0m16:36:49.944573 [info ] [MainThread]: 
[0m16:36:49.945733 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m16:36:49.946999 [debug] [MainThread]: Command end result
[0m16:36:50.015676 [info ] [MainThread]: 
[0m16:36:50.016860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:50.017975 [info ] [MainThread]: 
[0m16:36:50.019294 [error] [MainThread]: [33mDatabase Error in model cv_order_attributes (models/cdm/cv_order_attributes.sql)[0m
[0m16:36:50.020710 [error] [MainThread]:   argument of IS FALSE must be type boolean, not type text
[0m16:36:50.022067 [error] [MainThread]:   LINE 40:         when oc.is_sender_address_valid is false or oc.is_re...
[0m16:36:50.023599 [error] [MainThread]:                         ^
[0m16:36:50.025102 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/cv_order_attributes.sql
[0m16:36:50.026774 [info ] [MainThread]: 
[0m16:36:50.028181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:36:50.029608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ae422ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57ae405820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57aedbb5b0>]}
[0m16:36:50.030872 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:37:20.629927 | 854bd436-0b2d-40c7-a30a-f66a811ab910 ==============================
[0m16:37:20.629927 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:37:20.632945 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:37:20.633830 [debug] [MainThread]: Tracking: tracking
[0m16:37:20.638611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c887f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c8878b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c887e50>]}
[0m16:37:23.823480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:37:23.825015 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:37:23.852651 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m16:37:23.910426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '854bd436-0b2d-40c7-a30a-f66a811ab910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c7450d0>]}
[0m16:37:23.961491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '854bd436-0b2d-40c7-a30a-f66a811ab910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c471b20>]}
[0m16:37:23.962693 [info ] [MainThread]: Found 102 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:37:23.963841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854bd436-0b2d-40c7-a30a-f66a811ab910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c471c40>]}
[0m16:37:23.971483 [info ] [MainThread]: 
[0m16:37:23.974690 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:23.976995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:37:23.994681 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:37:23.996095 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:37:23.997368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:24.008394 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:37:24.010946 [debug] [ThreadPool]: On list_postgres: Close
[0m16:37:24.021472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:37:24.031062 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:37:24.032353 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:37:24.033490 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:24.041445 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:37:24.042984 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:37:24.044146 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:37:24.047706 [debug] [ThreadPool]: SQL status: SELECT 117 in 0 seconds
[0m16:37:24.053601 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:37:24.054888 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:37:24.083792 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:24.085197 [debug] [MainThread]: On master: BEGIN
[0m16:37:24.086410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:24.094507 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:37:24.096004 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:24.096983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:24.163385 [debug] [MainThread]: SQL status: SELECT 101 in 0 seconds
[0m16:37:24.179381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '854bd436-0b2d-40c7-a30a-f66a811ab910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c8972e0>]}
[0m16:37:24.180895 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:24.182565 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:24.183708 [debug] [MainThread]: On master: BEGIN
[0m16:37:24.184863 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:37:24.186141 [debug] [MainThread]: On master: COMMIT
[0m16:37:24.187072 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:24.187903 [debug] [MainThread]: On master: COMMIT
[0m16:37:24.188849 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:37:24.189588 [debug] [MainThread]: On master: Close
[0m16:37:24.190987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:24.191964 [info ] [MainThread]: 
[0m16:37:24.196179 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_business_area
[0m16:37:24.197328 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_business_area ............................... [RUN]
[0m16:37:24.198634 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_business_area'
[0m16:37:24.199676 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_business_area
[0m16:37:24.204172 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.211956 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (compile): 2024-09-01 16:37:24.200491 => 2024-09-01 16:37:24.211824
[0m16:37:24.212780 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_business_area
[0m16:37:24.266777 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.275196 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.275989 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: BEGIN
[0m16:37:24.276682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:24.283941 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:37:24.285300 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.286364 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */

  create view "postgres"."dbt"."cv_business_area__dbt_tmp" as (
    select
    1 as id,
    'ФЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'C2C' as business_area_name
UNION
select
    2 as id,
    'ФЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'C2B' as business_area_name
UNION
select
    3 as id,
    'ЮЛ' as receiver_type_name,
    'ЮЛ' as sender_type_name,
    'B2B' as business_area_name
UNION
select
    4 as id,
    'ЮЛ' as receiver_type_name,
    'ФЛ' as sender_type_name,
    'B2C' as business_area_name
  );
[0m16:37:24.289112 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:37:24.298915 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.299988 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area" rename to "cv_business_area__dbt_backup"
[0m16:37:24.301384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:37:24.306440 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.307511 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
alter table "postgres"."dbt"."cv_business_area__dbt_tmp" rename to "cv_business_area"
[0m16:37:24.308933 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:37:24.335136 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:37:24.336225 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.337328 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: COMMIT
[0m16:37:24.340223 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:37:24.348922 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_business_area"
[0m16:37:24.350034 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_business_area"} */
drop view if exists "postgres"."dbt"."cv_business_area__dbt_backup" cascade
[0m16:37:24.359580 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:37:24.362276 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_business_area (execute): 2024-09-01 16:37:24.213378 => 2024-09-01 16:37:24.362214
[0m16:37:24.363303 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_business_area: Close
[0m16:37:24.364772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854bd436-0b2d-40c7-a30a-f66a811ab910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02b32a4f0>]}
[0m16:37:24.365951 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.cv_business_area .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m16:37:24.369046 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_business_area
[0m16:37:24.371414 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_order_attributes
[0m16:37:24.372942 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.cv_order_attributes ............................ [RUN]
[0m16:37:24.374709 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_order_attributes'
[0m16:37:24.375783 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_order_attributes
[0m16:37:24.383617 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:37:24.390603 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (compile): 2024-09-01 16:37:24.377004 => 2024-09-01 16:37:24.390491
[0m16:37:24.391414 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_order_attributes
[0m16:37:24.402335 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_order_attributes"
[0m16:37:24.410187 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:37:24.410973 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: BEGIN
[0m16:37:24.411684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:24.419137 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:37:24.420694 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:37:24.422032 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_attributes"} */

  create view "postgres"."dbt"."cv_order_attributes__dbt_tmp" as (
    with ords as
(
SELECT
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    SUM(cg.count) as good_count,
    SUM(cg.full_good_cost) as full_good_cost,
    SUM(cg.full_good_cost_rur) as full_good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
group by
    cg.ORDER_PK,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    cg.delivery_warehouse_pk
)
select
    ords.ORDER_PK,
    ords.CURRENCY_PK,
    ords.order_date,
    ords.delivery_date,
    ords.good_count,
    ords.full_good_cost,
    ords.full_good_cost_rur,
    ords.delivery_warehouse_pk,
    ls.WAREHOUSE_PK as current_warehouse_pk,
    ls.ORDER_STATUS_PK as current_status_pk,
    so.weight as order_weight,
    so.length * so.height * so.width as order_volume,
    oc.payer_client_type_pk,
    oc.sender_city_pk,
    oc.receiver_city_pk,
    case
        when oc.is_sender_address_valid = 'false' or oc.is_receiver_address_valid = 'false' then TRUE
        else FALSE
    end as has_problem_address,
    ba.id as business_area_id
from ords
LEFT JOIN "postgres"."dbt"."cv_last_order_status" AS ls on ls.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."sat_order" AS so on ords.ORDER_PK = so.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_order_clients_info" AS oc on oc.ORDER_PK = ords.ORDER_PK
LEFT JOIN "postgres"."dbt"."cv_business_area" AS ba on ba.receiver_type_name = oc.sender_client_type_name
    and ba.receiver_type_name = oc.receiver_client_type_name
  );
[0m16:37:24.426870 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:37:24.432915 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:37:24.434217 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_attributes"} */
alter table "postgres"."dbt"."cv_order_attributes__dbt_tmp" rename to "cv_order_attributes"
[0m16:37:24.435828 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:37:24.438450 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: COMMIT
[0m16:37:24.439439 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:37:24.440489 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: COMMIT
[0m16:37:24.443216 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:37:24.447800 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_order_attributes"
[0m16:37:24.448937 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_order_attributes"} */
drop view if exists "postgres"."dbt"."cv_order_attributes__dbt_backup" cascade
[0m16:37:24.450287 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:37:24.452355 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_order_attributes (execute): 2024-09-01 16:37:24.392048 => 2024-09-01 16:37:24.452296
[0m16:37:24.453337 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_order_attributes: Close
[0m16:37:24.454712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '854bd436-0b2d-40c7-a30a-f66a811ab910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02b5032b0>]}
[0m16:37:24.455851 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.cv_order_attributes ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:37:24.457413 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_order_attributes
[0m16:37:24.460194 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:24.461471 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:24.462527 [debug] [MainThread]: On master: BEGIN
[0m16:37:24.463589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:24.471436 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:37:24.473110 [debug] [MainThread]: On master: COMMIT
[0m16:37:24.474107 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:24.475348 [debug] [MainThread]: On master: COMMIT
[0m16:37:24.476716 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:37:24.477790 [debug] [MainThread]: On master: Close
[0m16:37:24.479505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:24.481040 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_order_attributes' was properly closed.
[0m16:37:24.482263 [info ] [MainThread]: 
[0m16:37:24.483302 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m16:37:24.484613 [debug] [MainThread]: Command end result
[0m16:37:24.553721 [info ] [MainThread]: 
[0m16:37:24.554882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:24.556081 [info ] [MainThread]: 
[0m16:37:24.557294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:37:24.558836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c8e79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c86f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02c86f520>]}
[0m16:37:24.560066 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:39:36.823421 | f89d0f29-8ab2-4c0e-bf40-50a69a2c3421 ==============================
[0m16:39:36.823421 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:39:36.826743 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:39:36.827757 [debug] [MainThread]: Tracking: tracking
[0m16:39:36.832988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9eac046bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea906b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea906be50>]}
[0m16:39:40.095077 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 0 files changed.
[0m16:39:40.096764 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_order_attributes.sql
[0m16:39:40.097624 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_business_area.sql
[0m16:39:40.098380 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/d_date.sql
[0m16:39:40.099174 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_order_attributes.sql
[0m16:39:40.099981 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_business_area.sql
[0m16:39:40.126684 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_order_attributes.sql
[0m16:39:40.143990 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_business_area.sql
[0m16:39:40.149094 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_date.sql
[0m16:39:40.194284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f89d0f29-8ab2-4c0e-bf40-50a69a2c3421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea8f6f0d0>]}
[0m16:39:40.245950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f89d0f29-8ab2-4c0e-bf40-50a69a2c3421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea8c4d820>]}
[0m16:39:40.247101 [info ] [MainThread]: Found 103 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:39:40.248657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f89d0f29-8ab2-4c0e-bf40-50a69a2c3421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea906b7f0>]}
[0m16:39:40.255427 [info ] [MainThread]: 
[0m16:39:40.258480 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:40.260862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:39:40.277070 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:39:40.278429 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:39:40.279695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:40.288395 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:39:40.291121 [debug] [ThreadPool]: On list_postgres: Close
[0m16:39:40.301607 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:39:40.311083 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:39:40.312431 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:39:40.313615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:40.321479 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:39:40.323166 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:39:40.324333 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:39:40.328387 [debug] [ThreadPool]: SQL status: SELECT 118 in 0 seconds
[0m16:39:40.334478 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:39:40.335977 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:39:40.365789 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:40.367244 [debug] [MainThread]: On master: BEGIN
[0m16:39:40.368646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:40.376633 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:40.378250 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:40.379520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:40.449482 [debug] [MainThread]: SQL status: SELECT 106 in 0 seconds
[0m16:39:40.466791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f89d0f29-8ab2-4c0e-bf40-50a69a2c3421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea9088430>]}
[0m16:39:40.468258 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:40.469570 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:40.470629 [debug] [MainThread]: On master: BEGIN
[0m16:39:40.472098 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:40.473447 [debug] [MainThread]: On master: COMMIT
[0m16:39:40.474619 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:40.475773 [debug] [MainThread]: On master: COMMIT
[0m16:39:40.477031 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:40.478034 [debug] [MainThread]: On master: Close
[0m16:39:40.479508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:39:40.480731 [info ] [MainThread]: 
[0m16:39:40.485556 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:39:40.486854 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.d_date ......................................... [RUN]
[0m16:39:40.488598 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:39:40.489844 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:39:40.495985 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:39:40.503879 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:39:40.490935 => 2024-09-01 16:39:40.503759
[0m16:39:40.504712 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:39:40.559751 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:39:40.567311 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:39:40.568070 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:39:40.568833 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:39:40.576111 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:39:40.577506 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:39:40.578728 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date,
    date_trunc('month', d.as_of_date)
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:39:40.581144 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:39:40.591523 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:39:40.592601 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date__dbt_tmp" rename to "d_date"
[0m16:39:40.593925 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:39:40.616147 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m16:39:40.617374 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:39:40.618473 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m16:39:40.621326 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:39:40.629262 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:39:40.630493 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
drop view if exists "postgres"."dbt"."d_date__dbt_backup" cascade
[0m16:39:40.631727 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:39:40.633953 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:39:40.505338 => 2024-09-01 16:39:40.633894
[0m16:39:40.634950 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m16:39:40.636372 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f89d0f29-8ab2-4c0e-bf40-50a69a2c3421', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9b8d2b50>]}
[0m16:39:40.637526 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.d_date .................................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:39:40.640553 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m16:39:40.643381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:40.644516 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:40.645600 [debug] [MainThread]: On master: BEGIN
[0m16:39:40.646673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:40.654625 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:40.656194 [debug] [MainThread]: On master: COMMIT
[0m16:39:40.657244 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:40.658279 [debug] [MainThread]: On master: COMMIT
[0m16:39:40.659514 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:40.660462 [debug] [MainThread]: On master: Close
[0m16:39:40.661831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:40.662869 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m16:39:40.664059 [info ] [MainThread]: 
[0m16:39:40.665108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m16:39:40.666294 [debug] [MainThread]: Command end result
[0m16:39:40.699713 [info ] [MainThread]: 
[0m16:39:40.700823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:40.702061 [info ] [MainThread]: 
[0m16:39:40.703245 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:39:40.704608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea8f1aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea8b46a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ea8b46d90>]}
[0m16:39:40.705686 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:40:49.448373 | 2230bb0f-d4a0-4bd3-bb12-18b0002cfff6 ==============================
[0m16:40:49.448373 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:40:49.451562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:40:49.452756 [debug] [MainThread]: Tracking: tracking
[0m16:40:49.459139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1aa520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1aa130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1aaa30>]}
[0m16:40:52.590945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:52.592641 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/d_date.sql
[0m16:40:52.618116 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_date.sql
[0m16:40:52.676615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2230bb0f-d4a0-4bd3-bb12-18b0002cfff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa044fd0>]}
[0m16:40:52.728295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2230bb0f-d4a0-4bd3-bb12-18b0002cfff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf9d78ee0>]}
[0m16:40:52.729486 [info ] [MainThread]: Found 103 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:40:52.730605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2230bb0f-d4a0-4bd3-bb12-18b0002cfff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1a10a0>]}
[0m16:40:52.739210 [info ] [MainThread]: 
[0m16:40:52.742848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:52.745218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:40:52.763064 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:40:52.764559 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:40:52.765775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:52.774941 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:40:52.777783 [debug] [ThreadPool]: On list_postgres: Close
[0m16:40:52.789774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:40:52.800384 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:40:52.801660 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:40:52.802679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:52.811024 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:40:52.812430 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:40:52.813561 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:40:52.817686 [debug] [ThreadPool]: SQL status: SELECT 119 in 0 seconds
[0m16:40:52.824533 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:40:52.825738 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:40:52.856450 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:52.857766 [debug] [MainThread]: On master: BEGIN
[0m16:40:52.858807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:52.866818 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:40:52.868240 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:52.869088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:52.940948 [debug] [MainThread]: SQL status: SELECT 107 in 0 seconds
[0m16:40:52.959215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2230bb0f-d4a0-4bd3-bb12-18b0002cfff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf9f55760>]}
[0m16:40:52.960457 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:52.961533 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:52.962515 [debug] [MainThread]: On master: BEGIN
[0m16:40:52.963785 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:40:52.965164 [debug] [MainThread]: On master: COMMIT
[0m16:40:52.966185 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:52.967245 [debug] [MainThread]: On master: COMMIT
[0m16:40:52.968441 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:40:52.969508 [debug] [MainThread]: On master: Close
[0m16:40:52.971207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:40:52.972596 [info ] [MainThread]: 
[0m16:40:52.978753 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:40:52.980427 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.d_date ......................................... [RUN]
[0m16:40:52.982257 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:40:52.983486 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:40:52.989698 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:40:52.997020 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:40:52.984416 => 2024-09-01 16:40:52.996886
[0m16:40:52.998043 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:40:53.053898 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:40:53.061930 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:40:53.062721 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:40:53.063393 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:40:53.070763 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:40:53.072212 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:40:53.073487 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date,
    date_trunc('month', d.as_of_date),
    extract(WEEK FROM TIMESTAMP d.as_of_date)
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:40:53.074765 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "d"
LINE 7:     extract(WEEK FROM TIMESTAMP d.as_of_date)
                                        ^

[0m16:40:53.076026 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: ROLLBACK
[0m16:40:53.077563 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:40:52.998810 => 2024-09-01 16:40:53.077487
[0m16:40:53.078487 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m16:40:53.081488 [debug] [Thread-1  ]: Database Error in model d_date (models/cdm/d_date.sql)
  syntax error at or near "d"
  LINE 7:     extract(WEEK FROM TIMESTAMP d.as_of_date)
                                          ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:40:53.082726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2230bb0f-d4a0-4bd3-bb12-18b0002cfff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf8a2abb0>]}
[0m16:40:53.084050 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.d_date ................................ [[31mERROR[0m in 0.10s]
[0m16:40:53.086962 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m16:40:53.089848 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:53.091076 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:53.092026 [debug] [MainThread]: On master: BEGIN
[0m16:40:53.093132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:53.101116 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:40:53.102550 [debug] [MainThread]: On master: COMMIT
[0m16:40:53.103668 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:53.104720 [debug] [MainThread]: On master: COMMIT
[0m16:40:53.106141 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:40:53.107521 [debug] [MainThread]: On master: Close
[0m16:40:53.109636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:53.110723 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m16:40:53.111942 [info ] [MainThread]: 
[0m16:40:53.113332 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m16:40:53.114737 [debug] [MainThread]: Command end result
[0m16:40:53.147794 [info ] [MainThread]: 
[0m16:40:53.148944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:40:53.150177 [info ] [MainThread]: 
[0m16:40:53.151614 [error] [MainThread]: [33mDatabase Error in model d_date (models/cdm/d_date.sql)[0m
[0m16:40:53.152905 [error] [MainThread]:   syntax error at or near "d"
[0m16:40:53.154268 [error] [MainThread]:   LINE 7:     extract(WEEK FROM TIMESTAMP d.as_of_date)
[0m16:40:53.155664 [error] [MainThread]:                                           ^
[0m16:40:53.157078 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:40:53.158682 [info ] [MainThread]: 
[0m16:40:53.160209 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:40:53.161692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa1a10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa08f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bfa08f880>]}
[0m16:40:53.162948 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:41:30.948582 | fd134d80-cd1d-4916-b45b-bc3349821698 ==============================
[0m16:41:30.948582 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:41:30.951558 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:41:30.952693 [debug] [MainThread]: Tracking: tracking
[0m16:41:30.958110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f4251bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f127a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f127ae50>]}
[0m16:41:33.986235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:41:33.987669 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/d_date.sql
[0m16:41:34.013818 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_date.sql
[0m16:41:34.071528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd134d80-cd1d-4916-b45b-bc3349821698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1125fa0>]}
[0m16:41:34.120901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd134d80-cd1d-4916-b45b-bc3349821698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f0e5aeb0>]}
[0m16:41:34.122089 [info ] [MainThread]: Found 103 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:41:34.123273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd134d80-cd1d-4916-b45b-bc3349821698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f127a7f0>]}
[0m16:41:34.130997 [info ] [MainThread]: 
[0m16:41:34.134143 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:41:34.136321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:41:34.152631 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:41:34.154016 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:41:34.155246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:34.164162 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:41:34.166899 [debug] [ThreadPool]: On list_postgres: Close
[0m16:41:34.177670 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:41:34.187243 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:41:34.188534 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:41:34.189712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:34.198463 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:41:34.199921 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:41:34.201385 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:41:34.205488 [debug] [ThreadPool]: SQL status: SELECT 119 in 0 seconds
[0m16:41:34.212737 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:41:34.214574 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:41:34.247442 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:34.248502 [debug] [MainThread]: On master: BEGIN
[0m16:41:34.249393 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:34.257422 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:41:34.258877 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:34.260315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:41:34.333407 [debug] [MainThread]: SQL status: SELECT 107 in 0 seconds
[0m16:41:34.351667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd134d80-cd1d-4916-b45b-bc3349821698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f2ae6820>]}
[0m16:41:34.353046 [debug] [MainThread]: On master: ROLLBACK
[0m16:41:34.354268 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:34.355221 [debug] [MainThread]: On master: BEGIN
[0m16:41:34.356496 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:41:34.357697 [debug] [MainThread]: On master: COMMIT
[0m16:41:34.358831 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:34.359889 [debug] [MainThread]: On master: COMMIT
[0m16:41:34.360927 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:41:34.361821 [debug] [MainThread]: On master: Close
[0m16:41:34.363094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:41:34.364176 [info ] [MainThread]: 
[0m16:41:34.368783 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:41:34.370196 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.d_date ......................................... [RUN]
[0m16:41:34.371921 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:41:34.372957 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:41:34.378572 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:41:34.386602 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:41:34.373725 => 2024-09-01 16:41:34.386456
[0m16:41:34.387593 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:41:34.444831 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:41:34.453672 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:41:34.454475 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:41:34.455163 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:41:34.462664 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:41:34.464198 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:41:34.465490 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date,
    date_trunc('month', d.as_of_date),
    extract(WEEK FROM d.as_of_date)
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:41:34.468197 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:41:34.477915 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:41:34.479124 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m16:41:56.918062 [debug] [Thread-1  ]: Postgres adapter: Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m16:41:56.919732 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: ROLLBACK
[0m16:41:56.921417 [debug] [Thread-1  ]: Failed to rollback 'model.otus_project_dbtvault.d_date'
[0m16:41:56.922853 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m16:41:56.924203 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m16:41:56.925389 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:41:34.388500 => 2024-09-01 16:41:56.925281
[0m16:41:56.926369 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m16:41:56.929373 [debug] [Thread-1  ]: Database Error in model d_date (models/cdm/d_date.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:41:56.930518 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd134d80-cd1d-4916-b45b-bc3349821698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f115e2b0>]}
[0m16:41:56.931778 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.d_date ................................ [[31mERROR[0m in 22.56s]
[0m16:41:56.934894 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m16:41:56.937727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:41:56.938532 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:56.939182 [debug] [MainThread]: On master: BEGIN
[0m16:41:56.939841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:56.942016 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.3), port 5432 failed: FATAL:  the database system is shutting down

[0m16:41:56.944830 [debug] [MainThread]: Postgres adapter: Error running SQL: BEGIN
[0m16:41:56.946265 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m16:41:56.947151 [info ] [MainThread]: Database error while running on-run-end
[0m16:41:56.950770 [debug] [MainThread]: On master: No close available on handle
[0m16:41:56.952205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:56.953154 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m16:41:56.957696 [info ] [MainThread]: 
[0m16:41:56.959126 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 22.83 seconds (22.83s).
[0m16:41:56.961001 [debug] [MainThread]: Command end result
[0m16:41:57.003983 [info ] [MainThread]: 
[0m16:41:57.005146 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:41:57.006368 [info ] [MainThread]: 
[0m16:41:57.007478 [error] [MainThread]: [33mDatabase Error in model d_date (models/cdm/d_date.sql)[0m
[0m16:41:57.008618 [error] [MainThread]:   terminating connection due to administrator command
[0m16:41:57.009987 [error] [MainThread]:   server closed the connection unexpectedly
[0m16:41:57.011443 [error] [MainThread]:   	This probably means the server terminated abnormally
[0m16:41:57.012741 [error] [MainThread]:   	before or while processing the request.
[0m16:41:57.013869 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:41:57.014968 [info ] [MainThread]: 
[0m16:41:57.016096 [error] [MainThread]: [33mon-run-end failed, error:[0m
[0m16:41:57.017189 [error] [MainThread]:  connection to server at "postgres" (172.19.0.3), port 5432 failed: FATAL:  the database system is shutting down
[0m16:41:57.018273 [error] [MainThread]: 
[0m16:41:57.019496 [info ] [MainThread]: 
[0m16:41:57.020568 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:41:57.021878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1172910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f127a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78f1277400>]}
[0m16:41:57.023438 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:42:23.408500 | 5e7fc078-7ac3-4cff-b183-9c4c3839b670 ==============================
[0m16:42:23.408500 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:42:23.411207 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:42:23.412515 [debug] [MainThread]: Tracking: tracking
[0m16:42:23.417621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8f729100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8f729cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8f729430>]}
[0m16:42:23.420796 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e0rzw1g8'
[0m16:42:23.422230 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:42:24.524567 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:24.525869 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m16:42:24.527062 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:42:24.527872 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:42:24.533161 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:42:24.534575 [debug] [MainThread]: STDERR: "b''"
[0m16:42:24.535673 [debug] [MainThread]:   Checking out revision master.
[0m16:42:24.536626 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:42:24.542218 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:24.543404 [debug] [MainThread]: STDERR: "b''"
[0m16:42:24.544359 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:42:25.994691 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:25.995902 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m16:42:25.996713 [debug] [MainThread]: Executing "git tag --list"
[0m16:42:26.001183 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:42:26.002599 [debug] [MainThread]: STDERR: "b''"
[0m16:42:26.003950 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:42:26.015624 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:42:26.016946 [debug] [MainThread]: STDERR: "b''"
[0m16:42:26.017975 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:42:26.022695 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:42:26.024254 [debug] [MainThread]: STDERR: "b''"
[0m16:42:26.025101 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m16:42:26.026496 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:42:26.039273 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:42:26.370265 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:42:26.372050 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:42:26.577799 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:42:26.723026 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:42:26.728063 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:26.729738 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:42:26.730681 [debug] [MainThread]: command return code=128
[0m16:42:26.732358 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:42:26.733233 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:42:26.737555 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:42:26.738896 [debug] [MainThread]: STDERR: "b''"
[0m16:42:26.740040 [debug] [MainThread]:   Checking out revision master.
[0m16:42:26.741121 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:42:26.746938 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:26.748209 [debug] [MainThread]: STDERR: "b''"
[0m16:42:26.749170 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:42:27.603453 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:27.604528 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:42:27.605246 [debug] [MainThread]: Executing "git tag --list"
[0m16:42:27.609736 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:42:27.611042 [debug] [MainThread]: STDERR: "b''"
[0m16:42:27.611944 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:42:27.618660 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:42:27.620145 [debug] [MainThread]: STDERR: "b''"
[0m16:42:27.621474 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:42:27.626736 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:42:27.628378 [debug] [MainThread]: STDERR: "b''"
[0m16:42:27.629554 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:42:27.631072 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:42:27.643922 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m16:42:27.837832 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:42:27.843682 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:27.845132 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:42:27.846154 [debug] [MainThread]: command return code=128
[0m16:42:27.847474 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:42:27.848358 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:42:27.852808 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:42:27.854287 [debug] [MainThread]: STDERR: "b''"
[0m16:42:27.855295 [debug] [MainThread]:   Checking out revision master.
[0m16:42:27.856412 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:42:27.862147 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:27.863598 [debug] [MainThread]: STDERR: "b''"
[0m16:42:27.864604 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:42:28.653921 [debug] [MainThread]: STDOUT: "b''"
[0m16:42:28.655695 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:42:28.656654 [debug] [MainThread]: Executing "git tag --list"
[0m16:42:28.661606 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:42:28.662977 [debug] [MainThread]: STDERR: "b''"
[0m16:42:28.664016 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:42:28.670926 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:42:28.672377 [debug] [MainThread]: STDERR: "b''"
[0m16:42:28.673527 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:42:28.677841 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:42:28.679093 [debug] [MainThread]: STDERR: "b''"
[0m16:42:28.680150 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:42:31.359791 [info ] [MainThread]:   Installed from revision master
[0m16:42:31.361643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e7fc078-7ac3-4cff-b183-9c4c3839b670', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8f726370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8feb5790>]}
[0m16:42:31.363478 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:42:35.863930 [info ] [MainThread]:   Installed from version 1.3.0
[0m16:42:35.864944 [info ] [MainThread]:   Up to date!
[0m16:42:35.866335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5e7fc078-7ac3-4cff-b183-9c4c3839b670', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d904c0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8feb5790>]}
[0m16:42:35.867502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8f844700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d907c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d8f78b430>]}
[0m16:42:35.868247 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:42:43.106377 | 8ef30114-275c-4c36-9852-ceb84ad6903e ==============================
[0m16:42:43.106377 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:42:43.109520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:42:43.110520 [debug] [MainThread]: Tracking: tracking
[0m16:42:43.115937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a1162ebb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e64e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e64ee50>]}
[0m16:42:46.376995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:46.377982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:46.398388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ef30114-275c-4c36-9852-ceb84ad6903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e5b9940>]}
[0m16:42:46.454473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ef30114-275c-4c36-9852-ceb84ad6903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e342340>]}
[0m16:42:46.455659 [info ] [MainThread]: Found 103 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:42:46.456829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef30114-275c-4c36-9852-ceb84ad6903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e64e7f0>]}
[0m16:42:46.464024 [info ] [MainThread]: 
[0m16:42:46.467906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:46.470650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:42:46.486855 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:42:46.488246 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:42:46.489463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:46.500707 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:42:46.503521 [debug] [ThreadPool]: On list_postgres: Close
[0m16:42:46.514998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:42:46.524179 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:42:46.525405 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:42:46.526517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:46.534659 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:42:46.536396 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:42:46.537672 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:42:46.541925 [debug] [ThreadPool]: SQL status: SELECT 119 in 0 seconds
[0m16:42:46.548054 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:42:46.549505 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:42:46.589866 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:46.591237 [debug] [MainThread]: On master: BEGIN
[0m16:42:46.592378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:46.600006 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:42:46.601307 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:46.602185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:46.671461 [debug] [MainThread]: SQL status: SELECT 107 in 0 seconds
[0m16:42:46.689027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ef30114-275c-4c36-9852-ceb84ad6903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a1162ebb0>]}
[0m16:42:46.690324 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:46.691632 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:46.692647 [debug] [MainThread]: On master: BEGIN
[0m16:42:46.694085 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:42:46.695321 [debug] [MainThread]: On master: COMMIT
[0m16:42:46.696513 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:46.697531 [debug] [MainThread]: On master: COMMIT
[0m16:42:46.698768 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:42:46.699893 [debug] [MainThread]: On master: Close
[0m16:42:46.701550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:46.702540 [info ] [MainThread]: 
[0m16:42:46.707498 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:42:46.708908 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.d_date ......................................... [RUN]
[0m16:42:46.710584 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:42:46.711772 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:42:46.717126 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:42:46.724846 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:42:46.712758 => 2024-09-01 16:42:46.724725
[0m16:42:46.725661 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:42:46.780751 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:42:46.789712 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:42:46.790700 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:42:46.791413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:42:46.798627 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:42:46.800130 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:42:46.801525 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date,
    date_trunc('month', d.as_of_date),
    extract(WEEK FROM d.as_of_date)
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:42:46.804629 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:42:46.815014 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:42:46.816315 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m16:42:46.817736 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:42:46.824014 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:42:46.825293 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date__dbt_tmp" rename to "d_date"
[0m16:42:46.826782 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:42:46.851333 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m16:42:46.852637 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:42:46.853757 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m16:42:46.857418 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:42:46.865576 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:42:46.866672 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
drop view if exists "postgres"."dbt"."d_date__dbt_backup" cascade
[0m16:42:46.869881 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:42:46.872297 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:42:46.726311 => 2024-09-01 16:42:46.872236
[0m16:42:46.873373 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m16:42:46.875149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ef30114-275c-4c36-9852-ceb84ad6903e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e5b79a0>]}
[0m16:42:46.876524 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.d_date .................................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:42:46.879472 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m16:42:46.882623 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:46.883777 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:46.884815 [debug] [MainThread]: On master: BEGIN
[0m16:42:46.885619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:46.894001 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:42:46.895219 [debug] [MainThread]: On master: COMMIT
[0m16:42:46.896290 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:46.897339 [debug] [MainThread]: On master: COMMIT
[0m16:42:46.898591 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:42:46.899675 [debug] [MainThread]: On master: Close
[0m16:42:46.901177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:46.902218 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m16:42:46.903315 [info ] [MainThread]: 
[0m16:42:46.904393 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m16:42:46.905602 [debug] [MainThread]: Command end result
[0m16:42:46.941499 [info ] [MainThread]: 
[0m16:42:46.942858 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:46.944268 [info ] [MainThread]: 
[0m16:42:46.945511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:42:46.946980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e64e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e648c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a0e648cd0>]}
[0m16:42:46.948124 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:43:56.837771 | 0df5ce0b-60a5-42d9-a846-353722f14dbc ==============================
[0m16:43:56.837771 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:43:56.840977 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:43:56.841995 [debug] [MainThread]: Tracking: tracking
[0m16:43:56.847287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be3b50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be3b5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be3b5160>]}
[0m16:44:00.156395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:00.157972 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/d_date.sql
[0m16:44:00.183446 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_date.sql
[0m16:44:00.242419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0df5ce0b-60a5-42d9-a846-353722f14dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be26ff70>]}
[0m16:44:00.292957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0df5ce0b-60a5-42d9-a846-353722f14dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bdfa4d90>]}
[0m16:44:00.294121 [info ] [MainThread]: Found 103 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:44:00.295358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df5ce0b-60a5-42d9-a846-353722f14dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be3c2af0>]}
[0m16:44:00.302673 [info ] [MainThread]: 
[0m16:44:00.305833 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:00.308003 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:44:00.324908 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:44:00.326257 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:44:00.327426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:00.336704 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:44:00.339347 [debug] [ThreadPool]: On list_postgres: Close
[0m16:44:00.350055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:44:00.360016 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:44:00.361327 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:44:00.362400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:00.370362 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:44:00.371887 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:44:00.372910 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:44:00.375972 [debug] [ThreadPool]: SQL status: SELECT 119 in 0 seconds
[0m16:44:00.381870 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:44:00.384430 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:44:00.414951 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:00.416197 [debug] [MainThread]: On master: BEGIN
[0m16:44:00.417333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:00.425005 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:44:00.426320 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:00.427437 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:00.496477 [debug] [MainThread]: SQL status: SELECT 107 in 0 seconds
[0m16:44:00.513562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df5ce0b-60a5-42d9-a846-353722f14dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be3b41f0>]}
[0m16:44:00.514947 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:00.516474 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:00.517752 [debug] [MainThread]: On master: BEGIN
[0m16:44:00.519296 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:44:00.520621 [debug] [MainThread]: On master: COMMIT
[0m16:44:00.521879 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:00.522893 [debug] [MainThread]: On master: COMMIT
[0m16:44:00.524100 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:44:00.525298 [debug] [MainThread]: On master: Close
[0m16:44:00.526692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:00.527856 [info ] [MainThread]: 
[0m16:44:00.532961 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:44:00.534434 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.d_date ......................................... [RUN]
[0m16:44:00.536324 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:44:00.537104 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:44:00.543286 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:44:00.550729 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:44:00.537732 => 2024-09-01 16:44:00.550607
[0m16:44:00.551570 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:44:00.611827 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:44:00.619673 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:44:00.620492 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:44:00.621164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:44:00.628941 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:44:00.630319 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:44:00.631376 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date as date_value,
    extract(YEAR FROM d.as_of_date),
    extract(MONTH FROM d.as_of_date),
    extract(DAY FROM d.as_of_date),
    extract(WEEK FROM d.as_of_date)
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:44:00.633257 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "extract" specified more than once

[0m16:44:00.634860 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: ROLLBACK
[0m16:44:00.636420 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:44:00.552422 => 2024-09-01 16:44:00.636329
[0m16:44:00.637531 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m16:44:00.640927 [debug] [Thread-1  ]: Database Error in model d_date (models/cdm/d_date.sql)
  column "extract" specified more than once
  compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:44:00.642250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0df5ce0b-60a5-42d9-a846-353722f14dbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bcc53b50>]}
[0m16:44:00.643920 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.d_date ................................ [[31mERROR[0m in 0.11s]
[0m16:44:00.646933 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m16:44:00.649990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:00.651333 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:00.652545 [debug] [MainThread]: On master: BEGIN
[0m16:44:00.654040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:00.661646 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:44:00.663412 [debug] [MainThread]: On master: COMMIT
[0m16:44:00.664721 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:00.665822 [debug] [MainThread]: On master: COMMIT
[0m16:44:00.667265 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:44:00.668225 [debug] [MainThread]: On master: Close
[0m16:44:00.669543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:00.670352 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m16:44:00.671339 [info ] [MainThread]: 
[0m16:44:00.672691 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m16:44:00.673921 [debug] [MainThread]: Command end result
[0m16:44:00.707408 [info ] [MainThread]: 
[0m16:44:00.708754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:44:00.710239 [info ] [MainThread]: 
[0m16:44:00.711757 [error] [MainThread]: [33mDatabase Error in model d_date (models/cdm/d_date.sql)[0m
[0m16:44:00.713738 [error] [MainThread]:   column "extract" specified more than once
[0m16:44:00.715326 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:44:00.716657 [info ] [MainThread]: 
[0m16:44:00.718078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:44:00.719997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bfbc0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be3c2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92be2b2580>]}
[0m16:44:00.721437 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:44:39.475934 | da3ac6f2-5761-4537-8ce4-f2bfa4766535 ==============================
[0m16:44:39.475934 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:44:39.479396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:44:39.480555 [debug] [MainThread]: Tracking: tracking
[0m16:44:39.485867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05305ed520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05305ed130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05305eda30>]}
[0m16:44:42.785130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:42.786895 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/d_date.sql
[0m16:44:42.814732 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_date.sql
[0m16:44:42.871326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da3ac6f2-5761-4537-8ce4-f2bfa4766535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0530485fd0>]}
[0m16:44:42.921935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da3ac6f2-5761-4537-8ce4-f2bfa4766535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05301bbee0>]}
[0m16:44:42.923108 [info ] [MainThread]: Found 103 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:44:42.924262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3ac6f2-5761-4537-8ce4-f2bfa4766535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05305d1a30>]}
[0m16:44:42.931867 [info ] [MainThread]: 
[0m16:44:42.935184 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:42.937337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:44:42.954381 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:44:42.956096 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:44:42.957451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:42.966745 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:44:42.969672 [debug] [ThreadPool]: On list_postgres: Close
[0m16:44:42.980738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:44:42.990915 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:44:42.992563 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:44:42.993719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:43.002055 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:44:43.003830 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:44:43.005101 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:44:43.008616 [debug] [ThreadPool]: SQL status: SELECT 119 in 0 seconds
[0m16:44:43.015097 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:44:43.016570 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:44:43.047730 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:43.048966 [debug] [MainThread]: On master: BEGIN
[0m16:44:43.049810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:43.057641 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:44:43.059057 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:43.060054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:43.134242 [debug] [MainThread]: SQL status: SELECT 107 in 0 seconds
[0m16:44:43.151457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3ac6f2-5761-4537-8ce4-f2bfa4766535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053038a760>]}
[0m16:44:43.152982 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:43.154640 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:43.155725 [debug] [MainThread]: On master: BEGIN
[0m16:44:43.156856 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:44:43.158017 [debug] [MainThread]: On master: COMMIT
[0m16:44:43.158992 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:43.159998 [debug] [MainThread]: On master: COMMIT
[0m16:44:43.161158 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:44:43.162061 [debug] [MainThread]: On master: Close
[0m16:44:43.163464 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:43.164547 [info ] [MainThread]: 
[0m16:44:43.169556 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:44:43.170929 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.d_date ......................................... [RUN]
[0m16:44:43.172716 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:44:43.173891 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:44:43.179485 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:44:43.187904 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:44:43.174658 => 2024-09-01 16:44:43.187767
[0m16:44:43.188876 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:44:43.244926 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:44:43.253381 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:44:43.254159 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:44:43.254820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:44:43.262092 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:44:43.263716 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:44:43.265019 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date as date_value,
    extract(YEAR FROM d.as_of_date) as year,
    extract(MONTH FROM d.as_of_date) as month,
    extract(DAY FROM d.as_of_date) as day,
    extract(WEEK FROM d.as_of_date) as week
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:44:43.267506 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:44:43.277692 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:44:43.278973 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m16:44:58.209317 [debug] [Thread-1  ]: Postgres adapter: Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m16:44:58.210924 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: ROLLBACK
[0m16:44:58.212725 [debug] [Thread-1  ]: Failed to rollback 'model.otus_project_dbtvault.d_date'
[0m16:44:58.214013 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m16:44:58.215347 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m16:44:58.216519 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:44:43.189696 => 2024-09-01 16:44:58.216443
[0m16:44:58.217218 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m16:44:58.219772 [debug] [Thread-1  ]: Database Error in model d_date (models/cdm/d_date.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:44:58.220951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3ac6f2-5761-4537-8ce4-f2bfa4766535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05304f32e0>]}
[0m16:44:58.221954 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.d_date ................................ [[31mERROR[0m in 15.05s]
[0m16:44:58.224382 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m16:44:58.226819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:58.227773 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:58.228607 [debug] [MainThread]: On master: BEGIN
[0m16:44:58.229457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:58.231701 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.3), port 5432 failed: FATAL:  the database system is shutting down

[0m16:44:58.234749 [debug] [MainThread]: Postgres adapter: Error running SQL: BEGIN
[0m16:44:58.235996 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m16:44:58.237158 [info ] [MainThread]: Database error while running on-run-end
[0m16:44:58.238364 [debug] [MainThread]: On master: No close available on handle
[0m16:44:58.239889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:58.240767 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m16:44:58.241559 [info ] [MainThread]: 
[0m16:44:58.242671 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.31 seconds (15.31s).
[0m16:44:58.244030 [debug] [MainThread]: Command end result
[0m16:44:58.291791 [info ] [MainThread]: 
[0m16:44:58.293157 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:44:58.294445 [info ] [MainThread]: 
[0m16:44:58.295746 [error] [MainThread]: [33mDatabase Error in model d_date (models/cdm/d_date.sql)[0m
[0m16:44:58.297280 [error] [MainThread]:   terminating connection due to administrator command
[0m16:44:58.298659 [error] [MainThread]:   server closed the connection unexpectedly
[0m16:44:58.300315 [error] [MainThread]:   	This probably means the server terminated abnormally
[0m16:44:58.301701 [error] [MainThread]:   	before or while processing the request.
[0m16:44:58.303093 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m16:44:58.304638 [info ] [MainThread]: 
[0m16:44:58.306042 [error] [MainThread]: [33mon-run-end failed, error:[0m
[0m16:44:58.307449 [error] [MainThread]:  connection to server at "postgres" (172.19.0.3), port 5432 failed: FATAL:  the database system is shutting down
[0m16:44:58.308705 [error] [MainThread]: 
[0m16:44:58.310081 [info ] [MainThread]: 
[0m16:44:58.311296 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m16:44:58.312858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05305d1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531dd7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0531dd7280>]}
[0m16:44:58.313914 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:45:26.765890 | d85bee36-c798-45cc-8ba1-51c5d0166118 ==============================
[0m16:45:26.765890 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:45:26.768191 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:45:26.769123 [debug] [MainThread]: Tracking: tracking
[0m16:45:26.773551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646bcdd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646bcddcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646bcdd490>]}
[0m16:45:26.776623 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-f2wa18bi'
[0m16:45:26.777983 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:45:27.878098 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:27.879441 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m16:45:27.880647 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:45:27.881665 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:45:27.886502 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:45:27.887856 [debug] [MainThread]: STDERR: "b''"
[0m16:45:27.888853 [debug] [MainThread]:   Checking out revision master.
[0m16:45:27.889798 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:45:27.895699 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:27.897081 [debug] [MainThread]: STDERR: "b''"
[0m16:45:27.897877 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:45:29.440113 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:29.441320 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m16:45:29.442334 [debug] [MainThread]: Executing "git tag --list"
[0m16:45:29.446934 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:45:29.448086 [debug] [MainThread]: STDERR: "b''"
[0m16:45:29.449106 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:45:29.458839 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:45:29.460155 [debug] [MainThread]: STDERR: "b''"
[0m16:45:29.461394 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:45:29.466252 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:45:29.467720 [debug] [MainThread]: STDERR: "b''"
[0m16:45:29.468790 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m16:45:29.470519 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:45:29.484466 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:45:29.806514 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:45:29.808619 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:45:30.019995 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:45:30.168212 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:45:30.172994 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:30.174389 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:45:30.175428 [debug] [MainThread]: command return code=128
[0m16:45:30.177145 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:45:30.178093 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:45:30.182582 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:45:30.183868 [debug] [MainThread]: STDERR: "b''"
[0m16:45:30.184824 [debug] [MainThread]:   Checking out revision master.
[0m16:45:30.185789 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:45:30.191280 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:30.192604 [debug] [MainThread]: STDERR: "b''"
[0m16:45:30.193652 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:45:31.026421 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:31.027891 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:45:31.029021 [debug] [MainThread]: Executing "git tag --list"
[0m16:45:31.034527 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:45:31.036190 [debug] [MainThread]: STDERR: "b''"
[0m16:45:31.037345 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:45:31.044991 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:45:31.046458 [debug] [MainThread]: STDERR: "b''"
[0m16:45:31.047517 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:45:31.052550 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:45:31.054776 [debug] [MainThread]: STDERR: "b''"
[0m16:45:31.055925 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:45:31.057390 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:45:31.071931 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m16:45:31.281309 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:45:31.285980 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:31.287454 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:45:31.288554 [debug] [MainThread]: command return code=128
[0m16:45:31.289992 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:45:31.290805 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:45:31.295869 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:45:31.297195 [debug] [MainThread]: STDERR: "b''"
[0m16:45:31.298419 [debug] [MainThread]:   Checking out revision master.
[0m16:45:31.299512 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:45:31.307094 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:31.308395 [debug] [MainThread]: STDERR: "b''"
[0m16:45:31.309322 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:45:32.203872 [debug] [MainThread]: STDOUT: "b''"
[0m16:45:32.205056 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:45:32.205929 [debug] [MainThread]: Executing "git tag --list"
[0m16:45:32.212966 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:45:32.214936 [debug] [MainThread]: STDERR: "b''"
[0m16:45:32.215964 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:45:32.224875 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:45:32.226397 [debug] [MainThread]: STDERR: "b''"
[0m16:45:32.227456 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:45:32.232867 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:45:32.234587 [debug] [MainThread]: STDERR: "b''"
[0m16:45:32.235672 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:45:34.590543 [info ] [MainThread]:   Installed from revision master
[0m16:45:34.592238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd85bee36-c798-45cc-8ba1-51c5d0166118', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646c46a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646bcdd070>]}
[0m16:45:34.593665 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:45:39.207534 [info ] [MainThread]:   Installed from version 1.3.0
[0m16:45:39.208764 [info ] [MainThread]:   Up to date!
[0m16:45:39.209778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd85bee36-c798-45cc-8ba1-51c5d0166118', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646bcd9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646bd3ce20>]}
[0m16:45:39.211017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646bdf8880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646c3c2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646cabd6d0>]}
[0m16:45:39.211724 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:45:47.037796 | 8471f3ca-e036-4190-b5f9-78eef890b1df ==============================
[0m16:45:47.037796 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:45:47.041284 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:45:47.042628 [debug] [MainThread]: Tracking: tracking
[0m16:45:47.048574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df7806d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df780f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df7807f0>]}
[0m16:45:50.319254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:50.320088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:50.341189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8471f3ca-e036-4190-b5f9-78eef890b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df6dd9a0>]}
[0m16:45:50.400367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8471f3ca-e036-4190-b5f9-78eef890b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df3de3a0>]}
[0m16:45:50.401559 [info ] [MainThread]: Found 103 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:45:50.402950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8471f3ca-e036-4190-b5f9-78eef890b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df773e20>]}
[0m16:45:50.411292 [info ] [MainThread]: 
[0m16:45:50.414550 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:50.417234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:45:50.435625 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:45:50.436569 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:45:50.437346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:50.450806 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:45:50.453198 [debug] [ThreadPool]: On list_postgres: Close
[0m16:45:50.464017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:45:50.473485 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:45:50.474474 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:45:50.475289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:50.482906 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:45:50.484316 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:45:50.485314 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:45:50.488810 [debug] [ThreadPool]: SQL status: SELECT 119 in 0 seconds
[0m16:45:50.494457 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:45:50.495582 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:45:50.525693 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:50.526944 [debug] [MainThread]: On master: BEGIN
[0m16:45:50.527941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:50.535649 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:45:50.537196 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:50.538233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:50.608109 [debug] [MainThread]: SQL status: SELECT 107 in 0 seconds
[0m16:45:50.625477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8471f3ca-e036-4190-b5f9-78eef890b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df3de280>]}
[0m16:45:50.626783 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:50.628124 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:50.629195 [debug] [MainThread]: On master: BEGIN
[0m16:45:50.630601 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:45:50.631923 [debug] [MainThread]: On master: COMMIT
[0m16:45:50.633035 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:50.634205 [debug] [MainThread]: On master: COMMIT
[0m16:45:50.635283 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:45:50.636231 [debug] [MainThread]: On master: Close
[0m16:45:50.637670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:50.638704 [info ] [MainThread]: 
[0m16:45:50.643740 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:45:50.644917 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.d_date ......................................... [RUN]
[0m16:45:50.646359 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:45:50.647194 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:45:50.652585 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:45:50.660200 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:45:50.647947 => 2024-09-01 16:45:50.660057
[0m16:45:50.661472 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:45:50.719561 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:45:50.728004 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:45:50.728903 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:45:50.729690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:45:50.737307 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:45:50.738703 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:45:50.739827 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date as date_value,
    extract(YEAR FROM d.as_of_date) as year,
    extract(MONTH FROM d.as_of_date) as month,
    extract(DAY FROM d.as_of_date) as day,
    extract(WEEK FROM d.as_of_date) as week
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:45:50.742726 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:45:50.753652 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:45:50.754637 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m16:45:50.755855 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:45:50.761964 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:45:50.762961 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date__dbt_tmp" rename to "d_date"
[0m16:45:50.764336 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:45:50.789817 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m16:45:50.791031 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:45:50.792041 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m16:45:50.795924 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:45:50.804314 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:45:50.805457 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
drop view if exists "postgres"."dbt"."d_date__dbt_backup" cascade
[0m16:45:50.808513 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:45:50.810848 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:45:50.662400 => 2024-09-01 16:45:50.810784
[0m16:45:50.811848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m16:45:50.813273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8471f3ca-e036-4190-b5f9-78eef890b1df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df6dc910>]}
[0m16:45:50.814616 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.d_date .................................... [[32mCREATE VIEW[0m in 0.17s]
[0m16:45:50.818790 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m16:45:50.822099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:50.823263 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:50.824197 [debug] [MainThread]: On master: BEGIN
[0m16:45:50.825105 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:50.833070 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:45:50.834493 [debug] [MainThread]: On master: COMMIT
[0m16:45:50.835560 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:50.836453 [debug] [MainThread]: On master: COMMIT
[0m16:45:50.837728 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:45:50.838655 [debug] [MainThread]: On master: Close
[0m16:45:50.839885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:50.840845 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m16:45:50.841971 [info ] [MainThread]: 
[0m16:45:50.843117 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m16:45:50.844503 [debug] [MainThread]: Command end result
[0m16:45:50.878817 [info ] [MainThread]: 
[0m16:45:50.880022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:45:50.881273 [info ] [MainThread]: 
[0m16:45:50.882621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:45:50.884041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df63b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0e0fe7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0df27e370>]}
[0m16:45:50.885121 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 16:53:03.653489 | a10cce0e-cfba-4752-a836-426c30b301b5 ==============================
[0m16:53:03.653489 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:53:03.657264 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:53:03.658417 [debug] [MainThread]: Tracking: tracking
[0m16:53:03.664581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b972fdbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9431d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9431de50>]}
[0m16:53:06.957405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:53:06.959326 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_warehouse.sql
[0m16:53:06.989668 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_warehouse.sql
[0m16:53:07.053217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a10cce0e-cfba-4752-a836-426c30b301b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b941d0fd0>]}
[0m16:53:07.104169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a10cce0e-cfba-4752-a836-426c30b301b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b93e05e80>]}
[0m16:53:07.105199 [info ] [MainThread]: Found 104 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m16:53:07.106314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10cce0e-cfba-4752-a836-426c30b301b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9431d7f0>]}
[0m16:53:07.113774 [info ] [MainThread]: 
[0m16:53:07.116990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:07.119258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m16:53:07.135494 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m16:53:07.136874 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m16:53:07.138226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:07.146795 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m16:53:07.149630 [debug] [ThreadPool]: On list_postgres: Close
[0m16:53:07.160769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m16:53:07.170385 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:53:07.171733 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m16:53:07.172911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:07.180568 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:53:07.182161 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m16:53:07.183543 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m16:53:07.187083 [debug] [ThreadPool]: SQL status: SELECT 119 in 0 seconds
[0m16:53:07.192905 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m16:53:07.194235 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m16:53:07.224169 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:07.225532 [debug] [MainThread]: On master: BEGIN
[0m16:53:07.226657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:07.234786 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:53:07.236382 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:07.237503 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:07.307745 [debug] [MainThread]: SQL status: SELECT 107 in 0 seconds
[0m16:53:07.325318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a10cce0e-cfba-4752-a836-426c30b301b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b95b92610>]}
[0m16:53:07.326689 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:07.327972 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:07.329015 [debug] [MainThread]: On master: BEGIN
[0m16:53:07.330367 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:53:07.331714 [debug] [MainThread]: On master: COMMIT
[0m16:53:07.332834 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:07.333931 [debug] [MainThread]: On master: COMMIT
[0m16:53:07.335090 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:53:07.336056 [debug] [MainThread]: On master: Close
[0m16:53:07.337426 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:07.338490 [info ] [MainThread]: 
[0m16:53:07.343105 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_warehouse
[0m16:53:07.344275 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_warehouse ................................... [RUN]
[0m16:53:07.345645 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_warehouse'
[0m16:53:07.346805 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_warehouse
[0m16:53:07.353877 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_warehouse"
[0m16:53:07.362407 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_warehouse (compile): 2024-09-01 16:53:07.347502 => 2024-09-01 16:53:07.362284
[0m16:53:07.363256 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_warehouse
[0m16:53:07.418167 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_warehouse"
[0m16:53:07.426863 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_warehouse"
[0m16:53:07.427794 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_warehouse: BEGIN
[0m16:53:07.428650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:53:07.436192 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:53:07.437700 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_warehouse"
[0m16:53:07.438967 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_warehouse"} */

  create view "postgres"."dbt"."cv_warehouse__dbt_tmp" as (
    select
    sw.WAREHOUSE_PK,
    sw.name,
    sw.system_name,
    swp.max_loading_weight,
    swp.max_loading_volume,
    wac.CITY_PK
FROM "postgres"."dbt"."sat_warehouse" AS sw
LEFT JOIN "postgres"."dbt"."link_warehouse_warehouse_params" AS wp on sw.WAREHOUSE_PK = wp.WAREHOUSE_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_address_warehouse_params" AS wa ON wa.WAREHOUSE_PARAMS_PK = wp.WAREHOUSE_PARAMS_PK
LEFT JOIN "postgres"."dbt"."sat_warehouse_params" AS swp ON swp.WAREHOUSE_PARAMS_PK = wp.WAREHOUSE_PARAMS_PK
LEFT JOIN "postgres"."dbt"."link_warehouse_address_city" AS wac ON wac.WAREHOUSE_ADDRESS_PK = wa.WAREHOUSE_ADDRESS_PK
  );
[0m16:53:07.442216 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:53:07.452303 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_warehouse"
[0m16:53:07.453539 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_warehouse"} */
alter table "postgres"."dbt"."cv_warehouse__dbt_tmp" rename to "cv_warehouse"
[0m16:53:07.455181 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:53:07.477035 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_warehouse: COMMIT
[0m16:53:07.478386 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_warehouse"
[0m16:53:07.479614 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_warehouse: COMMIT
[0m16:53:07.484335 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:53:07.492730 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_warehouse"
[0m16:53:07.493799 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_warehouse"} */
drop view if exists "postgres"."dbt"."cv_warehouse__dbt_backup" cascade
[0m16:53:07.495041 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:53:07.497236 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_warehouse (execute): 2024-09-01 16:53:07.363920 => 2024-09-01 16:53:07.497177
[0m16:53:07.498322 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_warehouse: Close
[0m16:53:07.500228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10cce0e-cfba-4752-a836-426c30b301b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b92bbdc70>]}
[0m16:53:07.501780 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.cv_warehouse .............................. [[32mCREATE VIEW[0m in 0.15s]
[0m16:53:07.505068 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_warehouse
[0m16:53:07.506321 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m16:53:07.507489 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.d_date ......................................... [RUN]
[0m16:53:07.508815 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m16:53:07.509660 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m16:53:07.515469 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m16:53:07.521585 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 16:53:07.510273 => 2024-09-01 16:53:07.521475
[0m16:53:07.522412 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m16:53:07.533268 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m16:53:07.541368 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:53:07.542210 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m16:53:07.542940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:53:07.550157 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:53:07.551622 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:53:07.552782 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date as date_value,
    extract(YEAR FROM d.as_of_date) as year,
    extract(MONTH FROM d.as_of_date) as month,
    extract(DAY FROM d.as_of_date) as day,
    extract(WEEK FROM d.as_of_date) as week
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m16:53:07.555298 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:53:07.561249 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m16:53:07.562366 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m17:01:57.736566 [debug] [Thread-1  ]: Postgres adapter: Postgres error: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[0m17:01:57.737887 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: ROLLBACK
[0m17:01:57.739705 [debug] [Thread-1  ]: Failed to rollback 'model.otus_project_dbtvault.d_date'
[0m17:01:57.741302 [debug] [Thread-1  ]: Postgres adapter: Error running SQL: macro rename_relation
[0m17:01:57.742547 [debug] [Thread-1  ]: Postgres adapter: Rolling back transaction.
[0m17:01:57.744002 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 16:53:07.523023 => 2024-09-01 17:01:57.743908
[0m17:01:57.745141 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m17:01:57.748339 [debug] [Thread-1  ]: Database Error in model d_date (models/cdm/d_date.sql)
  terminating connection due to administrator command
  server closed the connection unexpectedly
  	This probably means the server terminated abnormally
  	before or while processing the request.
  compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m17:01:57.749589 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10cce0e-cfba-4752-a836-426c30b301b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b92d743d0>]}
[0m17:01:57.751133 [error] [Thread-1  ]: 2 of 2 ERROR creating sql view model dbt.d_date ................................ [[31mERROR[0m in 530.24s]
[0m17:01:57.752368 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m17:01:57.755207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:01:57.756383 [debug] [MainThread]: Using postgres connection "master"
[0m17:01:57.757426 [debug] [MainThread]: On master: BEGIN
[0m17:01:57.758367 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:57.761275 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.19.0.3), port 5432 failed: FATAL:  the database system is shutting down

[0m17:01:57.765633 [debug] [MainThread]: Postgres adapter: Error running SQL: BEGIN
[0m17:01:57.767419 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:01:57.768594 [info ] [MainThread]: Database error while running on-run-end
[0m17:01:57.770052 [debug] [MainThread]: On master: No close available on handle
[0m17:01:57.771777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:57.772821 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_date' was properly closed.
[0m17:01:57.774105 [info ] [MainThread]: 
[0m17:01:57.775389 [info ] [MainThread]: Finished running 2 view models in 0 hours 8 minutes and 50.66 seconds (530.66s).
[0m17:01:57.777309 [debug] [MainThread]: Command end result
[0m17:01:57.852671 [info ] [MainThread]: 
[0m17:01:57.853899 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m17:01:57.855134 [info ] [MainThread]: 
[0m17:01:57.856306 [error] [MainThread]: [33mDatabase Error in model d_date (models/cdm/d_date.sql)[0m
[0m17:01:57.857533 [error] [MainThread]:   terminating connection due to administrator command
[0m17:01:57.858927 [error] [MainThread]:   server closed the connection unexpectedly
[0m17:01:57.860345 [error] [MainThread]:   	This probably means the server terminated abnormally
[0m17:01:57.861741 [error] [MainThread]:   	before or while processing the request.
[0m17:01:57.863253 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/d_date.sql
[0m17:01:57.864705 [info ] [MainThread]: 
[0m17:01:57.866226 [error] [MainThread]: [33mon-run-end failed, error:[0m
[0m17:01:57.867466 [error] [MainThread]:  connection to server at "postgres" (172.19.0.3), port 5432 failed: server closed the connection unexpectedly
[0m17:01:57.868618 [error] [MainThread]: 	This probably means the server terminated abnormally
[0m17:01:57.869624 [error] [MainThread]: 	before or while processing the request.
[0m17:01:57.870824 [error] [MainThread]: 
[0m17:01:57.871963 [info ] [MainThread]: 
[0m17:01:57.873011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m17:01:57.874139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b96a91fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b9437aa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b96195f10>]}
[0m17:01:57.875051 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:03:00.375670 | 1325e402-5898-4ec8-a264-7d685e782452 ==============================
[0m17:03:00.375670 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:03:00.377894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m17:03:00.378795 [debug] [MainThread]: Tracking: tracking
[0m17:03:00.383300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ddcd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ddcdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ddcd430>]}
[0m17:03:00.386203 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-442m92vy'
[0m17:03:00.387761 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m17:03:01.471053 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:01.472427 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m17:03:01.473640 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m17:03:01.474591 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:03:01.479011 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m17:03:01.480544 [debug] [MainThread]: STDERR: "b''"
[0m17:03:01.481688 [debug] [MainThread]:   Checking out revision master.
[0m17:03:01.482652 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m17:03:01.487636 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:01.488842 [debug] [MainThread]: STDERR: "b''"
[0m17:03:01.489761 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m17:03:03.002607 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:03.003747 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m17:03:03.004461 [debug] [MainThread]: Executing "git tag --list"
[0m17:03:03.008709 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m17:03:03.009964 [debug] [MainThread]: STDERR: "b''"
[0m17:03:03.010911 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m17:03:03.020749 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m17:03:03.022048 [debug] [MainThread]: STDERR: "b''"
[0m17:03:03.022958 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:03:03.027851 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m17:03:03.029192 [debug] [MainThread]: STDERR: "b''"
[0m17:03:03.030251 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m17:03:03.031852 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m17:03:03.045554 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:03:03.364053 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:03:03.366038 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:03:03.566788 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:03:03.704753 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m17:03:03.709736 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:03.711265 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m17:03:03.712561 [debug] [MainThread]: command return code=128
[0m17:03:03.714537 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m17:03:03.715569 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:03:03.719796 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m17:03:03.721182 [debug] [MainThread]: STDERR: "b''"
[0m17:03:03.722395 [debug] [MainThread]:   Checking out revision master.
[0m17:03:03.723415 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m17:03:03.728889 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:03.730278 [debug] [MainThread]: STDERR: "b''"
[0m17:03:03.731394 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m17:03:04.537521 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:04.538852 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m17:03:04.539802 [debug] [MainThread]: Executing "git tag --list"
[0m17:03:04.545345 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m17:03:04.546573 [debug] [MainThread]: STDERR: "b''"
[0m17:03:04.547658 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m17:03:04.554865 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m17:03:04.556212 [debug] [MainThread]: STDERR: "b''"
[0m17:03:04.557298 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:03:04.561832 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m17:03:04.563241 [debug] [MainThread]: STDERR: "b''"
[0m17:03:04.564302 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m17:03:04.565752 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m17:03:04.580163 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m17:03:04.772731 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m17:03:04.776697 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:04.778424 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m17:03:04.779658 [debug] [MainThread]: command return code=128
[0m17:03:04.781106 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m17:03:04.782186 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:03:04.786415 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m17:03:04.787665 [debug] [MainThread]: STDERR: "b''"
[0m17:03:04.788664 [debug] [MainThread]:   Checking out revision master.
[0m17:03:04.789609 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m17:03:04.795141 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:04.796384 [debug] [MainThread]: STDERR: "b''"
[0m17:03:04.797330 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m17:03:05.565457 [debug] [MainThread]: STDOUT: "b''"
[0m17:03:05.566644 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m17:03:05.567506 [debug] [MainThread]: Executing "git tag --list"
[0m17:03:05.572382 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m17:03:05.573562 [debug] [MainThread]: STDERR: "b''"
[0m17:03:05.574389 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m17:03:05.581001 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m17:03:05.582325 [debug] [MainThread]: STDERR: "b''"
[0m17:03:05.583302 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m17:03:05.589325 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m17:03:05.590605 [debug] [MainThread]: STDERR: "b''"
[0m17:03:05.591729 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m17:03:08.752545 [info ] [MainThread]:   Installed from revision master
[0m17:03:08.754285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1325e402-5898-4ec8-a264-7d685e782452', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ddca370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0e558790>]}
[0m17:03:08.755861 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:03:12.618314 [info ] [MainThread]:   Installed from version 1.3.0
[0m17:03:12.619216 [info ] [MainThread]:   Up to date!
[0m17:03:12.620187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1325e402-5898-4ec8-a264-7d685e782452', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0eb63b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0e558790>]}
[0m17:03:12.621278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0dee7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0ee68d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf0de2e610>]}
[0m17:03:12.621995 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:03:24.713435 | a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf ==============================
[0m17:03:24.713435 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:03:24.716516 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:03:24.717733 [debug] [MainThread]: Tracking: tracking
[0m17:03:24.723178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590a98520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590a98130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590a98a30>]}
[0m17:03:27.966632 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 7 files added, 0 files changed.
[0m17:03:27.968391 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/d_currency.sql
[0m17:03:27.969625 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/d_order_status.sql
[0m17:03:27.970643 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/d_warehouse.sql
[0m17:03:27.971646 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/cv_warehouse.sql
[0m17:03:27.972671 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/d_business_area.sql
[0m17:03:27.973592 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/d_client_type.sql
[0m17:03:27.974514 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/d_geography_structure.sql
[0m17:03:27.975377 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/cv_warehouse.sql
[0m17:03:28.001871 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_currency.sql
[0m17:03:28.019519 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_order_status.sql
[0m17:03:28.025472 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_warehouse.sql
[0m17:03:28.031879 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/cv_warehouse.sql
[0m17:03:28.036905 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_business_area.sql
[0m17:03:28.041696 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_client_type.sql
[0m17:03:28.047235 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_geography_structure.sql
[0m17:03:28.094898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158f5290d0>]}
[0m17:03:28.146518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590672070>]}
[0m17:03:28.147500 [info ] [MainThread]: Found 110 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:03:28.148638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590a760a0>]}
[0m17:03:28.155789 [info ] [MainThread]: 
[0m17:03:28.159070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:28.161901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:03:28.177982 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:03:28.179353 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:03:28.180542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:28.189700 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:03:28.192273 [debug] [ThreadPool]: On list_postgres: Close
[0m17:03:28.203407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:03:28.212788 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:03:28.214328 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:03:28.215491 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:28.223315 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:03:28.224742 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:03:28.225893 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:03:28.230101 [debug] [ThreadPool]: SQL status: SELECT 120 in 0 seconds
[0m17:03:28.235694 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:03:28.236976 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:03:28.267020 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:28.268389 [debug] [MainThread]: On master: BEGIN
[0m17:03:28.269506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:28.277770 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:03:28.279342 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:28.280536 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:28.351244 [debug] [MainThread]: SQL status: SELECT 112 in 0 seconds
[0m17:03:28.368695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15922d0e80>]}
[0m17:03:28.369919 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:28.371086 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:28.372215 [debug] [MainThread]: On master: BEGIN
[0m17:03:28.373759 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:03:28.375290 [debug] [MainThread]: On master: COMMIT
[0m17:03:28.376597 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:28.377709 [debug] [MainThread]: On master: COMMIT
[0m17:03:28.378817 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:03:28.379817 [debug] [MainThread]: On master: Close
[0m17:03:28.381318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:28.382422 [info ] [MainThread]: 
[0m17:03:28.387104 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_business_area
[0m17:03:28.388316 [info ] [Thread-1  ]: 1 of 7 START sql view model dbt.d_business_area ................................ [RUN]
[0m17:03:28.389689 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_business_area'
[0m17:03:28.390661 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_business_area
[0m17:03:28.395595 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_business_area"
[0m17:03:28.404377 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_business_area (compile): 2024-09-01 17:03:28.391556 => 2024-09-01 17:03:28.404239
[0m17:03:28.405214 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_business_area
[0m17:03:28.460354 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_business_area"
[0m17:03:28.468676 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:03:28.469425 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: BEGIN
[0m17:03:28.470092 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:28.477342 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:03:28.478874 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:03:28.480236 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */

  create view "postgres"."dbt"."d_business_area__dbt_tmp" as (
    select
    ba.id,
    ba.business_area_name
FROM "postgres"."dbt"."cv_business_area" AS ba
  );
[0m17:03:28.483039 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:03:28.492652 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:03:28.493956 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
alter table "postgres"."dbt"."d_business_area__dbt_tmp" rename to "d_business_area"
[0m17:03:28.495507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:03:28.518708 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: COMMIT
[0m17:03:28.519983 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:03:28.521194 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: COMMIT
[0m17:03:28.523888 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:03:28.532161 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:03:28.533474 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
drop view if exists "postgres"."dbt"."d_business_area__dbt_backup" cascade
[0m17:03:28.534902 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:03:28.537066 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_business_area (execute): 2024-09-01 17:03:28.405904 => 2024-09-01 17:03:28.537007
[0m17:03:28.538021 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: Close
[0m17:03:28.539671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158f538dc0>]}
[0m17:03:28.541736 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dbt.d_business_area ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m17:03:28.544598 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_business_area
[0m17:03:28.545938 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_client_type
[0m17:03:28.546969 [info ] [Thread-1  ]: 2 of 7 START sql view model dbt.d_client_type .................................. [RUN]
[0m17:03:28.548611 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_client_type'
[0m17:03:28.549666 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_client_type
[0m17:03:28.555125 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_client_type"
[0m17:03:28.562731 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_client_type (compile): 2024-09-01 17:03:28.550532 => 2024-09-01 17:03:28.562596
[0m17:03:28.563568 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_client_type
[0m17:03:28.575713 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_client_type"
[0m17:03:28.583303 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:03:28.584037 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: BEGIN
[0m17:03:28.584755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:28.592122 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:03:28.593446 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:03:28.594447 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */

  create view "postgres"."dbt"."d_client_type__dbt_tmp" as (
    select
    sc.CLIENT_TYPE_PK,
    sc.name
FROM "postgres"."dbt"."sat_client_type" AS sc
  );
[0m17:03:28.597480 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:03:28.603384 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:03:28.604387 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
alter table "postgres"."dbt"."d_client_type__dbt_tmp" rename to "d_client_type"
[0m17:03:28.605762 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:03:28.608423 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: COMMIT
[0m17:03:28.609564 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:03:28.610446 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: COMMIT
[0m17:03:28.613056 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:03:28.618400 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:03:28.619532 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
drop view if exists "postgres"."dbt"."d_client_type__dbt_backup" cascade
[0m17:03:28.620766 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:03:28.623144 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_client_type (execute): 2024-09-01 17:03:28.564253 => 2024-09-01 17:03:28.623084
[0m17:03:28.624231 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: Close
[0m17:03:28.625698 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158f4ec190>]}
[0m17:03:28.627067 [info ] [Thread-1  ]: 2 of 7 OK created sql view model dbt.d_client_type ............................. [[32mCREATE VIEW[0m in 0.08s]
[0m17:03:28.628408 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_client_type
[0m17:03:28.629663 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_currency
[0m17:03:28.630829 [info ] [Thread-1  ]: 3 of 7 START sql view model dbt.d_currency ..................................... [RUN]
[0m17:03:28.632452 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_currency'
[0m17:03:28.633647 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_currency
[0m17:03:28.674561 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_currency"
[0m17:03:28.682537 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_currency (compile): 2024-09-01 17:03:28.634702 => 2024-09-01 17:03:28.682434
[0m17:03:28.683341 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_currency
[0m17:03:28.696181 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_currency"
[0m17:03:28.703907 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:03:28.704751 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: BEGIN
[0m17:03:28.705506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:28.713281 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:03:28.714734 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:03:28.715799 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */

  create view "postgres"."dbt"."d_currency__dbt_tmp" as (
    select
    sc.CURRENCY_PK,
    sc.name
FROM "postgres"."dbt"."sat_currency" AS sc
  );
[0m17:03:28.718445 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:03:28.726043 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:03:28.727235 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
alter table "postgres"."dbt"."d_currency__dbt_tmp" rename to "d_currency"
[0m17:03:28.728571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:03:28.731265 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: COMMIT
[0m17:03:28.732540 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:03:28.733641 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: COMMIT
[0m17:03:28.737230 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:03:28.741922 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:03:28.743085 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
drop view if exists "postgres"."dbt"."d_currency__dbt_backup" cascade
[0m17:03:28.744641 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:03:28.747550 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_currency (execute): 2024-09-01 17:03:28.683952 => 2024-09-01 17:03:28.747438
[0m17:03:28.748930 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: Close
[0m17:03:28.750999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158f4ec8e0>]}
[0m17:03:28.752329 [info ] [Thread-1  ]: 3 of 7 OK created sql view model dbt.d_currency ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m17:03:28.753496 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_currency
[0m17:03:28.754766 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m17:03:28.755698 [info ] [Thread-1  ]: 4 of 7 START sql view model dbt.d_date ......................................... [RUN]
[0m17:03:28.757131 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m17:03:28.758115 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m17:03:28.764231 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m17:03:28.771236 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 17:03:28.758905 => 2024-09-01 17:03:28.771129
[0m17:03:28.772293 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m17:03:28.785291 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m17:03:28.793686 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:03:28.794572 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m17:03:28.795299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:28.802664 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:03:28.804223 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:03:28.805473 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date as date_value,
    extract(YEAR FROM d.as_of_date) as year,
    extract(MONTH FROM d.as_of_date) as month,
    extract(DAY FROM d.as_of_date) as day,
    extract(WEEK FROM d.as_of_date) as week
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m17:03:28.808370 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:03:28.814511 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:03:28.815561 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m17:03:28.816896 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:03:28.821822 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:03:28.822990 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date__dbt_tmp" rename to "d_date"
[0m17:03:28.824540 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:03:28.830101 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m17:03:28.831230 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:03:28.832299 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m17:03:28.835313 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:03:28.840189 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:03:28.841392 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
drop view if exists "postgres"."dbt"."d_date__dbt_backup" cascade
[0m17:03:28.844687 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:03:28.846892 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 17:03:28.773212 => 2024-09-01 17:03:28.846834
[0m17:03:28.847948 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m17:03:28.849540 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f159093cc70>]}
[0m17:03:28.850807 [info ] [Thread-1  ]: 4 of 7 OK created sql view model dbt.d_date .................................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:03:28.852254 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m17:03:28.853736 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_geography_structure
[0m17:03:28.854973 [info ] [Thread-1  ]: 5 of 7 START sql view model dbt.d_geography_structure .......................... [RUN]
[0m17:03:28.856702 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_geography_structure'
[0m17:03:28.857641 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_geography_structure
[0m17:03:28.862908 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_geography_structure"
[0m17:03:28.870052 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_geography_structure (compile): 2024-09-01 17:03:28.858424 => 2024-09-01 17:03:28.869910
[0m17:03:28.871087 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_geography_structure
[0m17:03:28.883729 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_geography_structure"
[0m17:03:28.892054 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:03:28.892814 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: BEGIN
[0m17:03:28.893495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:28.901032 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:03:28.902683 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:03:28.903833 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */

  create view "postgres"."dbt"."d_geography_structure__dbt_tmp" as (
    select
    cc.CITY_PK,
    cc.city_name,
    cc.country_name
FROM "postgres"."dbt"."cv_city_country" AS cc
  );
[0m17:03:28.906173 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:03:28.912069 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:03:28.913062 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
alter table "postgres"."dbt"."d_geography_structure__dbt_tmp" rename to "d_geography_structure"
[0m17:03:28.914287 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:03:28.917013 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: COMMIT
[0m17:03:28.918169 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:03:28.919003 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: COMMIT
[0m17:03:28.922020 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:03:28.926511 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:03:28.927737 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
drop view if exists "postgres"."dbt"."d_geography_structure__dbt_backup" cascade
[0m17:03:28.929059 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:03:28.931321 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_geography_structure (execute): 2024-09-01 17:03:28.872144 => 2024-09-01 17:03:28.931264
[0m17:03:28.932548 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: Close
[0m17:03:28.934242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158f4ecd60>]}
[0m17:03:28.935752 [info ] [Thread-1  ]: 5 of 7 OK created sql view model dbt.d_geography_structure ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:03:28.937416 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_geography_structure
[0m17:03:28.938668 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_order_status
[0m17:03:28.940469 [info ] [Thread-1  ]: 6 of 7 START sql view model dbt.d_order_status ................................. [RUN]
[0m17:03:28.942170 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_order_status'
[0m17:03:28.943220 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_order_status
[0m17:03:28.948987 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_order_status"
[0m17:03:28.956768 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_order_status (compile): 2024-09-01 17:03:28.944255 => 2024-09-01 17:03:28.956652
[0m17:03:28.957889 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_order_status
[0m17:03:28.970325 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_order_status"
[0m17:03:28.978524 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:03:28.979501 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: BEGIN
[0m17:03:28.980191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:28.987467 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:03:28.988926 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:03:28.990161 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */

  create view "postgres"."dbt"."d_order_status__dbt_tmp" as (
    select
    sc.CURRENCY_PK,
    sc.name
FROM "postgres"."dbt"."sat_order_status" AS sc
  );
[0m17:03:28.991953 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column sc.currency_pk does not exist
LINE 5:     sc.CURRENCY_PK,
            ^

[0m17:03:28.993270 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: ROLLBACK
[0m17:03:28.994866 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_order_status (execute): 2024-09-01 17:03:28.958714 => 2024-09-01 17:03:28.994761
[0m17:03:28.995971 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: Close
[0m17:03:28.998701 [debug] [Thread-1  ]: Database Error in model d_order_status (models/cdm/d_order_status.sql)
  column sc.currency_pk does not exist
  LINE 5:     sc.CURRENCY_PK,
              ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/d_order_status.sql
[0m17:03:28.999869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1590749370>]}
[0m17:03:29.000931 [error] [Thread-1  ]: 6 of 7 ERROR creating sql view model dbt.d_order_status ........................ [[31mERROR[0m in 0.06s]
[0m17:03:29.002191 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_order_status
[0m17:03:29.003356 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_warehouse
[0m17:03:29.004529 [info ] [Thread-1  ]: 7 of 7 START sql view model dbt.d_warehouse .................................... [RUN]
[0m17:03:29.006171 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_warehouse'
[0m17:03:29.007278 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_warehouse
[0m17:03:29.014217 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_warehouse"
[0m17:03:29.021689 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_warehouse (compile): 2024-09-01 17:03:29.008036 => 2024-09-01 17:03:29.021584
[0m17:03:29.022504 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_warehouse
[0m17:03:29.033576 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_warehouse"
[0m17:03:29.041506 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:03:29.042285 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: BEGIN
[0m17:03:29.042956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:03:29.050291 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:03:29.052123 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:03:29.053282 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */

  create view "postgres"."dbt"."d_warehouse__dbt_tmp" as (
    select
    cw.WAREHOUSE_PK,
    cw.name as warehouse_name,
    cw.system_name as warehouse_system_name,
    cc.city_name,
    cc.country_name
FROM "postgres"."dbt"."cv_warehouse" AS cw
LEFT JOIN "postgres"."dbt"."cv_city_country" AS cc on cw.CITY_PK = cc.CITY_PK
  );
[0m17:03:29.055997 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:03:29.061794 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:03:29.062896 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
alter table "postgres"."dbt"."d_warehouse__dbt_tmp" rename to "d_warehouse"
[0m17:03:29.064314 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:03:29.066766 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: COMMIT
[0m17:03:29.067787 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:03:29.068666 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: COMMIT
[0m17:03:29.077859 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:03:29.082540 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:03:29.083741 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
drop view if exists "postgres"."dbt"."d_warehouse__dbt_backup" cascade
[0m17:03:29.085076 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:03:29.087163 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_warehouse (execute): 2024-09-01 17:03:29.023146 => 2024-09-01 17:03:29.087106
[0m17:03:29.088480 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: Close
[0m17:03:29.090113 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6d2ef1f-7d3c-467a-bdf6-ee3946f8aecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15909b08b0>]}
[0m17:03:29.091489 [info ] [Thread-1  ]: 7 of 7 OK created sql view model dbt.d_warehouse ............................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:03:29.092969 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_warehouse
[0m17:03:29.095654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:29.096662 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:29.097692 [debug] [MainThread]: On master: BEGIN
[0m17:03:29.098605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:29.106219 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:03:29.108029 [debug] [MainThread]: On master: COMMIT
[0m17:03:29.109234 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:29.110420 [debug] [MainThread]: On master: COMMIT
[0m17:03:29.111803 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:03:29.112839 [debug] [MainThread]: On master: Close
[0m17:03:29.114134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:29.114889 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_warehouse' was properly closed.
[0m17:03:29.115758 [info ] [MainThread]: 
[0m17:03:29.116800 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m17:03:29.118511 [debug] [MainThread]: Command end result
[0m17:03:29.151279 [info ] [MainThread]: 
[0m17:03:29.152453 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:29.153731 [info ] [MainThread]: 
[0m17:03:29.154891 [error] [MainThread]: [33mDatabase Error in model d_order_status (models/cdm/d_order_status.sql)[0m
[0m17:03:29.156164 [error] [MainThread]:   column sc.currency_pk does not exist
[0m17:03:29.157274 [error] [MainThread]:   LINE 5:     sc.CURRENCY_PK,
[0m17:03:29.158379 [error] [MainThread]:               ^
[0m17:03:29.159574 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/d_order_status.sql
[0m17:03:29.160923 [info ] [MainThread]: 
[0m17:03:29.162330 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m17:03:29.163818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15922d0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158f465eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f158f465f40>]}
[0m17:03:29.165154 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:04:19.046350 | ef08d808-713e-45ad-8eb2-ff01b4b450b0 ==============================
[0m17:04:19.046350 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:04:19.049381 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:04:19.050706 [debug] [MainThread]: Tracking: tracking
[0m17:04:19.056086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d6aa520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d6aa130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d6aaa30>]}
[0m17:04:21.965563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:04:21.967032 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/d_order_status.sql
[0m17:04:21.993010 [debug] [MainThread]: 1699: static parser successfully parsed cdm/d_order_status.sql
[0m17:04:22.053250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d5c60d0>]}
[0m17:04:22.103769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d28b340>]}
[0m17:04:22.104817 [info ] [MainThread]: Found 110 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:04:22.105833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d6900a0>]}
[0m17:04:22.113753 [info ] [MainThread]: 
[0m17:04:22.117713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:04:22.120150 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:04:22.136295 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:04:22.137625 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:04:22.138656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:22.148804 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:04:22.151460 [debug] [ThreadPool]: On list_postgres: Close
[0m17:04:22.162584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:04:22.171869 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:04:22.173144 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:04:22.174270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:22.182229 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:04:22.183638 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:04:22.184895 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:04:22.188580 [debug] [ThreadPool]: SQL status: SELECT 125 in 0 seconds
[0m17:04:22.194271 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:04:22.195512 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:04:22.225560 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:22.226946 [debug] [MainThread]: On master: BEGIN
[0m17:04:22.228131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:22.236410 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:04:22.237937 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:22.239128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:04:22.314134 [debug] [MainThread]: SQL status: SELECT 118 in 0 seconds
[0m17:04:22.336264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d586e80>]}
[0m17:04:22.337587 [debug] [MainThread]: On master: ROLLBACK
[0m17:04:22.338832 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:22.339783 [debug] [MainThread]: On master: BEGIN
[0m17:04:22.341104 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:04:22.342504 [debug] [MainThread]: On master: COMMIT
[0m17:04:22.343832 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:22.345039 [debug] [MainThread]: On master: COMMIT
[0m17:04:22.346244 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:04:22.347384 [debug] [MainThread]: On master: Close
[0m17:04:22.348825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:22.350191 [info ] [MainThread]: 
[0m17:04:22.355311 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_business_area
[0m17:04:22.356580 [info ] [Thread-1  ]: 1 of 7 START sql view model dbt.d_business_area ................................ [RUN]
[0m17:04:22.358244 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_business_area'
[0m17:04:22.359362 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_business_area
[0m17:04:22.364302 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.372392 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_business_area (compile): 2024-09-01 17:04:22.360340 => 2024-09-01 17:04:22.372267
[0m17:04:22.373271 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_business_area
[0m17:04:22.441077 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.448483 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.449347 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: BEGIN
[0m17:04:22.450049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:22.457527 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:04:22.458806 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.460148 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */

  create view "postgres"."dbt"."d_business_area__dbt_tmp" as (
    select
    ba.id,
    ba.business_area_name
FROM "postgres"."dbt"."cv_business_area" AS ba
  );
[0m17:04:22.463060 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:04:22.474343 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.475766 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
alter table "postgres"."dbt"."d_business_area" rename to "d_business_area__dbt_backup"
[0m17:04:22.477441 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.483888 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.485195 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
alter table "postgres"."dbt"."d_business_area__dbt_tmp" rename to "d_business_area"
[0m17:04:22.486827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.523341 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: COMMIT
[0m17:04:22.524519 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.525517 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: COMMIT
[0m17:04:22.528094 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:04:22.537319 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:04:22.538653 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
drop view if exists "postgres"."dbt"."d_business_area__dbt_backup" cascade
[0m17:04:22.541622 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:04:22.543823 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_business_area (execute): 2024-09-01 17:04:22.374041 => 2024-09-01 17:04:22.543759
[0m17:04:22.544698 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: Close
[0m17:04:22.546361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5c347400>]}
[0m17:04:22.547505 [info ] [Thread-1  ]: 1 of 7 OK created sql view model dbt.d_business_area ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m17:04:22.550702 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_business_area
[0m17:04:22.551822 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_client_type
[0m17:04:22.552805 [info ] [Thread-1  ]: 2 of 7 START sql view model dbt.d_client_type .................................. [RUN]
[0m17:04:22.554572 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_client_type'
[0m17:04:22.555729 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_client_type
[0m17:04:22.562365 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.569030 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_client_type (compile): 2024-09-01 17:04:22.556558 => 2024-09-01 17:04:22.568902
[0m17:04:22.569971 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_client_type
[0m17:04:22.581360 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.589310 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.590120 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: BEGIN
[0m17:04:22.590933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:22.598374 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:04:22.599819 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.601019 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */

  create view "postgres"."dbt"."d_client_type__dbt_tmp" as (
    select
    sc.CLIENT_TYPE_PK,
    sc.name
FROM "postgres"."dbt"."sat_client_type" AS sc
  );
[0m17:04:22.603347 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:04:22.609189 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.610374 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
alter table "postgres"."dbt"."d_client_type" rename to "d_client_type__dbt_backup"
[0m17:04:22.611795 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.652820 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.654126 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
alter table "postgres"."dbt"."d_client_type__dbt_tmp" rename to "d_client_type"
[0m17:04:22.655647 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.658544 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: COMMIT
[0m17:04:22.659506 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.660472 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: COMMIT
[0m17:04:22.663905 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:04:22.668393 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:04:22.669457 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
drop view if exists "postgres"."dbt"."d_client_type__dbt_backup" cascade
[0m17:04:22.672750 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:04:22.675297 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_client_type (execute): 2024-09-01 17:04:22.570895 => 2024-09-01 17:04:22.675235
[0m17:04:22.676506 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: Close
[0m17:04:22.677974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5c347940>]}
[0m17:04:22.679310 [info ] [Thread-1  ]: 2 of 7 OK created sql view model dbt.d_client_type ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:04:22.680954 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_client_type
[0m17:04:22.682509 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_currency
[0m17:04:22.683698 [info ] [Thread-1  ]: 3 of 7 START sql view model dbt.d_currency ..................................... [RUN]
[0m17:04:22.685269 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_currency'
[0m17:04:22.686237 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_currency
[0m17:04:22.691505 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_currency"
[0m17:04:22.699034 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_currency (compile): 2024-09-01 17:04:22.687125 => 2024-09-01 17:04:22.698940
[0m17:04:22.699833 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_currency
[0m17:04:22.710627 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_currency"
[0m17:04:22.719039 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:04:22.719722 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: BEGIN
[0m17:04:22.720439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:22.731850 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:04:22.733340 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:04:22.740436 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */

  create view "postgres"."dbt"."d_currency__dbt_tmp" as (
    select
    sc.CURRENCY_PK,
    sc.name
FROM "postgres"."dbt"."sat_currency" AS sc
  );
[0m17:04:22.743608 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:04:22.749956 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:04:22.751317 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
alter table "postgres"."dbt"."d_currency" rename to "d_currency__dbt_backup"
[0m17:04:22.752820 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.759195 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:04:22.760411 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
alter table "postgres"."dbt"."d_currency__dbt_tmp" rename to "d_currency"
[0m17:04:22.761827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.764695 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: COMMIT
[0m17:04:22.765813 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:04:22.766858 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: COMMIT
[0m17:04:22.770291 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:04:22.775089 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:04:22.776166 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
drop view if exists "postgres"."dbt"."d_currency__dbt_backup" cascade
[0m17:04:22.779459 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:04:22.781886 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_currency (execute): 2024-09-01 17:04:22.700429 => 2024-09-01 17:04:22.781827
[0m17:04:22.782930 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: Close
[0m17:04:22.784467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5c347a60>]}
[0m17:04:22.785700 [info ] [Thread-1  ]: 3 of 7 OK created sql view model dbt.d_currency ................................ [[32mCREATE VIEW[0m in 0.10s]
[0m17:04:22.786949 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_currency
[0m17:04:22.788209 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m17:04:22.789244 [info ] [Thread-1  ]: 4 of 7 START sql view model dbt.d_date ......................................... [RUN]
[0m17:04:22.790907 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m17:04:22.791973 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m17:04:22.797947 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m17:04:22.803999 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 17:04:22.792909 => 2024-09-01 17:04:22.803887
[0m17:04:22.804826 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m17:04:22.817650 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m17:04:22.825190 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:04:22.826004 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m17:04:22.826710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:22.834327 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:04:22.835647 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:04:22.836698 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date as date_value,
    extract(YEAR FROM d.as_of_date) as year,
    extract(MONTH FROM d.as_of_date) as month,
    extract(DAY FROM d.as_of_date) as day,
    extract(WEEK FROM d.as_of_date) as week
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m17:04:22.839072 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:04:22.845471 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:04:22.846377 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m17:04:22.847387 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.852104 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:04:22.853018 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date__dbt_tmp" rename to "d_date"
[0m17:04:22.854219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.858271 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m17:04:22.859134 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:04:22.860003 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m17:04:22.862430 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:04:22.867135 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:04:22.868167 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
drop view if exists "postgres"."dbt"."d_date__dbt_backup" cascade
[0m17:04:22.871346 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:04:22.873567 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 17:04:22.805446 => 2024-09-01 17:04:22.873507
[0m17:04:22.874572 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m17:04:22.875968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5c2cab50>]}
[0m17:04:22.877223 [info ] [Thread-1  ]: 4 of 7 OK created sql view model dbt.d_date .................................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:04:22.878920 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m17:04:22.880234 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_geography_structure
[0m17:04:22.881476 [info ] [Thread-1  ]: 5 of 7 START sql view model dbt.d_geography_structure .......................... [RUN]
[0m17:04:22.883058 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_geography_structure'
[0m17:04:22.883925 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_geography_structure
[0m17:04:22.888867 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.894936 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_geography_structure (compile): 2024-09-01 17:04:22.884765 => 2024-09-01 17:04:22.894837
[0m17:04:22.895688 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_geography_structure
[0m17:04:22.906366 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.914615 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.915352 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: BEGIN
[0m17:04:22.915966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:22.923048 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:04:22.924550 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.925744 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */

  create view "postgres"."dbt"."d_geography_structure__dbt_tmp" as (
    select
    cc.CITY_PK,
    cc.city_name,
    cc.country_name
FROM "postgres"."dbt"."cv_city_country" AS cc
  );
[0m17:04:22.927983 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:04:22.934328 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.935079 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
alter table "postgres"."dbt"."d_geography_structure" rename to "d_geography_structure__dbt_backup"
[0m17:04:22.936162 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.941140 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.942428 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
alter table "postgres"."dbt"."d_geography_structure__dbt_tmp" rename to "d_geography_structure"
[0m17:04:22.943787 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:22.946659 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: COMMIT
[0m17:04:22.947642 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.948582 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: COMMIT
[0m17:04:22.951438 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:04:22.957194 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:04:22.958283 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
drop view if exists "postgres"."dbt"."d_geography_structure__dbt_backup" cascade
[0m17:04:22.961451 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:04:22.963625 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_geography_structure (execute): 2024-09-01 17:04:22.896254 => 2024-09-01 17:04:22.963569
[0m17:04:22.964619 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: Close
[0m17:04:22.966138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d5b0070>]}
[0m17:04:22.967327 [info ] [Thread-1  ]: 5 of 7 OK created sql view model dbt.d_geography_structure ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m17:04:22.969009 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_geography_structure
[0m17:04:22.970390 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_order_status
[0m17:04:22.972167 [info ] [Thread-1  ]: 6 of 7 START sql view model dbt.d_order_status ................................. [RUN]
[0m17:04:22.974061 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_order_status'
[0m17:04:22.975256 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_order_status
[0m17:04:22.980794 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_order_status"
[0m17:04:22.986873 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_order_status (compile): 2024-09-01 17:04:22.976153 => 2024-09-01 17:04:22.986768
[0m17:04:22.987671 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_order_status
[0m17:04:22.998691 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_order_status"
[0m17:04:23.007332 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:04:23.008197 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: BEGIN
[0m17:04:23.009017 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:23.016228 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:04:23.017761 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:04:23.018853 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */

  create view "postgres"."dbt"."d_order_status__dbt_tmp" as (
    select
    sc.ORDER_STATUS_PK,
    sc.name
FROM "postgres"."dbt"."sat_order_status" AS sc
  );
[0m17:04:23.020888 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:04:23.026182 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:04:23.027277 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */
alter table "postgres"."dbt"."d_order_status__dbt_tmp" rename to "d_order_status"
[0m17:04:23.028648 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:23.031268 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: COMMIT
[0m17:04:23.032583 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:04:23.033734 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: COMMIT
[0m17:04:23.036524 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:04:23.041676 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:04:23.043065 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */
drop view if exists "postgres"."dbt"."d_order_status__dbt_backup" cascade
[0m17:04:23.044612 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:04:23.046721 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_order_status (execute): 2024-09-01 17:04:22.988292 => 2024-09-01 17:04:23.046666
[0m17:04:23.047852 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: Close
[0m17:04:23.049672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d5b0070>]}
[0m17:04:23.051080 [info ] [Thread-1  ]: 6 of 7 OK created sql view model dbt.d_order_status ............................ [[32mCREATE VIEW[0m in 0.08s]
[0m17:04:23.052532 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_order_status
[0m17:04:23.053797 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_warehouse
[0m17:04:23.055175 [info ] [Thread-1  ]: 7 of 7 START sql view model dbt.d_warehouse .................................... [RUN]
[0m17:04:23.057204 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_warehouse'
[0m17:04:23.058528 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_warehouse
[0m17:04:23.065630 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.072921 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_warehouse (compile): 2024-09-01 17:04:23.059585 => 2024-09-01 17:04:23.072818
[0m17:04:23.073809 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_warehouse
[0m17:04:23.084622 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.092208 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.092912 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: BEGIN
[0m17:04:23.093556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:04:23.100907 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:04:23.102358 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.103558 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */

  create view "postgres"."dbt"."d_warehouse__dbt_tmp" as (
    select
    cw.WAREHOUSE_PK,
    cw.name as warehouse_name,
    cw.system_name as warehouse_system_name,
    cc.city_name,
    cc.country_name
FROM "postgres"."dbt"."cv_warehouse" AS cw
LEFT JOIN "postgres"."dbt"."cv_city_country" AS cc on cw.CITY_PK = cc.CITY_PK
  );
[0m17:04:23.106074 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:04:23.113472 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.114773 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
alter table "postgres"."dbt"."d_warehouse" rename to "d_warehouse__dbt_backup"
[0m17:04:23.116205 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:23.121234 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.122452 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
alter table "postgres"."dbt"."d_warehouse__dbt_tmp" rename to "d_warehouse"
[0m17:04:23.123924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:04:23.127153 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: COMMIT
[0m17:04:23.128190 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.129209 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: COMMIT
[0m17:04:23.132544 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:04:23.137105 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:04:23.138109 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
drop view if exists "postgres"."dbt"."d_warehouse__dbt_backup" cascade
[0m17:04:23.141159 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:04:23.143335 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_warehouse (execute): 2024-09-01 17:04:23.074410 => 2024-09-01 17:04:23.143278
[0m17:04:23.144343 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: Close
[0m17:04:23.145875 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef08d808-713e-45ad-8eb2-ff01b4b450b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5c28aee0>]}
[0m17:04:23.147088 [info ] [Thread-1  ]: 7 of 7 OK created sql view model dbt.d_warehouse ............................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:04:23.148775 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_warehouse
[0m17:04:23.151430 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:04:23.152583 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:23.153624 [debug] [MainThread]: On master: BEGIN
[0m17:04:23.154494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:23.162185 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:04:23.163727 [debug] [MainThread]: On master: COMMIT
[0m17:04:23.165102 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:23.166242 [debug] [MainThread]: On master: COMMIT
[0m17:04:23.167577 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:04:23.168647 [debug] [MainThread]: On master: Close
[0m17:04:23.169868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:23.170883 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.d_warehouse' was properly closed.
[0m17:04:23.171816 [info ] [MainThread]: 
[0m17:04:23.172809 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m17:04:23.174339 [debug] [MainThread]: Command end result
[0m17:04:23.208260 [info ] [MainThread]: 
[0m17:04:23.209391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:23.210621 [info ] [MainThread]: 
[0m17:04:23.211973 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:04:23.213418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5c2f1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d59db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d59df10>]}
[0m17:04:23.214539 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:09:32.025910 | 5f8f04e6-8c33-4f25-aadb-78c28ad03081 ==============================
[0m17:09:32.025910 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:09:32.028779 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:09:32.029873 [debug] [MainThread]: Tracking: tracking
[0m17:09:32.036055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6340e16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6340e1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6340e17f0>]}
[0m17:09:35.089197 [debug] [MainThread]: Partial parsing enabled: 7 files deleted, 8 files added, 0 files changed.
[0m17:09:35.090602 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/d_order_status.sql
[0m17:09:35.091502 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/d_geography_structure.sql
[0m17:09:35.092285 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/d_currency.sql
[0m17:09:35.093188 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/f_good_sales.sql
[0m17:09:35.094090 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/d_date.sql
[0m17:09:35.094953 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/d_business_area.sql
[0m17:09:35.095689 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/d_warehouse.sql
[0m17:09:35.096497 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/d_client_type.sql
[0m17:09:35.097163 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/d_date.sql
[0m17:09:35.097788 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/d_business_area.sql
[0m17:09:35.098438 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/d_currency.sql
[0m17:09:35.099091 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/d_order_status.sql
[0m17:09:35.099677 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/d_geography_structure.sql
[0m17:09:35.100233 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/d_warehouse.sql
[0m17:09:35.100875 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/d_client_type.sql
[0m17:09:35.126073 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/d_order_status.sql
[0m17:09:35.143711 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/d_geography_structure.sql
[0m17:09:35.148426 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/d_currency.sql
[0m17:09:35.153158 [debug] [MainThread]: 1699: static parser successfully parsed cdm/f_good_sales.sql
[0m17:09:35.157815 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/d_date.sql
[0m17:09:35.162322 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/d_business_area.sql
[0m17:09:35.167262 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/d_warehouse.sql
[0m17:09:35.171924 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/d_client_type.sql
[0m17:09:35.218559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f8f04e6-8c33-4f25-aadb-78c28ad03081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb633ff80d0>]}
[0m17:09:35.270650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f8f04e6-8c33-4f25-aadb-78c28ad03081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb633bc4e80>]}
[0m17:09:35.271646 [info ] [MainThread]: Found 111 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:09:35.272730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f8f04e6-8c33-4f25-aadb-78c28ad03081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6340d9e20>]}
[0m17:09:35.281887 [info ] [MainThread]: 
[0m17:09:35.285283 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:35.287376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:09:35.303318 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:09:35.304665 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:09:35.305839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:35.314666 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:09:35.317252 [debug] [ThreadPool]: On list_postgres: Close
[0m17:09:35.328483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:09:35.337802 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:09:35.339006 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:09:35.340109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:35.347917 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:09:35.349316 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:09:35.350761 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:09:35.354289 [debug] [ThreadPool]: SQL status: SELECT 126 in 0 seconds
[0m17:09:35.360140 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:09:35.361466 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:09:35.392547 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:35.393852 [debug] [MainThread]: On master: BEGIN
[0m17:09:35.394916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:35.402710 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:35.404197 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:35.405257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:35.481533 [debug] [MainThread]: SQL status: SELECT 119 in 0 seconds
[0m17:09:35.500532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f8f04e6-8c33-4f25-aadb-78c28ad03081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6358dd5e0>]}
[0m17:09:35.501994 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:35.503518 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:35.504611 [debug] [MainThread]: On master: BEGIN
[0m17:09:35.505988 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:35.507251 [debug] [MainThread]: On master: COMMIT
[0m17:09:35.508404 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:35.509505 [debug] [MainThread]: On master: COMMIT
[0m17:09:35.510633 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:09:35.511677 [debug] [MainThread]: On master: Close
[0m17:09:35.513172 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:35.514231 [info ] [MainThread]: 
[0m17:09:35.518581 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_good_sales
[0m17:09:35.519650 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.f_good_sales ................................... [RUN]
[0m17:09:35.521061 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_good_sales'
[0m17:09:35.522006 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_good_sales
[0m17:09:35.527110 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_good_sales"
[0m17:09:35.535274 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_good_sales (compile): 2024-09-01 17:09:35.522834 => 2024-09-01 17:09:35.535154
[0m17:09:35.536096 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_good_sales
[0m17:09:35.593334 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_good_sales"
[0m17:09:35.602044 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:09:35.602848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: BEGIN
[0m17:09:35.603576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:09:35.610950 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:09:35.612380 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:09:35.613556 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */

  create view "postgres"."dbt"."f_good_sales__dbt_tmp" as (
    select
    cg.GOOD_PK,
    cg.count as good_count,
    cg.order_date,
    cg.delivery_date,
    cg.CURRENCY_PK,
    cg.order_date,
    cg.delivery_date,
    cg.full_good_cost as good_cost_original,
    cg.full_good_cost_rur as good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
  );
[0m17:09:35.615970 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "order_date" specified more than once

[0m17:09:35.617500 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: ROLLBACK
[0m17:09:35.618919 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_good_sales (execute): 2024-09-01 17:09:35.536732 => 2024-09-01 17:09:35.618792
[0m17:09:35.620059 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: Close
[0m17:09:35.622927 [debug] [Thread-1  ]: Database Error in model f_good_sales (models/cdm/f_good_sales.sql)
  column "order_date" specified more than once
  compiled Code at target/run/otus_project_dbtvault/models/cdm/f_good_sales.sql
[0m17:09:35.624395 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f8f04e6-8c33-4f25-aadb-78c28ad03081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb633fb8e20>]}
[0m17:09:35.625619 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.f_good_sales .......................... [[31mERROR[0m in 0.10s]
[0m17:09:35.628594 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.f_good_sales
[0m17:09:35.631227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:35.632234 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:35.633129 [debug] [MainThread]: On master: BEGIN
[0m17:09:35.634060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:35.641742 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:35.643155 [debug] [MainThread]: On master: COMMIT
[0m17:09:35.644424 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:35.645568 [debug] [MainThread]: On master: COMMIT
[0m17:09:35.646809 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:09:35.647873 [debug] [MainThread]: On master: Close
[0m17:09:35.649374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:35.650299 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.f_good_sales' was properly closed.
[0m17:09:35.651173 [info ] [MainThread]: 
[0m17:09:35.652205 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m17:09:35.653426 [debug] [MainThread]: Command end result
[0m17:09:35.687018 [info ] [MainThread]: 
[0m17:09:35.688172 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:09:35.689880 [info ] [MainThread]: 
[0m17:09:35.691190 [error] [MainThread]: [33mDatabase Error in model f_good_sales (models/cdm/f_good_sales.sql)[0m
[0m17:09:35.692485 [error] [MainThread]:   column "order_date" specified more than once
[0m17:09:35.693613 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/f_good_sales.sql
[0m17:09:35.695316 [info ] [MainThread]: 
[0m17:09:35.696952 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:09:35.698585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb633bc4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6340dfe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6340df4f0>]}
[0m17:09:35.699957 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:09:49.642311 | ba07d489-5c21-435e-8b24-01a6854097f8 ==============================
[0m17:09:49.642311 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:09:49.645374 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:09:49.646500 [debug] [MainThread]: Tracking: tracking
[0m17:09:49.651233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedc791bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed97afd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed97af1c0>]}
[0m17:09:53.086236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:53.087633 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/f_good_sales.sql
[0m17:09:53.112828 [debug] [MainThread]: 1699: static parser successfully parsed cdm/f_good_sales.sql
[0m17:09:53.170437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba07d489-5c21-435e-8b24-01a6854097f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed96e4e20>]}
[0m17:09:53.219723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba07d489-5c21-435e-8b24-01a6854097f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed93ac5e0>]}
[0m17:09:53.220730 [info ] [MainThread]: Found 111 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:09:53.221859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba07d489-5c21-435e-8b24-01a6854097f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed97af820>]}
[0m17:09:53.230933 [info ] [MainThread]: 
[0m17:09:53.234275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:53.237079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:09:53.253807 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:09:53.255120 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:09:53.256256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:53.265187 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:09:53.267733 [debug] [ThreadPool]: On list_postgres: Close
[0m17:09:53.278840 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:09:53.289017 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:09:53.290062 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:09:53.290996 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:53.298853 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:09:53.300596 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:09:53.302056 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:09:53.306011 [debug] [ThreadPool]: SQL status: SELECT 126 in 0 seconds
[0m17:09:53.312288 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:09:53.313853 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:09:53.344176 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:53.345315 [debug] [MainThread]: On master: BEGIN
[0m17:09:53.346331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:53.354190 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:53.355578 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:53.356717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:53.431747 [debug] [MainThread]: SQL status: SELECT 119 in 0 seconds
[0m17:09:53.451193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba07d489-5c21-435e-8b24-01a6854097f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed8447b80>]}
[0m17:09:53.452415 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:53.453440 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:53.454366 [debug] [MainThread]: On master: BEGIN
[0m17:09:53.455613 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:53.456700 [debug] [MainThread]: On master: COMMIT
[0m17:09:53.457677 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:53.458721 [debug] [MainThread]: On master: COMMIT
[0m17:09:53.459782 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:09:53.460594 [debug] [MainThread]: On master: Close
[0m17:09:53.461917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:53.463038 [info ] [MainThread]: 
[0m17:09:53.467670 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_good_sales
[0m17:09:53.469018 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.f_good_sales ................................... [RUN]
[0m17:09:53.470856 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_good_sales'
[0m17:09:53.472054 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_good_sales
[0m17:09:53.477297 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_good_sales"
[0m17:09:53.484736 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_good_sales (compile): 2024-09-01 17:09:53.473047 => 2024-09-01 17:09:53.484618
[0m17:09:53.485530 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_good_sales
[0m17:09:53.540770 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_good_sales"
[0m17:09:53.549151 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:09:53.549975 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: BEGIN
[0m17:09:53.550807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:09:53.558699 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:09:53.560283 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:09:53.561498 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */

  create view "postgres"."dbt"."f_good_sales__dbt_tmp" as (
    select
    cg.GOOD_PK,
    cg.count as good_count,
    cg.order_date,
    cg.delivery_date,
    cg.CURRENCY_PK,
    cg.full_good_cost as good_cost_original,
    cg.full_good_cost_rur as good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
  );
[0m17:09:53.564645 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:09:53.575744 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:09:53.576986 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */
alter table "postgres"."dbt"."f_good_sales__dbt_tmp" rename to "f_good_sales"
[0m17:09:53.578612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:09:53.601167 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: COMMIT
[0m17:09:53.602313 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:09:53.603265 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: COMMIT
[0m17:09:53.605813 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:09:53.614748 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:09:53.616002 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */
drop view if exists "postgres"."dbt"."f_good_sales__dbt_backup" cascade
[0m17:09:53.617219 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:09:53.619350 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_good_sales (execute): 2024-09-01 17:09:53.486168 => 2024-09-01 17:09:53.619291
[0m17:09:53.620240 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: Close
[0m17:09:53.621634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba07d489-5c21-435e-8b24-01a6854097f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed846cdf0>]}
[0m17:09:53.622888 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.f_good_sales .............................. [[32mCREATE VIEW[0m in 0.15s]
[0m17:09:53.626510 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.f_good_sales
[0m17:09:53.629459 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:53.630572 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:53.631615 [debug] [MainThread]: On master: BEGIN
[0m17:09:53.632395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:53.640254 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:53.641799 [debug] [MainThread]: On master: COMMIT
[0m17:09:53.643105 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:53.644293 [debug] [MainThread]: On master: COMMIT
[0m17:09:53.645746 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:09:53.646869 [debug] [MainThread]: On master: Close
[0m17:09:53.648193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:53.649041 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.f_good_sales' was properly closed.
[0m17:09:53.649886 [info ] [MainThread]: 
[0m17:09:53.651130 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m17:09:53.652483 [debug] [MainThread]: Command end result
[0m17:09:53.720703 [info ] [MainThread]: 
[0m17:09:53.722004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:53.723326 [info ] [MainThread]: 
[0m17:09:53.724662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:53.726207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedb605820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbedbce8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbed8461370>]}
[0m17:09:53.727532 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:20:24.630900 | 5b896383-06b6-448e-863e-d82e1441ddf4 ==============================
[0m17:20:24.630900 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:20:24.634321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:20:24.635338 [debug] [MainThread]: Tracking: tracking
[0m17:20:24.640109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca8a2f4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca87312310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca87312e50>]}
[0m17:20:27.826625 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m17:20:27.828404 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/f_order_detalization.sql
[0m17:20:27.829626 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/f_good_sales.sql
[0m17:20:27.830680 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/f_good_sales.sql
[0m17:20:27.856688 [debug] [MainThread]: 1699: static parser successfully parsed cdm/f_order_detalization.sql
[0m17:20:27.873821 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/f_good_sales.sql
[0m17:20:27.920797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b896383-06b6-448e-863e-d82e1441ddf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca8724bf40>]}
[0m17:20:27.973293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b896383-06b6-448e-863e-d82e1441ddf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca86f0fd60>]}
[0m17:20:27.974285 [info ] [MainThread]: Found 112 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:20:27.975291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b896383-06b6-448e-863e-d82e1441ddf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca873127f0>]}
[0m17:20:27.985022 [info ] [MainThread]: 
[0m17:20:27.988175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:27.990184 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:20:28.006339 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:20:28.007620 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:20:28.008977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:28.017637 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:20:28.020462 [debug] [ThreadPool]: On list_postgres: Close
[0m17:20:28.032927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:20:28.042614 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:20:28.044042 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:20:28.045081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:28.053056 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:20:28.054538 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:20:28.055821 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:20:28.059447 [debug] [ThreadPool]: SQL status: SELECT 127 in 0 seconds
[0m17:20:28.065409 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:20:28.066593 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:20:28.097413 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:28.098855 [debug] [MainThread]: On master: BEGIN
[0m17:20:28.099986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:28.107844 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:28.109487 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:28.110751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:20:28.188709 [debug] [MainThread]: SQL status: SELECT 120 in 0 seconds
[0m17:20:28.208496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b896383-06b6-448e-863e-d82e1441ddf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca85da9640>]}
[0m17:20:28.209772 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:28.211007 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:28.212121 [debug] [MainThread]: On master: BEGIN
[0m17:20:28.213569 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:28.214763 [debug] [MainThread]: On master: COMMIT
[0m17:20:28.215890 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:28.216884 [debug] [MainThread]: On master: COMMIT
[0m17:20:28.218287 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:20:28.219489 [debug] [MainThread]: On master: Close
[0m17:20:28.220765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:28.221711 [info ] [MainThread]: 
[0m17:20:28.226404 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_order_detalization
[0m17:20:28.227940 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.f_order_detalization ........................... [RUN]
[0m17:20:28.229868 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_order_detalization'
[0m17:20:28.230776 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_order_detalization
[0m17:20:28.236361 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:28.245976 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_order_detalization (compile): 2024-09-01 17:20:28.231552 => 2024-09-01 17:20:28.245847
[0m17:20:28.246842 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_order_detalization
[0m17:20:28.301877 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:28.310817 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:28.311609 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: BEGIN
[0m17:20:28.312331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:28.319833 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:20:28.321276 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:28.322402 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_order_detalization"} */

  create view "postgres"."dbt"."f_order_detalization__dbt_tmp" as (
    with ords_delay as
(
select
    lowd.ORDER_PK,
    count(owd.ORDER_WITH_DELAY_PK)
FROM "postgres"."dbt"."sat_order_with_delay" AS owd
left join "postgres"."dbt"."link_order_with_delay_order" AS lowd on lowd.ORDER_WITH_DELAY_PK = owd.ORDER_WITH_DELAY_PK
)
select
    ca.ORDER_PK,
    ca.CURRENCY_PK,
    ca.order_date,
    ca.delivery_date,
    ca.good_count,
    ca.full_good_cost as order_cost_original,
    ca.full_good_cost_rur as order_cost_rur,
    ca.current_warehouse_pk,
    ca.current_status_pk,
    ca.order_weight,
    ca.payer_client_type_pk,
    ca.sender_city_pk,
    ca.receiver_city_pk,
    ca.has_problem_address,
    ca.business_area_id,
    case
        when ords.delay >= 0 then TRUE
        else FALSE
    end as has_delay
FROM "postgres"."dbt"."cv_order_attributes" AS ca
left join ords_delay on ords_delay.ORDER_PK = ca.ORDER_PK
  );
[0m17:20:28.324418 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "lowd.order_pk" must appear in the GROUP BY clause or be used in an aggregate function
LINE 7:     lowd.ORDER_PK,
            ^

[0m17:20:28.326019 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: ROLLBACK
[0m17:20:28.327297 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_order_detalization (execute): 2024-09-01 17:20:28.247520 => 2024-09-01 17:20:28.327191
[0m17:20:28.328228 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: Close
[0m17:20:28.331580 [debug] [Thread-1  ]: Database Error in model f_order_detalization (models/cdm/f_order_detalization.sql)
  column "lowd.order_pk" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 7:     lowd.ORDER_PK,
              ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/f_order_detalization.sql
[0m17:20:28.332770 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b896383-06b6-448e-863e-d82e1441ddf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca85db8ee0>]}
[0m17:20:28.333862 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.f_order_detalization .................. [[31mERROR[0m in 0.10s]
[0m17:20:28.336921 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.f_order_detalization
[0m17:20:28.339708 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:28.340704 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:28.341636 [debug] [MainThread]: On master: BEGIN
[0m17:20:28.342602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:28.350017 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:28.351482 [debug] [MainThread]: On master: COMMIT
[0m17:20:28.352812 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:28.354128 [debug] [MainThread]: On master: COMMIT
[0m17:20:28.355493 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:20:28.356534 [debug] [MainThread]: On master: Close
[0m17:20:28.357952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:28.358945 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.f_order_detalization' was properly closed.
[0m17:20:28.359913 [info ] [MainThread]: 
[0m17:20:28.361193 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m17:20:28.362712 [debug] [MainThread]: Command end result
[0m17:20:28.398128 [info ] [MainThread]: 
[0m17:20:28.399487 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:28.400841 [info ] [MainThread]: 
[0m17:20:28.402102 [error] [MainThread]: [33mDatabase Error in model f_order_detalization (models/cdm/f_order_detalization.sql)[0m
[0m17:20:28.403329 [error] [MainThread]:   column "lowd.order_pk" must appear in the GROUP BY clause or be used in an aggregate function
[0m17:20:28.404631 [error] [MainThread]:   LINE 7:     lowd.ORDER_PK,
[0m17:20:28.405904 [error] [MainThread]:               ^
[0m17:20:28.407241 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/f_order_detalization.sql
[0m17:20:28.408693 [info ] [MainThread]: 
[0m17:20:28.409969 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:20:28.411377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca873127f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca87336190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca87211fd0>]}
[0m17:20:28.412582 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:20:52.895530 | 9fb64404-b0e0-4c07-9e21-f6d762250997 ==============================
[0m17:20:52.895530 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:20:52.898555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:20:52.899425 [debug] [MainThread]: Tracking: tracking
[0m17:20:52.904861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e369df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e369d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e369deb0>]}
[0m17:20:55.980341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:55.982134 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/f_order_detalization.sql
[0m17:20:56.010008 [debug] [MainThread]: 1699: static parser successfully parsed cdm/f_order_detalization.sql
[0m17:20:56.069729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fb64404-b0e0-4c07-9e21-f6d762250997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e35c9940>]}
[0m17:20:56.122444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fb64404-b0e0-4c07-9e21-f6d762250997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e328cd30>]}
[0m17:20:56.123480 [info ] [MainThread]: Found 112 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:20:56.125095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb64404-b0e0-4c07-9e21-f6d762250997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e369caf0>]}
[0m17:20:56.132972 [info ] [MainThread]: 
[0m17:20:56.136182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:56.138397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:20:56.157024 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:20:56.158292 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:20:56.159417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:56.168157 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:20:56.170808 [debug] [ThreadPool]: On list_postgres: Close
[0m17:20:56.182319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:20:56.191726 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:20:56.193080 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:20:56.194396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:56.202140 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:20:56.203646 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:20:56.204867 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:20:56.208200 [debug] [ThreadPool]: SQL status: SELECT 127 in 0 seconds
[0m17:20:56.213824 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:20:56.215181 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:20:56.248541 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:56.249740 [debug] [MainThread]: On master: BEGIN
[0m17:20:56.250896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:56.258878 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:56.260580 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:56.261836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:20:56.338701 [debug] [MainThread]: SQL status: SELECT 120 in 0 seconds
[0m17:20:56.358674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fb64404-b0e0-4c07-9e21-f6d762250997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e2328220>]}
[0m17:20:56.360058 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:56.361257 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:56.362389 [debug] [MainThread]: On master: BEGIN
[0m17:20:56.363953 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:56.365287 [debug] [MainThread]: On master: COMMIT
[0m17:20:56.366475 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:56.367453 [debug] [MainThread]: On master: COMMIT
[0m17:20:56.368678 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:20:56.369724 [debug] [MainThread]: On master: Close
[0m17:20:56.371181 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:56.372264 [info ] [MainThread]: 
[0m17:20:56.376941 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_order_detalization
[0m17:20:56.378550 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.f_order_detalization ........................... [RUN]
[0m17:20:56.380228 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_order_detalization'
[0m17:20:56.381175 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_order_detalization
[0m17:20:56.386769 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:56.394122 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_order_detalization (compile): 2024-09-01 17:20:56.381981 => 2024-09-01 17:20:56.393970
[0m17:20:56.395221 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_order_detalization
[0m17:20:56.451224 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:56.459338 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:56.460109 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: BEGIN
[0m17:20:56.460764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:56.468034 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:20:56.469579 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:20:56.470681 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_order_detalization"} */

  create view "postgres"."dbt"."f_order_detalization__dbt_tmp" as (
    with ords_delay as
(
select
    lowd.ORDER_PK,
    count(owd.ORDER_WITH_DELAY_PK)
FROM "postgres"."dbt"."sat_order_with_delay" AS owd
left join "postgres"."dbt"."link_order_with_delay_order" AS lowd on lowd.ORDER_WITH_DELAY_PK = owd.ORDER_WITH_DELAY_PK
group by lowd.ORDER_PK
)
select
    ca.ORDER_PK,
    ca.CURRENCY_PK,
    ca.order_date,
    ca.delivery_date,
    ca.good_count,
    ca.full_good_cost as order_cost_original,
    ca.full_good_cost_rur as order_cost_rur,
    ca.current_warehouse_pk,
    ca.current_status_pk,
    ca.order_weight,
    ca.payer_client_type_pk,
    ca.sender_city_pk,
    ca.receiver_city_pk,
    ca.has_problem_address,
    ca.business_area_id,
    case
        when ords.delay >= 0 then TRUE
        else FALSE
    end as has_delay
FROM "postgres"."dbt"."cv_order_attributes" AS ca
left join ords_delay on ords_delay.ORDER_PK = ca.ORDER_PK
  );
[0m17:20:56.473274 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "ords"
LINE 30:         when ords.delay >= 0 then TRUE
                      ^

[0m17:20:56.474775 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: ROLLBACK
[0m17:20:56.476204 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_order_detalization (execute): 2024-09-01 17:20:56.396076 => 2024-09-01 17:20:56.476126
[0m17:20:56.477226 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: Close
[0m17:20:56.480170 [debug] [Thread-1  ]: Database Error in model f_order_detalization (models/cdm/f_order_detalization.sql)
  missing FROM-clause entry for table "ords"
  LINE 30:         when ords.delay >= 0 then TRUE
                        ^
  compiled Code at target/run/otus_project_dbtvault/models/cdm/f_order_detalization.sql
[0m17:20:56.481645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fb64404-b0e0-4c07-9e21-f6d762250997', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e36b58e0>]}
[0m17:20:56.482898 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dbt.f_order_detalization .................. [[31mERROR[0m in 0.10s]
[0m17:20:56.485746 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.f_order_detalization
[0m17:20:56.488710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:56.489743 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:56.490705 [debug] [MainThread]: On master: BEGIN
[0m17:20:56.491640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:56.499407 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:56.501085 [debug] [MainThread]: On master: COMMIT
[0m17:20:56.502218 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:56.503426 [debug] [MainThread]: On master: COMMIT
[0m17:20:56.504694 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:20:56.505700 [debug] [MainThread]: On master: Close
[0m17:20:56.507200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:56.508338 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.f_order_detalization' was properly closed.
[0m17:20:56.509327 [info ] [MainThread]: 
[0m17:20:56.510509 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m17:20:56.512091 [debug] [MainThread]: Command end result
[0m17:20:56.546186 [info ] [MainThread]: 
[0m17:20:56.547433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:56.548733 [info ] [MainThread]: 
[0m17:20:56.549963 [error] [MainThread]: [33mDatabase Error in model f_order_detalization (models/cdm/f_order_detalization.sql)[0m
[0m17:20:56.551095 [error] [MainThread]:   missing FROM-clause entry for table "ords"
[0m17:20:56.552577 [error] [MainThread]:   LINE 30:         when ords.delay >= 0 then TRUE
[0m17:20:56.553772 [error] [MainThread]:                         ^
[0m17:20:56.555152 [error] [MainThread]:   compiled Code at target/run/otus_project_dbtvault/models/cdm/f_order_detalization.sql
[0m17:20:56.556477 [info ] [MainThread]: 
[0m17:20:56.557830 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:20:56.559046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e369e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e3555df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e3555eb0>]}
[0m17:20:56.560187 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:21:40.241553 | 8f3472ee-0946-45ed-a070-fcc8dcf1efb3 ==============================
[0m17:21:40.241553 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:21:40.244601 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:21:40.245797 [debug] [MainThread]: Tracking: tracking
[0m17:21:40.250936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6818666520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6818666130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6818666a30>]}
[0m17:21:43.650219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:43.652075 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/f_order_detalization.sql
[0m17:21:43.679480 [debug] [MainThread]: 1699: static parser successfully parsed cdm/f_order_detalization.sql
[0m17:21:43.739583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f3472ee-0946-45ed-a070-fcc8dcf1efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68185849a0>]}
[0m17:21:43.791300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f3472ee-0946-45ed-a070-fcc8dcf1efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6818247fa0>]}
[0m17:21:43.792482 [info ] [MainThread]: Found 112 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:21:43.793607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f3472ee-0946-45ed-a070-fcc8dcf1efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681864a5e0>]}
[0m17:21:43.801451 [info ] [MainThread]: 
[0m17:21:43.804800 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:43.807038 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:21:43.825896 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:21:43.827306 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:21:43.828486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:43.837404 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:21:43.840011 [debug] [ThreadPool]: On list_postgres: Close
[0m17:21:43.851555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:21:43.860973 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:21:43.862314 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:21:43.863429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:43.871294 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:21:43.872920 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:21:43.874153 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:21:43.877498 [debug] [ThreadPool]: SQL status: SELECT 127 in 0 seconds
[0m17:21:43.883105 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:21:43.884447 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:21:43.917017 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:43.918081 [debug] [MainThread]: On master: BEGIN
[0m17:21:43.919126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:43.927181 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:21:43.928639 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:43.929638 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:44.010179 [debug] [MainThread]: SQL status: SELECT 120 in 0 seconds
[0m17:21:44.030799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f3472ee-0946-45ed-a070-fcc8dcf1efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68170e5310>]}
[0m17:21:44.032512 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:44.034332 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:44.035508 [debug] [MainThread]: On master: BEGIN
[0m17:21:44.037138 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:21:44.038485 [debug] [MainThread]: On master: COMMIT
[0m17:21:44.039723 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:44.040785 [debug] [MainThread]: On master: COMMIT
[0m17:21:44.042206 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:21:44.043452 [debug] [MainThread]: On master: Close
[0m17:21:44.045115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:21:44.046395 [info ] [MainThread]: 
[0m17:21:44.051639 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_order_detalization
[0m17:21:44.052982 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.f_order_detalization ........................... [RUN]
[0m17:21:44.054996 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_order_detalization'
[0m17:21:44.056081 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_order_detalization
[0m17:21:44.061945 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:21:44.069412 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_order_detalization (compile): 2024-09-01 17:21:44.056935 => 2024-09-01 17:21:44.069296
[0m17:21:44.070304 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_order_detalization
[0m17:21:44.125614 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:21:44.132518 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:21:44.133229 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: BEGIN
[0m17:21:44.133871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:44.140994 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:21:44.142418 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:21:44.143483 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_order_detalization"} */

  create view "postgres"."dbt"."f_order_detalization__dbt_tmp" as (
    with ords_delay as
(
select
    lowd.ORDER_PK,
    count(owd.ORDER_WITH_DELAY_PK) as delay_reasons_count
FROM "postgres"."dbt"."sat_order_with_delay" AS owd
left join "postgres"."dbt"."link_order_with_delay_order" AS lowd on lowd.ORDER_WITH_DELAY_PK = owd.ORDER_WITH_DELAY_PK
group by lowd.ORDER_PK
)
select
    ca.ORDER_PK,
    ca.CURRENCY_PK,
    ca.order_date,
    ca.delivery_date,
    ca.good_count,
    ca.full_good_cost as order_cost_original,
    ca.full_good_cost_rur as order_cost_rur,
    ca.current_warehouse_pk,
    ca.current_status_pk,
    ca.order_weight,
    ca.payer_client_type_pk,
    ca.sender_city_pk,
    ca.receiver_city_pk,
    ca.has_problem_address,
    ca.business_area_id,
    case
        when ords_delay.delay_reasons_count >= 0 then TRUE
        else FALSE
    end as has_delay
FROM "postgres"."dbt"."cv_order_attributes" AS ca
left join ords_delay on ords_delay.ORDER_PK = ca.ORDER_PK
  );
[0m17:21:44.146854 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:21:44.156495 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:21:44.157507 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_order_detalization"} */
alter table "postgres"."dbt"."f_order_detalization__dbt_tmp" rename to "f_order_detalization"
[0m17:21:44.158880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:21:44.180639 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: COMMIT
[0m17:21:44.181697 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:21:44.182644 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: COMMIT
[0m17:21:44.186808 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:21:44.195680 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:21:44.196722 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_order_detalization"} */
drop view if exists "postgres"."dbt"."f_order_detalization__dbt_backup" cascade
[0m17:21:44.197888 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:21:44.199894 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_order_detalization (execute): 2024-09-01 17:21:44.071094 => 2024-09-01 17:21:44.199794
[0m17:21:44.200801 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: Close
[0m17:21:44.202331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f3472ee-0946-45ed-a070-fcc8dcf1efb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68170fe1c0>]}
[0m17:21:44.203501 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.f_order_detalization ...................... [[32mCREATE VIEW[0m in 0.15s]
[0m17:21:44.206783 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.f_order_detalization
[0m17:21:44.210004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:44.211149 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:44.212090 [debug] [MainThread]: On master: BEGIN
[0m17:21:44.213281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:44.221025 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:21:44.222609 [debug] [MainThread]: On master: COMMIT
[0m17:21:44.223999 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:44.225059 [debug] [MainThread]: On master: COMMIT
[0m17:21:44.226381 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:21:44.227477 [debug] [MainThread]: On master: Close
[0m17:21:44.229098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:44.229981 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.f_order_detalization' was properly closed.
[0m17:21:44.230862 [info ] [MainThread]: 
[0m17:21:44.232093 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m17:21:44.233380 [debug] [MainThread]: Command end result
[0m17:21:44.301597 [info ] [MainThread]: 
[0m17:21:44.302743 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:44.304009 [info ] [MainThread]: 
[0m17:21:44.305116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:21:44.306452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f681a4c4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68186a7a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6818630910>]}
[0m17:21:44.307614 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:31:24.053674 | 4d2e2b75-640d-4bf6-a06e-1f66f22b454b ==============================
[0m17:31:24.053674 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:31:24.057322 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:31:24.058462 [debug] [MainThread]: Tracking: tracking
[0m17:31:24.064764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349a3b36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349a3b3f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349a3b37f0>]}
[0m17:31:27.444223 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m17:31:27.445897 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/business_vault/f_order_detalization.sql
[0m17:31:27.446984 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/cv_last_order_status_by_date.sql
[0m17:31:27.448088 [debug] [MainThread]: Partial parsing: deleted file: otus_project_dbtvault://models/cdm/f_order_detalization.sql
[0m17:31:27.475563 [debug] [MainThread]: 1699: static parser successfully parsed business_vault/f_order_detalization.sql
[0m17:31:27.494450 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_last_order_status_by_date.sql
[0m17:31:27.542690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d2e2b75-640d-4bf6-a06e-1f66f22b454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349a2db0d0>]}
[0m17:31:27.595195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d2e2b75-640d-4bf6-a06e-1f66f22b454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3499fa2fd0>]}
[0m17:31:27.596310 [info ] [MainThread]: Found 113 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:31:27.597582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d2e2b75-640d-4bf6-a06e-1f66f22b454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349a3abbe0>]}
[0m17:31:27.605309 [info ] [MainThread]: 
[0m17:31:27.608547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:31:27.610686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:31:27.626810 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:31:27.628166 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:31:27.629559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:27.638200 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:31:27.640877 [debug] [ThreadPool]: On list_postgres: Close
[0m17:31:27.652445 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:31:27.663646 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:31:27.664951 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:31:27.666102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:27.674475 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:31:27.676043 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:31:27.677395 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:31:27.681011 [debug] [ThreadPool]: SQL status: SELECT 128 in 0 seconds
[0m17:31:27.687060 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:31:27.688739 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:31:27.720673 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:27.722083 [debug] [MainThread]: On master: BEGIN
[0m17:31:27.723293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:27.731808 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:31:27.733402 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:27.734710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:31:27.816377 [debug] [MainThread]: SQL status: SELECT 123 in 0 seconds
[0m17:31:27.838358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d2e2b75-640d-4bf6-a06e-1f66f22b454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349a254d00>]}
[0m17:31:27.839734 [debug] [MainThread]: On master: ROLLBACK
[0m17:31:27.841132 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:27.842307 [debug] [MainThread]: On master: BEGIN
[0m17:31:27.844064 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:31:27.845462 [debug] [MainThread]: On master: COMMIT
[0m17:31:27.846664 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:27.847920 [debug] [MainThread]: On master: COMMIT
[0m17:31:27.849365 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:31:27.850698 [debug] [MainThread]: On master: Close
[0m17:31:27.852209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:31:27.853347 [info ] [MainThread]: 
[0m17:31:27.857915 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:31:27.859232 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.cv_last_order_status_by_date ................... [RUN]
[0m17:31:27.860864 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status_by_date'
[0m17:31:27.861974 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:31:27.868198 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:31:27.876752 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status_by_date (compile): 2024-09-01 17:31:27.863064 => 2024-09-01 17:31:27.876624
[0m17:31:27.877626 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:31:27.939299 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:31:27.946512 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:31:27.947404 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: BEGIN
[0m17:31:27.948116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:31:27.955731 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:31:27.957249 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:31:27.958901 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */

  create view "postgres"."dbt"."cv_last_order_status_by_date__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd') as status_date,
        row_number() over (partition by lo.ORDER_PK, to_date(status_datetime, 'yyyy-mm-dd')  order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    lw.WAREHOUSE_PK,
	os.status_date,
	count(os.ORDER_PK) as order_count
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
group by os.status_date, lw.WAREHOUSE_PK
  );
[0m17:31:27.962784 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:31:27.973359 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:31:27.974461 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
alter table "postgres"."dbt"."cv_last_order_status_by_date__dbt_tmp" rename to "cv_last_order_status_by_date"
[0m17:31:27.975908 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:31:27.999207 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: COMMIT
[0m17:31:28.000535 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:31:28.001700 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: COMMIT
[0m17:31:28.005336 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:31:28.014310 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:31:28.015623 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
drop view if exists "postgres"."dbt"."cv_last_order_status_by_date__dbt_backup" cascade
[0m17:31:28.017083 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:31:28.019498 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status_by_date (execute): 2024-09-01 17:31:27.878331 => 2024-09-01 17:31:28.019432
[0m17:31:28.020819 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: Close
[0m17:31:28.022469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d2e2b75-640d-4bf6-a06e-1f66f22b454b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3498df1f40>]}
[0m17:31:28.023833 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.cv_last_order_status_by_date .............. [[32mCREATE VIEW[0m in 0.16s]
[0m17:31:28.027114 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:31:28.030042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:31:28.031218 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:28.032255 [debug] [MainThread]: On master: BEGIN
[0m17:31:28.033076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:28.040903 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:31:28.042614 [debug] [MainThread]: On master: COMMIT
[0m17:31:28.044006 [debug] [MainThread]: Using postgres connection "master"
[0m17:31:28.045153 [debug] [MainThread]: On master: COMMIT
[0m17:31:28.046546 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:31:28.047515 [debug] [MainThread]: On master: Close
[0m17:31:28.048766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:28.049648 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_last_order_status_by_date' was properly closed.
[0m17:31:28.050653 [info ] [MainThread]: 
[0m17:31:28.052022 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m17:31:28.053826 [debug] [MainThread]: Command end result
[0m17:31:28.124930 [info ] [MainThread]: 
[0m17:31:28.126100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:28.127367 [info ] [MainThread]: 
[0m17:31:28.128618 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:28.129946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349a400a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349c20fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f349e2f87c0>]}
[0m17:31:28.131098 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:33:07.028458 | 1a6ee32a-6e54-48b2-8097-040e14bcda4b ==============================
[0m17:33:07.028458 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:33:07.031702 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:33:07.032865 [debug] [MainThread]: Tracking: tracking
[0m17:33:07.038568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e011b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e011bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e011b7f0>]}
[0m17:33:09.999898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:33:10.001566 [debug] [MainThread]: Partial parsing: updated file: otus_project_dbtvault://models/cdm/cv_last_order_status_by_date.sql
[0m17:33:10.029084 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_last_order_status_by_date.sql
[0m17:33:10.090059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a6ee32a-6e54-48b2-8097-040e14bcda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e00430d0>]}
[0m17:33:10.142148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a6ee32a-6e54-48b2-8097-040e14bcda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dfd131c0>]}
[0m17:33:10.143256 [info ] [MainThread]: Found 113 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:33:10.144230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a6ee32a-6e54-48b2-8097-040e14bcda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e0113460>]}
[0m17:33:10.151656 [info ] [MainThread]: 
[0m17:33:10.154906 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:10.157326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:33:10.174456 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:33:10.176189 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:33:10.177414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:10.186495 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:33:10.189045 [debug] [ThreadPool]: On list_postgres: Close
[0m17:33:10.200374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:33:10.209667 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:33:10.210983 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:33:10.212201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:10.219918 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:33:10.221548 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:33:10.222854 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:33:10.226501 [debug] [ThreadPool]: SQL status: SELECT 129 in 0 seconds
[0m17:33:10.232419 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:33:10.233743 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:33:10.264552 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:10.265889 [debug] [MainThread]: On master: BEGIN
[0m17:33:10.267086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:10.275360 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:33:10.276803 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:10.277904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:33:10.358561 [debug] [MainThread]: SQL status: SELECT 126 in 0 seconds
[0m17:33:10.379326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a6ee32a-6e54-48b2-8097-040e14bcda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05dfc08dc0>]}
[0m17:33:10.380724 [debug] [MainThread]: On master: ROLLBACK
[0m17:33:10.382091 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:10.383125 [debug] [MainThread]: On master: BEGIN
[0m17:33:10.384587 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:33:10.385835 [debug] [MainThread]: On master: COMMIT
[0m17:33:10.386754 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:10.387795 [debug] [MainThread]: On master: COMMIT
[0m17:33:10.388957 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:33:10.389937 [debug] [MainThread]: On master: Close
[0m17:33:10.391445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:10.392890 [info ] [MainThread]: 
[0m17:33:10.397342 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:33:10.398685 [info ] [Thread-1  ]: 1 of 1 START sql view model dbt.cv_last_order_status_by_date ................... [RUN]
[0m17:33:10.400170 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status_by_date'
[0m17:33:10.401070 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:33:10.406594 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.413956 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status_by_date (compile): 2024-09-01 17:33:10.401813 => 2024-09-01 17:33:10.413840
[0m17:33:10.414717 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:33:10.468778 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.476083 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.476767 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: BEGIN
[0m17:33:10.477409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:33:10.484560 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:33:10.485958 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.487198 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */

  create view "postgres"."dbt"."cv_last_order_status_by_date__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd') as status_date,
        row_number() over (partition by lo.ORDER_PK, to_date(status_datetime, 'yyyy-mm-dd')  order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    lw.WAREHOUSE_PK,
	os.status_date,
	os.ORDER_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m17:33:10.490395 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:33:10.500595 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.501646 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
alter table "postgres"."dbt"."cv_last_order_status_by_date" rename to "cv_last_order_status_by_date__dbt_backup"
[0m17:33:10.503044 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:33:10.508805 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.509764 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
alter table "postgres"."dbt"."cv_last_order_status_by_date__dbt_tmp" rename to "cv_last_order_status_by_date"
[0m17:33:10.511041 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:33:10.536473 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: COMMIT
[0m17:33:10.537526 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.538481 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: COMMIT
[0m17:33:10.542714 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:33:10.550648 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:33:10.551649 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
drop view if exists "postgres"."dbt"."cv_last_order_status_by_date__dbt_backup" cascade
[0m17:33:10.555614 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:33:10.558079 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status_by_date (execute): 2024-09-01 17:33:10.415305 => 2024-09-01 17:33:10.558014
[0m17:33:10.559065 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: Close
[0m17:33:10.560436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a6ee32a-6e54-48b2-8097-040e14bcda4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05debbe7f0>]}
[0m17:33:10.561582 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dbt.cv_last_order_status_by_date .............. [[32mCREATE VIEW[0m in 0.16s]
[0m17:33:10.564437 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:33:10.567326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:10.568516 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:10.569447 [debug] [MainThread]: On master: BEGIN
[0m17:33:10.570477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:10.578469 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:33:10.579984 [debug] [MainThread]: On master: COMMIT
[0m17:33:10.581164 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:10.582309 [debug] [MainThread]: On master: COMMIT
[0m17:33:10.583538 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:33:10.584623 [debug] [MainThread]: On master: Close
[0m17:33:10.585940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:10.586728 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.cv_last_order_status_by_date' was properly closed.
[0m17:33:10.587652 [info ] [MainThread]: 
[0m17:33:10.588674 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m17:33:10.589997 [debug] [MainThread]: Command end result
[0m17:33:10.659566 [info ] [MainThread]: 
[0m17:33:10.660819 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:10.662077 [info ] [MainThread]: 
[0m17:33:10.663333 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:33:10.664778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e1f86280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e1f8e1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05e28f5520>]}
[0m17:33:10.665854 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:41:15.949289 | 6efd2293-2f4a-4ae4-8cec-c16ae9311c19 ==============================
[0m17:41:15.949289 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:41:15.952420 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:cdm'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:41:15.953479 [debug] [MainThread]: Tracking: tracking
[0m17:41:15.958110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44c528520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44c528130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44c528a30>]}
[0m17:41:19.312970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:41:19.314695 [debug] [MainThread]: Partial parsing: added file: otus_project_dbtvault://models/cdm/f_warehouse_loading.sql
[0m17:41:19.341820 [debug] [MainThread]: 1699: static parser successfully parsed cdm/f_warehouse_loading.sql
[0m17:41:19.404361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6efd2293-2f4a-4ae4-8cec-c16ae9311c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44c4430d0>]}
[0m17:41:19.458224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6efd2293-2f4a-4ae4-8cec-c16ae9311c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44c34dee0>]}
[0m17:41:19.459154 [info ] [MainThread]: Found 114 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:41:19.460180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efd2293-2f4a-4ae4-8cec-c16ae9311c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44c50e340>]}
[0m17:41:19.467481 [info ] [MainThread]: 
[0m17:41:19.471509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:41:19.474442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:41:19.492179 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:41:19.493484 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:41:19.494531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:19.503213 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:41:19.505846 [debug] [ThreadPool]: On list_postgres: Close
[0m17:41:19.517321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:41:19.526637 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:41:19.527960 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:41:19.529157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:19.537093 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:41:19.538755 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:41:19.539980 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:41:19.543590 [debug] [ThreadPool]: SQL status: SELECT 129 in 0 seconds
[0m17:41:19.549463 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:41:19.550810 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:41:19.581320 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:19.582634 [debug] [MainThread]: On master: BEGIN
[0m17:41:19.583671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:19.591697 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:41:19.593186 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:19.594398 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:41:19.673955 [debug] [MainThread]: SQL status: SELECT 126 in 0 seconds
[0m17:41:19.694571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efd2293-2f4a-4ae4-8cec-c16ae9311c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44dd12580>]}
[0m17:41:19.695882 [debug] [MainThread]: On master: ROLLBACK
[0m17:41:19.697197 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:19.698140 [debug] [MainThread]: On master: BEGIN
[0m17:41:19.699442 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:41:19.700540 [debug] [MainThread]: On master: COMMIT
[0m17:41:19.701711 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:19.702559 [debug] [MainThread]: On master: COMMIT
[0m17:41:19.704008 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:41:19.705059 [debug] [MainThread]: On master: Close
[0m17:41:19.706629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:41:19.707726 [info ] [MainThread]: 
[0m17:41:19.712298 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:41:19.713747 [info ] [Thread-1  ]: 1 of 2 START sql view model dbt.cv_last_order_status_by_date ................... [RUN]
[0m17:41:19.715209 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.cv_last_order_status_by_date'
[0m17:41:19.716233 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:41:19.722249 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.729004 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status_by_date (compile): 2024-09-01 17:41:19.716950 => 2024-09-01 17:41:19.728889
[0m17:41:19.729854 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:41:19.784043 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.790441 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.791218 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: BEGIN
[0m17:41:19.791930 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:19.799358 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:41:19.800780 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.801863 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */

  create view "postgres"."dbt"."cv_last_order_status_by_date__dbt_tmp" as (
    WITH order_status_history as (
    SELECT
        lo.ORDER_PK,
	    lo.ORDER_STATUS_HISTORY_PK,
        to_date(status_datetime, 'yyyy-mm-dd') as status_date,
        row_number() over (partition by lo.ORDER_PK, to_date(status_datetime, 'yyyy-mm-dd')  order by to_date(status_datetime, 'yyyy-mm-dd hh24:mi') desc) as row_num
    FROM "postgres"."dbt"."sat_order_status_history" AS so
    LEFT JOIN "postgres"."dbt"."link_order_order_status_history" AS lo on lo.ORDER_STATUS_HISTORY_PK = so.ORDER_STATUS_HISTORY_PK
)
select
    lw.WAREHOUSE_PK,
	os.status_date,
	os.ORDER_PK
from order_status_history os
LEFT JOIN "postgres"."dbt"."link_warehouse_order_status_history" AS lw on lw.ORDER_STATUS_HISTORY_PK = os.ORDER_STATUS_HISTORY_PK
where os.row_num = 1
  );
[0m17:41:19.805381 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:41:19.817170 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.818288 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
alter table "postgres"."dbt"."cv_last_order_status_by_date" rename to "cv_last_order_status_by_date__dbt_backup"
[0m17:41:19.820264 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:41:19.827263 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.828475 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
alter table "postgres"."dbt"."cv_last_order_status_by_date__dbt_tmp" rename to "cv_last_order_status_by_date"
[0m17:41:19.830297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:41:19.856946 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: COMMIT
[0m17:41:19.858010 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.858867 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: COMMIT
[0m17:41:19.869878 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:41:19.877961 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.cv_last_order_status_by_date"
[0m17:41:19.879099 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.cv_last_order_status_by_date"} */
drop view if exists "postgres"."dbt"."cv_last_order_status_by_date__dbt_backup" cascade
[0m17:41:19.882532 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:41:19.885439 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.cv_last_order_status_by_date (execute): 2024-09-01 17:41:19.730515 => 2024-09-01 17:41:19.885304
[0m17:41:19.886437 [debug] [Thread-1  ]: On model.otus_project_dbtvault.cv_last_order_status_by_date: Close
[0m17:41:19.887923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efd2293-2f4a-4ae4-8cec-c16ae9311c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44dd12640>]}
[0m17:41:19.888914 [info ] [Thread-1  ]: 1 of 2 OK created sql view model dbt.cv_last_order_status_by_date .............. [[32mCREATE VIEW[0m in 0.17s]
[0m17:41:19.892340 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.cv_last_order_status_by_date
[0m17:41:19.894752 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_warehouse_loading
[0m17:41:19.896093 [info ] [Thread-1  ]: 2 of 2 START sql view model dbt.f_warehouse_loading ............................ [RUN]
[0m17:41:19.898115 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_warehouse_loading'
[0m17:41:19.899563 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_warehouse_loading
[0m17:41:19.906970 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_warehouse_loading"
[0m17:41:19.914083 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_warehouse_loading (compile): 2024-09-01 17:41:19.900784 => 2024-09-01 17:41:19.913929
[0m17:41:19.915069 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_warehouse_loading
[0m17:41:19.928426 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_warehouse_loading"
[0m17:41:19.935809 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_warehouse_loading"
[0m17:41:19.936717 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_warehouse_loading: BEGIN
[0m17:41:19.937637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:41:19.946326 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:41:19.948062 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_warehouse_loading"
[0m17:41:19.949218 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_warehouse_loading: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_warehouse_loading"} */

  create view "postgres"."dbt"."f_warehouse_loading__dbt_tmp" as (
    with precalc as
(SELECT
    so.WAREHOUSE_PK,
	so.status_date,
	SUM(ca.good_count) as good_count,
    SUM(ca.order_weight) as good_weight,
    SUM(ca.order_volume) as good_volume
FROM "postgres"."dbt"."cv_last_order_status_by_date" AS so
left join "postgres"."dbt"."cv_order_attributes" AS ca on ca.ORDER_PK = so.ORDER_PK
group by so.WAREHOUSE_PK,
	so.status_date
)
select
    p.WAREHOUSE_PK,
	p.status_date,
	p.good_count,
    p.good_weight,
    p.good_volume,
	cw.max_loading_weight,
    cw.max_loading_volume,
    case
        when p.good_weight > cw.max_loading_weight then TRUE
        else FALSE
    end as has_weight_overload,
    case
        when p.good_volume > cw.max_loading_volume then TRUE
        else FALSE
    end as has_volume_overload
from precalc p
left join "postgres"."dbt"."cv_warehouse" AS cw on cw.WAREHOUSE_PK = p.WAREHOUSE_PK
  );
[0m17:41:19.953832 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:41:19.959576 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_warehouse_loading"
[0m17:41:19.960675 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_warehouse_loading: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_warehouse_loading"} */
alter table "postgres"."dbt"."f_warehouse_loading__dbt_tmp" rename to "f_warehouse_loading"
[0m17:41:19.961854 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:41:19.965295 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_warehouse_loading: COMMIT
[0m17:41:19.966243 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_warehouse_loading"
[0m17:41:19.967255 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_warehouse_loading: COMMIT
[0m17:41:19.970103 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:41:20.010930 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_warehouse_loading"
[0m17:41:20.012175 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_warehouse_loading: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_warehouse_loading"} */
drop view if exists "postgres"."dbt"."f_warehouse_loading__dbt_backup" cascade
[0m17:41:20.013584 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:41:20.015771 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_warehouse_loading (execute): 2024-09-01 17:41:19.915831 => 2024-09-01 17:41:20.015714
[0m17:41:20.016833 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_warehouse_loading: Close
[0m17:41:20.018363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6efd2293-2f4a-4ae4-8cec-c16ae9311c19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44af41d90>]}
[0m17:41:20.019552 [info ] [Thread-1  ]: 2 of 2 OK created sql view model dbt.f_warehouse_loading ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m17:41:20.021098 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.f_warehouse_loading
[0m17:41:20.024028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:41:20.025198 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:20.026244 [debug] [MainThread]: On master: BEGIN
[0m17:41:20.027161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:20.035599 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:41:20.037338 [debug] [MainThread]: On master: COMMIT
[0m17:41:20.038518 [debug] [MainThread]: Using postgres connection "master"
[0m17:41:20.039476 [debug] [MainThread]: On master: COMMIT
[0m17:41:20.040654 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:41:20.041807 [debug] [MainThread]: On master: Close
[0m17:41:20.043318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:20.044168 [debug] [MainThread]: Connection 'model.otus_project_dbtvault.f_warehouse_loading' was properly closed.
[0m17:41:20.045181 [info ] [MainThread]: 
[0m17:41:20.046256 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m17:41:20.047637 [debug] [MainThread]: Command end result
[0m17:41:20.085106 [info ] [MainThread]: 
[0m17:41:20.086489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:20.087792 [info ] [MainThread]: 
[0m17:41:20.089030 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:41:20.090646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44af858b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44af1f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe44afaedc0>]}
[0m17:41:20.091908 [debug] [MainThread]: Flushing usage events


============================== 2024-09-01 17:44:39.296349 | b47aad11-1361-4717-9e13-126efc18862a ==============================
[0m17:44:39.296349 [info ] [MainThread]: Running with dbt=1.4.0
[0m17:44:39.299661 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['tag:marts'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:44:39.300777 [debug] [MainThread]: Tracking: tracking
[0m17:44:39.305412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5370e04bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536de3da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536de3df40>]}
[0m17:44:39.417083 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:44:39.418550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536de3db20>]}
[0m17:44:45.904539 [debug] [MainThread]: 1603: static parser failed on business_vault/as_of_date.sql
[0m17:44:45.958308 [debug] [MainThread]: 1602: parser fallback to jinja rendering on business_vault/as_of_date.sql
[0m17:44:45.962025 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_business_area.sql
[0m17:44:45.967196 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_city_country.sql
[0m17:44:45.972580 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_currency_rate_by_date.sql
[0m17:44:45.977019 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_date.sql
[0m17:44:45.983406 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_goods.sql
[0m17:44:45.988810 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_last_order_status.sql
[0m17:44:45.994116 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_last_order_status_by_date.sql
[0m17:44:45.999953 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_attributes.sql
[0m17:44:46.006145 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_clients_info.sql
[0m17:44:46.011871 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_payer.sql
[0m17:44:46.017252 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_receiver.sql
[0m17:44:46.022857 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_order_sender.sql
[0m17:44:46.028372 [debug] [MainThread]: 1699: static parser successfully parsed cdm/cv_warehouse.sql
[0m17:44:46.033331 [debug] [MainThread]: 1699: static parser successfully parsed marts/d_business_area.sql
[0m17:44:46.037889 [debug] [MainThread]: 1699: static parser successfully parsed marts/d_client_type.sql
[0m17:44:46.042227 [debug] [MainThread]: 1699: static parser successfully parsed marts/d_currency.sql
[0m17:44:46.047136 [debug] [MainThread]: 1699: static parser successfully parsed marts/d_date.sql
[0m17:44:46.051598 [debug] [MainThread]: 1699: static parser successfully parsed marts/d_geography_structure.sql
[0m17:44:46.056049 [debug] [MainThread]: 1699: static parser successfully parsed marts/d_order_status.sql
[0m17:44:46.061026 [debug] [MainThread]: 1699: static parser successfully parsed marts/d_warehouse.sql
[0m17:44:46.065603 [debug] [MainThread]: 1699: static parser successfully parsed marts/f_good_sales.sql
[0m17:44:46.070630 [debug] [MainThread]: 1699: static parser successfully parsed marts/f_order_detalization.sql
[0m17:44:46.075750 [debug] [MainThread]: 1699: static parser successfully parsed marts/f_warehouse_loading.sql
[0m17:44:46.081262 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_city.sql
[0m17:44:46.203223 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_city.sql
[0m17:44:46.206310 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_client.sql
[0m17:44:46.220636 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_client.sql
[0m17:44:46.223583 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_client_address.sql
[0m17:44:46.239045 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_client_address.sql
[0m17:44:46.241860 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_client_type.sql
[0m17:44:46.256055 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_client_type.sql
[0m17:44:46.258834 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_country.sql
[0m17:44:46.272271 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_country.sql
[0m17:44:46.274956 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_currency.sql
[0m17:44:46.287831 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_currency.sql
[0m17:44:46.290717 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_currency_rate.sql
[0m17:44:46.304809 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_currency_rate.sql
[0m17:44:46.307670 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_good.sql
[0m17:44:46.320765 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_good.sql
[0m17:44:46.323669 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order.sql
[0m17:44:46.336746 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order.sql
[0m17:44:46.339743 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order_status.sql
[0m17:44:46.353512 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order_status.sql
[0m17:44:46.356401 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order_status_history.sql
[0m17:44:46.371757 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order_status_history.sql
[0m17:44:46.374537 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_order_with_delay.sql
[0m17:44:46.387844 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_order_with_delay.sql
[0m17:44:46.390517 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_warehouse.sql
[0m17:44:46.403745 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_warehouse.sql
[0m17:44:46.406365 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_warehouse_address.sql
[0m17:44:46.419713 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_warehouse_address.sql
[0m17:44:46.422567 [debug] [MainThread]: 1603: static parser failed on raw_vault/hubs/hub_warehouse_params.sql
[0m17:44:46.436644 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/hubs/hub_warehouse_params.sql
[0m17:44:46.439701 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_city_country.sql
[0m17:44:46.481938 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_city_country.sql
[0m17:44:46.484811 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_client_address_city.sql
[0m17:44:46.498111 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_client_address_city.sql
[0m17:44:46.500855 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_client_address_client.sql
[0m17:44:46.515624 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_client_address_client.sql
[0m17:44:46.518466 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_client_client_type.sql
[0m17:44:46.532412 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_client_client_type.sql
[0m17:44:46.535416 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_currency_currency_rate.sql
[0m17:44:46.549353 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_currency_currency_rate.sql
[0m17:44:46.552125 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_client.sql
[0m17:44:46.565921 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_client.sql
[0m17:44:46.568903 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_currency.sql
[0m17:44:46.583580 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_currency.sql
[0m17:44:46.586477 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_goods.sql
[0m17:44:46.600169 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_goods.sql
[0m17:44:46.603051 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_order_status_history.sql
[0m17:44:46.616219 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_order_status_history.sql
[0m17:44:46.618995 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_status_order_status_history.sql
[0m17:44:46.633410 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_status_order_status_history.sql
[0m17:44:46.636334 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_order_with_delay_order.sql
[0m17:44:46.650043 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_order_with_delay_order.sql
[0m17:44:46.652997 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_address_city.sql
[0m17:44:46.666487 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_address_city.sql
[0m17:44:46.669140 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_address_warehouse_params.sql
[0m17:44:46.682596 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_address_warehouse_params.sql
[0m17:44:46.685240 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_order_status_history.sql
[0m17:44:46.699821 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_order_status_history.sql
[0m17:44:46.702601 [debug] [MainThread]: 1603: static parser failed on raw_vault/links/link_warehouse_warehouse_params.sql
[0m17:44:46.716069 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/links/link_warehouse_warehouse_params.sql
[0m17:44:46.718840 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_city.sql
[0m17:44:46.791645 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_city.sql
[0m17:44:46.794741 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_client.sql
[0m17:44:46.817586 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_client.sql
[0m17:44:46.820610 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_client_address.sql
[0m17:44:46.839593 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_client_address.sql
[0m17:44:46.842746 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_client_type.sql
[0m17:44:46.862023 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_client_type.sql
[0m17:44:46.864849 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_country.sql
[0m17:44:46.884627 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_country.sql
[0m17:44:46.887701 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_currency.sql
[0m17:44:46.906782 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_currency.sql
[0m17:44:46.909675 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_currency_rate.sql
[0m17:44:46.930432 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_currency_rate.sql
[0m17:44:46.933347 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_good.sql
[0m17:44:46.954414 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_good.sql
[0m17:44:46.957471 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order.sql
[0m17:44:46.978633 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order.sql
[0m17:44:46.981507 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_status.sql
[0m17:44:47.001390 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_status.sql
[0m17:44:47.004400 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_status_history.sql
[0m17:44:47.061079 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_status_history.sql
[0m17:44:47.064148 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_order_with_delay.sql
[0m17:44:47.083586 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_order_with_delay.sql
[0m17:44:47.086724 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_warehouse.sql
[0m17:44:47.107103 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_warehouse.sql
[0m17:44:47.109792 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_warehouse_address.sql
[0m17:44:47.128186 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_warehouse_address.sql
[0m17:44:47.130981 [debug] [MainThread]: 1603: static parser failed on raw_vault/sats/sat_warehouse_params.sql
[0m17:44:47.149016 [debug] [MainThread]: 1602: parser fallback to jinja rendering on raw_vault/sats/sat_warehouse_params.sql
[0m17:44:47.151909 [debug] [MainThread]: 1603: static parser failed on stage/stg_city.sql
[0m17:44:47.361527 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_city.sql
[0m17:44:47.364731 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_city_country.sql
[0m17:44:47.369402 [debug] [MainThread]: 1603: static parser failed on stage/stg_client.sql
[0m17:44:47.400281 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_client.sql
[0m17:44:47.403168 [debug] [MainThread]: 1603: static parser failed on stage/stg_client_address.sql
[0m17:44:47.429457 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_client_address.sql
[0m17:44:47.432975 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_client_address_city.sql
[0m17:44:47.438137 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_client_address_client.sql
[0m17:44:47.443121 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_client_client_type.sql
[0m17:44:47.447786 [debug] [MainThread]: 1603: static parser failed on stage/stg_client_type.sql
[0m17:44:47.469604 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_client_type.sql
[0m17:44:47.473848 [debug] [MainThread]: 1603: static parser failed on stage/stg_country.sql
[0m17:44:47.495339 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_country.sql
[0m17:44:47.498084 [debug] [MainThread]: 1603: static parser failed on stage/stg_currency.sql
[0m17:44:47.520496 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_currency.sql
[0m17:44:47.523770 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_currency_currency_rate.sql
[0m17:44:47.528873 [debug] [MainThread]: 1603: static parser failed on stage/stg_currency_rate.sql
[0m17:44:47.554846 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_currency_rate.sql
[0m17:44:47.557943 [debug] [MainThread]: 1603: static parser failed on stage/stg_goods.sql
[0m17:44:47.583183 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_goods.sql
[0m17:44:47.586244 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_city_country.sql
[0m17:44:47.608236 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_city_country.sql
[0m17:44:47.611364 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_client_address_city.sql
[0m17:44:47.632412 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_client_address_city.sql
[0m17:44:47.635518 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_client_address_client.sql
[0m17:44:47.656818 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_client_address_client.sql
[0m17:44:47.659668 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_client_client_type.sql
[0m17:44:47.684876 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_client_client_type.sql
[0m17:44:47.688611 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_currency_currency_rate.sql
[0m17:44:47.711872 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_currency_currency_rate.sql
[0m17:44:47.714963 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_client.sql
[0m17:44:47.738600 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_client.sql
[0m17:44:47.742678 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_currency.sql
[0m17:44:47.767637 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_currency.sql
[0m17:44:47.770925 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_goods.sql
[0m17:44:47.792686 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_goods.sql
[0m17:44:47.796086 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_order_status_history.sql
[0m17:44:47.825320 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_order_status_history.sql
[0m17:44:47.828989 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_status_order_status_history.sql
[0m17:44:47.862045 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_status_order_status_history.sql
[0m17:44:47.867067 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_order_with_delay_order.sql
[0m17:44:47.894927 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_order_with_delay_order.sql
[0m17:44:47.897707 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_address_city.sql
[0m17:44:47.922193 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_address_city.sql
[0m17:44:47.925005 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_address_warehouse_params.sql
[0m17:44:47.947144 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_address_warehouse_params.sql
[0m17:44:47.950338 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_order_status_history.sql
[0m17:44:47.972941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_order_status_history.sql
[0m17:44:47.975869 [debug] [MainThread]: 1603: static parser failed on stage/stg_link_warehouse_warehouse_params.sql
[0m17:44:47.998596 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_link_warehouse_warehouse_params.sql
[0m17:44:48.001547 [debug] [MainThread]: 1603: static parser failed on stage/stg_orders.sql
[0m17:44:48.030106 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_orders.sql
[0m17:44:48.033320 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_client.sql
[0m17:44:48.039148 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_currency.sql
[0m17:44:48.044156 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_goods.sql
[0m17:44:48.049124 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_order_status_history.sql
[0m17:44:48.053975 [debug] [MainThread]: 1603: static parser failed on stage/stg_order_status.sql
[0m17:44:48.077158 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_order_status.sql
[0m17:44:48.079987 [debug] [MainThread]: 1603: static parser failed on stage/stg_order_status_history.sql
[0m17:44:48.102535 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_order_status_history.sql
[0m17:44:48.105779 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_status_order_status_history.sql
[0m17:44:48.110779 [debug] [MainThread]: 1603: static parser failed on stage/stg_order_with_delay.sql
[0m17:44:48.133555 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_order_with_delay.sql
[0m17:44:48.136863 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_order_with_delay_order.sql
[0m17:44:48.141940 [debug] [MainThread]: 1603: static parser failed on stage/stg_warehouse.sql
[0m17:44:48.166325 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_warehouse.sql
[0m17:44:48.169287 [debug] [MainThread]: 1603: static parser failed on stage/stg_warehouse_address.sql
[0m17:44:48.194304 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_warehouse_address.sql
[0m17:44:48.197617 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_address_city.sql
[0m17:44:48.202664 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_address_warehouse_params.sql
[0m17:44:48.207940 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_order_status_history.sql
[0m17:44:48.212878 [debug] [MainThread]: 1603: static parser failed on stage/stg_warehouse_params.sql
[0m17:44:48.236535 [debug] [MainThread]: 1602: parser fallback to jinja rendering on stage/stg_warehouse_params.sql
[0m17:44:48.240077 [debug] [MainThread]: 1699: static parser successfully parsed stage/stg_warehouse_warehouse_params.sql
[0m17:44:48.563250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536dd79070>]}
[0m17:44:48.621558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536de3deb0>]}
[0m17:44:48.622702 [info ] [MainThread]: Found 114 models, 0 tests, 0 snapshots, 0 analyses, 647 macros, 0 operations, 15 seed files, 60 sources, 0 exposures, 0 metrics
[0m17:44:48.623896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536db44a30>]}
[0m17:44:48.632282 [info ] [MainThread]: 
[0m17:44:48.635678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:48.638629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres'
[0m17:44:48.649170 [debug] [ThreadPool]: Using postgres connection "list_postgres"
[0m17:44:48.650472 [debug] [ThreadPool]: On list_postgres: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
[0m17:44:48.651927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:48.661090 [debug] [ThreadPool]: SQL status: SELECT 11 in 0 seconds
[0m17:44:48.663839 [debug] [ThreadPool]: On list_postgres: Close
[0m17:44:48.675406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_postgres_dbt'
[0m17:44:48.684811 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:44:48.686025 [debug] [ThreadPool]: On list_postgres_dbt: BEGIN
[0m17:44:48.686910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:48.694982 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:44:48.696580 [debug] [ThreadPool]: Using postgres connection "list_postgres_dbt"
[0m17:44:48.697788 [debug] [ThreadPool]: On list_postgres_dbt: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "list_postgres_dbt"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dbt'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dbt'
  
[0m17:44:48.702706 [debug] [ThreadPool]: SQL status: SELECT 130 in 0 seconds
[0m17:44:48.708838 [debug] [ThreadPool]: On list_postgres_dbt: ROLLBACK
[0m17:44:48.710497 [debug] [ThreadPool]: On list_postgres_dbt: Close
[0m17:44:48.745446 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:48.747063 [debug] [MainThread]: On master: BEGIN
[0m17:44:48.748544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:48.762821 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:44:48.764616 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:48.765766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:48.853859 [debug] [MainThread]: SQL status: SELECT 129 in 0 seconds
[0m17:44:48.874707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5370e04bb0>]}
[0m17:44:48.876072 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:48.877198 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:48.878142 [debug] [MainThread]: On master: BEGIN
[0m17:44:48.879342 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:44:48.880512 [debug] [MainThread]: On master: COMMIT
[0m17:44:48.881654 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:48.882555 [debug] [MainThread]: On master: COMMIT
[0m17:44:48.883911 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:44:48.884854 [debug] [MainThread]: On master: Close
[0m17:44:48.886265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:44:48.887428 [info ] [MainThread]: 
[0m17:44:48.892264 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_business_area
[0m17:44:48.893515 [info ] [Thread-1  ]: 1 of 10 START sql view model dbt.d_business_area ............................... [RUN]
[0m17:44:48.894984 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_business_area'
[0m17:44:48.895764 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_business_area
[0m17:44:48.900836 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_business_area"
[0m17:44:48.911349 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_business_area (compile): 2024-09-01 17:44:48.896597 => 2024-09-01 17:44:48.911232
[0m17:44:48.912302 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_business_area
[0m17:44:48.965959 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_business_area"
[0m17:44:48.977702 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:44:48.978487 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: BEGIN
[0m17:44:48.979160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:48.986303 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:48.987738 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:44:48.988927 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */

  create view "postgres"."dbt"."d_business_area__dbt_tmp" as (
    select
    ba.id,
    ba.business_area_name
FROM "postgres"."dbt"."cv_business_area" AS ba
  );
[0m17:44:48.991928 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.002986 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:44:49.004083 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
alter table "postgres"."dbt"."d_business_area" rename to "d_business_area__dbt_backup"
[0m17:44:49.005691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.011152 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:44:49.012344 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
alter table "postgres"."dbt"."d_business_area__dbt_tmp" rename to "d_business_area"
[0m17:44:49.013739 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.041126 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: COMMIT
[0m17:44:49.042530 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:44:49.043853 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: COMMIT
[0m17:44:49.047487 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.056104 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_business_area"
[0m17:44:49.057453 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_business_area"} */
drop view if exists "postgres"."dbt"."d_business_area__dbt_backup" cascade
[0m17:44:49.060921 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.063239 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_business_area (execute): 2024-09-01 17:44:48.912986 => 2024-09-01 17:44:49.063162
[0m17:44:49.064251 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_business_area: Close
[0m17:44:49.065719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536dbfe760>]}
[0m17:44:49.067063 [info ] [Thread-1  ]: 1 of 10 OK created sql view model dbt.d_business_area .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m17:44:49.070376 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_business_area
[0m17:44:49.071814 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_client_type
[0m17:44:49.073170 [info ] [Thread-1  ]: 2 of 10 START sql view model dbt.d_client_type ................................. [RUN]
[0m17:44:49.075106 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_client_type'
[0m17:44:49.076128 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_client_type
[0m17:44:49.081420 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.088877 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_client_type (compile): 2024-09-01 17:44:49.077116 => 2024-09-01 17:44:49.088770
[0m17:44:49.089731 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_client_type
[0m17:44:49.101181 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.109176 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.110030 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: BEGIN
[0m17:44:49.110726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.117795 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.119340 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.120346 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */

  create view "postgres"."dbt"."d_client_type__dbt_tmp" as (
    select
    sc.CLIENT_TYPE_PK,
    sc.name
FROM "postgres"."dbt"."sat_client_type" AS sc
  );
[0m17:44:49.122560 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.128718 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.129788 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
alter table "postgres"."dbt"."d_client_type" rename to "d_client_type__dbt_backup"
[0m17:44:49.131653 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.174904 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.176159 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
alter table "postgres"."dbt"."d_client_type__dbt_tmp" rename to "d_client_type"
[0m17:44:49.177490 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.180508 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: COMMIT
[0m17:44:49.181478 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.182401 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: COMMIT
[0m17:44:49.186050 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.190666 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_client_type"
[0m17:44:49.192148 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_client_type"} */
drop view if exists "postgres"."dbt"."d_client_type__dbt_backup" cascade
[0m17:44:49.195611 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.198017 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_client_type (execute): 2024-09-01 17:44:49.090388 => 2024-09-01 17:44:49.197958
[0m17:44:49.198977 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_client_type: Close
[0m17:44:49.200446 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536dbfe8b0>]}
[0m17:44:49.201940 [info ] [Thread-1  ]: 2 of 10 OK created sql view model dbt.d_client_type ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m17:44:49.203405 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_client_type
[0m17:44:49.204634 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_currency
[0m17:44:49.205797 [info ] [Thread-1  ]: 3 of 10 START sql view model dbt.d_currency .................................... [RUN]
[0m17:44:49.207309 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_currency'
[0m17:44:49.208090 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_currency
[0m17:44:49.212976 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_currency"
[0m17:44:49.218919 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_currency (compile): 2024-09-01 17:44:49.208741 => 2024-09-01 17:44:49.218808
[0m17:44:49.219776 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_currency
[0m17:44:49.230994 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_currency"
[0m17:44:49.239098 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:44:49.240069 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: BEGIN
[0m17:44:49.240878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.248134 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.249697 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:44:49.250797 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */

  create view "postgres"."dbt"."d_currency__dbt_tmp" as (
    select
    sc.CURRENCY_PK,
    sc.name
FROM "postgres"."dbt"."sat_currency" AS sc
  );
[0m17:44:49.253092 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.259161 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:44:49.260306 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
alter table "postgres"."dbt"."d_currency" rename to "d_currency__dbt_backup"
[0m17:44:49.261812 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.267913 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:44:49.269027 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
alter table "postgres"."dbt"."d_currency__dbt_tmp" rename to "d_currency"
[0m17:44:49.270549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.273475 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: COMMIT
[0m17:44:49.274533 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:44:49.275442 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: COMMIT
[0m17:44:49.278188 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.282846 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_currency"
[0m17:44:49.284199 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_currency"} */
drop view if exists "postgres"."dbt"."d_currency__dbt_backup" cascade
[0m17:44:49.287625 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.289966 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_currency (execute): 2024-09-01 17:44:49.220411 => 2024-09-01 17:44:49.289906
[0m17:44:49.291085 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_currency: Close
[0m17:44:49.292658 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536dcdfd30>]}
[0m17:44:49.294033 [info ] [Thread-1  ]: 3 of 10 OK created sql view model dbt.d_currency ............................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:44:49.295735 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_currency
[0m17:44:49.296966 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_date
[0m17:44:49.298015 [info ] [Thread-1  ]: 4 of 10 START sql view model dbt.d_date ........................................ [RUN]
[0m17:44:49.299638 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_date'
[0m17:44:49.300695 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_date
[0m17:44:49.306203 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_date"
[0m17:44:49.313283 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (compile): 2024-09-01 17:44:49.301698 => 2024-09-01 17:44:49.313179
[0m17:44:49.314232 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_date
[0m17:44:49.325398 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_date"
[0m17:44:49.333256 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:44:49.334032 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: BEGIN
[0m17:44:49.334704 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.342037 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.343579 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:44:49.344777 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */

  create view "postgres"."dbt"."d_date__dbt_tmp" as (
    SELECT
    d.as_of_date as date_value,
    extract(YEAR FROM d.as_of_date) as year,
    extract(MONTH FROM d.as_of_date) as month,
    extract(DAY FROM d.as_of_date) as day,
    extract(WEEK FROM d.as_of_date) as week
FROM "postgres"."dbt"."as_of_date" AS d
  );
[0m17:44:49.347507 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.353495 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:44:49.354424 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date" rename to "d_date__dbt_backup"
[0m17:44:49.355620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.362222 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:44:49.363495 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
alter table "postgres"."dbt"."d_date__dbt_tmp" rename to "d_date"
[0m17:44:49.365424 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.368775 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m17:44:49.369906 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:44:49.370926 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: COMMIT
[0m17:44:49.373926 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.378635 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_date"
[0m17:44:49.379840 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_date"} */
drop view if exists "postgres"."dbt"."d_date__dbt_backup" cascade
[0m17:44:49.383103 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.385353 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_date (execute): 2024-09-01 17:44:49.314909 => 2024-09-01 17:44:49.385295
[0m17:44:49.386405 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_date: Close
[0m17:44:49.387951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536dd5b820>]}
[0m17:44:49.389239 [info ] [Thread-1  ]: 4 of 10 OK created sql view model dbt.d_date ................................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:44:49.390597 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_date
[0m17:44:49.392060 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_geography_structure
[0m17:44:49.393394 [info ] [Thread-1  ]: 5 of 10 START sql view model dbt.d_geography_structure ......................... [RUN]
[0m17:44:49.395155 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_geography_structure'
[0m17:44:49.396291 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_geography_structure
[0m17:44:49.401512 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.408736 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_geography_structure (compile): 2024-09-01 17:44:49.397264 => 2024-09-01 17:44:49.408627
[0m17:44:49.409581 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_geography_structure
[0m17:44:49.420822 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.430441 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.431464 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: BEGIN
[0m17:44:49.432443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.439920 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.441429 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.442539 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */

  create view "postgres"."dbt"."d_geography_structure__dbt_tmp" as (
    select
    cc.CITY_PK,
    cc.city_name,
    cc.country_name
FROM "postgres"."dbt"."cv_city_country" AS cc
  );
[0m17:44:49.444896 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.450650 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.451745 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
alter table "postgres"."dbt"."d_geography_structure" rename to "d_geography_structure__dbt_backup"
[0m17:44:49.453255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.459900 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.461338 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
alter table "postgres"."dbt"."d_geography_structure__dbt_tmp" rename to "d_geography_structure"
[0m17:44:49.462793 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.465711 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: COMMIT
[0m17:44:49.466750 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.467853 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: COMMIT
[0m17:44:49.470362 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.474933 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_geography_structure"
[0m17:44:49.475893 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_geography_structure"} */
drop view if exists "postgres"."dbt"."d_geography_structure__dbt_backup" cascade
[0m17:44:49.479288 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.481549 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_geography_structure (execute): 2024-09-01 17:44:49.410180 => 2024-09-01 17:44:49.481491
[0m17:44:49.482560 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_geography_structure: Close
[0m17:44:49.484212 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536dc8db80>]}
[0m17:44:49.485628 [info ] [Thread-1  ]: 5 of 10 OK created sql view model dbt.d_geography_structure .................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:44:49.487021 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_geography_structure
[0m17:44:49.488414 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_order_status
[0m17:44:49.489523 [info ] [Thread-1  ]: 6 of 10 START sql view model dbt.d_order_status ................................ [RUN]
[0m17:44:49.491167 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_order_status'
[0m17:44:49.492227 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_order_status
[0m17:44:49.497614 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.504977 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_order_status (compile): 2024-09-01 17:44:49.493005 => 2024-09-01 17:44:49.504864
[0m17:44:49.505856 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_order_status
[0m17:44:49.517374 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.525768 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.526648 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: BEGIN
[0m17:44:49.527387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.534795 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.536068 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.537165 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */

  create view "postgres"."dbt"."d_order_status__dbt_tmp" as (
    select
    sc.ORDER_STATUS_PK,
    sc.name
FROM "postgres"."dbt"."sat_order_status" AS sc
  );
[0m17:44:49.539435 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.546155 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.547277 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */
alter table "postgres"."dbt"."d_order_status" rename to "d_order_status__dbt_backup"
[0m17:44:49.549046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.554352 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.555501 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */
alter table "postgres"."dbt"."d_order_status__dbt_tmp" rename to "d_order_status"
[0m17:44:49.556955 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.560565 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: COMMIT
[0m17:44:49.561708 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.562478 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: COMMIT
[0m17:44:49.565103 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.571363 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_order_status"
[0m17:44:49.572622 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_order_status"} */
drop view if exists "postgres"."dbt"."d_order_status__dbt_backup" cascade
[0m17:44:49.575903 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.578566 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_order_status (execute): 2024-09-01 17:44:49.506540 => 2024-09-01 17:44:49.578504
[0m17:44:49.579739 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_order_status: Close
[0m17:44:49.581156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536ddb3c70>]}
[0m17:44:49.582363 [info ] [Thread-1  ]: 6 of 10 OK created sql view model dbt.d_order_status ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m17:44:49.583732 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_order_status
[0m17:44:49.585172 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.d_warehouse
[0m17:44:49.586328 [info ] [Thread-1  ]: 7 of 10 START sql view model dbt.d_warehouse ................................... [RUN]
[0m17:44:49.588125 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.d_warehouse'
[0m17:44:49.589203 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.d_warehouse
[0m17:44:49.595153 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.602192 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_warehouse (compile): 2024-09-01 17:44:49.590031 => 2024-09-01 17:44:49.602060
[0m17:44:49.603076 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.d_warehouse
[0m17:44:49.614960 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.623055 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.623842 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: BEGIN
[0m17:44:49.624511 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.632327 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.634021 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.635100 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */

  create view "postgres"."dbt"."d_warehouse__dbt_tmp" as (
    select
    cw.WAREHOUSE_PK,
    cw.name as warehouse_name,
    cw.system_name as warehouse_system_name,
    cc.city_name,
    cc.country_name
FROM "postgres"."dbt"."cv_warehouse" AS cw
LEFT JOIN "postgres"."dbt"."cv_city_country" AS cc on cw.CITY_PK = cc.CITY_PK
  );
[0m17:44:49.638438 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.644656 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.645920 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
alter table "postgres"."dbt"."d_warehouse" rename to "d_warehouse__dbt_backup"
[0m17:44:49.647614 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.653215 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.654411 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
alter table "postgres"."dbt"."d_warehouse__dbt_tmp" rename to "d_warehouse"
[0m17:44:49.655873 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.658866 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: COMMIT
[0m17:44:49.659908 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.660848 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: COMMIT
[0m17:44:49.663681 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.670272 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.d_warehouse"
[0m17:44:49.671530 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.d_warehouse"} */
drop view if exists "postgres"."dbt"."d_warehouse__dbt_backup" cascade
[0m17:44:49.674930 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.677525 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.d_warehouse (execute): 2024-09-01 17:44:49.603773 => 2024-09-01 17:44:49.677444
[0m17:44:49.678671 [debug] [Thread-1  ]: On model.otus_project_dbtvault.d_warehouse: Close
[0m17:44:49.680049 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536c8dd100>]}
[0m17:44:49.681185 [info ] [Thread-1  ]: 7 of 10 OK created sql view model dbt.d_warehouse .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m17:44:49.682431 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.d_warehouse
[0m17:44:49.683529 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_good_sales
[0m17:44:49.684525 [info ] [Thread-1  ]: 8 of 10 START sql view model dbt.f_good_sales .................................. [RUN]
[0m17:44:49.685875 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_good_sales'
[0m17:44:49.686626 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_good_sales
[0m17:44:49.691733 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.698474 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_good_sales (compile): 2024-09-01 17:44:49.687321 => 2024-09-01 17:44:49.698331
[0m17:44:49.699486 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_good_sales
[0m17:44:49.711348 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.719664 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.720624 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: BEGIN
[0m17:44:49.721456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.729594 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.731444 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.732787 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */

  create view "postgres"."dbt"."f_good_sales__dbt_tmp" as (
    select
    cg.GOOD_PK,
    cg.count as good_count,
    cg.order_date,
    cg.delivery_date,
    cg.CURRENCY_PK,
    cg.full_good_cost as good_cost_original,
    cg.full_good_cost_rur as good_cost_rur,
    cg.delivery_warehouse_pk
FROM "postgres"."dbt"."cv_goods" AS cg
  );
[0m17:44:49.735721 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.742682 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.744024 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */
alter table "postgres"."dbt"."f_good_sales" rename to "f_good_sales__dbt_backup"
[0m17:44:49.745561 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.751025 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.752565 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */
alter table "postgres"."dbt"."f_good_sales__dbt_tmp" rename to "f_good_sales"
[0m17:44:49.754173 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:44:49.757648 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: COMMIT
[0m17:44:49.758926 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.760050 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: COMMIT
[0m17:44:49.762684 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:44:49.768447 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_good_sales"
[0m17:44:49.769736 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_good_sales"} */
drop view if exists "postgres"."dbt"."f_good_sales__dbt_backup" cascade
[0m17:44:49.773002 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:44:49.775450 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_good_sales (execute): 2024-09-01 17:44:49.700129 => 2024-09-01 17:44:49.775387
[0m17:44:49.776473 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_good_sales: Close
[0m17:44:49.777988 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b47aad11-1361-4717-9e13-126efc18862a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f536c952f10>]}
[0m17:44:49.779425 [info ] [Thread-1  ]: 8 of 10 OK created sql view model dbt.f_good_sales ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m17:44:49.780942 [debug] [Thread-1  ]: Finished running node model.otus_project_dbtvault.f_good_sales
[0m17:44:49.782254 [debug] [Thread-1  ]: Began running node model.otus_project_dbtvault.f_order_detalization
[0m17:44:49.783473 [info ] [Thread-1  ]: 9 of 10 START sql view model dbt.f_order_detalization .......................... [RUN]
[0m17:44:49.785096 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.otus_project_dbtvault.f_order_detalization'
[0m17:44:49.786201 [debug] [Thread-1  ]: Began compiling node model.otus_project_dbtvault.f_order_detalization
[0m17:44:49.792672 [debug] [Thread-1  ]: Writing injected SQL for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:44:49.800530 [debug] [Thread-1  ]: Timing info for model.otus_project_dbtvault.f_order_detalization (compile): 2024-09-01 17:44:49.786938 => 2024-09-01 17:44:49.800393
[0m17:44:49.801660 [debug] [Thread-1  ]: Began executing node model.otus_project_dbtvault.f_order_detalization
[0m17:44:49.813622 [debug] [Thread-1  ]: Writing runtime sql for node "model.otus_project_dbtvault.f_order_detalization"
[0m17:44:49.824523 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:44:49.825453 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: BEGIN
[0m17:44:49.826174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:44:49.833872 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:44:49.835022 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:44:49.835773 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_order_detalization"} */

  create view "postgres"."dbt"."f_order_detalization__dbt_tmp" as (
    with ords_delay as
(
select
    lowd.ORDER_PK,
    count(owd.ORDER_WITH_DELAY_PK) as delay_reasons_count
FROM "postgres"."dbt"."sat_order_with_delay" AS owd
left join "postgres"."dbt"."link_order_with_delay_order" AS lowd on lowd.ORDER_WITH_DELAY_PK = owd.ORDER_WITH_DELAY_PK
group by lowd.ORDER_PK
)
select
    ca.ORDER_PK,
    ca.CURRENCY_PK,
    ca.order_date,
    ca.delivery_date,
    ca.good_count,
    ca.full_good_cost as order_cost_original,
    ca.full_good_cost_rur as order_cost_rur,
    ca.current_warehouse_pk,
    ca.current_status_pk,
    ca.order_weight,
    ca.payer_client_type_pk,
    ca.sender_city_pk,
    ca.receiver_city_pk,
    ca.has_problem_address,
    ca.business_area_id,
    case
        when ords_delay.delay_reasons_count >= 0 then TRUE
        else FALSE
    end as has_delay
FROM "postgres"."dbt"."cv_order_attributes" AS ca
left join ords_delay on ords_delay.ORDER_PK = ca.ORDER_PK
  );
[0m17:44:49.838554 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:44:49.844146 [debug] [Thread-1  ]: Using postgres connection "model.otus_project_dbtvault.f_order_detalization"
[0m17:44:49.845352 [debug] [Thread-1  ]: On model.otus_project_dbtvault.f_order_detalization: /* {"app": "dbt", "dbt_version": "1.4.0", "profile_name": "otus_project", "target_name": "dev", "node_id": "model.otus_project_dbtvault.f_order_detalization"} */
alter table "postgres"."dbt"."f_order_detalization" rename to "f_order_detalization__dbt_backup"


============================== 2024-09-02 15:49:25.963257 | fa314138-b1bd-4e92-be6e-6e927be9e83c ==============================
[0m15:49:25.963257 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:49:25.966032 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:49:25.967088 [debug] [MainThread]: Tracking: tracking
[0m15:49:25.972406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f4c7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f4c7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f4c76a0>]}
[0m15:49:25.978932 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-zy8eq763'
[0m15:49:25.980486 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:49:27.244023 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:27.245551 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m15:49:27.246970 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:49:27.247991 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:49:27.253069 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:49:27.254438 [debug] [MainThread]: STDERR: "b''"
[0m15:49:27.255546 [debug] [MainThread]:   Checking out revision master.
[0m15:49:27.256564 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:49:27.260889 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:27.262177 [debug] [MainThread]: STDERR: "b''"
[0m15:49:27.263258 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:49:28.775696 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:28.776828 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m15:49:28.777713 [debug] [MainThread]: Executing "git tag --list"
[0m15:49:28.782267 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:49:28.783699 [debug] [MainThread]: STDERR: "b''"
[0m15:49:28.784591 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:49:28.795801 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:49:28.797024 [debug] [MainThread]: STDERR: "b''"
[0m15:49:28.797908 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:49:28.802311 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:49:28.803652 [debug] [MainThread]: STDERR: "b''"
[0m15:49:28.804744 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m15:49:28.806416 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:49:28.821370 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:49:29.209171 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:49:29.211559 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:49:29.425475 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:49:29.621520 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:49:29.625534 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:29.626674 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:49:29.627416 [debug] [MainThread]: command return code=128
[0m15:49:29.628895 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:49:29.629707 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:49:29.634843 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:49:29.635954 [debug] [MainThread]: STDERR: "b''"
[0m15:49:29.636714 [debug] [MainThread]:   Checking out revision master.
[0m15:49:29.637385 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:49:29.642428 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:29.643475 [debug] [MainThread]: STDERR: "b''"
[0m15:49:29.644149 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:49:30.440961 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:30.442516 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:49:30.443680 [debug] [MainThread]: Executing "git tag --list"
[0m15:49:30.448386 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:49:30.449864 [debug] [MainThread]: STDERR: "b''"
[0m15:49:30.451067 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:49:30.458120 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:49:30.459305 [debug] [MainThread]: STDERR: "b''"
[0m15:49:30.460358 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:49:30.464838 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:49:30.466154 [debug] [MainThread]: STDERR: "b''"
[0m15:49:30.467050 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:49:30.468459 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m15:49:30.482829 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m15:49:30.720957 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:49:30.725104 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:30.726309 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m15:49:30.727177 [debug] [MainThread]: command return code=128
[0m15:49:30.728500 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m15:49:30.729389 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:49:30.733959 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:49:30.735398 [debug] [MainThread]: STDERR: "b''"
[0m15:49:30.736381 [debug] [MainThread]:   Checking out revision master.
[0m15:49:30.737353 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m15:49:30.743093 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:30.744432 [debug] [MainThread]: STDERR: "b''"
[0m15:49:30.745371 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m15:49:32.445062 [debug] [MainThread]: STDOUT: "b''"
[0m15:49:32.446943 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m15:49:32.448249 [debug] [MainThread]: Executing "git tag --list"
[0m15:49:32.452956 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m15:49:32.454315 [debug] [MainThread]: STDERR: "b''"
[0m15:49:32.455279 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m15:49:32.461365 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m15:49:32.462950 [debug] [MainThread]: STDERR: "b''"
[0m15:49:32.464050 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m15:49:32.468248 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m15:49:32.469643 [debug] [MainThread]: STDERR: "b''"
[0m15:49:32.470540 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m15:49:35.230454 [info ] [MainThread]:   Installed from revision master
[0m15:49:35.232100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fa314138-b1bd-4e92-be6e-6e927be9e83c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f537130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f537370>]}
[0m15:49:35.233439 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:49:39.053548 [info ] [MainThread]:   Installed from version 1.3.0
[0m15:49:39.054782 [info ] [MainThread]:   Up to date!
[0m15:49:39.055993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fa314138-b1bd-4e92-be6e-6e927be9e83c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3025ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2fbcda60>]}
[0m15:49:39.058652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f5debb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad30286640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad3025ab80>]}
[0m15:49:39.059816 [debug] [MainThread]: Flushing usage events


============================== 2024-09-02 15:49:50.243301 | 49818fb0-85f5-4b91-84a3-fff2b639e4dd ==============================
[0m15:49:50.243301 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:49:50.245462 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m15:49:50.246245 [debug] [MainThread]: Tracking: tracking
[0m15:49:50.250668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f920c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f920cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f91a0880>]}
[0m15:49:50.444843 [debug] [MainThread]: Executing "git --help"
[0m15:49:50.450479 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:49:50.452265 [debug] [MainThread]: STDERR: "b''"
[0m15:49:50.460354 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:49:50.461945 [debug] [MainThread]: Using postgres connection "debug"
[0m15:49:50.463102 [debug] [MainThread]: On debug: select 1 as id
[0m15:49:50.464215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:50.489479 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m15:49:50.492383 [debug] [MainThread]: On debug: Close
[0m15:49:50.493929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f920cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f79a4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5f79a4700>]}
[0m15:49:50.495672 [debug] [MainThread]: Flushing usage events
[0m15:49:51.204969 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-09-02 16:31:16.897583 | 0fc06dd5-34d5-4a37-9cc7-6e695c2d71eb ==============================
[0m16:31:16.897583 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:31:16.900215 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m16:31:16.901412 [debug] [MainThread]: Tracking: tracking
[0m16:31:16.907745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09d9f3160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09d9f3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09d9f36a0>]}
[0m16:31:16.915403 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vj7e5ria'
[0m16:31:16.917442 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:31:18.204465 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:18.205877 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\n""
[0m16:31:18.207228 [debug] [MainThread]: Pulling new dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:31:18.208358 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:31:18.215007 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:31:18.216599 [debug] [MainThread]: STDERR: "b''"
[0m16:31:18.217775 [debug] [MainThread]:   Checking out revision master.
[0m16:31:18.219097 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:31:18.225312 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:18.226747 [debug] [MainThread]: STDERR: "b''"
[0m16:31:18.227783 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:31:19.728261 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:19.729451 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n * [new tag]         v0.1-pre   -> v0.1-pre\n * [new tag]         v0.2-pre   -> v0.2-pre\n * [new tag]         v0.2.1-pre -> v0.2.1-pre\n * [new tag]         v0.2.2-pre -> v0.2.2-pre\n * [new tag]         v0.2.3-pre -> v0.2.3-pre\n * [new tag]         v0.2.4-pre -> v0.2.4-pre\n * [new tag]         v0.3-pre   -> v0.3-pre\n * [new tag]         v0.3.1-pre -> v0.3.1-pre\n * [new tag]         v0.3.2-pre -> v0.3.2-pre\n * [new tag]         v0.3.3-pre -> v0.3.3-pre\n * [new tag]         v0.4       -> v0.4\n * [new tag]         v0.4.1     -> v0.4.1\n * [new tag]         v0.5       -> v0.5\n * [new tag]         v0.6       -> v0.6\n * [new tag]         v0.6-b1    -> v0.6-b1\n * [new tag]         v0.6-b2    -> v0.6-b2\n * [new tag]         v0.6.1     -> v0.6.1\n * [new tag]         v0.6.2     -> v0.6.2\n * [new tag]         v0.7.0     -> v0.7.0\n * [new tag]         v0.7.1     -> v0.7.1\n * [new tag]         v0.7.2     -> v0.7.2\n * [new tag]         v0.7.3     -> v0.7.3\n'"
[0m16:31:19.730234 [debug] [MainThread]: Executing "git tag --list"
[0m16:31:19.743820 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:31:19.744895 [debug] [MainThread]: STDERR: "b''"
[0m16:31:19.745595 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:31:19.754990 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:31:19.756015 [debug] [MainThread]: STDERR: "b''"
[0m16:31:19.756740 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:31:19.760371 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:31:19.761400 [debug] [MainThread]: STDERR: "b''"
[0m16:31:19.762110 [debug] [MainThread]:   Checked out at 8ee9ee8.
[0m16:31:19.763407 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:31:19.776852 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:31:20.150902 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:31:20.152446 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:31:20.353785 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:31:20.499041 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:31:20.504049 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:20.505494 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:31:20.506668 [debug] [MainThread]: command return code=128
[0m16:31:20.508483 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:31:20.509584 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:31:20.514875 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:31:20.516635 [debug] [MainThread]: STDERR: "b''"
[0m16:31:20.517920 [debug] [MainThread]:   Checking out revision master.
[0m16:31:20.519445 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:31:20.524889 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:20.526445 [debug] [MainThread]: STDERR: "b''"
[0m16:31:20.527555 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:31:21.363792 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:21.365259 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:31:21.366147 [debug] [MainThread]: Executing "git tag --list"
[0m16:31:21.370439 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:31:21.371974 [debug] [MainThread]: STDERR: "b''"
[0m16:31:21.373070 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:31:21.379499 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:31:21.380982 [debug] [MainThread]: STDERR: "b''"
[0m16:31:21.382409 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:31:21.387919 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:31:21.389714 [debug] [MainThread]: STDERR: "b''"
[0m16:31:21.390850 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:31:21.392406 [warn ] [MainThread]: [33mWARNING: The git package "https://github.com/kzzzr/dbtvault.git" 
	is None.
	This can introduce breaking changes into your project without warning!

See https://docs.getdbt.com/docs/package-management#section-specifying-package-versions[0m
[0m16:31:21.407520 [info ] [MainThread]: Installing https://github.com/kzzzr/dbtvault.git
[0m16:31:21.604229 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m16:31:21.607914 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:21.609338 [debug] [MainThread]: STDERR: "b"fatal: destination path '8f67def39d1e3209f86c5b38b1f63392' already exists and is not an empty directory.\n""
[0m16:31:21.610354 [debug] [MainThread]: command return code=128
[0m16:31:21.611730 [debug] [MainThread]: Updating existing dependency 8f67def39d1e3209f86c5b38b1f63392.
[0m16:31:21.612527 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:31:21.616235 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:31:21.617416 [debug] [MainThread]: STDERR: "b''"
[0m16:31:21.618482 [debug] [MainThread]:   Checking out revision master.
[0m16:31:21.619544 [debug] [MainThread]: Executing "git remote set-branches origin master"
[0m16:31:21.624119 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:21.625508 [debug] [MainThread]: STDERR: "b''"
[0m16:31:21.626521 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags master"
[0m16:31:22.483343 [debug] [MainThread]: STDOUT: "b''"
[0m16:31:22.484733 [debug] [MainThread]: STDERR: "b'From https://github.com/kzzzr/dbtvault\n * branch            master     -> FETCH_HEAD\n'"
[0m16:31:22.485916 [debug] [MainThread]: Executing "git tag --list"
[0m16:31:22.490653 [debug] [MainThread]: STDOUT: "b'v0.1-pre\nv0.2-pre\nv0.2.1-pre\nv0.2.2-pre\nv0.2.3-pre\nv0.2.4-pre\nv0.3-pre\nv0.3.1-pre\nv0.3.2-pre\nv0.3.3-pre\nv0.4\nv0.4.1\nv0.5\nv0.6\nv0.6-b1\nv0.6-b2\nv0.6.1\nv0.6.2\nv0.7.0\nv0.7.1\nv0.7.2\nv0.7.3\n'"
[0m16:31:22.491972 [debug] [MainThread]: STDERR: "b''"
[0m16:31:22.492905 [debug] [MainThread]: Executing "git reset --hard origin/master"
[0m16:31:22.499783 [debug] [MainThread]: STDOUT: "b'HEAD is now at 8ee9ee8 Adapt to Greenplum\n'"
[0m16:31:22.501274 [debug] [MainThread]: STDERR: "b''"
[0m16:31:22.502644 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m16:31:22.506622 [debug] [MainThread]: STDOUT: "b'8ee9ee882a9b3f3e4c334b38ef6460eafc12af06\n'"
[0m16:31:22.507941 [debug] [MainThread]: STDERR: "b''"
[0m16:31:22.508957 [debug] [MainThread]: Already at 8ee9ee8, nothing to do.
[0m16:31:24.756366 [info ] [MainThread]:   Installed from revision master
[0m16:31:24.757729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0fc06dd5-34d5-4a37-9cc7-6e695c2d71eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09da63130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09da632e0>]}
[0m16:31:24.759038 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:31:28.796766 [info ] [MainThread]:   Installed from version 1.3.0
[0m16:31:28.797875 [info ] [MainThread]:   Up to date!
[0m16:31:28.799150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0fc06dd5-34d5-4a37-9cc7-6e695c2d71eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e786b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e0f9c40>]}
[0m16:31:28.800473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09db0abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e7ad640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe09e786b80>]}
[0m16:31:28.801501 [debug] [MainThread]: Flushing usage events


============================== 2024-09-02 16:32:43.879303 | b6b2e228-5498-4ec0-a790-da78f8975217 ==============================
[0m16:32:43.879303 [info ] [MainThread]: Running with dbt=1.4.0
[0m16:32:43.881639 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m16:32:43.882748 [debug] [MainThread]: Tracking: tracking
[0m16:32:43.886959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88d6227970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88d6227df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88d61bb8b0>]}
[0m16:32:44.087277 [debug] [MainThread]: Executing "git --help"
[0m16:32:44.092695 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:32:44.094258 [debug] [MainThread]: STDERR: "b''"
[0m16:32:44.102128 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:32:44.104106 [debug] [MainThread]: Using postgres connection "debug"
[0m16:32:44.105893 [debug] [MainThread]: On debug: select 1 as id
[0m16:32:44.107507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:44.132376 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m16:32:44.135478 [debug] [MainThread]: On debug: Close
[0m16:32:44.137118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88d62271c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88d49bee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88d49becd0>]}
[0m16:32:44.139033 [debug] [MainThread]: Flushing usage events
[0m16:32:44.932356 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2024-09-03 15:23:12.253842 | 336d272b-2618-4a1f-8043-d255e6f58a47 ==============================
[0m15:23:12.253842 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:23:12.256963 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:23:12.259208 [debug] [MainThread]: Tracking: tracking
[0m15:23:12.267901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd840c1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd840b6ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd840b6eb0>]}
[0m15:23:12.282524 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-fp2eqvqp'
[0m15:23:12.284509 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"


============================== 2024-09-03 15:25:14.535265 | 1487d002-e3c6-4643-8178-6ebe3012a87e ==============================
[0m15:25:14.535265 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:25:14.537935 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:25:14.541925 [debug] [MainThread]: Tracking: tracking
[0m15:25:14.551839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bc103160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bc103d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bc1036a0>]}
[0m15:25:14.556212 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m4q3_cys'
[0m15:25:14.558706 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
[0m15:27:25.470798 [debug] [MainThread]: STDOUT: "b''"
[0m15:27:25.472711 [debug] [MainThread]: STDERR: "b"Cloning into '8f67def39d1e3209f86c5b38b1f63392'...\nfatal: unable to access 'https://github.com/kzzzr/dbtvault.git/': Failed to connect to github.com port 443: Connection timed out\n""
[0m15:27:25.474163 [debug] [MainThread]: command return code=128
[0m15:27:25.476184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bc176fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bc1514c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bc1513a0>]}
[0m15:27:25.477792 [debug] [MainThread]: Flushing usage events
[0m15:27:35.611652 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m15:27:35.614728 [error] [MainThread]: Encountered an error:
Internal Error
  Error checking out spec='None' for repo https://github.com/kzzzr/dbtvault.git
  Cloning into '8f67def39d1e3209f86c5b38b1f63392'...
  fatal: unable to access 'https://github.com/kzzzr/dbtvault.git/': Failed to connect to github.com port 443: Connection timed out


============================== 2024-09-03 15:30:40.525298 | ad5f4de3-2672-4aff-a472-4d4e4efc12a0 ==============================
[0m15:30:40.525298 [info ] [MainThread]: Running with dbt=1.4.0
[0m15:30:40.527936 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/workspace', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m15:30:40.529210 [debug] [MainThread]: Tracking: tracking
[0m15:30:40.534644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b9704100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b9704cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8b9704670>]}
[0m15:30:40.538331 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p7zsjcgf'
[0m15:30:40.540072 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/kzzzr/dbtvault.git 8f67def39d1e3209f86c5b38b1f63392"
